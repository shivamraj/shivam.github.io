var Mailcheck,UpdateHomeInfoViewModel,RoomViewModel,matchMessageCenterPopupBuilder;!function(n){function t(n,t){if(!(n.originalEvent.touches.length>1)){n.preventDefault();var i=n.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null);n.target.dispatchEvent(r)}}if(n.support.touch="ontouchend"in document,n.support.touch){var r,i=n.ui.mouse.prototype,u=i._mouseInit,f=i._mouseDestroy;i._touchStart=function(n){var i=this;!r&&i._mouseCapture(n.originalEvent.changedTouches[0])&&(r=!0,i._touchMoved=!1,t(n,"mouseover"),t(n,"mousemove"),t(n,"mousedown"))};i._touchMove=function(n){r&&(this._touchMoved=!0,t(n,"mousemove"))};i._touchEnd=function(n){r&&(t(n,"mouseup"),t(n,"mouseout"),this._touchMoved||t(n,"click"),r=!1)};i._mouseInit=function(){var t=this;t.element.bind({touchstart:n.proxy(t,"_touchStart"),touchmove:n.proxy(t,"_touchMove"),touchend:n.proxy(t,"_touchEnd")});u.call(t)};i._mouseDestroy=function(){var t=this;t.element.unbind({touchstart:n.proxy(t,"_touchStart"),touchmove:n.proxy(t,"_touchMove"),touchend:n.proxy(t,"_touchEnd")});f.call(t)}}}(jQuery);window.Modernizr=function(n,t,i){function a(n){c.cssText=n}function vt(n,t){return a(y.join(n+";")+(t||""))}function h(n,t){return typeof n===t}function v(n,t){return!!~(""+n).indexOf(t)}function lt(n,t){var u,r;for(u in n)if(r=n[u],!v(r,"-")&&c[r]!==i)return t=="pfx"?r:!0;return!1}function yt(n,t,r){var f,u;for(f in n)if(u=t[n[f]],u!==i)return r===!1?n[f]:h(u,"function")?u.bind(r||t):u;return!1}function f(n,t,i){var r=n.charAt(0).toUpperCase()+n.slice(1),u=(n+" "+ot.join(r+" ")+r).split(" ");return h(t,"string")||h(t,"undefined")?lt(u,t):(u=(n+" "+st.join(r+" ")+r).split(" "),yt(u,t,i))}function pt(){u.input=function(i){for(var r=0,u=i.length;r<u;r++)w[i[r]]=!!(i[r]in o);return w.list&&(w.list=!!(t.createElement("datalist")&&n.HTMLDataListElement)),w}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" "));u.inputtypes=function(n){for(var u=0,r,f,e,h=n.length;u<h;u++)o.setAttribute("type",f=n[u]),r=o.type!=="text",r&&(o.value=g,o.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&o.style.WebkitAppearance!==i?(s.appendChild(o),e=t.defaultView,r=e.getComputedStyle&&e.getComputedStyle(o,null).WebkitAppearance!=="textfield"&&o.offsetHeight!==0,s.removeChild(o)):/^(search|tel)$/.test(f)||(r=/^(url|email)$/.test(f)?o.checkValidity&&o.checkValidity()===!1:o.value!=g)),ht[n[u]]=!!r;return ht}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var u={},d=!0,s=t.documentElement,e="modernizr",ut=t.createElement(e),c=ut.style,o=t.createElement("input"),g=":)",ft={}.toString,y=" -webkit- -moz- -o- -ms- ".split(" "),et="Webkit Moz O ms",ot=et.split(" "),st=et.toLowerCase().split(" "),p={svg:"http://www.w3.org/2000/svg"},r={},ht={},w={},nt=[],tt=nt.slice,b,l=function(n,i,r,u){var l,a,c,v,f=t.createElement("div"),h=t.body,o=h||t.createElement("body");if(parseInt(r,10))while(r--)c=t.createElement("div"),c.id=u?u[r]:e+(r+1),f.appendChild(c);return l=["&#173;",'<style id="s',e,'">',n,"<\/style>"].join(""),f.id=e,(h?f:o).innerHTML+=l,o.appendChild(f),h||(o.style.background="",o.style.overflow="hidden",v=s.style.overflow,s.style.overflow="hidden",s.appendChild(o)),a=i(f,n),h?f.parentNode.removeChild(f):(o.parentNode.removeChild(o),s.style.overflow=v),!!a},at=function(t){var i=n.matchMedia||n.msMatchMedia,r;return i?i(t).matches:(l("@media "+t+" { #"+e+" { position: absolute; } }",function(t){r=(n.getComputedStyle?getComputedStyle(t,null):t.currentStyle).position=="absolute"}),r)},ct=function(){function r(r,u){u=u||t.createElement(n[r]||"div");r="on"+r;var f=r in u;return f||(u.setAttribute||(u=t.createElement("div")),u.setAttribute&&u.removeAttribute&&(u.setAttribute(r,""),f=h(u[r],"function"),h(u[r],"undefined")||(u[r]=i),u.removeAttribute(r))),u=null,f}var n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return r}(),it={}.hasOwnProperty,rt,k;rt=h(it,"undefined")||h(it.call,"undefined")?function(n,t){return t in n&&h(n.constructor.prototype[t],"undefined")}:function(n,t){return it.call(n,t)};Function.prototype.bind||(Function.prototype.bind=function(n){var t=this,i,r;if(typeof t!="function")throw new TypeError;return i=tt.call(arguments,1),r=function(){var f,e,u;return this instanceof r?(f=function(){},f.prototype=t.prototype,e=new f,u=t.apply(e,i.concat(tt.call(arguments))),Object(u)===u)?u:e:t.apply(n,i.concat(tt.call(arguments)))},r});r.flexbox=function(){return f("flexWrap")};r.flexboxlegacy=function(){return f("boxDirection")};r.canvas=function(){var n=t.createElement("canvas");return!!(n.getContext&&n.getContext("2d"))};r.canvastext=function(){return!!(u.canvas&&h(t.createElement("canvas").getContext("2d").fillText,"function"))};r.webgl=function(){return!!n.WebGLRenderingContext};r.touch=function(){var i;return"ontouchstart"in n||n.DocumentTouch&&t instanceof DocumentTouch?i=!0:l(["@media (",y.join("touch-enabled),("),e,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(n){i=n.offsetTop===9}),i};r.geolocation=function(){return"geolocation"in navigator};r.postmessage=function(){return!!n.postMessage};r.websqldatabase=function(){return!!n.openDatabase};r.indexedDB=function(){return!!f("indexedDB",n)};r.hashchange=function(){return ct("hashchange",n)&&(t.documentMode===i||t.documentMode>7)};r.history=function(){return!!(n.history&&history.pushState)};r.draganddrop=function(){var n=t.createElement("div");return"draggable"in n||"ondragstart"in n&&"ondrop"in n};r.websockets=function(){return"WebSocket"in n||"MozWebSocket"in n};r.rgba=function(){return a("background-color:rgba(150,255,150,.5)"),v(c.backgroundColor,"rgba")};r.hsla=function(){return a("background-color:hsla(120,40%,100%,.5)"),v(c.backgroundColor,"rgba")||v(c.backgroundColor,"hsla")};r.multiplebgs=function(){return a("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(c.background)};r.backgroundsize=function(){return f("backgroundSize")};r.borderimage=function(){return f("borderImage")};r.borderradius=function(){return f("borderRadius")};r.boxshadow=function(){return f("boxShadow")};r.textshadow=function(){return t.createElement("div").style.textShadow===""};r.opacity=function(){return vt("opacity:.55"),/^0.55$/.test(c.opacity)};r.cssanimations=function(){return f("animationName")};r.csscolumns=function(){return f("columnCount")};r.cssgradients=function(){var n="background-image:";return a((n+"-webkit- ".split(" ").join("gradient(linear,left top,right bottom,from(#9f9),to(white));"+n)+y.join("linear-gradient(left top,#9f9, white);"+n)).slice(0,-n.length)),v(c.backgroundImage,"gradient")};r.cssreflections=function(){return f("boxReflect")};r.csstransforms=function(){return!!f("transform")};r.csstransforms3d=function(){var n=!!f("perspective");return n&&"webkitPerspective"in s.style&&l("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t){n=t.offsetLeft===9&&t.offsetHeight===3}),n};r.csstransitions=function(){return f("transition")};r.fontface=function(){var n;return l('@font-face {font-family:"font";src:url("https://")}',function(i,r){var f=t.getElementById("smodernizr"),u=f.sheet||f.styleSheet,e=u?u.cssRules&&u.cssRules[0]?u.cssRules[0].cssText:u.cssText||"":"";n=/src/i.test(e)&&e.indexOf(r.split(" ")[0])===0}),n};r.generatedcontent=function(){var n;return l(["#",e,"{font:0/0 a}#",e,':after{content:"',g,'";visibility:hidden;font:3px/1 a}'].join(""),function(t){n=t.offsetHeight>=3}),n};r.video=function(){var i=t.createElement("video"),n=!1;try{(n=!!i.canPlayType)&&(n=new Boolean(n),n.ogg=i.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),n.h264=i.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),n.webm=i.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(r){}return n};r.audio=function(){var i=t.createElement("audio"),n=!1;try{(n=!!i.canPlayType)&&(n=new Boolean(n),n.ogg=i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),n.mp3=i.canPlayType("audio/mpeg;").replace(/^no$/,""),n.wav=i.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),n.m4a=(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(r){}return n};r.localstorage=function(){try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(n){return!1}};r.sessionstorage=function(){try{return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(n){return!1}};r.webworkers=function(){return!!n.Worker};r.applicationcache=function(){return!!n.applicationCache};r.svg=function(){return!!t.createElementNS&&!!t.createElementNS(p.svg,"svg").createSVGRect};r.inlinesvg=function(){var n=t.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==p.svg};r.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(ft.call(t.createElementNS(p.svg,"animate")))};r.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(ft.call(t.createElementNS(p.svg,"clipPath")))};for(k in r)rt(r,k)&&(b=k.toLowerCase(),u[b]=r[k](),nt.push((u[b]?"":"no-")+b));return u.input||pt(),u.addTest=function(n,t){if(typeof n=="object")for(var r in n)rt(n,r)&&u.addTest(r,n[r]);else{if(n=n.toLowerCase(),u[n]!==i)return u;t=typeof t=="function"?t():t;typeof d!="undefined"&&d&&(s.className+=" "+(t?"":"no-")+n);u[n]=t}return u},a(""),ut=o=null,function(n,t){function p(n,t){var i=n.createElement("p"),r=n.getElementsByTagName("head")[0]||n.documentElement;return i.innerHTML="x<style>"+t+"<\/style>",r.insertBefore(i.lastChild,r.firstChild)}function c(){var n=r.elements;return typeof n=="string"?n.split(" "):n}function o(n){var t=h[n[s]];return t||(t={},e++,n[s]=e,h[e]=t),t}function l(n,r,u){if(r||(r=t),i)return r.createElement(n);u||(u=o(r));var f;return f=u.cache[n]?u.cache[n].cloneNode():y.test(n)?(u.cache[n]=u.createElem(n)).cloneNode():u.createElem(n),f.canHaveChildren&&!v.test(n)?u.frag.appendChild(f):f}function w(n,r){if(n||(n=t),i)return n.createDocumentFragment();r=r||o(n);for(var f=r.frag.cloneNode(),u=0,e=c(),s=e.length;u<s;u++)f.createElement(e[u]);return f}function b(n,t){t.cache||(t.cache={},t.createElem=n.createElement,t.createFrag=n.createDocumentFragment,t.frag=t.createFrag());n.createElement=function(i){return r.shivMethods?l(i,n,t):t.createElem(i)};n.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+c().join().replace(/\w+/g,function(n){return t.createElem(n),t.frag.createElement(n),'c("'+n+'")'})+");return n}")(r,t.frag)}function a(n){n||(n=t);var u=o(n);return!r.shivCSS||f||u.hasCSS||(u.hasCSS=!!p(n,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),i||b(n,u),n}var u=n.html5||{},v=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,y=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,f,s="_html5shiv",e=0,h={},i,r;(function(){try{var n=t.createElement("a");n.innerHTML="<xyz><\/xyz>";f="hidden"in n;i=n.childNodes.length==1||function(){t.createElement("a");var n=t.createDocumentFragment();return typeof n.cloneNode=="undefined"||typeof n.createDocumentFragment=="undefined"||typeof n.createElement=="undefined"}()}catch(r){f=!0;i=!0}})();r={elements:u.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:u.shivCSS!==!1,supportsUnknownElements:i,shivMethods:u.shivMethods!==!1,type:"default",shivDocument:a,createElement:l,createDocumentFragment:w};n.html5=r;a(t)}(this,t),u._version="2.6.2",u._prefixes=y,u._domPrefixes=st,u._cssomPrefixes=ot,u.mq=at,u.hasEvent=ct,u.testProp=function(n){return lt([n])},u.testAllProps=f,u.testStyles=l,u.prefixed=function(n,t,i){return t?f(n,t,i):f(n,"pfx")},s.className=s.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(d?" js "+nt.join(" "):""),u}(this,this.document),function(n){n.fn.jsonify=function(i){function r(t,i,u){i.each(function(){var i=n(this),f=c(i,u);f&&t.push([f,i]);r(t,i.children(),f)})}function o(n,t,i){for(var f,c,u=0;u<n.length;u++){var y=n[u][0],w=n[u][1],a=y.split("."),p=s(w),r=t;for(f=0;f<a.length;f++){var e=l(a[f]),o=e[0],b=f==a.length-1,v={};b&&p!==undefined&&(v=p);r=o in r?r[o]:e[1]?r[o]=[]:r[o]=v;e[1]&&(c=e[2]||h(y,i),r=r[c]?r[c]:r[c]=v)}}}function s(n){var t=n.attr("data-type")||"default",i=e.parser[t];if(typeof i!="function")throw"Parser for data type '"+t+"' not found.";return i(n)}function h(n,t){return n in t?++t[n]:t[n]=0}function c(n,t){var i=n.attr("data-name")||n.attr("name"),r=n.attr("data-checked"),u=n.attr("data-ignore");return u||r&&(r==="0"||r.toLowerCase()==="false"||r.toLowerCase()==="no")?null:t&&i?t+"."+i:i?i:null}function l(n){var r=n.length,t,i,u,f;if(n[r-1]=="]"){for(t=null,i=r-2;i>0;i--)if(n[i]==="["){t=i;break}return u=n.substring(0,t),f=t&&t<r-2?n.substring(t+1,r-1):null,[u,!0,f]}return[n,!1]}var e=n.extend(!0,{},t,i),u=[],f={};return r(u,this),o(u,f,{}),f};var t={};t.parser={"default":function(n){if(n.is('input[type="checkbox"],input[type="radio"]'))return n.is(":checked");if(n.is("select"))return n.val()===""?null:n.val();var t=n.data("value");return t===undefined&&(t=n.val()),t}};n.jsonify=function(i){t=n.extend(!0,{},t,i)}}(jQuery),function(n){"use strict";var t=n.jCarousel={},i;t.version="0.3.0-beta.5";i=/^([+\-]=)?(.+)$/;t.parseTarget=function(n){var r=!1,t=typeof n!="object"?i.exec(n):null;return t?(n=parseInt(t[2],10)||0,t[1]&&(r=!0,t[1]==="-="&&(n*=-1))):typeof n!="object"&&(n=parseInt(n,10)||0),{target:n,relative:r}};t.detectCarousel=function(n){for(var t;n.size()>0;){if((t=n.filter("[data-jcarousel]"),t.size()>0)||(t=n.find("[data-jcarousel]"),t.size()>0))return t;n=n.parent()}return null};t.base=function(i){return{version:t.version,_options:{},_element:null,_carousel:null,_init:n.noop,_create:n.noop,_destroy:n.noop,_reload:n.noop,create:function(){return(this._element.attr("data-"+i.toLowerCase(),!0).data(i,this),!1===this._trigger("create"))?this:(this._create(),this._trigger("createend"),this)},destroy:function(){return!1===this._trigger("destroy")?this:(this._destroy(),this._trigger("destroyend"),this._element.removeData(i).removeAttr("data-"+i.toLowerCase()),this)},reload:function(n){return!1===this._trigger("reload")?this:(n&&this.options(n),this._reload(),this._trigger("reloadend"),this)},element:function(){return this._element},options:function(t,i){if(arguments.length===0)return n.extend({},this._options);if(typeof t=="string"){if(typeof i=="undefined")return typeof this._options[t]=="undefined"?null:this._options[t];this._options[t]=i}else this._options=n.extend({},this._options,t);return this},carousel:function(){return this._carousel||(this._carousel=t.detectCarousel(this.options("carousel")||this._element),this._carousel||n.error('Could not detect carousel for plugin "'+i+'"')),this._carousel},_trigger:function(t,r,u){var f,e=!1;return u=[this].concat(u||[]),(r||this._element).each(function(){f=n.Event((t+"."+i).toLowerCase());n(this).trigger(f,u);f.isDefaultPrevented()&&(e=!0)}),!e}}};t.plugin=function(i,r){var u=n[i]=function(t,i){this._element=n(t);this.options(i);this._init();this.create()};return u.fn=u.prototype=n.extend({},t.base(i),r),n.fn[i]=function(t){var f=Array.prototype.slice.call(arguments,1),r=this;return typeof t=="string"?this.each(function(){var u=n(this).data(i),e;return u?!n.isFunction(u[t])||t.charAt(0)==="_"?n.error('No such method "'+t+'" for '+i+" instance"):(e=u[t].apply(u,f),e!==u&&typeof e!="undefined"?(r=e,!1):void 0):n.error("Cannot call methods on "+i+' prior to initialization; attempted to call method "'+t+'"')}):this.each(function(){var r=n(this).data(i);r instanceof u?r.reload(t):new u(this,t)}),r},u}}(jQuery),function(n,t){"use strict";var i=function(n){return parseFloat(n)||0};n.jCarousel.plugin("jcarousel",{animating:!1,tail:0,inTail:!1,resizeTimer:null,lt:null,vertical:!1,rtl:!1,circular:!1,underflow:!1,_options:{list:function(){return this.element().children().eq(0)},items:function(){return this.list().children()},animation:400,transitions:!1,wrap:null,vertical:null,rtl:null,center:!1},_list:null,_items:null,_target:null,_first:null,_last:null,_visible:null,_fullyvisible:null,_init:function(){var n=this;return this.onWindowResize=function(){n.resizeTimer&&clearTimeout(n.resizeTimer);n.resizeTimer=setTimeout(function(){n.reload()},100)},this},_create:function(){this._reload();n(t).on("resize.jcarousel",this.onWindowResize)},_destroy:function(){n(t).off("resize.jcarousel",this.onWindowResize)},_reload:function(){var t,i;return this.vertical=this.options("vertical"),this.vertical==null&&(this.vertical=this.list().height()>this.list().width()),this.rtl=this.options("rtl"),this.rtl==null&&(this.rtl=function(t){if((""+t.attr("dir")).toLowerCase()==="rtl")return!0;var i=!1;return t.parents("[dir]").each(function(){if(/rtl/i.test(n(this).attr("dir")))return i=!0,!1}),i}(this._element)),this.lt=this.vertical?"top":"left",this._list=null,this._items=null,t=this._target&&this.index(this._target)>=0?this._target:this.closest(),this.circular=this.options("wrap")==="circular",this.underflow=!1,i={left:0,top:0},t.size()>0&&(this._prepare(t),this.list().find("[data-jcarousel-clone]").remove(),this._items=null,this.underflow=this._fullyvisible.size()>=this.items().size(),this.circular=this.circular&&!this.underflow,i[this.lt]=this._position(t)+"px"),this.move(i),this},list:function(){if(this._list===null){var t=this.options("list");this._list=n.isFunction(t)?t.call(this):this._element.find(t)}return this._list},items:function(){if(this._items===null){var t=this.options("items");this._items=(n.isFunction(t)?t.call(this):this.list().find(t)).not("[data-jcarousel-clone]")}return this._items},index:function(n){return this.items().index(n)},closest:function(){var e=this,t=this.list().position()[this.lt],r=n(),u=!1,o=this.vertical?"bottom":this.rtl?"left":"right",f;return this.rtl&&!this.vertical&&(t=(t+this.list().width()-this.clipping())*-1),this.items().each(function(){if(r=n(this),u)return!1;var s=e.dimension(r);if(t+=s,t>=0)if(f=s-i(r.css("margin-"+o)),Math.abs(t)-s+f/2<=0)u=!0;else return!1}),r},target:function(){return this._target},first:function(){return this._first},last:function(){return this._last},visible:function(){return this._visible},fullyvisible:function(){return this._fullyvisible},hasNext:function(){if(!1===this._trigger("hasnext"))return!0;var n=this.options("wrap"),t=this.items().size()-1;return t>=0&&(n&&n!=="first"||this.index(this._last)<t||this.tail&&!this.inTail)?!0:!1},hasPrev:function(){if(!1===this._trigger("hasprev"))return!0;var n=this.options("wrap");return this.items().size()>0&&(n&&n!=="last"||this.index(this._first)>0||this.tail&&this.inTail)?!0:!1},clipping:function(){return this._element["inner"+(this.vertical?"Height":"Width")]()},dimension:function(n){return n["outer"+(this.vertical?"Height":"Width")](!0)},scroll:function(t,r,u){var c,b,p,k;if(this.animating||!1===this._trigger("scroll",null,[t,r]))return this;if(n.isFunction(r)&&(u=r,r=!0),c=n.jCarousel.parseTarget(t),c.relative){var o=this.items().size()-1,v=Math.abs(c.target),e=this.options("wrap"),l,d,s,w,f,a,h,y;if(c.target>0)if(b=this.index(this._last),b>=o&&this.tail)this.inTail?e==="both"||e==="last"?this._scroll(0,r,u):this._scroll(Math.min(this.index(this._target)+v,o),r,u):this._scrollTail(r,u);else if(l=this.index(this._target),this.underflow&&l===o&&(e==="circular"||e==="both"||e==="last")||!this.underflow&&b===o&&(e==="both"||e==="last"))this._scroll(0,r,u);else if(s=l+v,this.circular&&s>o){for(y=o,f=this.items().get(-1);y++<s;)f=this.items().eq(0),a=this._visible.index(f)>=0,a&&f.after(f.clone(!0).attr("data-jcarousel-clone",!0)),this.list().append(f),a||(h={},h[this.lt]=this.dimension(f)*(this.rtl?-1:1),this.moveBy(h)),this._items=null;this._scroll(f,r,u)}else this._scroll(Math.min(s,o),r,u);else if(this.inTail)this._scroll(Math.max(this.index(this._first)-v+1,0),r,u);else if(d=this.index(this._first),l=this.index(this._target),w=this.underflow?l:d,s=w-v,w<=0&&(this.underflow&&e==="circular"||e==="both"||e==="first"))this._scroll(o,r,u);else if(this.circular&&s<0){for(y=s,f=this.items().get(0);y++<0;)f=this.items().eq(-1),a=this._visible.index(f)>=0,a&&f.after(f.clone(!0).attr("data-jcarousel-clone",!0)),this.list().prepend(f),this._items=null,p=i(this.list().position()[this.lt]),k=this.dimension(f),this.rtl&&!this.vertical?p+=k:p-=k,h={},h[this.lt]=p+"px",this.move(h);this._scroll(f,r,u)}else this._scroll(Math.max(s,0),r,u)}else this._scroll(c.target,r,u);return this._trigger("scrollend"),this},moveBy:function(n,t){var r=this.list().position();return n.left&&(n.left=r.left+i(n.left)+"px"),n.top&&(n.top=r.top+i(n.top)+"px"),this.move(n,t)},move:function(t,i){var e,u,l,a;i=i||{};var o=this.options("transitions"),s=!!o,h=!!o.transforms,c=!!o.transforms3d,r=i.duration||0,f=this.list();if(!s&&r>0){f.animate(t,i);return}if(e=i.complete||n.noop,u={},s&&(l=f.css(["transitionDuration","transitionTimingFunction","transitionProperty"]),a=e,e=function(){n(this).css(l);a.call(this)},u={transitionDuration:(r>0?r/1e3:0)+"s",transitionTimingFunction:o.easing||i.easing,transitionProperty:r>0?function(){return h||c?"all":t.left?"left":"top"}():"none",transform:"none"}),c?u.transform="translate3d("+(t.left||0)+","+(t.top||0)+",0)":h?u.transform="translate("+(t.left||0)+","+(t.top||0)+")":n.extend(u,t),s&&r>0)f.one("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",e);f.css(u);r<=0&&f.each(function(){e.call(this)})},_scroll:function(t,r,u){var f,o,e;return this.animating?(n.isFunction(u)&&u.call(this,!1),this):(typeof t!="object"?t=this.items().eq(t):typeof t.jquery=="undefined"&&(t=n(t)),t.size()===0)?(n.isFunction(u)&&u.call(this,!1),this):(this.inTail=!1,this._prepare(t),f=this._position(t),o=i(this.list().position()[this.lt]),f===o)?(n.isFunction(u)&&u.call(this,!1),this):(e={},e[this.lt]=f+"px",this._animate(e,r,u),this)},_scrollTail:function(t,i){var r,u;return this.animating||!this.tail?(n.isFunction(i)&&i.call(this,!1),this):(r=this.list().position()[this.lt],this.rtl?r+=this.tail:r-=this.tail,this.inTail=!0,u={},u[this.lt]=r+"px",this._update({target:this._target.next(),fullyvisible:this._fullyvisible.slice(1).add(this._visible.last())}),this._animate(u,t,i),this)},_animate:function(t,i,r){if(r=r||n.noop,!1===this._trigger("animate"))return r.call(this,!1),this;this.animating=!0;var f=this.options("animation"),e=n.proxy(function(){this.animating=!1;var n=this.list().find("[data-jcarousel-clone]");n.size()>0&&(n.remove(),this._reload());this._trigger("animateend");r.call(this,!0)},this),u=typeof f=="object"?n.extend({},f):{duration:f},o=u.complete||n.noop;return i===!1?u.duration=0:typeof n.fx.speeds[u.duration]!="undefined"&&(u.duration=n.fx.speeds[u.duration]),u.complete=function(){e();o.call(this)},this.move(t,u),this},_prepare:function(t){var v=this.index(t),o=v,u=this.dimension(t),e=this.clipping(),h=this.vertical?"bottom":this.rtl?"left":"right",c=this.options("center"),f={target:t,first:t,last:t,visible:t,fullyvisible:u<=e?t:n()},r,l,s,a;if(c&&(u/=2,e/=2),u<e)for(;;){if(r=this.items().eq(++o),r.size()===0){if(!this.circular)break;if(r=this.items().eq(0),t.get(0)===r.get(0))break;l=this._visible.index(r)>=0;l&&r.after(r.clone(!0).attr("data-jcarousel-clone",!0));this.list().append(r);l||(a={},a[this.lt]=this.dimension(r)*(this.rtl?-1:1),this.moveBy(a));this._items=null}if(u+=this.dimension(r),f.last=r,f.visible=f.visible.add(r),s=i(r.css("margin-"+h)),u-s<=e&&(f.fullyvisible=f.fullyvisible.add(r)),u>=e)break}if(!this.circular&&!c&&u<e)for(o=v;;){if(--o<0)break;if(r=this.items().eq(o),r.size()===0)break;if(u+=this.dimension(r),f.first=r,f.visible=f.visible.add(r),s=i(r.css("margin-"+h)),u-s<=e&&(f.fullyvisible=f.fullyvisible.add(r)),u>=e)break}return this._update(f),this.tail=0,c||this.options("wrap")==="circular"||this.options("wrap")==="custom"||this.index(f.last)!==this.items().size()-1||(u-=i(f.last.css("margin-"+h)),u>e&&(this.tail=u-e)),this},_position:function(n){var i=this._first,t=i.position()[this.lt],r=this.options("center"),u=r?this.clipping()/2-this.dimension(i)/2:0;return this.rtl&&!this.vertical?(t-=this.clipping()-this.dimension(i),t+=u):t-=u,!r&&(this.index(n)>this.index(i)||this.inTail)&&this.tail?(t=this.rtl?t-this.tail:t+this.tail,this.inTail=!0):this.inTail=!1,-t},_update:function(t){var r=this,i={target:this._target||n(),first:this._first||n(),last:this._last||n(),visible:this._visible||n(),fullyvisible:this._fullyvisible||n()},f=this.index(t.first||i.first)<this.index(i.first),u,e=function(u){var e=[],o=[];t[u].each(function(){i[u].index(this)<0&&e.push(this)});i[u].each(function(){t[u].index(this)<0&&o.push(this)});f?e=e.reverse():o=o.reverse();r._trigger("item"+u+"in",n(e));r._trigger("item"+u+"out",n(o));r["_"+u]=t[u]};for(u in t)e(u);return this}})}(jQuery,window),function(n){"use strict";n.jcarousel.fn.scrollIntoView=function(t,i,r){var f=n.jCarousel.parseTarget(t),o=this.index(this._fullyvisible.first()),h=this.index(this._fullyvisible.last()),u,l;if(u=f.relative?f.target<0?Math.max(0,o+f.target):h+f.target:typeof f.target!="object"?f.target:this.index(f.target),u<o)return this.scroll(u,i,r);if(u>=o&&u<=h)return n.isFunction(r)&&r.call(this,!1),this;for(var a=this.items(),c=this.clipping(),v=this.vertical?"bottom":this.rtl?"left":"right",s=0,e;;){if(e=a.eq(u),e.size()===0)break;if(s+=this.dimension(e),s>=c){l=parseFloat(e.css("margin-"+v))||0;s-l!==c&&u++;break}if(u<=0)break;u--}return this.scroll(u,i,r)}}(jQuery),function(n){"use strict";n.jCarousel.plugin("jcarouselControl",{_options:{target:"+=1",event:"click",method:"scroll"},_active:null,_init:function(){this.onDestroy=n.proxy(function(){this._destroy();this.carousel().one("createend.jcarousel",n.proxy(this._create,this))},this);this.onReload=n.proxy(this._reload,this);this.onEvent=n.proxy(function(t){t.preventDefault();var i=this.options("method");n.isFunction(i)?i.call(this):this.carousel().jcarousel(this.options("method"),this.options("target"))},this)},_create:function(){this.carousel().one("destroy.jcarousel",this.onDestroy).on("reloadend.jcarousel scrollend.jcarousel",this.onReload);this._element.on(this.options("event")+".jcarouselcontrol",this.onEvent);this._reload()},_destroy:function(){this._element.off(".jcarouselcontrol",this.onEvent);this.carousel().off("destroy.jcarousel",this.onDestroy).off("reloadend.jcarousel scrollend.jcarousel",this.onReload)},_reload:function(){var t=n.jCarousel.parseTarget(this.options("target")),r=this.carousel(),i,u;return t.relative?i=r.jcarousel(t.target>0?"hasNext":"hasPrev"):(u=typeof t.target!="object"?r.jcarousel("items").eq(t.target):t.target,i=r.jcarousel("target").index(u)>=0),this._active!==i&&(this._trigger(i?"active":"inactive"),this._active=i),this}})}(jQuery),function(n){"use strict";n.jCarousel.plugin("jcarouselPagination",{_options:{perPage:null,item:function(n){return'<a href="#'+n+'">'+n+"<\/a>"},event:"click",method:"scroll"},_pages:{},_items:{},_currentPage:null,_init:function(){this.onDestroy=n.proxy(function(){this._destroy();this.carousel().one("createend.jcarousel",n.proxy(this._create,this))},this);this.onReload=n.proxy(this._reload,this);this.onScroll=n.proxy(this._update,this)},_create:function(){this.carousel().one("destroy.jcarousel",this.onDestroy).on("reloadend.jcarousel",this.onReload).on("scrollend.jcarousel",this.onScroll);this._reload()},_destroy:function(){this._clear();this.carousel().off("destroy.jcarousel",this.onDestroy).off("reloadend.jcarousel",this.onReload).off("scrollend.jcarousel",this.onScroll)},_reload:function(){var i=this.options("perPage");if(this._pages={},this._items={},n.isFunction(i)&&(i=i.call(this)),i==null)this._pages=this._calculatePages();else for(var o=parseInt(i,10)||0,s=this.carousel().jcarousel("items"),u=1,e=0,f;;){if(f=s.eq(e++),f.size()===0)break;this._pages[u]=this._pages[u]?this._pages[u].add(f):f;e%o==0&&u++}this._clear();var r=this,t=this.carousel().data("jcarousel"),h=this._element,c=this.options("item");n.each(this._pages,function(i,u){var f=r._items[i]=n(c.call(r,i,u));f.on(r.options("event")+".jcarouselpagination",n.proxy(function(){var e=u.eq(0),n,f;t.circular&&(n=t.index(t.target()),f=t.index(e),parseFloat(i)>parseFloat(r._currentPage)?f<n&&(e="+="+(t.items().size()-n+f)):f>n&&(e="-="+(n+(t.items().size()-f))));t[this.options("method")](e)},r));h.append(f)});this._update()},_update:function(){var i=this.carousel().jcarousel("target"),t;n.each(this._pages,function(n,r){return r.each(function(){if(i.is(this))return t=n,!1}),t?!1:void 0});this._currentPage!==t&&(this._trigger("inactive",this._items[this._currentPage]),this._trigger("active",this._items[t]));this._currentPage=t},items:function(){return this._items},_clear:function(){this._element.empty();this._currentPage=null},_calculatePages:function(){for(var r=this.carousel().data("jcarousel"),f=r.items(),e=r.clipping(),u=0,o=0,t=1,i={},n;;){if(n=f.eq(o++),n.size()===0)break;i[t]=i[t]?i[t].add(n):n;u+=r.dimension(n);u>=e&&(t++,u=0)}return i}})}(jQuery),function(n){"use strict";n.jCarousel.plugin("jcarouselAutoscroll",{_options:{target:"+=1",interval:3e3,autostart:!0},_timer:null,_init:function(){this.onDestroy=n.proxy(function(){this._destroy();this.carousel().one("createend.jcarousel",n.proxy(this._create,this))},this);this.onAnimateEnd=n.proxy(this.start,this)},_create:function(){this.carousel().one("destroy.jcarousel",this.onDestroy);this.options("autostart")&&this.start()},_destroy:function(){this.stop();this.carousel().off("destroy.jcarousel",this.onDestroy)},start:function(){this.stop();this.carousel().one("animateend.jcarousel",this.onAnimateEnd);return this._timer=setTimeout(n.proxy(function(){this.carousel().jcarousel("scroll",this.options("target"))},this),this.options("interval")),this},stop:function(){return this._timer&&(this._timer=clearTimeout(this._timer)),this.carousel().off("animateend.jcarousel",this.onAnimateEnd),this}})}(jQuery),function(n){"use strict";n.jCarousel.plugin("jcarouselControl",{_options:{target:"+=1",event:"click",method:"scroll"},_active:null,_init:function(){this.onDestroy=n.proxy(function(){this._destroy();this.carousel().one("createend.jcarousel",n.proxy(this._create,this))},this);this.onReload=n.proxy(this._reload,this);this.onEvent=n.proxy(function(t){t.preventDefault();var i=this.options("method");n.isFunction(i)?i.call(this):this.carousel().jcarousel(this.options("method"),this.options("target"))},this)},_create:function(){this.carousel().one("destroy.jcarousel",this.onDestroy).on("reloadend.jcarousel scrollend.jcarousel",this.onReload);this._element.on(this.options("event")+".jcarouselcontrol",this.onEvent);this._reload()},_destroy:function(){this._element.off(".jcarouselcontrol",this.onEvent);this.carousel().off("destroy.jcarousel",this.onDestroy).off("reloadend.jcarousel scrollend.jcarousel",this.onReload)},_reload:function(){var t=n.jCarousel.parseTarget(this.options("target")),r=this.carousel(),i,u;return t.relative?i=r.jcarousel(t.target>0?"hasNext":"hasPrev"):(u=typeof t.target!="object"?r.jcarousel("items").eq(t.target):t.target,i=r.jcarousel("target").index(u)>=0),this._active!==i&&(this._trigger(i?"active":"inactive"),this._active=i),this}})}(jQuery),function(n){n.fn.extend({slimScroll:function(i){var r=n.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},i);return this.each(function(){function d(t){var t,i,f;l&&(t=t||window.event,i=0,t.wheelDelta&&(i=-t.wheelDelta/120),t.detail&&(i=t.detail/3),f=t.target||t.srcTarget||t.srcElement,n(f).closest("."+r.wrapperClass).is(u.parent())&&h(i,!0),t.preventDefault&&!o&&t.preventDefault(),o||(t.returnValue=!1))}function h(n,t,i){var s,l,h;o=!1;s=n;l=u.outerHeight()-f.outerHeight();t&&(s=parseInt(f.css("top"))+n*parseInt(r.wheelStep)/100*f.outerHeight(),s=Math.min(Math.max(s,0),l),s=n>0?Math.ceil(s):Math.floor(s),f.css({top:s+"px"}));e=parseInt(f.css("top"))/(u.outerHeight()-f.outerHeight());s=e*(u[0].scrollHeight-u.outerHeight());i&&(s=n,h=s/u[0].scrollHeight*u.outerHeight(),h=Math.min(Math.max(h,0),l),f.css({top:h+"px"}));u.scrollTop(s);u.trigger("slimscrolling",~~s);nt();c()}function et(){window.addEventListener?(this.addEventListener("DOMMouseScroll",d,!1),this.addEventListener("mousewheel",d,!1)):document.attachEvent("onmousewheel",d)}function g(){a=Math.max(u.outerHeight()/u[0].scrollHeight*u.outerHeight(),ft);f.css({height:a+"px"});var n=a==u.outerHeight()?"none":"block";f.css({display:n})}function nt(){if(g(),clearTimeout(tt),e==~~e){if(o=r.allowPageScroll,it!=e){var n=~~e==0?"top":"bottom";u.trigger("slimscroll",n)}}else o=!1;if(it=e,a>=u.outerHeight()){o=!0;return}f.stop(!0,!0).fadeIn("fast");r.railVisible&&s.stop(!0,!0).fadeIn("fast")}function c(){r.alwaysVisible||(tt=setTimeout(function(){r.disableFadeOut&&l||y||p||(f.fadeOut("slow"),s.fadeOut("slow"))},1e3))}var l,y,p,tt,w,a,e,it,b="<div><\/div>",ft=30,o=!1,u=n(this),v,k,rt;if(u.parent().hasClass(r.wrapperClass)){if(v=u.scrollTop(),f=u.parent().find("."+r.barClass),s=u.parent().find("."+r.railClass),g(),n.isPlainObject(i)){if("height"in i&&i.height=="auto"&&(u.parent().css("height","auto"),u.css("height","auto"),k=u.parent().parent().height(),u.parent().css("height",k),u.css("height",k)),"scrollTo"in i)v=parseInt(r.scrollTo);else if("scrollBy"in i)v+=parseInt(r.scrollBy);else if("destroy"in i){f.remove();s.remove();u.unwrap();return}h(v,!1,!0)}return}if(!n.isPlainObject(i)||!("destroy"in i)){r.height=r.height=="auto"?u.parent().height():r.height;rt=n(b).addClass(r.wrapperClass).css({position:"relative",overflow:"hidden",width:r.width,height:r.height});u.css({overflow:"hidden",width:r.width,height:r.height});var s=n(b).addClass(r.railClass).css({width:r.size,height:"100%",position:"absolute",top:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.railBorderRadius,background:r.railColor,opacity:r.railOpacity,zIndex:90}),f=n(b).addClass(r.barClass).css({background:r.color,width:r.size,position:"absolute",top:0,opacity:r.opacity,display:r.alwaysVisible?"block":"none","border-radius":r.borderRadius,BorderRadius:r.borderRadius,MozBorderRadius:r.borderRadius,WebkitBorderRadius:r.borderRadius,zIndex:99}),ut=r.position=="right"?{right:r.distance}:{left:r.distance};s.css(ut);f.css(ut);u.wrap(rt);u.parent().append(f);u.parent().append(s);r.railDraggable&&f.bind("mousedown",function(i){var r=n(document);return p=!0,t=parseFloat(f.css("top")),pageY=i.pageY,r.bind("mousemove.slimscroll",function(n){currTop=t+n.pageY-pageY;f.css("top",currTop);h(0,f.position().top,!1)}),r.bind("mouseup.slimscroll",function(){p=!1;c();r.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(n){return n.stopPropagation(),n.preventDefault(),!1});s.hover(function(){nt()},function(){c()});f.hover(function(){y=!0},function(){y=!1});u.hover(function(){l=!0;nt();c()},function(){l=!1;c()});u.bind("touchstart",function(n){n.originalEvent.touches.length&&(w=n.originalEvent.touches[0].pageY)});u.bind("touchmove",function(n){if(o||n.originalEvent.preventDefault(),n.originalEvent.touches.length){var t=(w-n.originalEvent.touches[0].pageY)/r.touchScrollStep;h(t,!0);w=n.originalEvent.touches[0].pageY}});g();r.start==="bottom"?(f.css({top:u.outerHeight()-f.outerHeight()}),h(0,!0)):r.start!=="top"&&(h(n(r.start).position().top,null,!0),r.alwaysVisible||f.hide());et()}}),this}});n.fn.extend({slimscroll:n.fn.slimScroll})}(jQuery),function(n){var t={addTag:function(t){var i,r=n(this),f,e,o,u;if(typeof t=="string"){if(f=n(this).find("input[type=hidden]").filter(function(){return n(this).val()==t}),f.length)return;i=n("<li><\/li>")}else i=n(t),t=i.text();e=r.data("tagit");o=n('<input type="hidden"/>').attr("name",e.field).val(t);i.empty().append(n("<span><\/span>").text(t)).append(o);u=n('<a class="close"><\/a>');u.text(unescape("%D7")).click(function(){n(this).parent().remove();r.trigger("tagit-tag-removed",null);event.preventDefault()});i.addClass("tag").append(u);n(i).parent().length||i.insertBefore(n(".tagit-edit-handle",r));r.trigger("tagit-tag-added",[t])},removeTag:function(t){var i=n(this),r=i.find("input[type=hidden]").filter(function(){return n(this).val()==t});r.length&&(r.parent().remove(),i.trigger("tagit-tag-removed",[t]))},getTags:function(){return n.map(n(this).find("input[type=hidden]"),function(t){return n(t).val()})},handler:function(){}};n.extend(n.fn,{tagit:function(){var r=n.makeArray(arguments),i=r.shift();return t[i]?t[i].apply(this,r):this.each(function(){var r=n(this),f=n.extend({},n.fn.tagit.defaults),u,t;n.isPlainObject(i)&&(f=n.extend(f,i));r.is(".tagit")||(r.data("tagit",f),u=n('<input type="text" class="no-style" />'),t=n("<ul><\/ul>"),r.bind("tagit-tag-added",function(){t.removeClass("open")}),r.bind("focusin",function(){n(this).addClass("focused").find("input[type=text]").focus()}).bind("focusout",function(){n(this).removeClass("focused");u.val("")}),u.keydown(function(i){var u=n(this),e=u.val(),f=i.which,h,o,y,p,w,a;if(f==13||f==32)t.is(".open")?(o=n("li.selected",t),o.length?(r.tagit("addTag",o.text()),u.val("")):u.val()!=""&&(r.tagit("addTag",u.val()),u.val(""))):u.val()!=""&&(r.tagit("addTag",u.val()),u.val("")),i.preventDefault();else if(f==9)e&&(r.tagit("addTag",u.val()),u.val(""),i.preventDefault());else if(f==38||f==40)t.is(".open")&&(h=n("li",t),o=n(h).filter(".selected"),o.length==0&&h.length>0?h.eq(f==38?h.length-1:0).addClass("selected"):(y=f==38?"prev":"next",p=o[y]().addClass("selected"),p.length&&o.removeClass("selected")),i.preventDefault());else if(f==8)if(w=u.val(),a=u.val().length,a>0){function l(i){t.empty();var u=n.grep(i,function(t){return n.inArray(t,v)==-1}),r=0;n.each(u,function(i,u){r>15||u.toLowerCase().indexOf(e)>=0&&(t.append(n("<li><\/li>").text(u)),r++)});r>0?t.addClass("open"):t.removeClass("open")}var c=n(this).parents(".tagit"),s=c.data("tagit").tags,v=c.tagit("getTags");n.isFunction(s)?s(e).then(function(n){l(n);a<=1&&t.removeClass("open")}):l(s)}else u.parent().prev().remove(),u.trigger("tagit-tag-removed",null),i.preventDefault();else if(e=(e+String.fromCharCode(f)).toLowerCase(),e){function l(i){t.empty();var u=n.grep(i,function(t){return n.inArray(t,v)==-1}),r=0;n.each(u,function(i,u){r>15||u.toLowerCase().indexOf(e)>=0&&(t.append(n("<li><\/li>").text(u)),r++)});r>0?t.addClass("open"):t.removeClass("open")}var c=n(this).parents(".tagit"),s=c.data("tagit").tags,v=c.tagit("getTags");n.isFunction(s)?s(e).then(function(n){l(n)}):l(s)}}),t.click(function(t){var i=n(t.target);i.is("li")&&n(r).tagit("addTag",i.text())}),r.append(n('<li class="tagit-edit-handle"><\/li>').append(u).append(t)).addClass("tagit"),n("li:not(.tagit-edit-handle)",r).each(function(){n(r).tagit("addTag",this)}))})}});n.fn.tagit.defaults={field:"tag",tags:[]}}(jQuery),function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports!="undefined"?module.exports=n(require("jquery")):n(jQuery)}(function(n){"use strict";var t=window.Slick||{};t=function(){function i(i,r){var u=this,f;u.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:n(i),appendDots:n(i),arrows:!0,asNavFor:null,prevArrow:'<button type="button" data-role="none" class="slick-prev" aria-label="Previous" tabindex="0" role="button">Previous<\/button>',nextArrow:'<button type="button" data-role="none" class="slick-next" aria-label="Next" tabindex="0" role="button">Next<\/button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(n,t){return'<button type="button" data-role="none" role="button" aria-required="false" tabindex="0">'+(t+1)+"<\/button>"},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!1,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3};u.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1};n.extend(u,u.initials);u.activeBreakpoint=null;u.animType=null;u.animProp=null;u.breakpoints=[];u.breakpointSettings=[];u.cssTransitions=!1;u.hidden="hidden";u.paused=!1;u.positionProp=null;u.respondTo=null;u.rowCount=1;u.shouldClick=!0;u.$slider=n(i);u.$slidesCache=null;u.transformType=null;u.transitionType=null;u.visibilityChange="visibilitychange";u.windowWidth=0;u.windowTimer=null;f=n(i).data("slick")||{};u.options=n.extend({},u.defaults,f,r);u.currentSlide=u.options.initialSlide;u.originalSettings=u.options;typeof document.mozHidden!="undefined"?(u.hidden="mozHidden",u.visibilityChange="mozvisibilitychange"):typeof document.webkitHidden!="undefined"&&(u.hidden="webkitHidden",u.visibilityChange="webkitvisibilitychange");u.autoPlay=n.proxy(u.autoPlay,u);u.autoPlayClear=n.proxy(u.autoPlayClear,u);u.changeSlide=n.proxy(u.changeSlide,u);u.clickHandler=n.proxy(u.clickHandler,u);u.selectHandler=n.proxy(u.selectHandler,u);u.setPosition=n.proxy(u.setPosition,u);u.swipeHandler=n.proxy(u.swipeHandler,u);u.dragHandler=n.proxy(u.dragHandler,u);u.keyHandler=n.proxy(u.keyHandler,u);u.autoPlayIterator=n.proxy(u.autoPlayIterator,u);u.instanceUid=t++;u.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/;u.registerBreakpoints();u.init(!0);u.checkResponsive(!0)}var t=0;return i}();t.prototype.addSlide=t.prototype.slickAdd=function(t,i,r){var u=this;if(typeof i=="boolean")r=i,i=null;else if(i<0||i>=u.slideCount)return!1;u.unload();typeof i=="number"?i===0&&u.$slides.length===0?n(t).appendTo(u.$slideTrack):r?n(t).insertBefore(u.$slides.eq(i)):n(t).insertAfter(u.$slides.eq(i)):r===!0?n(t).prependTo(u.$slideTrack):n(t).appendTo(u.$slideTrack);u.$slides=u.$slideTrack.children(this.options.slide);u.$slideTrack.children(this.options.slide).detach();u.$slideTrack.append(u.$slides);u.$slides.each(function(t,i){n(i).attr("data-slick-index",t)});u.$slidesCache=u.$slides;u.reinit()};t.prototype.animateHeight=function(){var n=this,t;n.options.slidesToShow===1&&n.options.adaptiveHeight===!0&&n.options.vertical===!1&&(t=n.$slides.eq(n.currentSlide).outerHeight(!0),n.$list.animate({height:t},n.options.speed))};t.prototype.animateSlide=function(t,i){var u={},r=this;r.animateHeight();r.options.rtl===!0&&r.options.vertical===!1&&(t=-t);r.transformsEnabled===!1?r.options.vertical===!1?r.$slideTrack.animate({left:t},r.options.speed,r.options.easing,i):r.$slideTrack.animate({top:t},r.options.speed,r.options.easing,i):r.cssTransitions===!1?(r.options.rtl===!0&&(r.currentLeft=-r.currentLeft),n({animStart:r.currentLeft}).animate({animStart:t},{duration:r.options.speed,easing:r.options.easing,step:function(n){n=Math.ceil(n);r.options.vertical===!1?(u[r.animType]="translate("+n+"px, 0px)",r.$slideTrack.css(u)):(u[r.animType]="translate(0px,"+n+"px)",r.$slideTrack.css(u))},complete:function(){i&&i.call()}})):(r.applyTransition(),t=Math.ceil(t),u[r.animType]=r.options.vertical===!1?"translate3d("+t+"px, 0px, 0px)":"translate3d(0px,"+t+"px, 0px)",r.$slideTrack.css(u),i&&setTimeout(function(){r.disableTransition();i.call()},r.options.speed))};t.prototype.asNavFor=function(t){var r=this,i=r.options.asNavFor;i&&i!==null&&(i=n(i).not(r.$slider));i!==null&&typeof i=="object"&&i.each(function(){var i=n(this).slick("getSlick");i.unslicked||i.slideHandler(t,!0)})};t.prototype.applyTransition=function(n){var t=this,i={};i[t.transitionType]=t.options.fade===!1?t.transformType+" "+t.options.speed+"ms "+t.options.cssEase:"opacity "+t.options.speed+"ms "+t.options.cssEase;t.options.fade===!1?t.$slideTrack.css(i):t.$slides.eq(n).css(i)};t.prototype.autoPlay=function(){var n=this;n.autoPlayTimer&&clearInterval(n.autoPlayTimer);n.slideCount>n.options.slidesToShow&&n.paused!==!0&&(n.autoPlayTimer=setInterval(n.autoPlayIterator,n.options.autoplaySpeed))};t.prototype.autoPlayClear=function(){var n=this;n.autoPlayTimer&&clearInterval(n.autoPlayTimer)};t.prototype.autoPlayIterator=function(){var n=this;n.options.infinite===!1?n.direction===1?(n.currentSlide+1===n.slideCount-1&&(n.direction=0),n.slideHandler(n.currentSlide+n.options.slidesToScroll)):(n.currentSlide-1==0&&(n.direction=1),n.slideHandler(n.currentSlide-n.options.slidesToScroll)):n.slideHandler(n.currentSlide+n.options.slidesToScroll)};t.prototype.buildArrows=function(){var t=this;t.options.arrows===!0&&(t.$prevArrow=n(t.options.prevArrow).addClass("slick-arrow"),t.$nextArrow=n(t.options.nextArrow).addClass("slick-arrow"),t.slideCount>t.options.slidesToShow?(t.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),t.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),t.htmlExpr.test(t.options.prevArrow)&&t.$prevArrow.prependTo(t.options.appendArrows),t.htmlExpr.test(t.options.nextArrow)&&t.$nextArrow.appendTo(t.options.appendArrows),t.options.infinite!==!0&&t.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):t.$prevArrow.add(t.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"}))};t.prototype.buildDots=function(){var t=this,i,r;if(t.options.dots===!0&&t.slideCount>t.options.slidesToShow){for(r='<ul class="'+t.options.dotsClass+'">',i=0;i<=t.getDotCount();i+=1)r+="<li>"+t.options.customPaging.call(this,t,i)+"<\/li>";r+="<\/ul>";t.$dots=n(r).appendTo(t.options.appendDots);t.$dots.find("li").first().addClass("slick-active").attr("aria-hidden","false")}};t.prototype.buildOut=function(){var t=this;t.$slides=t.$slider.children(t.options.slide+":not(.slick-cloned)").addClass("slick-slide");t.slideCount=t.$slides.length;t.$slides.each(function(t,i){n(i).attr("data-slick-index",t).data("originalStyling",n(i).attr("style")||"")});t.$slider.addClass("slick-slider");t.$slideTrack=t.slideCount===0?n('<div class="slick-track"/>').appendTo(t.$slider):t.$slides.wrapAll('<div class="slick-track"/>').parent();t.$list=t.$slideTrack.wrap('<div aria-live="polite" class="slick-list"/>').parent();t.$slideTrack.css("opacity",0);(t.options.centerMode===!0||t.options.swipeToSlide===!0)&&(t.options.slidesToScroll=1);n("img[data-lazy]",t.$slider).not("[src]").addClass("slick-loading");t.setupInfinite();t.buildArrows();t.buildDots();t.updateDots();t.setSlideClasses(typeof t.currentSlide=="number"?t.currentSlide:0);t.options.draggable===!0&&t.$list.addClass("draggable")};t.prototype.buildRows=function(){var n=this,t,i,r,f,c,u,e,o,s,h;if(f=document.createDocumentFragment(),u=n.$slider.children(),n.options.rows>1){for(e=n.options.slidesPerRow*n.options.rows,c=Math.ceil(u.length/e),t=0;t<c;t++){for(o=document.createElement("div"),i=0;i<n.options.rows;i++){for(s=document.createElement("div"),r=0;r<n.options.slidesPerRow;r++)h=t*e+(i*n.options.slidesPerRow+r),u.get(h)&&s.appendChild(u.get(h));o.appendChild(s)}f.appendChild(o)}n.$slider.html(f);n.$slider.children().children().children().css({width:100/n.options.slidesPerRow+"%",display:"inline-block"})}};t.prototype.checkResponsive=function(t,i){var r=this,f,u,e,o=!1,s=r.$slider.width(),h=window.innerWidth||n(window).width();if(r.respondTo==="window"?e=h:r.respondTo==="slider"?e=s:r.respondTo==="min"&&(e=Math.min(h,s)),r.options.responsive&&r.options.responsive.length&&r.options.responsive!==null){u=null;for(f in r.breakpoints)r.breakpoints.hasOwnProperty(f)&&(r.originalSettings.mobileFirst===!1?e<r.breakpoints[f]&&(u=r.breakpoints[f]):e>r.breakpoints[f]&&(u=r.breakpoints[f]));u!==null?r.activeBreakpoint!==null?(u!==r.activeBreakpoint||i)&&(r.activeBreakpoint=u,r.breakpointSettings[u]==="unslick"?r.unslick(u):(r.options=n.extend({},r.originalSettings,r.breakpointSettings[u]),t===!0&&(r.currentSlide=r.options.initialSlide),r.refresh(t)),o=u):(r.activeBreakpoint=u,r.breakpointSettings[u]==="unslick"?r.unslick(u):(r.options=n.extend({},r.originalSettings,r.breakpointSettings[u]),t===!0&&(r.currentSlide=r.options.initialSlide),r.refresh(t)),o=u):r.activeBreakpoint!==null&&(r.activeBreakpoint=null,r.options=r.originalSettings,t===!0&&(r.currentSlide=r.options.initialSlide),r.refresh(t),o=u);t||o===!1||r.$slider.trigger("breakpoint",[r,o])}};t.prototype.changeSlide=function(t,i){var r=this,u=n(t.target),f,e,o,s;u.is("a")&&t.preventDefault();u.is("li")||(u=u.closest("li"));o=r.slideCount%r.options.slidesToScroll!=0;f=o?0:(r.slideCount-r.currentSlide)%r.options.slidesToScroll;switch(t.data.message){case"previous":e=f===0?r.options.slidesToScroll:r.options.slidesToShow-f;r.slideCount>r.options.slidesToShow&&r.slideHandler(r.currentSlide-e,!1,i);break;case"next":e=f===0?r.options.slidesToScroll:f;r.slideCount>r.options.slidesToShow&&r.slideHandler(r.currentSlide+e,!1,i);break;case"index":s=t.data.index===0?0:t.data.index||u.index()*r.options.slidesToScroll;r.slideHandler(r.checkNavigable(s),!1,i);u.children().trigger("focus");break;default:return}};t.prototype.checkNavigable=function(n){var u=this,t,i,r;if(t=u.getNavigableIndexes(),i=0,n>t[t.length-1])n=t[t.length-1];else for(r in t){if(n<t[r]){n=i;break}i=t[r]}return n};t.prototype.cleanUpEvents=function(){var t=this;t.options.dots&&t.$dots!==null&&(n("li",t.$dots).off("click.slick",t.changeSlide),t.options.pauseOnDotsHover===!0&&t.options.autoplay===!0&&n("li",t.$dots).off("mouseenter.slick",n.proxy(t.setPaused,t,!0)).off("mouseleave.slick",n.proxy(t.setPaused,t,!1)));t.options.arrows===!0&&t.slideCount>t.options.slidesToShow&&(t.$prevArrow&&t.$prevArrow.off("click.slick",t.changeSlide),t.$nextArrow&&t.$nextArrow.off("click.slick",t.changeSlide));t.$list.off("touchstart.slick mousedown.slick",t.swipeHandler);t.$list.off("touchmove.slick mousemove.slick",t.swipeHandler);t.$list.off("touchend.slick mouseup.slick",t.swipeHandler);t.$list.off("touchcancel.slick mouseleave.slick",t.swipeHandler);t.$list.off("click.slick",t.clickHandler);n(document).off(t.visibilityChange,t.visibility);t.$list.off("mouseenter.slick",n.proxy(t.setPaused,t,!0));t.$list.off("mouseleave.slick",n.proxy(t.setPaused,t,!1));t.options.accessibility===!0&&t.$list.off("keydown.slick",t.keyHandler);t.options.focusOnSelect===!0&&n(t.$slideTrack).children().off("click.slick",t.selectHandler);n(window).off("orientationchange.slick.slick-"+t.instanceUid,t.orientationChange);n(window).off("resize.slick.slick-"+t.instanceUid,t.resize);n("[draggable!=true]",t.$slideTrack).off("dragstart",t.preventDefault);n(window).off("load.slick.slick-"+t.instanceUid,t.setPosition);n(document).off("ready.slick.slick-"+t.instanceUid,t.setPosition)};t.prototype.cleanUpRows=function(){var n=this,t;n.options.rows>1&&(t=n.$slides.children().children(),t.removeAttr("style"),n.$slider.html(t))};t.prototype.clickHandler=function(n){var t=this;t.shouldClick===!1&&(n.stopImmediatePropagation(),n.stopPropagation(),n.preventDefault())};t.prototype.destroy=function(t){var i=this;i.autoPlayClear();i.touchObject={};i.cleanUpEvents();n(".slick-cloned",i.$slider).detach();i.$dots&&i.$dots.remove();i.$prevArrow&&i.$prevArrow.length&&(i.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),i.htmlExpr.test(i.options.prevArrow)&&i.$prevArrow.remove());i.$nextArrow&&i.$nextArrow.length&&(i.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),i.htmlExpr.test(i.options.nextArrow)&&i.$nextArrow.remove());i.$slides&&(i.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){n(this).attr("style",n(this).data("originalStyling"))}),i.$slideTrack.children(this.options.slide).detach(),i.$slideTrack.detach(),i.$list.detach(),i.$slider.append(i.$slides));i.cleanUpRows();i.$slider.removeClass("slick-slider");i.$slider.removeClass("slick-initialized");i.unslicked=!0;t||i.$slider.trigger("destroy",[i])};t.prototype.disableTransition=function(n){var t=this,i={};i[t.transitionType]="";t.options.fade===!1?t.$slideTrack.css(i):t.$slides.eq(n).css(i)};t.prototype.fadeSlide=function(n,t){var i=this;i.cssTransitions===!1?(i.$slides.eq(n).css({zIndex:i.options.zIndex}),i.$slides.eq(n).animate({opacity:1},i.options.speed,i.options.easing,t)):(i.applyTransition(n),i.$slides.eq(n).css({opacity:1,zIndex:i.options.zIndex}),t&&setTimeout(function(){i.disableTransition(n);t.call()},i.options.speed))};t.prototype.fadeSlideOut=function(n){var t=this;t.cssTransitions===!1?t.$slides.eq(n).animate({opacity:0,zIndex:t.options.zIndex-2},t.options.speed,t.options.easing):(t.applyTransition(n),t.$slides.eq(n).css({opacity:0,zIndex:t.options.zIndex-2}))};t.prototype.filterSlides=t.prototype.slickFilter=function(n){var t=this;n!==null&&(t.$slidesCache=t.$slides,t.unload(),t.$slideTrack.children(this.options.slide).detach(),t.$slidesCache.filter(n).appendTo(t.$slideTrack),t.reinit())};t.prototype.getCurrent=t.prototype.slickCurrentSlide=function(){var n=this;return n.currentSlide};t.prototype.getDotCount=function(){var n=this,t=0,i=0,r=0;if(n.options.infinite===!0)while(t<n.slideCount)++r,t=i+n.options.slidesToScroll,i+=n.options.slidesToScroll<=n.options.slidesToShow?n.options.slidesToScroll:n.options.slidesToShow;else if(n.options.centerMode===!0)r=n.slideCount;else while(t<n.slideCount)++r,t=i+n.options.slidesToScroll,i+=n.options.slidesToScroll<=n.options.slidesToShow?n.options.slidesToScroll:n.options.slidesToShow;return r-1};t.prototype.getLeft=function(n){var t=this,f,r,u=0,i;return t.slideOffset=0,r=t.$slides.first().outerHeight(!0),t.options.infinite===!0?(t.slideCount>t.options.slidesToShow&&(t.slideOffset=t.slideWidth*t.options.slidesToShow*-1,u=r*t.options.slidesToShow*-1),t.slideCount%t.options.slidesToScroll!=0&&n+t.options.slidesToScroll>t.slideCount&&t.slideCount>t.options.slidesToShow&&(n>t.slideCount?(t.slideOffset=(t.options.slidesToShow-(n-t.slideCount))*t.slideWidth*-1,u=(t.options.slidesToShow-(n-t.slideCount))*r*-1):(t.slideOffset=t.slideCount%t.options.slidesToScroll*t.slideWidth*-1,u=t.slideCount%t.options.slidesToScroll*r*-1))):n+t.options.slidesToShow>t.slideCount&&(t.slideOffset=(n+t.options.slidesToShow-t.slideCount)*t.slideWidth,u=(n+t.options.slidesToShow-t.slideCount)*r),t.slideCount<=t.options.slidesToShow&&(t.slideOffset=0,u=0),t.options.centerMode===!0&&t.options.infinite===!0?t.slideOffset+=t.slideWidth*Math.floor(t.options.slidesToShow/2)-t.slideWidth:t.options.centerMode===!0&&(t.slideOffset=0,t.slideOffset+=t.slideWidth*Math.floor(t.options.slidesToShow/2)),f=t.options.vertical===!1?n*t.slideWidth*-1+t.slideOffset:n*r*-1+u,t.options.variableWidth===!0&&(i=t.slideCount<=t.options.slidesToShow||t.options.infinite===!1?t.$slideTrack.children(".slick-slide").eq(n):t.$slideTrack.children(".slick-slide").eq(n+t.options.slidesToShow),f=t.options.rtl===!0?i[0]?(t.$slideTrack.width()-i[0].offsetLeft-i.width())*-1:0:i[0]?i[0].offsetLeft*-1:0,t.options.centerMode===!0&&(i=t.slideCount<=t.options.slidesToShow||t.options.infinite===!1?t.$slideTrack.children(".slick-slide").eq(n):t.$slideTrack.children(".slick-slide").eq(n+t.options.slidesToShow+1),f=(t.options.rtl===!0?i[0]?(t.$slideTrack.width()-i[0].offsetLeft-i.width())*-1:0:i[0]?i[0].offsetLeft*-1:0)+(t.$list.width()-i.outerWidth())/2)),f};t.prototype.getOption=t.prototype.slickGetOption=function(n){var t=this;return t.options[n]};t.prototype.getNavigableIndexes=function(){var n=this,t=0,i=0,u=[],r;for(n.options.infinite===!1?r=n.slideCount:(t=n.options.slidesToScroll*-1,i=n.options.slidesToScroll*-1,r=n.slideCount*2);t<r;)u.push(t),t=i+n.options.slidesToScroll,i+=n.options.slidesToScroll<=n.options.slidesToShow?n.options.slidesToScroll:n.options.slidesToShow;return u};t.prototype.getSlick=function(){return this};t.prototype.getSlideCount=function(){var t=this,i,r;return r=t.options.centerMode===!0?t.slideWidth*Math.floor(t.options.slidesToShow/2):0,t.options.swipeToSlide===!0?(t.$slideTrack.find(".slick-slide").each(function(u,f){if(f.offsetLeft-r+n(f).outerWidth()/2>t.swipeLeft*-1)return i=f,!1}),Math.abs(n(i).attr("data-slick-index")-t.currentSlide)||1):t.options.slidesToScroll};t.prototype.goTo=t.prototype.slickGoTo=function(n,t){var i=this;i.changeSlide({data:{message:"index",index:parseInt(n)}},t)};t.prototype.init=function(t){var i=this;n(i.$slider).hasClass("slick-initialized")||(n(i.$slider).addClass("slick-initialized"),i.buildRows(),i.buildOut(),i.setProps(),i.startLoad(),i.loadSlider(),i.initializeEvents(),i.updateArrows(),i.updateDots());t&&i.$slider.trigger("init",[i]);i.options.accessibility===!0&&i.initADA()};t.prototype.initArrowEvents=function(){var n=this;if(n.options.arrows===!0&&n.slideCount>n.options.slidesToShow){n.$prevArrow.on("click.slick",{message:"previous"},n.changeSlide);n.$nextArrow.on("click.slick",{message:"next"},n.changeSlide)}};t.prototype.initDotEvents=function(){var t=this;if(t.options.dots===!0&&t.slideCount>t.options.slidesToShow)n("li",t.$dots).on("click.slick",{message:"index"},t.changeSlide);if(t.options.dots===!0&&t.options.pauseOnDotsHover===!0&&t.options.autoplay===!0)n("li",t.$dots).on("mouseenter.slick",n.proxy(t.setPaused,t,!0)).on("mouseleave.slick",n.proxy(t.setPaused,t,!1))};t.prototype.initializeEvents=function(){var t=this;t.initArrowEvents();t.initDotEvents();t.$list.on("touchstart.slick mousedown.slick",{action:"start"},t.swipeHandler);t.$list.on("touchmove.slick mousemove.slick",{action:"move"},t.swipeHandler);t.$list.on("touchend.slick mouseup.slick",{action:"end"},t.swipeHandler);t.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},t.swipeHandler);t.$list.on("click.slick",t.clickHandler);n(document).on(t.visibilityChange,n.proxy(t.visibility,t));t.$list.on("mouseenter.slick",n.proxy(t.setPaused,t,!0));t.$list.on("mouseleave.slick",n.proxy(t.setPaused,t,!1));if(t.options.accessibility===!0)t.$list.on("keydown.slick",t.keyHandler);if(t.options.focusOnSelect===!0)n(t.$slideTrack).children().on("click.slick",t.selectHandler);n(window).on("orientationchange.slick.slick-"+t.instanceUid,n.proxy(t.orientationChange,t));n(window).on("resize.slick.slick-"+t.instanceUid,n.proxy(t.resize,t));n("[draggable!=true]",t.$slideTrack).on("dragstart",t.preventDefault);n(window).on("load.slick.slick-"+t.instanceUid,t.setPosition);n(document).on("ready.slick.slick-"+t.instanceUid,t.setPosition)};t.prototype.initUI=function(){var n=this;n.options.arrows===!0&&n.slideCount>n.options.slidesToShow&&(n.$prevArrow.show(),n.$nextArrow.show());n.options.dots===!0&&n.slideCount>n.options.slidesToShow&&n.$dots.show();n.options.autoplay===!0&&n.autoPlay()};t.prototype.keyHandler=function(n){var t=this;n.target.tagName.match("TEXTAREA|INPUT|SELECT")||(n.keyCode===37&&t.options.accessibility===!0?t.changeSlide({data:{message:"previous"}}):n.keyCode===39&&t.options.accessibility===!0&&t.changeSlide({data:{message:"next"}}))};t.prototype.lazyLoad=function(){function f(t){n("img[data-lazy]",t).each(function(){var t=n(this),i=n(this).attr("data-lazy"),r=document.createElement("img");r.onload=function(){t.animate({opacity:0},100,function(){t.attr("src",i).animate({opacity:1},200,function(){t.removeAttr("data-lazy").removeClass("slick-loading")})})};r.src=i})}var t=this,e,r,i,u;t.options.centerMode===!0?t.options.infinite===!0?(i=t.currentSlide+(t.options.slidesToShow/2+1),u=i+t.options.slidesToShow+2):(i=Math.max(0,t.currentSlide-(t.options.slidesToShow/2+1)),u=2+(t.options.slidesToShow/2+1)+t.currentSlide):(i=t.options.infinite?t.options.slidesToShow+t.currentSlide:t.currentSlide,u=i+t.options.slidesToShow,t.options.fade===!0&&(i>0&&i--,u<=t.slideCount&&u++));e=t.$slider.find(".slick-slide").slice(i,u);f(e);t.slideCount<=t.options.slidesToShow?(r=t.$slider.find(".slick-slide"),f(r)):t.currentSlide>=t.slideCount-t.options.slidesToShow?(r=t.$slider.find(".slick-cloned").slice(0,t.options.slidesToShow),f(r)):t.currentSlide===0&&(r=t.$slider.find(".slick-cloned").slice(t.options.slidesToShow*-1),f(r))};t.prototype.loadSlider=function(){var n=this;n.setPosition();n.$slideTrack.css({opacity:1});n.$slider.removeClass("slick-loading");n.initUI();n.options.lazyLoad==="progressive"&&n.progressiveLazyLoad()};t.prototype.next=t.prototype.slickNext=function(){var n=this;n.changeSlide({data:{message:"next"}})};t.prototype.orientationChange=function(){var n=this;n.checkResponsive();n.setPosition()};t.prototype.pause=t.prototype.slickPause=function(){var n=this;n.autoPlayClear();n.paused=!0};t.prototype.play=t.prototype.slickPlay=function(){var n=this;n.paused=!1;n.autoPlay()};t.prototype.postSlide=function(n){var t=this;t.$slider.trigger("afterChange",[t,n]);t.animating=!1;t.setPosition();t.swipeLeft=null;t.options.autoplay===!0&&t.paused===!1&&t.autoPlay();t.options.accessibility===!0&&t.initADA()};t.prototype.prev=t.prototype.slickPrev=function(){var n=this;n.changeSlide({data:{message:"previous"}})};t.prototype.preventDefault=function(n){n.preventDefault()};t.prototype.progressiveLazyLoad=function(){var t=this,r,i;r=n("img[data-lazy]",t.$slider).length;r>0&&(i=n("img[data-lazy]",t.$slider).first(),i.attr("src",null),i.attr("src",i.attr("data-lazy")).removeClass("slick-loading").load(function(){i.removeAttr("data-lazy");t.progressiveLazyLoad();t.options.adaptiveHeight===!0&&t.setPosition()}).error(function(){i.removeAttr("data-lazy");t.progressiveLazyLoad()}))};t.prototype.refresh=function(t){var i=this,r,u;u=i.slideCount-i.options.slidesToShow;i.options.infinite||(i.slideCount<=i.options.slidesToShow?i.currentSlide=0:i.currentSlide>u&&(i.currentSlide=u));r=i.currentSlide;i.destroy(!0);n.extend(i,i.initials,{currentSlide:r});i.init();t||i.changeSlide({data:{message:"index",index:r}},!1)};t.prototype.registerBreakpoints=function(){var t=this,u,f,i,r=t.options.responsive||null;if(n.type(r)==="array"&&r.length){t.respondTo=t.options.respondTo||"window";for(u in r)if(i=t.breakpoints.length-1,f=r[u].breakpoint,r.hasOwnProperty(u)){while(i>=0)t.breakpoints[i]&&t.breakpoints[i]===f&&t.breakpoints.splice(i,1),i--;t.breakpoints.push(f);t.breakpointSettings[f]=r[u].settings}t.breakpoints.sort(function(n,i){return t.options.mobileFirst?n-i:i-n})}};t.prototype.reinit=function(){var t=this;if(t.$slides=t.$slideTrack.children(t.options.slide).addClass("slick-slide"),t.slideCount=t.$slides.length,t.currentSlide>=t.slideCount&&t.currentSlide!==0&&(t.currentSlide=t.currentSlide-t.options.slidesToScroll),t.slideCount<=t.options.slidesToShow&&(t.currentSlide=0),t.registerBreakpoints(),t.setProps(),t.setupInfinite(),t.buildArrows(),t.updateArrows(),t.initArrowEvents(),t.buildDots(),t.updateDots(),t.initDotEvents(),t.checkResponsive(!1,!0),t.options.focusOnSelect===!0)n(t.$slideTrack).children().on("click.slick",t.selectHandler);t.setSlideClasses(0);t.setPosition();t.$slider.trigger("reInit",[t]);t.options.autoplay===!0&&t.focusHandler()};t.prototype.resize=function(){var t=this;n(window).width()!==t.windowWidth&&(clearTimeout(t.windowDelay),t.windowDelay=window.setTimeout(function(){t.windowWidth=n(window).width();t.checkResponsive();t.unslicked||t.setPosition()},50))};t.prototype.removeSlide=t.prototype.slickRemove=function(n,t,i){var r=this;if(typeof n=="boolean"?(t=n,n=t===!0?0:r.slideCount-1):n=t===!0?--n:n,r.slideCount<1||n<0||n>r.slideCount-1)return!1;r.unload();i===!0?r.$slideTrack.children().remove():r.$slideTrack.children(this.options.slide).eq(n).remove();r.$slides=r.$slideTrack.children(this.options.slide);r.$slideTrack.children(this.options.slide).detach();r.$slideTrack.append(r.$slides);r.$slidesCache=r.$slides;r.reinit()};t.prototype.setCSS=function(n){var t=this,i={},r,u;t.options.rtl===!0&&(n=-n);r=t.positionProp=="left"?Math.ceil(n)+"px":"0px";u=t.positionProp=="top"?Math.ceil(n)+"px":"0px";i[t.positionProp]=n;t.transformsEnabled===!1?t.$slideTrack.css(i):(i={},t.cssTransitions===!1?(i[t.animType]="translate("+r+", "+u+")",t.$slideTrack.css(i)):(i[t.animType]="translate3d("+r+", "+u+", 0px)",t.$slideTrack.css(i)))};t.prototype.setDimensions=function(){var n=this,t;n.options.vertical===!1?n.options.centerMode===!0&&n.$list.css({padding:"0px "+n.options.centerPadding}):(n.$list.height(n.$slides.first().outerHeight(!0)*n.options.slidesToShow),n.options.centerMode===!0&&n.$list.css({padding:n.options.centerPadding+" 0px"}));n.listWidth=n.$list.width();n.listHeight=n.$list.height();n.options.vertical===!1&&n.options.variableWidth===!1?(n.slideWidth=Math.ceil(n.listWidth/n.options.slidesToShow),n.$slideTrack.width(Math.ceil(n.slideWidth*n.$slideTrack.children(".slick-slide").length))):n.options.variableWidth===!0?n.$slideTrack.width(5e3*n.slideCount):(n.slideWidth=Math.ceil(n.listWidth),n.$slideTrack.height(Math.ceil(n.$slides.first().outerHeight(!0)*n.$slideTrack.children(".slick-slide").length)));t=n.$slides.first().outerWidth(!0)-n.$slides.first().width();n.options.variableWidth===!1&&n.$slideTrack.children(".slick-slide").width(n.slideWidth-t)};t.prototype.setFade=function(){var t=this,i;t.$slides.each(function(r,u){i=t.slideWidth*r*-1;t.options.rtl===!0?n(u).css({position:"relative",right:i,top:0,zIndex:t.options.zIndex-2,opacity:0}):n(u).css({position:"relative",left:i,top:0,zIndex:t.options.zIndex-2,opacity:0})});t.$slides.eq(t.currentSlide).css({zIndex:t.options.zIndex-1,opacity:1})};t.prototype.setHeight=function(){var n=this,t;n.options.slidesToShow===1&&n.options.adaptiveHeight===!0&&n.options.vertical===!1&&(t=n.$slides.eq(n.currentSlide).outerHeight(!0),n.$list.css("height",t))};t.prototype.setOption=t.prototype.slickSetOption=function(t,i,r){var u=this,f,e;if(t==="responsive"&&n.type(i)==="array")for(e in i)if(n.type(u.options.responsive)!=="array")u.options.responsive=[i[e]];else{for(f=u.options.responsive.length-1;f>=0;)u.options.responsive[f].breakpoint===i[e].breakpoint&&u.options.responsive.splice(f,1),f--;u.options.responsive.push(i[e])}else u.options[t]=i;r===!0&&(u.unload(),u.reinit())};t.prototype.setPosition=function(){var n=this;n.setDimensions();n.setHeight();n.options.fade===!1?n.setCSS(n.getLeft(n.currentSlide)):n.setFade();n.$slider.trigger("setPosition",[n])};t.prototype.setProps=function(){var n=this,t=document.body.style;n.positionProp=n.options.vertical===!0?"top":"left";n.positionProp==="top"?n.$slider.addClass("slick-vertical"):n.$slider.removeClass("slick-vertical");(t.WebkitTransition!==undefined||t.MozTransition!==undefined||t.msTransition!==undefined)&&n.options.useCSS===!0&&(n.cssTransitions=!0);n.options.fade&&(typeof n.options.zIndex=="number"?n.options.zIndex<3&&(n.options.zIndex=3):n.options.zIndex=n.defaults.zIndex);t.OTransform!==undefined&&(n.animType="OTransform",n.transformType="-o-transform",n.transitionType="OTransition",t.perspectiveProperty===undefined&&t.webkitPerspective===undefined&&(n.animType=!1));t.MozTransform!==undefined&&(n.animType="MozTransform",n.transformType="-moz-transform",n.transitionType="MozTransition",t.perspectiveProperty===undefined&&t.MozPerspective===undefined&&(n.animType=!1));t.webkitTransform!==undefined&&(n.animType="webkitTransform",n.transformType="-webkit-transform",n.transitionType="webkitTransition",t.perspectiveProperty===undefined&&t.webkitPerspective===undefined&&(n.animType=!1));t.msTransform!==undefined&&(n.animType="msTransform",n.transformType="-ms-transform",n.transitionType="msTransition",t.msTransform===undefined&&(n.animType=!1));t.transform!==undefined&&n.animType!==!1&&(n.animType="transform",n.transformType="transform",n.transitionType="transition");n.transformsEnabled=n.options.useTransform&&n.animType!==null&&n.animType!==!1};t.prototype.setSlideClasses=function(n){var t=this,u,i,r,f;i=t.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true");t.$slides.eq(n).addClass("slick-current");t.options.centerMode===!0?(u=Math.floor(t.options.slidesToShow/2),t.options.infinite===!0&&(n>=u&&n<=t.slideCount-1-u?t.$slides.slice(n-u,n+u+1).addClass("slick-active").attr("aria-hidden","false"):(r=t.options.slidesToShow+n,i.slice(r-u+1,r+u+2).addClass("slick-active").attr("aria-hidden","false")),n===0?i.eq(i.length-1-t.options.slidesToShow).addClass("slick-center"):n===t.slideCount-1&&i.eq(t.options.slidesToShow).addClass("slick-center")),t.$slides.eq(n).addClass("slick-center")):n>=0&&n<=t.slideCount-t.options.slidesToShow?t.$slides.slice(n,n+t.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):i.length<=t.options.slidesToShow?i.addClass("slick-active").attr("aria-hidden","false"):(f=t.slideCount%t.options.slidesToShow,r=t.options.infinite===!0?t.options.slidesToShow+n:n,t.options.slidesToShow==t.options.slidesToScroll&&t.slideCount-n<t.options.slidesToShow?i.slice(r-(t.options.slidesToShow-f),r+f).addClass("slick-active").attr("aria-hidden","false"):i.slice(r,r+t.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"));t.options.lazyLoad==="ondemand"&&t.lazyLoad()};t.prototype.setupInfinite=function(){var t=this,i,r,u;if(t.options.fade===!0&&(t.options.centerMode=!1),t.options.infinite===!0&&t.options.fade===!1&&(r=null,t.slideCount>t.options.slidesToShow)){for(u=t.options.centerMode===!0?t.options.slidesToShow+1:t.options.slidesToShow,i=t.slideCount;i>t.slideCount-u;i-=1)r=i-1,n(t.$slides[r]).clone(!0).attr("id","").attr("data-slick-index",r-t.slideCount).prependTo(t.$slideTrack).addClass("slick-cloned");for(i=0;i<u;i+=1)r=i,n(t.$slides[r]).clone(!0).attr("id","").attr("data-slick-index",r+t.slideCount).appendTo(t.$slideTrack).addClass("slick-cloned");t.$slideTrack.find(".slick-cloned").find("[id]").each(function(){n(this).attr("id","")})}};t.prototype.setPaused=function(n){var t=this;t.options.autoplay===!0&&t.options.pauseOnHover===!0&&(t.paused=n,n?t.autoPlayClear():t.autoPlay())};t.prototype.selectHandler=function(t){var i=this,u=n(t.target).is(".slick-slide")?n(t.target):n(t.target).parents(".slick-slide"),r=parseInt(u.attr("data-slick-index"));if(r||(r=0),i.slideCount<=i.options.slidesToShow){i.setSlideClasses(r);i.asNavFor(r);return}i.slideHandler(r)};t.prototype.slideHandler=function(n,t,i){var u,f,o,e,s=null,r=this;if((t=t||!1,r.animating!==!0||r.options.waitForAnimate!==!0)&&(r.options.fade!==!0||r.currentSlide!==n)&&!(r.slideCount<=r.options.slidesToShow)){if(t===!1&&r.asNavFor(n),u=n,s=r.getLeft(u),e=r.getLeft(r.currentSlide),r.currentLeft=r.swipeLeft===null?e:r.swipeLeft,r.options.infinite===!1&&r.options.centerMode===!1&&(n<0||n>r.getDotCount()*r.options.slidesToScroll)){r.options.fade===!1&&(u=r.currentSlide,i!==!0?r.animateSlide(e,function(){r.postSlide(u)}):r.postSlide(u));return}if(r.options.infinite===!1&&r.options.centerMode===!0&&(n<0||n>r.slideCount-r.options.slidesToScroll)){r.options.fade===!1&&(u=r.currentSlide,i!==!0?r.animateSlide(e,function(){r.postSlide(u)}):r.postSlide(u));return}if(r.options.autoplay===!0&&clearInterval(r.autoPlayTimer),f=u<0?r.slideCount%r.options.slidesToScroll!=0?r.slideCount-r.slideCount%r.options.slidesToScroll:r.slideCount+u:u>=r.slideCount?r.slideCount%r.options.slidesToScroll!=0?0:u-r.slideCount:u,r.animating=!0,r.$slider.trigger("beforeChange",[r,r.currentSlide,f]),o=r.currentSlide,r.currentSlide=f,r.setSlideClasses(r.currentSlide),r.updateDots(),r.updateArrows(),r.options.fade===!0){i!==!0?(r.fadeSlideOut(o),r.fadeSlide(f,function(){r.postSlide(f)})):r.postSlide(f);r.animateHeight();return}i!==!0?r.animateSlide(s,function(){r.postSlide(f)}):r.postSlide(f)}};t.prototype.startLoad=function(){var n=this;n.options.arrows===!0&&n.slideCount>n.options.slidesToShow&&(n.$prevArrow.hide(),n.$nextArrow.hide());n.options.dots===!0&&n.slideCount>n.options.slidesToShow&&n.$dots.hide();n.$slider.addClass("slick-loading")};t.prototype.swipeDirection=function(){var i,r,u,n,t=this;return(i=t.touchObject.startX-t.touchObject.curX,r=t.touchObject.startY-t.touchObject.curY,u=Math.atan2(r,i),n=Math.round(u*180/Math.PI),n<0&&(n=360-Math.abs(n)),n<=45&&n>=0)?t.options.rtl===!1?"left":"right":n<=360&&n>=315?t.options.rtl===!1?"left":"right":n>=135&&n<=225?t.options.rtl===!1?"right":"left":t.options.verticalSwiping===!0?n>=35&&n<=135?"left":"right":"vertical"};t.prototype.swipeEnd=function(){var n=this,t;if(n.dragging=!1,n.shouldClick=n.touchObject.swipeLength>10?!1:!0,n.touchObject.curX===undefined)return!1;if(n.touchObject.edgeHit===!0&&n.$slider.trigger("edge",[n,n.swipeDirection()]),n.touchObject.swipeLength>=n.touchObject.minSwipe)switch(n.swipeDirection()){case"left":t=n.options.swipeToSlide?n.checkNavigable(n.currentSlide+n.getSlideCount()):n.currentSlide+n.getSlideCount();n.slideHandler(t);n.currentDirection=0;n.touchObject={};n.$slider.trigger("swipe",[n,"left"]);break;case"right":t=n.options.swipeToSlide?n.checkNavigable(n.currentSlide-n.getSlideCount()):n.currentSlide-n.getSlideCount();n.slideHandler(t);n.currentDirection=1;n.touchObject={};n.$slider.trigger("swipe",[n,"right"])}else n.touchObject.startX!==n.touchObject.curX&&(n.slideHandler(n.currentSlide),n.touchObject={})};t.prototype.swipeHandler=function(n){var t=this;if(t.options.swipe!==!1&&(!("ontouchend"in document)||t.options.swipe!==!1)&&(t.options.draggable!==!1||n.type.indexOf("mouse")===-1)){t.touchObject.fingerCount=n.originalEvent&&n.originalEvent.touches!==undefined?n.originalEvent.touches.length:1;t.touchObject.minSwipe=t.listWidth/t.options.touchThreshold;t.options.verticalSwiping===!0&&(t.touchObject.minSwipe=t.listHeight/t.options.touchThreshold);switch(n.data.action){case"start":t.swipeStart(n);break;case"move":t.swipeMove(n);break;case"end":t.swipeEnd(n)}}};t.prototype.swipeMove=function(n){var t=this,f,e,r,u,i;if(i=n.originalEvent!==undefined?n.originalEvent.touches:null,!t.dragging||i&&i.length!==1)return!1;if(f=t.getLeft(t.currentSlide),t.touchObject.curX=i!==undefined?i[0].pageX:n.clientX,t.touchObject.curY=i!==undefined?i[0].pageY:n.clientY,t.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(t.touchObject.curX-t.touchObject.startX,2))),t.options.verticalSwiping===!0&&(t.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(t.touchObject.curY-t.touchObject.startY,2)))),e=t.swipeDirection(),e!=="vertical"){if(n.originalEvent!==undefined&&t.touchObject.swipeLength>4&&n.preventDefault(),u=(t.options.rtl===!1?1:-1)*(t.touchObject.curX>t.touchObject.startX?1:-1),t.options.verticalSwiping===!0&&(u=t.touchObject.curY>t.touchObject.startY?1:-1),r=t.touchObject.swipeLength,t.touchObject.edgeHit=!1,t.options.infinite===!1&&(t.currentSlide===0&&e==="right"||t.currentSlide>=t.getDotCount()&&e==="left")&&(r=t.touchObject.swipeLength*t.options.edgeFriction,t.touchObject.edgeHit=!0),t.swipeLeft=t.options.vertical===!1?f+r*u:f+r*(t.$list.height()/t.listWidth)*u,t.options.verticalSwiping===!0&&(t.swipeLeft=f+r*u),t.options.fade===!0||t.options.touchMove===!1)return!1;if(t.animating===!0)return t.swipeLeft=null,!1;t.setCSS(t.swipeLeft)}};t.prototype.swipeStart=function(n){var t=this,i;if(t.touchObject.fingerCount!==1||t.slideCount<=t.options.slidesToShow)return t.touchObject={},!1;n.originalEvent!==undefined&&n.originalEvent.touches!==undefined&&(i=n.originalEvent.touches[0]);t.touchObject.startX=t.touchObject.curX=i!==undefined?i.pageX:n.clientX;t.touchObject.startY=t.touchObject.curY=i!==undefined?i.pageY:n.clientY;t.dragging=!0};t.prototype.unfilterSlides=t.prototype.slickUnfilter=function(){var n=this;n.$slidesCache!==null&&(n.unload(),n.$slideTrack.children(this.options.slide).detach(),n.$slidesCache.appendTo(n.$slideTrack),n.reinit())};t.prototype.unload=function(){var t=this;n(".slick-cloned",t.$slider).remove();t.$dots&&t.$dots.remove();t.$prevArrow&&t.htmlExpr.test(t.options.prevArrow)&&t.$prevArrow.remove();t.$nextArrow&&t.htmlExpr.test(t.options.nextArrow)&&t.$nextArrow.remove();t.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")};t.prototype.unslick=function(n){var t=this;t.$slider.trigger("unslick",[t,n]);t.destroy()};t.prototype.updateArrows=function(){var n=this,t;t=Math.floor(n.options.slidesToShow/2);n.options.arrows===!0&&n.slideCount>n.options.slidesToShow&&!n.options.infinite&&(n.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),n.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),n.currentSlide===0?(n.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),n.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):n.currentSlide>=n.slideCount-n.options.slidesToShow&&n.options.centerMode===!1?(n.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),n.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")):n.currentSlide>=n.slideCount-1&&n.options.centerMode===!0&&(n.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),n.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))};t.prototype.updateDots=function(){var n=this;n.$dots!==null&&(n.$dots.find("li").removeClass("slick-active").attr("aria-hidden","true"),n.$dots.find("li").eq(Math.floor(n.currentSlide/n.options.slidesToScroll)).addClass("slick-active").attr("aria-hidden","false"))};t.prototype.visibility=function(){var n=this;document[n.hidden]?(n.paused=!0,n.autoPlayClear()):n.options.autoplay===!0&&(n.paused=!1,n.autoPlay())};t.prototype.initADA=function(){var t=this;t.$slides.add(t.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"});t.$slideTrack.attr("role","listbox");t.$slides.not(t.$slideTrack.find(".slick-cloned")).each(function(i){n(this).attr({role:"option","aria-describedby":"slick-slide"+t.instanceUid+i+""})});t.$dots!==null&&t.$dots.attr("role","tablist").find("li").each(function(i){n(this).attr({role:"presentation","aria-selected":"false","aria-controls":"navigation"+t.instanceUid+i+"",id:"slick-slide"+t.instanceUid+i+""})}).first().attr("aria-selected","true").end().find("button").attr("role","button").end().closest("div").attr("role","toolbar");t.activateADA()};t.prototype.activateADA=function(){var n=this;n.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({tabindex:"0"})};t.prototype.focusHandler=function(){var t=this;t.$slider.on("focus.slick blur.slick","*",function(i){i.stopImmediatePropagation();var r=n(this);setTimeout(function(){t.isPlay&&(r.is(":focus")?(t.autoPlayClear(),t.paused=!0):(t.paused=!1,t.autoPlay()))},0)})};n.fn.slick=function(){for(var i=this,r=arguments[0],f=Array.prototype.slice.call(arguments,1),e=i.length,u,n=0;n<e;n++)if(typeof r=="object"||typeof r=="undefined"?i[n].slick=new t(i[n],r):u=i[n].slick[r].apply(i[n].slick,f),typeof u!="undefined")return u;return i}}),function(n,t){if(typeof define=="function"&&define.amd)define(["exports","module"],t);else if(typeof exports!="undefined"&&typeof module!="undefined")t(exports,module);else{var i={exports:{}};t(i.exports,i);n.autosize=i.exports}}(this,function(n,t){"use strict";function f(n){function y(){var r=window.getComputedStyle(n,null);r.resize==="vertical"?n.style.resize="none":r.resize==="both"&&(n.style.resize="horizontal");i=r.boxSizing==="content-box"?-(parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)):parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth);t()}function e(t){var i=n.style.width;n.style.width="0px";n.offsetWidth;n.style.width=i;f=t;l&&(n.style.overflowY=t);a()}function a(){var f=window.pageYOffset,e=document.body.scrollTop,o=n.style.height,t;if(u=!1,n.style.height="auto",t=n.scrollHeight+i,r!=undefined&&r.maxHeight!=undefined&&r.maxHeight<t){u=!0;n.style.height=o;document.documentElement.scrollTop=f;document.body.scrollTop=e;return}if(n.scrollHeight===0){n.style.height=o;return}n.style.height=t+"px";document.documentElement.scrollTop=f;document.body.scrollTop=e}function t(){var r=n.style.height,i,t;a();i=window.getComputedStyle(n,null);i.height!==n.style.height?f!=="visible"&&e("visible"):f!=="hidden"&&e("hidden");r!==n.style.height&&(t=document.createEvent("Event"),t.initEvent("autosize:resized",!0,!1),n.dispatchEvent(t));u==!0&&e("visible")}var s=arguments[1]===undefined?{}:arguments[1],h=s.setOverflowX,v=h===undefined?!0:h,c=s.setOverflowY,l=c===undefined?!0:c,i,f,o;n&&n.nodeName&&n.nodeName==="TEXTAREA"&&!n.hasAttribute("data-autosize-on")&&(i=null,f="hidden",o=function(i){window.removeEventListener("resize",t);n.removeEventListener("input",t);n.removeEventListener("keyup",t);n.removeAttribute("data-autosize-on");n.removeEventListener("autosize:destroy",o);Object.keys(i).forEach(function(t){n.style[t]=i[t]})}.bind(n,{height:n.style.height,resize:n.style.resize,overflowY:n.style.overflowY,overflowX:n.style.overflowX,wordWrap:n.style.wordWrap}),n.addEventListener("autosize:destroy",o),"onpropertychange"in n&&"oninput"in n&&n.addEventListener("keyup",t),window.addEventListener("resize",t),n.addEventListener("input",t),n.addEventListener("autosize:update",t),n.setAttribute("data-autosize-on",!0),l&&(n.style.overflowY="hidden"),v&&(n.style.overflowX="hidden",n.style.wordWrap="break-word"),y())}function e(n){if(n&&n.nodeName&&n.nodeName==="TEXTAREA"){var t=document.createEvent("Event");t.initEvent("autosize:destroy",!0,!1);n.dispatchEvent(t)}}function o(n){if(n&&n.nodeName&&n.nodeName==="TEXTAREA"){var t=document.createEvent("Event");t.initEvent("autosize:update",!0,!1);n.dispatchEvent(t)}}var r=undefined,u=!1,i=null;typeof window=="undefined"||typeof window.getComputedStyle!="function"?(i=function(n){return n},i.destroy=function(n){return n},i.update=function(n){return n}):(i=function(n,t){return n&&Array.prototype.forEach.call(n.length?n:[n],function(n){return r=t,f(n,t)}),n},i.destroy=function(n){return n&&Array.prototype.forEach.call(n.length?n:[n],e),n},i.update=function(n){return n&&Array.prototype.forEach.call(n.length?n:[n],o),n});t.exports=i}),function(n,t,i,r){"use strict";function c(n){var r=n.currentTarget,e=n.data?n.data.options:{},t=n.data?n.data.items:[],u="",f=0;n.preventDefault();n.stopPropagation();i(r).attr("data-fancybox")&&(u=i(r).data("fancybox"));u?(t=t.length?t.filter('[data-fancybox="'+u+'"]'):i("[data-fancybox="+u+"]"),f=t.index(r)):t=[r];i.fancybox.open(t,e,f)}if(!i)return r;var s={speed:330,loop:!0,opacity:"auto",margin:[44,0],gutter:30,infobar:!0,buttons:!0,slideShow:!0,fullScreen:!0,thumbs:!0,closeBtn:!0,smallBtn:"auto",image:{preload:"auto",protect:!1},ajax:{settings:{data:{fancybox:!0}}},iframe:{tpl:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen allowtransparency="true" src=""><\/iframe>',preload:!0,scrolling:"no",css:{}},baseClass:"",slideClass:"",baseTpl:'<div class="fancybox-container" role="dialog" tabindex="-1"><div class="fancybox-bg"><\/div><div class="fancybox-controls"><div class="fancybox-infobar"><button data-fancybox-previous class="fancybox-button fancybox-button--left" title="Previous"><\/button><div class="fancybox-infobar__body"><span class="js-fancybox-index"><\/span>&nbsp;/&nbsp;<span class="js-fancybox-count"><\/span><\/div><button data-fancybox-next class="fancybox-button fancybox-button--right" title="Next"><\/button><\/div><div class="fancybox-buttons"><button data-fancybox-close class="fancybox-button fancybox-button--close" title="Close (Esc)"><\/button><\/div><\/div><div class="fancybox-slider-wrap"><div class="fancybox-slider"><\/div><\/div><div class="fancybox-caption-wrap"><div class="fancybox-caption"><\/div><\/div><\/div>',spinnerTpl:'<div class="fancybox-loading"><\/div>',errorTpl:'<div class="fancybox-error"><p>The requested content cannot be loaded. <br /> Please try again later.<p><\/div>',closeTpl:'<button data-fancybox-close class="fancybox-close-small"><\/button>',parentEl:"body",touch:!0,keyboard:!0,focus:!0,closeClickOutside:!0,beforeLoad:i.noop,afterLoad:i.noop,beforeMove:i.noop,afterMove:i.noop,onComplete:i.noop,onInit:i.noop,beforeClose:i.noop,afterClose:i.noop,onActivate:i.noop,onDeactivate:i.noop},e=i(n),f=i(t),l=0,h=function(n){return n&&n.hasOwnProperty&&n instanceof i},u=function(){return n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||function(t){n.setTimeout(t,1e3/60)}}(),a=function(r){var u;return typeof i=="function"&&r instanceof i&&(r=r[0]),u=r.getBoundingClientRect(),u.bottom>0&&u.right>0&&u.left<(n.innerWidth||t.documentElement.clientWidth)&&u.top<(n.innerHeight||t.documentElement.clientHeight)},o=function(n,r,u){var f=this;(f.opts=i.extend(!0,{index:u},s,r||{}),f.id=f.opts.id||++l,f.group=[],f.currIndex=parseInt(f.opts.index,10)||0,f.prevIndex=null,f.prevPos=null,f.currPos=0,f.firstRun=null,f.createGroup(n),f.group.length)&&(f.$lastFocus=i(t.activeElement).blur(),f.slides={},f.init(n))};i.extend(o.prototype,{init:function(){var n=this,u=!1,r,t;(n.scrollTop=f.scrollTop(),n.scrollLeft=f.scrollLeft(),i.fancybox.getInstance()||(r=i("body").width(),i("html").addClass("fancybox-enabled"),i.fancybox.isTouch?(i.each(n.group,function(n,t){if(t.type!=="image"&&t.type!=="iframe")return u=!0,!1}),u&&i("body").css({position:"fixed",width:r,top:n.scrollTop*-1})):(r=i("body").width()-r,r>1&&i('<style id="fancybox-noscroll" type="text/css">').html(".compensate-for-scrollbar, .fancybox-enabled body { margin-right: "+r+"px; }").appendTo("head"))),t=i(n.opts.baseTpl).attr("id","fancybox-container-"+n.id).data("FancyBox",n).addClass(n.opts.baseClass).hide().prependTo(n.opts.parentEl),n.$refs={container:t,bg:t.find(".fancybox-bg"),controls:t.find(".fancybox-controls"),buttons:t.find(".fancybox-buttons"),slider_wrap:t.find(".fancybox-slider-wrap"),slider:t.find(".fancybox-slider"),caption:t.find(".fancybox-caption")},n.trigger("onInit"),n.activate(),n.current)||n.jumpTo(n.currIndex)},createGroup:function(n){var t=this,u=i.makeArray(n);i.each(u,function(n,u){var f={},e={},o=[],h,s,c,l;i.isPlainObject(u)?(f=u,e=u.opts||{}):i.type(u)==="object"&&i(u).length?(h=i(u),o=h.data(),e="options"in o?o.options:{},e=i.type(e)==="object"?e:{},f.type="type"in o?o.type:e.type,f.src="src"in o?o.src:e.src||h.attr("href"),e.width="width"in o?o.width:e.width,e.height="height"in o?o.height:e.height,e.thumb="thumb"in o?o.thumb:e.thumb,e.selector="selector"in o?o.selector:e.selector,"srcset"in o&&(e.image={srcset:o.srcset}),e.$orig=h):f={type:"html",content:u+""};f.opts=i.extend(!0,{},t.opts,e);s=f.type;c=f.src||"";s||(f.content?s="html":c.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\?|#).*)?$)/i)?s="image":c.match(/\.(pdf)((\?|#).*)?$/i)?s="pdf":c.charAt(0)==="#"&&(s="inline"),f.type=s);f.index=t.group.length;f.opts.$orig&&!f.opts.$orig.length&&delete f.opts.$orig;!f.opts.$thumb&&f.opts.$orig&&(f.opts.$thumb=f.opts.$orig.find("img:first"));f.opts.$thumb&&!f.opts.$thumb.length&&delete f.opts.$thumb;i.type(f.opts.caption)==="function"?f.opts.caption=f.opts.caption.apply(u,[t,f]):"caption"in o?f.opts.caption=o.caption:e.$orig&&(f.opts.caption=h.attr("title"));f.opts.caption=f.opts.caption===r?"":f.opts.caption+"";s==="ajax"&&(l=c.split(/\s+/,2),l.length>1&&(f.src=l.shift(),f.opts.selector=l.shift()));f.opts.smallBtn=="auto"&&(i.inArray(s,["html","inline","ajax"])>-1?(f.opts.buttons=!1,f.opts.smallBtn=!0):f.opts.smallBtn=!1);s==="pdf"&&(f.type="iframe",f.opts.closeBtn=!0,f.opts.smallBtn=!1,f.opts.iframe.preload=!1);f.opts.modal&&i.extend(!0,f.opts,{infobar:0,buttons:0,keyboard:0,slideShow:0,fullScreen:0,closeClickOutside:0});t.group.push(f)})},addEvents:function(){var t=this;t.removeEvents();t.$refs.container.on("click.fb-close","[data-fancybox-close]",function(n){n.stopPropagation();n.preventDefault();t.close(n)}).on("click.fb-previous","[data-fancybox-previous]",function(n){n.stopPropagation();n.preventDefault();t.previous()}).on("click.fb-next","[data-fancybox-next]",function(n){n.stopPropagation();n.preventDefault();t.next()});i(n).on("orientationchange.fb resize.fb",function(n){u(function(){n&&n.originalEvent&&n.originalEvent.type==="resize"?t.update():(t.$refs.slider_wrap.hide(),u(function(){t.$refs.slider_wrap.show();t.update()}))})});f.on("focusin.fb",function(n){var r=i.fancybox?i.fancybox.getInstance():null;!r||i(n.target).hasClass("fancybox-container")||i.contains(r.$refs.container[0],n.target)||(n.stopPropagation(),r.focus(),e.scrollTop(t.scrollTop).scrollLeft(t.scrollLeft))});f.on("keydown.fb",function(n){var u=t.current,r=n.keyCode||n.which;if(u&&u.opts.keyboard&&!i(n.target).is("input")&&!i(n.target).is("textarea")){if(r===8||r===27){n.preventDefault();t.close(n);return}switch(r){case 37:case 38:n.preventDefault();t.previous();break;case 39:case 40:n.preventDefault();t.next();break;case 80:case 32:n.preventDefault();t.SlideShow&&(n.preventDefault(),t.SlideShow.toggle());break;case 70:t.FullScreen&&(n.preventDefault(),t.FullScreen.toggle());break;case 71:t.Thumbs&&(n.preventDefault(),t.Thumbs.toggle())}}})},removeEvents:function(){e.off("scroll.fb resize.fb orientationchange.fb");f.off("keydown.fb focusin.fb click.fb-close");this.$refs.container.off("click.fb-close click.fb-previous click.fb-next")},previous:function(n){this.jumpTo(this.currIndex-1,n)},next:function(n){this.jumpTo(this.currIndex+1,n)},jumpTo:function(n,t){var i=this,o,e,f,s;if(o=i.firstRun=i.firstRun===null,e=f=n=parseInt(n,10),s=i.current?i.current.opts.loop:!1,!i.isAnimating&&(e!=i.currIndex||o)){if(i.group.length>1&&s)e=e%i.group.length,e=e<0?i.group.length+e:e,i.group.length==2?f=n-i.currIndex+i.currPos:(f=e-i.currIndex+i.currPos,Math.abs(i.currPos-(f+i.group.length))<Math.abs(i.currPos-f)?f=f+i.group.length:Math.abs(i.currPos-(f-i.group.length))<Math.abs(i.currPos-f)&&(f=f-i.group.length));else if(!i.group[e]){i.update(!1,!1,t);return}i.current&&(i.current.$slide.removeClass("fancybox-slide--current fancybox-slide--complete"),i.updateSlide(i.current,!0));i.prevIndex=i.currIndex;i.prevPos=i.currPos;i.currIndex=e;i.currPos=f;i.current=i.createSlide(f);i.group.length>1&&((i.opts.loop||f-1>=0)&&i.createSlide(f-1),(i.opts.loop||f+1<i.group.length)&&i.createSlide(f+1));i.current.isMoved=!1;i.current.isComplete=!1;t=parseInt(t===r?i.current.opts.speed*1.5:t,10);i.trigger("beforeMove");i.updateControls();o&&(i.current.$slide.addClass("fancybox-slide--current"),i.$refs.container.show(),u(function(){i.$refs.bg.css("transition-duration",i.current.opts.speed+"ms");i.$refs.container.addClass("fancybox-container--ready")}));i.update(!0,!1,o?0:t,function(){i.afterMove()});i.loadSlide(i.current);o&&i.current.$ghost||i.preload()}},createSlide:function(n){var t=this,e,r,u,f;if(r=n%t.group.length,r=r<0?t.group.length+r:r,!t.slides[n]&&t.group[r]){if(t.opts.loop&&t.group.length>2)for(f in t.slides)if(t.slides[f].index===r)return u=t.slides[f],u.pos=n,t.slides[n]=u,delete t.slides[f],t.updateSlide(u),u;e=i('<div class="fancybox-slide"><\/div>').appendTo(t.$refs.slider);t.slides[n]=i.extend(!0,{},t.group[r],{pos:n,$slide:e,isMoved:!1,isLoaded:!1})}return t.slides[n]},zoomInOut:function(n,t,r){var s=this,f=s.current,o=f.$placeholder,l=f.opts.opacity,h=f.opts.$thumb,v=h?h.offset():0,y=f.$slide.offset(),c,e,u;return!o||!f.isMoved||!v||!a(h)?!1:n==="In"&&!s.firstRun?!1:(i.fancybox.stop(o),s.isAnimating=!0,c={top:v.top-y.top+parseFloat(h.css("border-top-width")||0),left:v.left-y.left+parseFloat(h.css("border-left-width")||0),width:h.width(),height:h.height(),scaleX:1,scaleY:1},l=="auto"&&(l=Math.abs(f.width/f.height-c.width/c.height)>.1),n==="In"?(e=c,u=s.getFitPos(f),u.scaleX=u.width/e.width,u.scaleY=u.height/e.height,l&&(e.opacity=.1,u.opacity=1)):(e=i.fancybox.getTranslate(o),u=c,f.$ghost&&(f.$ghost.show(),f.$image&&f.$image.remove()),e.scaleX=e.width/u.width,e.scaleY=e.height/u.height,e.width=u.width,e.height=u.height,l&&(u.opacity=0)),s.updateCursor(u.width,u.height),delete u.width,delete u.height,i.fancybox.setTranslate(o,e),o.show(),s.trigger("beforeZoom"+n),o.css("transition","all "+t+"ms"),i.fancybox.setTranslate(o,u),setTimeout(function(){var t;o.css("transition","none");t=i.fancybox.getTranslate(o);t.scaleX=1;t.scaleY=1;i.fancybox.setTranslate(o,t);s.trigger("afterZoom"+n);r.apply(s);s.isAnimating=!1},t),!0)},canPan:function(){var i=this,r=i.current,t=r.$placeholder,n=!1;return t&&(n=i.getFitPos(r),n=Math.abs(t.width()-n.width)>1||Math.abs(t.height()-n.height)>1),n},isScaledDown:function(){var u=this,t=u.current,r=t.$placeholder,n=!1;return r&&(n=i.fancybox.getTranslate(r),n=n.width<t.width||n.height<t.height),n},scaleToActual:function(n,t,u){var v=this,o=v.current,w=o.$placeholder,c,f,e,y,p,l=parseInt(o.$slide.width(),10),a=parseInt(o.$slide.height(),10),s=o.width,h=o.height;w&&(v.isAnimating=!0,n=n===r?l*.5:n,t=t===r?a*.5:t,c=i.fancybox.getTranslate(w),y=s/c.width,p=h/c.height,f=l*.5-s*.5,e=a*.5-h*.5,s>l&&(f=c.left*y-(n*y-n),f>0&&(f=0),f<l-s&&(f=l-s)),h>a&&(e=c.top*p-(t*p-t),e>0&&(e=0),e<a-h&&(e=a-h)),v.updateCursor(s,h),i.fancybox.animate(w,null,{top:e,left:f,scaleX:y,scaleY:p},u||o.opts.speed,function(){v.isAnimating=!1}))},scaleToFit:function(n){var r=this,f=r.current,u=f.$placeholder,t;u&&(r.isAnimating=!0,t=r.getFitPos(f),r.updateCursor(t.width,t.height),i.fancybox.animate(u,null,{top:t.top,left:t.left,scaleX:t.width/u.width(),scaleY:t.height/u.height()},n||f.opts.speed,function(){r.isAnimating=!1}))},getFitPos:function(n){var l=n.$placeholder||n.$content,r=n.width,u=n.height,t=n.opts.margin,f,o,s,a,v,h,c;return!l||!l.length||!r&&!u?!1:(i.type(t)==="number"&&(t=[t,t]),t.length==2&&(t=[t[0],t[1],t[0],t[1]]),e.width()<800&&(t=[0,0,0,0]),f=parseInt(n.$slide.width(),10)-(t[1]+t[3]),o=parseInt(n.$slide.height(),10)-(t[0]+t[2]),s=Math.min(1,f/r,o/u),h=Math.floor(s*r),c=Math.floor(s*u),a=Math.floor((o-c)*.5)+t[0],v=Math.floor((f-h)*.5)+t[3],{top:a,left:v,width:h,height:c})},update:function(n,t,r,u){var f=this,e;f.isAnimating!==!0&&f.current&&(e=f.current.pos*Math.floor(f.current.$slide.width())*-1-f.current.pos*f.current.opts.gutter,r=parseInt(r,10)||0,i.fancybox.stop(f.$refs.slider),n===!1?f.updateSlide(f.current,t):i.each(f.slides,function(n,i){f.updateSlide(i,t)}),r?i.fancybox.animate(f.$refs.slider,null,{top:0,left:e},r,function(){f.current.isMoved=!0;i.type(u)==="function"&&u.apply(f)}):(i.fancybox.setTranslate(f.$refs.slider,{top:0,left:e}),f.current.isMoved=!0,i.type(u)==="function"&&u.apply(f)))},updateSlide:function(n,t){var r=this,f=n.$placeholder,u;(n=n||r.current,n&&!r.isClosing)&&(u=n.pos*Math.floor(n.$slide.width())+n.pos*n.opts.gutter,u!==n.leftPos&&(i.fancybox.setTranslate(n.$slide,{top:0,left:u}),n.leftPos=u),t!==!1&&f&&(i.fancybox.setTranslate(f,r.getFitPos(n)),n.pos===r.currPos&&r.updateCursor()),n.$slide.trigger("refresh"),r.trigger("onUpdate",n))},updateCursor:function(n,t){var i=this,f,u=i.$refs.container.removeClass("fancybox-controls--canzoomIn fancybox-controls--canzoomOut fancybox-controls--canGrab");!i.isClosing&&i.opts.touch&&(f=n!==r&&t!==r?n<i.current.width&&t<i.current.height:i.isScaledDown(),f?u.addClass("fancybox-controls--canzoomIn"):i.group.length<2?u.addClass("fancybox-controls--canzoomOut"):u.addClass("fancybox-controls--canGrab"))},loadSlide:function(n){var t=this,r,u,f;if(n&&!n.isLoaded&&!n.isLoading){n.isLoading=!0;t.trigger("beforeLoad",n);r=n.type;u=n.$slide;u.off("refresh").trigger("onReset").addClass("fancybox-slide--"+(r||"unknown")).addClass(n.opts.slideClass);switch(r){case"image":t.setImage(n);break;case"iframe":t.setIframe(n);break;case"html":t.setContent(n,n.content);break;case"inline":i(n.src).length?t.setContent(n,i(n.src)):t.setError(n);break;case"ajax":t.showLoading(n);f=i.ajax(i.extend({},n.opts.ajax.settings,{url:n.src,success:function(i,r){r==="success"&&t.setContent(n,i)},error:function(i,r){i&&r!=="abort"&&t.setError(n)}}));u.one("onReset",function(){f.abort()});break;default:t.setError(n)}return!0}},setImage:function(t){var r=this,h=t.opts.image.srcset,u,f,s,c,o,e;if(t.isLoaded&&!t.hasError){r.afterLoad(t);return}if(h){for(s=n.devicePixelRatio||1,c=n.innerWidth*s,f=h.split(",").map(function(n){var t={};return n.trim().split(/\s+/).forEach(function(n,i){var r=parseInt(n.substring(0,n.length-1),10);if(i===0)return t.url=n;r&&(t.value=r,t.postfix=n[n.length-1])}),t}),f.sort(function(n,t){return n.value-t.value}),o=0;o<f.length;o++)if(e=f[o],e.postfix==="w"&&e.value>=c||e.postfix==="x"&&e.value>=s){u=e;break}!u&&f.length&&(u=f[f.length-1]);u&&(t.src=u.url,t.width&&t.height&&u.postfix=="w"&&(t.height=t.width/t.height*u.value,t.width=u.value))}t.$placeholder=i('<div class="fancybox-placeholder"><\/div>').hide().appendTo(t.$slide);t.opts.preload!==!1&&t.opts.width&&t.opts.height&&(t.opts.thumb||t.opts.$thumb)?(t.width=t.opts.width,t.height=t.opts.height,t.$ghost=i("<img />").one("load error",function(){r.isClosing||(i("<img/>")[0].src=t.src,r.revealImage(t,function(){r.setBigImage(t);r.firstRun&&t.index===r.currIndex&&r.preload()}))}).addClass("fancybox-image").appendTo(t.$placeholder).attr("src",t.opts.thumb||t.opts.$thumb.attr("src"))):r.setBigImage(t)},setBigImage:function(n){var r=this,t=i("<img />");if(n.$image=t.one("error",function(){r.setError(n)}).one("load",function(){(clearTimeout(n.timouts),n.timouts=null,r.isClosing)||(n.width=this.naturalWidth,n.height=this.naturalHeight,n.opts.image.srcset&&t.attr("sizes","100vw").attr("srcset",n.opts.image.srcset),r.afterLoad(n),n.$ghost&&(n.timouts=setTimeout(function(){n.$ghost.hide()},350)))}).addClass("fancybox-image").attr("src",n.src).appendTo(n.$placeholder),t[0].complete?t.trigger("load"):t[0].error?t.trigger("error"):n.timouts=setTimeout(function(){t[0].complete||n.hasError||r.showLoading(n)},150),n.opts.image.protect)i('<div class="fancybox-spaceball"><\/div>').appendTo(n.$placeholder).on("contextmenu.fb",function(n){return n.button==2&&n.preventDefault(),!0})},revealImage:function(n,t){var r=this;if(t=t||i.noop,n.type!=="image"||n.hasError||n.isRevealed===!0){t.apply(r);return}n.isRevealed=!0;n.pos===r.currPos&&r.zoomInOut("In",n.opts.speed,t)||(n.$ghost&&!n.isLoaded&&r.updateSlide(n,!0),n.pos===r.currPos?i.fancybox.animate(n.$placeholder,{opacity:0},{opacity:1},300,t):n.$placeholder.show(),t.apply(r))},setIframe:function(n){var e=this,t=n.opts.iframe,f=n.$slide,u;if(n.$content=i('<div class="fancybox-content"><\/div>').css(t.css).appendTo(f),u=i(t.tpl.replace(/\{rnd\}/g,(new Date).getTime())).attr("scrolling",i.fancybox.isTouch?"auto":t.scrolling).appendTo(n.$content),t.preload){n.$content.addClass("fancybox-tmp");e.showLoading(n);u.on("load.fb error.fb",function(){this.isReady=1;n.$slide.trigger("refresh");e.afterLoad(n)});f.on("refresh.fb",function(){var i=n.$content,e,f,o,s,h;if(u[0].isReady===1){try{e=u.contents();f=e.find("body")}catch(c){}!f||!f.length||t.css.width!==r&&t.css.height!==r||(o=u[0].contentWindow.document.documentElement.scrollWidth,s=Math.ceil(f.outerWidth(!0)+(i.width()-o)),h=Math.ceil(f.outerHeight(!0)),i.css({width:t.css.width===r?s+(i.outerWidth()-i.innerWidth()):t.css.width,height:t.css.height===r?h+(i.outerHeight()-i.innerHeight()):t.css.height}));i.removeClass("fancybox-tmp")}})}else this.afterLoad(n);u.attr("src",n.src);n.opts.smallBtn&&n.$content.prepend(n.opts.closeTpl);f.one("onReset",function(){try{i(this).find("iframe").hide().attr("src","//about:blank")}catch(t){}i(this).empty();n.isLoaded=!1})},setContent:function(n,t){var r=this;if(!r.isClosing){r.hideLoading(n);n.$slide.empty();h(t)&&t.parent().length?(t.data("placeholder")&&t.parents(".fancybox-slide").trigger("onReset"),t.data({placeholder:i("<div><\/div>").hide().insertAfter(t)}).css("display","inline-block")):(i.type(t)==="string"&&(t=i("<div>").append(t).contents(),t[0].nodeType===3&&(t=i("<div>").html(t))),n.opts.selector&&(t=i("<div>").html(t).find(n.opts.selector)));n.$slide.one("onReset",function(){var r=h(t)?t.data("placeholder"):0;r&&(t.hide().replaceAll(r),t.data("placeholder",null));n.hasError||(i(this).empty(),n.isLoaded=!1)});n.$content=i(t).appendTo(n.$slide);n.opts.smallBtn===!0&&n.$content.find(".fancybox-close-small").remove().end().eq(0).append(n.opts.closeTpl);this.afterLoad(n)}},setError:function(n){n.hasError=!0;this.setContent(n,n.opts.errorTpl)},showLoading:function(n){var t=this;n=n||t.current;n&&!n.$spinner&&(n.$spinner=i(t.opts.spinnerTpl).appendTo(n.$slide))},hideLoading:function(n){var t=this;n=n||t.current;n&&n.$spinner&&(n.$spinner.remove(),delete n.$spinner)},afterMove:function(){var n=this,t=n.current,r={};t&&(t.$slide.siblings().trigger("onReset"),i.each(n.slides,function(t,i){i.pos>=n.currPos-1&&i.pos<=n.currPos+1?r[i.pos]=i:i&&i.$slide.remove()}),n.slides=r,n.trigger("afterMove"),t.isLoaded&&n.complete())},afterLoad:function(n){var t=this;t.isClosing||(n.isLoading=!1,n.isLoaded=!0,t.trigger("afterLoad",n),t.hideLoading(n),n.$ghost||t.updateSlide(n,!0),n.index===t.currIndex&&n.isMoved?t.complete():n.$ghost||t.revealImage(n))},complete:function(){var t=this,n=t.current;t.revealImage(n,function(){n.isComplete=!0;n.$slide.addClass("fancybox-slide--complete");t.updateCursor();t.trigger("onComplete");!n.opts.focus||n.type==="image"||n.type==="iframe"||t.focus()})},preload:function(){var n=this,t,i;n.group.length<2||(t=n.slides[n.currPos+1],i=n.slides[n.currPos-1],t&&t.type==="image"&&n.loadSlide(t),i&&i.type==="image"&&n.loadSlide(i))},focus:function(){var n=this.current,t;t=n&&n.isComplete?n.$slide.find('button,:input,[tabindex],a:not(".disabled")').filter(":visible:first"):null;t&&t.length||(t=this.$refs.container);t.focus();this.$refs.slider_wrap.scrollLeft(0);n&&n.$slide.scrollTop(0)},activate:function(){var n=this;i(".fancybox-container").each(function(){var t=i(this).data("FancyBox");t&&t.uid!==n.uid&&!t.isClosing&&t.trigger("onDeactivate")});n.current&&(n.$refs.container.index()>0&&n.$refs.container.prependTo(t.body),n.updateControls());n.trigger("onActivate");n.addEvents()},close:function(n){var t=this,r=t.current,f=r.opts.speed,e=i.proxy(function(){t.cleanUp(n)},this);if(t.isAnimating||t.isClosing)return!1;if(t.trigger("beforeClose",n)===!1){i.fancybox.stop(t.$refs.slider);u(function(){t.update(!0,!0,150)});return}t.isClosing=!0;r.timouts&&clearTimeout(r.timouts);n!==!0&&i.fancybox.stop(t.$refs.slider);t.$refs.container.removeClass("fancybox-container--active").addClass("fancybox-container--closing");r.$slide.removeClass("fancybox-slide--complete").siblings().remove();r.isMoved||r.$slide.css("overflow","visible");t.removeEvents();t.hideLoading(r);t.hideControls();t.updateCursor();t.$refs.bg.css("transition-duration",f+"ms");this.$refs.container.removeClass("fancybox-container--ready");n===!0?setTimeout(e,f):t.zoomInOut("Out",f,e)||i.fancybox.animate(t.$refs.container,null,{opacity:0},f,"easeInSine",e)},cleanUp:function(n){var t=this,r;t.$refs.slider.children().trigger("onReset");t.$refs.container.empty().remove();t.trigger("afterClose",n);t.current=null;r=i.fancybox.getInstance();r?r.activate():(i("html").removeClass("fancybox-enabled"),i("body").removeAttr("style"),e.scrollTop(t.scrollTop).scrollLeft(t.scrollLeft),i("#fancybox-noscroll").remove());t.$lastFocus&&t.$lastFocus.focus()},trigger:function(n,r){var f=Array.prototype.slice.call(arguments,1),e=this,u=r&&r.opts?r:e.current,o;if(u?f.unshift(u):u=e,f.unshift(e),i.isFunction(u.opts[n])&&(o=u.opts[n].apply(u,f)),o===!1)return o;n==="afterClose"?i(t).trigger(n+".fb",f):e.$refs.container.trigger(n+".fb",f)},toggleControls:function(n){this.isHiddenControls?this.updateControls(n):this.hideControls()},hideControls:function(){this.isHiddenControls=!0;this.$refs.container.removeClass("fancybox-show-controls");this.$refs.container.removeClass("fancybox-show-caption")},updateControls:function(n){var t=this,u=t.$refs.container,f=t.$refs.caption,e=t.current,o=e.index,r=e.opts,s=r.caption;this.isHiddenControls&&n!==!0||(this.isHiddenControls=!1,u.addClass("fancybox-show-controls").toggleClass("fancybox-show-infobar",!!r.infobar&&t.group.length>1).toggleClass("fancybox-show-buttons",!!r.buttons).toggleClass("fancybox-is-modal",!!r.modal),i(".fancybox-button--left",u).toggleClass("fancybox-button--disabled",!r.loop&&o<=0),i(".fancybox-button--right",u).toggleClass("fancybox-button--disabled",!r.loop&&o>=t.group.length-1),i(".fancybox-button--play",u).toggle(!!(r.slideShow&&t.group.length>1)),i(".fancybox-button--close",u).toggle(!!r.closeBtn),i(".js-fancybox-count",u).html(t.group.length),i(".js-fancybox-index",u).html(o+1),e.$slide.trigger("refresh"),f&&f.empty(),s&&s.length?(f.html(s),this.$refs.container.addClass("fancybox-show-caption "),t.$caption=f):this.$refs.container.removeClass("fancybox-show-caption"))}});i.fancybox={version:"3.0.47",defaults:s,getInstance:function(n){var t=i('.fancybox-container:not(".fancybox-container--closing"):first').data("FancyBox"),r=Array.prototype.slice.call(arguments,1);return t instanceof o?(i.type(n)==="string"?t[n].apply(t,r):i.type(n)==="function"&&n.apply(t,r),t):!1},open:function(n,t,i){return new o(n,t,i)},close:function(n){var t=this.getInstance();t&&(t.close(),n===!0&&this.close())},isTouch:t.createTouch!==r&&/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent),use3d:function(){var i=t.createElement("div");return n.getComputedStyle(i).getPropertyValue("transform")&&!(t.documentMode&&t.documentMode<=11)}(),getTranslate:function(n){var i,t;return!n||!n.length?!1:(i=n.get(0).getBoundingClientRect(),t=n.eq(0).css("transform"),t&&t.indexOf("matrix")!==-1?(t=t.split("(")[1],t=t.split(")")[0],t=t.split(",")):t=[],t.length?(t=t.length>10?[t[13],t[12],t[0],t[5]]:[t[5],t[4],t[0],t[3]],t=t.map(parseFloat)):t=[0,0,1,1],{top:t[0],left:t[1],scaleX:t[2],scaleY:t[3],opacity:parseFloat(n.css("opacity")),width:i.width,height:i.height})},setTranslate:function(n,t){var i="",u={};if(n&&t)return(t.left!==r||t.top!==r)&&(i=(t.left===r?n.position().top:t.left)+"px, "+(t.top===r?n.position().top:t.top)+"px",i=this.use3d?"translate3d("+i+", 0px)":"translate("+i+")"),t.scaleX!==r&&t.scaleY!==r&&(i=(i.length?i+" ":"")+"scale("+t.scaleX+", "+t.scaleY+")"),i.length&&(u.transform=i),t.opacity!==r&&(u.opacity=t.opacity),t.width!==r&&(u.width=t.width),t.height!==r&&(u.height=t.height),n.css(u)},easing:{easeOutCubic:function(n,t,i,r){return i*((n=n/r-1)*n*n+1)+t},easeInCubic:function(n,t,i,r){return i*(n/=r)*n*n+t},easeOutSine:function(n,t,i,r){return i*Math.sin(n/r*(Math.PI/2))+t},easeInSine:function(n,t,i,r){return-i*Math.cos(n/r*(Math.PI/2))+i+t}},stop:function(n){n.removeData("animateID")},animate:function(n,t,f,e,o,s){var h=this,l=null,a=0,c,v,y,p=function(){f.scaleX!==r&&f.scaleY!==r&&t&&t.width!==r&&t.height!==r&&(f.width=t.width*f.scaleX,f.height=t.height*f.scaleY,f.scaleX=1,f.scaleY=1);h.setTranslate(n,f);s()},w=function(i){if(c=[],v=0,n.length&&n.data("animateID")===y){if(i=i||Date.now(),l&&(v=i-l),l=i,a+=v,a>=e){p();return}for(var s in f)f.hasOwnProperty(s)&&t[s]!==r&&(c[s]=t[s]==f[s]?f[s]:h.easing[o](a,t[s],f[s]-t[s],e));h.setTranslate(n,c);u(w)}};h.animateID=y=h.animateID===r?1:h.animateID+1;n.data("animateID",y);s===r&&i.type(o)=="function"&&(s=o,o=r);o||(o="easeOutCubic");s=s||i.noop;t?this.setTranslate(n,t):t=this.getTranslate(n);e?(n.show(),u(w)):p()}};i.fn.fancybox=function(n){this.off("click.fb-start").on("click.fb-start",{items:this,options:n||{}},c);return this};i(t).on("click.fb-start","[data-fancybox]",c)}(window,document,window.jQuery),function(n){"use strict";var t=function(t,i,r){if(t)return r=r||"",n.type(r)==="object"&&(r=n.param(r,!0)),n.each(i,function(n,i){t=t.replace("$"+n,i||"")}),r.length&&(t+=(t.indexOf("?")>0?"&":"?")+r),t},i={youtube:{matcher:/(youtube\.com|youtu\.be|youtube\-nocookie\.com)\/(watch\?(.*&)?v=|v\/|u\/|embed\/?)?(videoseries\?list=(.*)|[\w-]{11}|\?listType=(.*)&list=(.*))(.*)/i,params:{autoplay:1,autohide:1,fs:1,rel:0,hd:1,wmode:"transparent",enablejsapi:1,html5:1},paramPlace:8,type:"iframe",url:"//www.youtube.com/embed/$4",thumb:"//img.youtube.com/vi/$4/hqdefault.jpg"},vimeo:{matcher:/^.+vimeo.com\/(.*\/)?([\d]+)(.*)?/,params:{autoplay:1,hd:1,show_title:1,show_byline:1,show_portrait:0,fullscreen:1,api:1},paramPlace:3,type:"iframe",url:"//player.vimeo.com/video/$2"},metacafe:{matcher:/metacafe.com\/watch\/(\d+)\/(.*)?/,type:"iframe",url:"//www.metacafe.com/embed/$1/?ap=1"},dailymotion:{matcher:/dailymotion.com\/video\/(.*)\/?(.*)/,params:{additionalInfos:0,autoStart:1},type:"iframe",url:"//www.dailymotion.com/embed/video/$1"},vine:{matcher:/vine.co\/v\/([a-zA-Z0-9\?\=\-]+)/,type:"iframe",url:"//vine.co/v/$1/embed/simple"},instagram:{matcher:/(instagr\.am|instagram\.com)\/p\/([a-zA-Z0-9_\-]+)\/?/i,type:"image",url:"//$1/p/$2/media/?size=l"},google_maps:{matcher:/(maps\.)?google\.([a-z]{2,3}(\.[a-z]{2})?)\/(((maps\/(place\/(.*)\/)?\@(.*),(\d+.?\d+?)z))|(\?ll=))(.*)?/i,type:"iframe",url:function(n){return"//maps.google."+n[2]+"/?ll="+(n[9]?n[9]+"&z="+Math.floor(n[10])+(n[12]?n[12].replace(/^\//,"&"):""):n[12])+"&output="+(n[12]&&n[12].indexOf("layer=c")>0?"svembed":"embed")}}};n(document).on("onInit.fb",function(r,u){n.each(u.group,function(r,u){var o=u.src||"",s=!1,l,f,h,e,c,a;u.type||(n.each(i,function(i,r){var v,y;if(f=o.match(r.matcher),c={},a=i,f){if(s=r.type,r.paramPlace&&f[r.paramPlace])for(e=f[r.paramPlace],e[0]=="?"&&(e=e.substring(1)),e=e.split("&"),v=0;v<e.length;++v)y=e[v].split("=",2),y.length==2&&(c[y[0]]=decodeURIComponent(y[1].replace(/\+/g," ")));return h=n.extend(!0,{},r.params,u.opts[i],c),o=n.type(r.url)==="function"?r.url.call(this,f,h,u):t(r.url,f,h),l=n.type(r.thumb)==="function"?r.thumb.call(this,f,h,u):t(r.thumb,f),a==="vimeo"&&(o=o.replace("&%23","#")),!1}}),s?(u.src=o,u.type=s,u.opts.thumb||u.opts.$thumb&&u.opts.$thumb.length||(u.opts.thumb=l),s==="iframe"&&(n.extend(!0,u.opts,{iframe:{preload:!1,scrolling:"no"},smallBtn:!1,closeBtn:!0,fullScreen:!1,slideShow:!1}),u.opts.slideClass+=" fancybox-slide--video")):u.type="iframe")})})}(window.jQuery),function(n,t,i){"use strict";var f=function(){return n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||function(t){n.setTimeout(t,1e3/60)}}(),e=function(t){var r=[],i;t=t.originalEvent||t||n.e;t=t.touches&&t.touches.length?t.touches:t.changedTouches&&t.changedTouches.length?t.changedTouches:[t];for(i in t)t[i].pageX?r.push({x:t[i].pageX,y:t[i].pageY}):t[i].clientX&&r.push({x:t[i].clientX,y:t[i].clientY});return r},u=function(n,t,i){return!t||!n?0:i==="x"?n.x-t.x:i==="y"?n.y-t.y:Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))},o=function(n){return n.is("a")||n.is("button")||n.is("input")||n.is("select")||n.is("textarea")||i.isFunction(n.get(0).onclick)},s=function(t){var i=n.getComputedStyle(t)["overflow-y"],r=n.getComputedStyle(t)["overflow-x"],u=(i==="scroll"||i==="auto")&&t.scrollHeight>t.clientHeight,f=(r==="scroll"||r==="auto")&&t.scrollWidth>t.clientWidth;return u||f},h=function(n){for(var t=!1;;){if(t=s(n.get(0)),t)break;if(n=n.parent(),!n.length||n.hasClass("fancybox-slider")||n.is("body"))break}return t},r=function(n){var t=this;t.instance=n;t.$wrap=n.$refs.slider_wrap;t.$slider=n.$refs.slider;t.$container=n.$refs.container;t.destroy();t.$wrap.on("touchstart.fb mousedown.fb",i.proxy(t,"ontouchstart"))};r.prototype.destroy=function(){this.$wrap.off("touchstart.fb mousedown.fb touchmove.fb mousemove.fb touchend.fb touchcancel.fb mouseup.fb mouseleave.fb")};r.prototype.ontouchstart=function(t){var r=this,s=i(t.target),c=r.instance,f=c.current,l=f.$content||f.$placeholder;if(r.startPoints=e(t),r.$target=s,r.$content=l,r.canvasWidth=Math.round(f.$slide[0].clientWidth),r.canvasHeight=Math.round(f.$slide[0].clientHeight),r.startEvent=t,t.originalEvent.clientX>r.canvasWidth+f.$slide.offset().left)return!0;if(!o(s)&&!o(s.parent())&&!h(s)){if(!f.opts.touch)return r.endPoints=r.startPoints,r.ontap();if((!t.originalEvent||t.originalEvent.button!=2)&&(t.stopPropagation(),t.preventDefault(),f&&!r.instance.isAnimating&&!r.instance.isClosing)&&r.startPoints&&(!(r.startPoints.length>1)||f.isMoved)){r.$wrap.off("touchmove.fb mousemove.fb",i.proxy(r,"ontouchmove"));r.$wrap.off("touchend.fb touchcancel.fb mouseup.fb mouseleave.fb",i.proxy(r,"ontouchend"));r.$wrap.on("touchend.fb touchcancel.fb mouseup.fb mouseleave.fb",i.proxy(r,"ontouchend"));r.$wrap.on("touchmove.fb mousemove.fb",i.proxy(r,"ontouchmove"));r.startTime=(new Date).getTime();r.distanceX=r.distanceY=r.distance=0;r.canTap=!1;r.isPanning=!1;r.isSwiping=!1;r.isZooming=!1;r.sliderStartPos=i.fancybox.getTranslate(r.$slider);r.contentStartPos=i.fancybox.getTranslate(r.$content);r.contentLastPos=null;r.startPoints.length!==1||r.isZooming||(r.canTap=f.isMoved,f.type==="image"&&(r.contentStartPos.width>r.canvasWidth+1||r.contentStartPos.height>r.canvasHeight+1)?(i.fancybox.stop(r.$content),r.isPanning=!0):(i.fancybox.stop(r.$slider),r.isSwiping=!0),r.$container.addClass("fancybox-controls--isGrabbing"));r.startPoints.length===2&&f.isMoved&&!f.hasError&&f.type==="image"&&(f.isLoaded||f.$ghost)&&(r.isZooming=!0,r.isSwiping=!1,r.isPanning=!1,i.fancybox.stop(r.$content),r.centerPointStartX=(r.startPoints[0].x+r.startPoints[1].x)*.5-i(n).scrollLeft(),r.centerPointStartY=(r.startPoints[0].y+r.startPoints[1].y)*.5-i(n).scrollTop(),r.percentageOfImageAtPinchPointX=(r.centerPointStartX-r.contentStartPos.left)/r.contentStartPos.width,r.percentageOfImageAtPinchPointY=(r.centerPointStartY-r.contentStartPos.top)/r.contentStartPos.height,r.startDistanceBetweenFingers=u(r.startPoints[0],r.startPoints[1]))}}};r.prototype.ontouchmove=function(n){var t=this;(n.preventDefault(),t.newPoints=e(n),t.newPoints&&t.newPoints.length)&&(t.distanceX=u(t.newPoints[0],t.startPoints[0],"x"),t.distanceY=u(t.newPoints[0],t.startPoints[0],"y"),t.distance=u(t.newPoints[0],t.startPoints[0]),t.distance>0&&(t.isSwiping?t.onSwipe():t.isPanning?t.onPan():t.isZooming&&t.onZoom()))};r.prototype.onSwipe=function(){var t=this,u=t.isSwiping,r=t.sliderStartPos.left,e;u===!0?Math.abs(t.distance)>10&&(t.instance.group.length<2?t.isSwiping="y":!t.instance.current.isMoved||t.instance.opts.touch.vertical===!1||t.instance.opts.touch.vertical==="auto"&&i(n).width()>800?t.isSwiping="x":(e=Math.abs(Math.atan2(t.distanceY,t.distanceX)*180/Math.PI),t.isSwiping=e>45&&e<135?"y":"x"),t.canTap=!1,t.instance.current.isMoved=!1,t.startPoints=t.newPoints):(u=="x"&&(r=!t.instance.current.opts.loop&&t.instance.current.index===0&&t.distanceX>0?r+Math.pow(t.distanceX,.8):!t.instance.current.opts.loop&&t.instance.current.index===t.instance.group.length-1&&t.distanceX<0?r-Math.pow(-t.distanceX,.8):r+t.distanceX),t.sliderLastPos={top:u=="x"?0:t.sliderStartPos.top+t.distanceY,left:r},f(function(){i.fancybox.setTranslate(t.$slider,t.sliderLastPos)}))};r.prototype.onPan=function(){var n=this,r,u,t;n.canTap=!1;r=n.contentStartPos.width>n.canvasWidth?n.contentStartPos.left+n.distanceX:n.contentStartPos.left;u=n.contentStartPos.top+n.distanceY;t=n.limitMovement(r,u,n.contentStartPos.width,n.contentStartPos.height);t.scaleX=n.contentStartPos.scaleX;t.scaleY=n.contentStartPos.scaleY;n.contentLastPos=t;f(function(){i.fancybox.setTranslate(n.$content,n.contentLastPos)})};r.prototype.limitMovement=function(n,t,i,r){var u=this,f,e,o,s,h=u.canvasWidth,c=u.canvasHeight,v=u.contentStartPos.left,y=u.contentStartPos.top,l=u.distanceX,a=u.distanceY;return f=Math.max(0,h*.5-i*.5),e=Math.max(0,c*.5-r*.5),o=Math.min(h-i,h*.5-i*.5),s=Math.min(c-r,c*.5-r*.5),i>h&&(l>0&&n>f&&(n=f-1+Math.pow(-f+v+l,.8)||0),l<0&&n<o&&(n=o+1-Math.pow(o-v-l,.8)||0)),r>c&&(a>0&&t>e&&(t=e-1+Math.pow(-e+y+a,.8)||0),a<0&&t<s&&(t=s+1-Math.pow(s-y-a,.8)||0)),{top:t,left:n}};r.prototype.limitPosition=function(n,t,i,r){var e=this,u=e.canvasWidth,f=e.canvasHeight;return i>u?(n=n>0?0:n,n=n<u-i?u-i:n):n=Math.max(0,u/2-i/2),r>f?(t=t>0?0:t,t=t<f-r?f-r:t):t=Math.max(0,f/2-r/2),{top:t,left:n}};r.prototype.onZoom=function(){var t=this,e=t.contentStartPos.width,o=t.contentStartPos.height,c=t.contentStartPos.left,l=t.contentStartPos.top,a=u(t.newPoints[0],t.newPoints[1]),r=a/t.startDistanceBetweenFingers,s=Math.floor(e*r),h=Math.floor(o*r),v=(e-s)*t.percentageOfImageAtPinchPointX,y=(o-h)*t.percentageOfImageAtPinchPointY,p=(t.newPoints[0].x+t.newPoints[1].x)/2-i(n).scrollLeft(),w=(t.newPoints[0].y+t.newPoints[1].y)/2-i(n).scrollTop(),b=p-t.centerPointStartX,k=w-t.centerPointStartY,d=c+(v+b),g=l+(y+k),nt={top:g,left:d,scaleX:t.contentStartPos.scaleX*r,scaleY:t.contentStartPos.scaleY*r};t.canTap=!1;t.newWidth=s;t.newHeight=h;t.contentLastPos=nt;f(function(){i.fancybox.setTranslate(t.$content,t.contentLastPos)})};r.prototype.ontouchend=function(n){var t=this,u=t.instance.current,r=Math.max((new Date).getTime()-t.startTime,1),f=t.isSwiping,o=t.isPanning,s=t.isZooming;if(t.endPoints=e(n),t.$container.removeClass("fancybox-controls--isGrabbing"),t.$wrap.off("touchmove.fb mousemove.fb",i.proxy(this,"ontouchmove")),t.$wrap.off("touchend.fb touchcancel.fb mouseup.fb mouseleave.fb",i.proxy(this,"ontouchend")),t.isSwiping=!1,t.isPanning=!1,t.isZooming=!1,t.canTap)return t.ontap();t.velocityX=t.distanceX/r*.5;t.velocityY=t.distanceY/r*.5;t.speed=u.opts.speed||330;t.speedX=Math.max(t.speed*.75,Math.min(t.speed*1.5,1/Math.abs(t.velocityX)*t.speed));t.speedY=Math.max(t.speed*.75,Math.min(t.speed*1.5,1/Math.abs(t.velocityY)*t.speed));o?t.endPanning():s?t.endZooming():t.endSwiping(f);return};r.prototype.endSwiping=function(n){var t=this;n=="y"&&Math.abs(t.distanceY)>50?(i.fancybox.animate(t.$slider,null,{top:t.sliderStartPos.top+t.distanceY+t.velocityY*150,left:t.sliderStartPos.left,opacity:0},t.speedY),t.instance.close(!0)):n=="x"&&t.distanceX>50?t.instance.previous(t.speedX):n=="x"&&t.distanceX<-50?t.instance.next(t.speedX):t.instance.update(!1,!0,150)};r.prototype.endPanning=function(){var n=this,r,u,t;n.contentLastPos&&(r=n.contentLastPos.left+n.velocityX*n.speed*2,u=n.contentLastPos.top+n.velocityY*n.speed*2,t=n.limitPosition(r,u,n.contentStartPos.width,n.contentStartPos.height),t.width=n.contentStartPos.width,t.height=n.contentStartPos.height,i.fancybox.animate(n.$content,null,t,n.speed,"easeOutSine"))};r.prototype.endZooming=function(){var n=this,e=n.instance.current,u,f,o,s,t=n.newWidth,r=n.newHeight;n.contentLastPos&&(u=n.contentLastPos.left,f=n.contentLastPos.top,s={top:f,left:u,width:t,height:r,scaleX:1,scaleY:1},i.fancybox.setTranslate(n.$content,s),t<n.canvasWidth&&r<n.canvasHeight?n.instance.scaleToFit(150):t>e.width||r>e.height?n.instance.scaleToActual(n.centerPointStartX,n.centerPointStartY,150):(o=n.limitPosition(u,f,t,r),i.fancybox.animate(n.$content,null,o,n.speed,"easeOutSine")))};r.prototype.ontap=function(){var n=this,t=n.instance,r=t.current,u=n.endPoints[0].x,f=n.endPoints[0].y;if(u=u-n.$wrap.offset().left,f=f-n.$wrap.offset().top,t.SlideShow&&t.SlideShow.isActive&&t.SlideShow.stop(),!i.fancybox.isTouch){if(r.opts.closeClickOutside&&n.$target.is(".fancybox-slide")){t.close(n.startEvent);return}r.type=="image"&&r.isMoved&&(t.canPan()?t.scaleToFit():t.isScaledDown()?t.scaleToActual(u,f):t.group.length<2&&t.close(n.startEvent));return}if(n.tapped){if(clearTimeout(n.tapped),n.tapped=null,Math.abs(u-n.x)>50||Math.abs(f-n.y)>50||!r.isMoved)return this;r.type=="image"&&(r.isLoaded||r.$ghost)&&(t.canPan()?t.scaleToFit():t.isScaledDown()&&t.scaleToActual(u,f))}else n.x=u,n.y=f,n.tapped=setTimeout(function(){n.tapped=null;t.toggleControls(!0)},300);return this};i(t).on("onActivate.fb",function(n,t){t&&!t.Guestures&&(t.Guestures=new r(t))});i(t).on("beforeClose.fb",function(n,t){t&&t.Guestures&&t.Guestures.destroy()})}(window,document,window.jQuery),function(n,t){"use strict";var i=function(n){this.instance=n;this.init()};t.extend(i.prototype,{timer:null,isActive:!1,$button:null,speed:3e3,init:function(){var n=this;n.$button=t('<button data-fancybox-play class="fancybox-button fancybox-button--play" title="Slideshow (P)"><\/button>').appendTo(n.instance.$refs.buttons);n.instance.$refs.container.on("click","[data-fancybox-play]",function(){n.toggle()})},set:function(){var n=this;n.instance&&n.instance.current&&(n.instance.current.opts.loop||n.instance.currIndex<n.instance.group.length-1)?n.timer=setTimeout(function(){n.instance.next()},n.instance.current.opts.slideShow.speed||n.speed):n.stop()},clear:function(){var n=this;clearTimeout(n.timer);n.timer=null},start:function(){var n=this;if(n.stop(),n.instance&&n.instance.current&&(n.instance.current.opts.loop||n.instance.currIndex<n.instance.group.length-1)){n.instance.$refs.container.on({"beforeLoad.fb.player":t.proxy(n,"clear"),"onComplete.fb.player":t.proxy(n,"set")});n.isActive=!0;n.instance.current.isComplete&&n.set();n.instance.$refs.container.trigger("onPlayStart");n.$button.addClass("fancybox-button--pause")}},stop:function(){var n=this;n.clear();n.instance.$refs.container.trigger("onPlayEnd").off(".player");n.$button.removeClass("fancybox-button--pause");n.isActive=!1},toggle:function(){var n=this;n.isActive?n.stop():n.start()}});t(n).on("onInit.fb",function(n,t){t&&t.group.length>1&&!!t.opts.slideShow&&!t.SlideShow&&(t.SlideShow=new i(t))});t(n).on("beforeClose.fb onDeactivate.fb",function(n,t){t&&t.SlideShow&&t.SlideShow.stop()})}(document,window.jQuery),function(n,t){"use strict";var i=function(){for(var u=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],t,f={},i,r=0;r<u.length;r++)if(t=u[r],t&&t[1]in n){for(i=0;i<t.length;i++)f[u[0][i]]=t[i];return f}return!1}(),r;if(i){r={request:function(t){t=t||n.documentElement;t[i.requestFullscreen](t.ALLOW_KEYBOARD_INPUT)},exit:function(){n[i.exitFullscreen]()},toggle:function(n){this.isFullscreen()?this.exit():this.request(n)},isFullscreen:function(){return Boolean(n[i.fullscreenElement])},enabled:function(){return Boolean(n[i.fullscreenEnabled])}};t(n).on({"onInit.fb":function(n,i){var u;if(i&&!!i.opts.fullScreen&&!i.FullScreen){u=i.$refs.container;i.$refs.button_fs=t('<button data-fancybox-fullscreen class="fancybox-button fancybox-button--fullscreen" title="Full screen (F)"><\/button>').appendTo(i.$refs.buttons);u.on("click.fb-fullscreen","[data-fancybox-fullscreen]",function(n){n.stopPropagation();n.preventDefault();r.toggle(u[0])});i.opts.fullScreen.requestOnStart===!0&&r.request(u[0])}},"beforeMove.fb":function(n,t){t&&t.$refs.button_fs&&t.$refs.button_fs.toggle(!!t.current.opts.fullScreen)},"beforeClose.fb":function(){r.exit()}});t(n).on(i.fullscreenchange,function(){var n=t.fancybox.getInstance(),i=n?n.current.$placeholder:null;i&&(i.css("transition","none"),n.isAnimating=!1,n.update(!0,!0,0))})}}(document,window.jQuery),function(n,t){"use strict";var i=function(n){this.instance=n;this.init()};t.extend(i.prototype,{$button:null,$grid:null,$list:null,isVisible:!1,init:function(){var n=this;n.$button=t('<button data-fancybox-thumbs class="fancybox-button fancybox-button--thumbs" title="Thumbnails (G)"><\/button>').appendTo(this.instance.$refs.buttons).on("touchend click",function(t){t.stopPropagation();t.preventDefault();n.toggle()})},create:function(){var r=this.instance,i,n;this.$grid=t('<div class="fancybox-thumbs"><\/div>').appendTo(r.$refs.container);i="<ul>";t.each(r.group,function(t,r){n=r.opts.thumb||(r.opts.$thumb?r.opts.$thumb.attr("src"):null);n||r.type!=="image"||(n=r.src);n&&n.length&&(i+='<li data-index="'+t+'"  tabindex="0" class="fancybox-thumbs-loading"><img data-src="'+n+'" /><\/li>')});i+="<\/ul>";this.$list=t(i).appendTo(this.$grid).on("click touchstart","li",function(){r.jumpTo(t(this).data("index"))});this.$list.find("img").hide().one("load",function(){var o=t(this).parent().removeClass("fancybox-thumbs-loading"),f=o.outerWidth(),e=o.outerHeight(),n,i,r,u;n=this.naturalWidth||this.width;i=this.naturalHeight||this.height;r=n/f;u=i/e;r>=1&&u>=1&&(r>u?(n=n/u,i=e):(n=f,i=i/r));t(this).css({width:Math.floor(n),height:Math.floor(i),"margin-top":Math.min(0,Math.floor(e*.3-i*.3)),"margin-left":Math.min(0,Math.floor(f*.5-n*.5))}).show()}).each(function(){this.src=t(this).data("src")})},focus:function(){this.instance.current&&this.$list.children().removeClass("fancybox-thumbs-active").filter('[data-index="'+this.instance.current.index+'"]').addClass("fancybox-thumbs-active").focus()},close:function(){this.$grid.hide()},update:function(){this.instance.$refs.container.toggleClass("fancybox-container--thumbs",this.isVisible);this.isVisible?(this.$grid||this.create(),this.$grid.show(),this.focus()):this.$grid&&this.$grid.hide();this.instance.update()},hide:function(){this.isVisible=!1;this.update()},show:function(){this.isVisible=!0;this.update()},toggle:function(){this.isVisible?this.hide():this.show()}});t(n).on("onInit.fb",function(n,t){var r=t.group[0],u=t.group[1];!!t.opts.thumbs&&!t.Thumbs&&t.group.length>1&&(r.type=="image"||r.opts.thumb||r.opts.$thumb)&&(u.type=="image"||u.opts.thumb||u.opts.$thumb)&&(t.Thumbs=new i(t))});t(n).on("beforeMove.fb",function(n,t,i){var r=t&&t.Thumbs;r&&(i.modal?(r.$button.hide(),r.hide()):(t.opts.thumbs.showOnStart===!0&&t.firstRun&&r.show(),r.$button.show(),r.isVisible&&r.focus()))});t(n).on("beforeClose.fb",function(n,t){t&&t.Thumbs&&(t.Thumbs.isVisible&&t.opts.thumbs.hideOnClosing!==!1&&t.Thumbs.close(),t.Thumbs=null)})}(document,window.jQuery),function(n,t,i){"use strict";function u(){var r=t.location.hash.substr(1),n=r.split("-"),i=n.length>1&&/^\+?\d+$/.test(n[n.length-1])?parseInt(n.pop(-1),10)||1:1,u=n.join("-");return i<1&&(i=1),{hash:r,index:i,gallery:u}}function e(n){var t;n.gallery!==""&&(t=i("[data-fancybox='"+i.escapeSelector(n.gallery)+"']").eq(n.index-1),t.length?t.trigger("click"):i("#"+i.escapeSelector(n.gallery)+"").trigger("click"))}function f(n){var t;return n?(t=n.current?n.current.opts:n.opts,t.$orig?t.$orig.data("fancybox"):t.hash||""):!1}i.escapeSelector||(i.escapeSelector=function(n){var t=function(n,t){return t?n==="\0"?"�":n.slice(0,-1)+"\\"+n.charCodeAt(n.length-1).toString(16)+" ":"\\"+n};return(n+"").replace(/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g,t)});var r=null;i(function(){setTimeout(function(){if(i.fancybox.defaults.hash!==!1){i(t).on("hashchange.fb",function(){var n=u();i.fancybox.getInstance()?r&&r!==n.gallery+"-"+n.index&&(r=null,i.fancybox.close()):n.gallery!==""&&e(n)});i(n).on({"onInit.fb":function(n,t){var i=u(),r=f(t);r&&i.gallery&&r==i.gallery&&(t.currIndex=i.index-1)},"beforeMove.fb":function(i,u,e){var o=f(u);o&&o!==""&&(t.location.hash.indexOf(o)<0&&(u.opts.origHash=t.location.hash),r=o+(u.group.length>1?"-"+(e.index+1):""),"pushState"in history?history.pushState("",n.title,t.location.pathname+t.location.search+"#"+r):t.location.hash=r)},"beforeClose.fb":function(i,u){var e=f(u),o=u&&u.opts.origHash?u.opts.origHash:"";e&&e!==""&&("pushState"in history?history.pushState("",n.title,t.location.pathname+t.location.search+o):t.location.hash=o);r=null}});e(u())}},50)})}(document,window,window.jQuery);!function(n){n(["jquery"],function(n){return function(){function v(n,t,r){return u({type:f.error,iconClass:i().iconClasses.error,message:n,optionsOverride:r,title:t})}function r(r,u){return r||(r=i()),t=n("#"+r.containerId),t.length?t:(u&&(t=nt(r)),t)}function y(n,t,r){return u({type:f.info,iconClass:i().iconClasses.info,message:n,optionsOverride:r,title:t})}function p(n){o=n}function w(n,t,r){return u({type:f.success,iconClass:i().iconClasses.success,message:n,optionsOverride:r,title:t})}function b(n,t,r){return u({type:f.warning,iconClass:i().iconClasses.warning,message:n,optionsOverride:r,title:t})}function k(n){var u=i();t||r(u);h(n,u)||g(u)}function d(u){var f=i();return t||r(f),u&&0===n(":focus",u).length?void e(u):void(t.children().length&&t.remove())}function g(i){for(var u=t.children(),r=u.length-1;r>=0;r--)h(n(u[r]),i)}function h(t,i){return t&&0===n(":focus",t).length?(t[i.hideMethod]({duration:i.hideDuration,easing:i.hideEasing,complete:function(){e(t)}}),!0):!1}function nt(i){return t=n("<div/>").attr("id",i.containerId).addClass(i.positionClass).attr("aria-live","polite").attr("role","alert"),t.appendTo(n(i.target)),t}function tt(){return{tapToDismiss:!0,toastClass:"toast",containerId:"toast-container",debug:!1,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:void 0,hideMethod:"fadeOut",hideDuration:1e3,hideEasing:"swing",onHidden:void 0,extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},iconClass:"toast-info",positionClass:"toast-top-right",timeOut:5e3,titleClass:"toast-title",messageClass:"toast-message",target:"body",closeHtml:'<button type="button">&times;<\/button>',newestOnTop:!0,preventDuplicates:!1,progressBar:!1}}function c(n){o&&o(n)}function u(u){function v(t){if(!n(":focus",o).length||t)return(clearTimeout(h.intervalId),o[f.hideMethod]({duration:f.hideDuration,easing:f.hideEasing,complete:function(){e(o);f.onHidden&&"hidden"!==a.state&&f.onHidden();a.state="hidden";a.endTime=new Date;c(a)}}))}function g(){(f.timeOut>0||f.extendedTimeOut>0)&&(w=setTimeout(v,f.extendedTimeOut),h.maxHideTime=parseFloat(f.extendedTimeOut),h.hideEta=(new Date).getTime()+h.maxHideTime)}function nt(){clearTimeout(w);h.hideEta=0;o.stop(!0,!0)[f.showMethod]({duration:f.showDuration,easing:f.showEasing})}function tt(){var n=(h.hideEta-(new Date).getTime())/h.maxHideTime*100;b.width(n+"%")}var f=i(),p=u.iconClass||f.iconClass;if("undefined"!=typeof u.optionsOverride&&(f=n.extend(f,u.optionsOverride),p=u.optionsOverride.iconClass||p),f.preventDuplicates){if(u.message===s)return;s=u.message}l++;t=r(f,!0);var w=null,o=n("<div/>"),k=n("<div/>"),d=n("<div/>"),b=n("<div/>"),y=n(f.closeHtml),h={intervalId:null,hideEta:null,maxHideTime:null},a={toastId:l,state:"visible",startTime:new Date,options:f,map:u};return u.iconClass&&o.addClass(f.toastClass).addClass(p),u.title&&(k.append(u.title).addClass(f.titleClass),o.append(k)),u.message&&(d.append(u.message).addClass(f.messageClass),o.append(d)),f.closeButton&&(y.addClass("toast-close-button").attr("role","button"),o.prepend(y)),f.progressBar&&(b.addClass("toast-progress"),o.prepend(b)),o.hide(),f.newestOnTop?t.prepend(o):t.append(o),o[f.showMethod]({duration:f.showDuration,easing:f.showEasing,complete:f.onShown}),f.timeOut>0&&(w=setTimeout(v,f.timeOut),h.maxHideTime=parseFloat(f.timeOut),h.hideEta=(new Date).getTime()+h.maxHideTime,f.progressBar&&(h.intervalId=setInterval(tt,10))),o.hover(nt,g),!f.onclick&&f.tapToDismiss&&o.click(v),f.closeButton&&y&&y.click(function(n){n.stopPropagation?n.stopPropagation():void 0!==n.cancelBubble&&n.cancelBubble!==!0&&(n.cancelBubble=!0);v(!0)}),f.onclick&&o.click(function(){f.onclick();v()}),c(a),f.debug&&console&&console.log(a),o}function i(){return n.extend({},tt(),a.options)}function e(n){t||(t=r());n.is(":visible")||(n.remove(),n=null,0===t.children().length&&(t.remove(),s=void 0))}var t,o,s,l=0,f={error:"error",info:"info",success:"success",warning:"warning"},a={clear:k,remove:d,error:v,getContainer:r,info:y,options:{},subscribe:p,success:w,version:"2.1.0",warning:b};return a}()})}("function"==typeof define&&define.amd?define:function(n,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):window.toastr=t(window.jQuery)});eval(function(n,t,i,r,u,f){if(u=function(n){return(n<t?"":u(parseInt(n/t)))+((n=n%t)>35?String.fromCharCode(n+29):n.toString(36))},!"".replace(/^/,String)){while(i--)f[u(i)]=r[i]||u(i);r=[function(n){return f[n]}];u=function(){return"\\w+"};i=1}while(i--)r[i]&&(n=n.replace(new RegExp("\\b"+u(i)+"\\b","g"),r[i]));return n}('5 G(b,a){b.N().V(G,n.o.2Z);4.I=b;4.2E=b.N().2y();4.M=a;4.C=t;4.q=t;4.16=t;4.1o=w;4.K(b.v())}G.6.2F=5(){7 d=4;7 g;7 f;4.q=3A.3u("1Y");4.q.5p=4.2E;9(4.1o){4.2a()}4.4O().4H.4B(4.q);4.2X=n.o.u.1G(4.v(),"4b",5(){f=g});n.o.u.1E(4.q,"42",5(){g=H;f=w});n.o.u.1E(4.q,"2M",5(e){g=w;9(!f){7 c;7 b;7 a=d.I.N();n.o.u.X(a,"2M",d.I);n.o.u.X(a,"3V",d.I);9(a.2B()){b=a.1y();c=d.I.1s();a.v().1V(c);1U(5(){a.v().1V(c);9(b!==t&&(a.v().17()>b)){a.v().3F(b+1)}},3z)}e.3w=H;9(e.2j){e.2j()}}});n.o.u.1E(4.q,"2U",5(){7 a=d.I.N();n.o.u.X(a,"2U",d.I)});n.o.u.1E(4.q,"2L",5(){7 a=d.I.N();n.o.u.X(a,"2L",d.I)})};G.6.2Q=5(){9(4.q&&4.q.3e){4.1F();n.o.u.3b(4.2X);n.o.u.57(4.q);4.q.3e.4Z(4.q);4.q=t}};G.6.38=5(){9(4.1o){7 a=4.28(4.C);4.q.U.1J=a.y+"z";4.q.U.1H=a.x+"z"}};G.6.1F=5(){9(4.q){4.q.U.36="2V"}4.1o=w};G.6.2a=5(){9(4.q){7 e="";7 c=4.3g.4j(" ");7 b=12(c[0].1N(),10);7 d=12(c[1].1N(),10);7 a=4.28(4.C);4.q.U.43=4.2P(a);e="<41 3Z=\'"+4.2O+"\' U=\'20: 1Z; 1J: "+d+"z; 1H: "+b+"z; ";9(!4.I.N().1l){e+="3Y: 3X("+(-1*d)+"z, "+((-1*b)+4.1r)+"z, "+((-1*d)+4.1k)+"z, "+(-1*b)+"z);"}e+="\'>";4.q.3W=e+"<1Y U=\'"+"20: 1Z;"+"1J: "+4.1X[0]+"z;"+"1H: "+4.1X[1]+"z;"+"3T: "+4.2D+";"+"1O-1f: "+4.2z+"z;"+"1O-3P: "+4.2v+";"+"1O-3N: "+4.2t+";"+"1O-U: "+4.2s+";"+"1w-3I: "+4.2o+";"+"1w-3E: 1h;"+"1x: "+4.1r+"z;"+"3B-1u:"+4.1k+"z;"+"\'>"+4.16.1w+"<\/1Y>";9(1Q 4.16.14==="15"||4.16.14===""){4.q.14=4.I.N().2G()}L{4.q.14=4.16.14}4.q.U.36=""}4.1o=H};G.6.3i=5(a){4.16=a;7 b=A.3p(0,a.2T-1);b=A.22(4.M.p-1,b);7 c=4.M[b];4.2O=c.3f;4.1k=c.1u;4.1r=c.1x;4.1X=c.5m||[0,0];4.2c=c.5g||[12(4.1k/2,10),12(4.1r/2,10)];4.2D=c.5b||"55";4.2z=c.51||11;4.2o=c.4V||"2V";4.2t=c.4T||"4R";4.2s=c.4N||"4K";4.2v=c.4J||"4I,4G-4F";4.3g=c.4D||"0 0"};G.6.3h=5(a){4.C=a};G.6.2P=5(b){7 a=[];a.Y("4A: 4y;");a.Y("20: 1Z; 1J: "+b.y+"z; 1H: "+b.x+"z;");a.Y("1x: "+4.1r+"z; 1u: "+4.1k+"z;");j a.4v("")};G.6.28=5(b){7 a=4.37().1P(b);a.x-=4.2c[1];a.y-=4.2c[0];a.x=12(a.x,10);a.y=12(a.y,10);j a};5 D(a){4.W=a;4.Q=a.v();4.T=a.3c();4.13=a.2S();4.18=a.3a();4.k=[];4.C=t;4.2e=t;4.Z=F G(4,a.23())}D.6.45=5(){j 4.k.p};D.6.1D=5(){j 4.k};D.6.2R=5(){j 4.C};D.6.v=5(){j 4.Q};D.6.N=5(){j 4.W};D.6.1s=5(){7 i;7 b=F n.o.1m(4.C,4.C);7 a=4.1D();B(i=0;i<a.p;i++){b.V(a[i].S())}j b};D.6.1C=5(){4.Z.K(t);4.k=[];21 4.k};D.6.1B=5(e){7 i;7 c;7 b;9(4.2N(e)){j w}9(!4.C){4.C=e.S();4.25()}L{9(4.18){7 l=4.k.p+1;7 a=(4.C.O()*(l-1)+e.S().O())/l;7 d=(4.C.19()*(l-1)+e.S().19())/l;4.C=F n.o.1q(a,d);4.25()}}e.1p=H;4.k.Y(e);c=4.k.p;b=4.W.1y();9(b!==t&&4.Q.17()>b){9(e.v()!==4.Q){e.K(4.Q)}}L 9(c<4.13){9(e.v()!==4.Q){e.K(4.Q)}}L 9(c===4.13){B(i=0;i<c;i++){4.k[i].K(t)}}L{e.K(t)}4.2K();j H};D.6.2J=5(a){j 4.2e.2I(a.S())};D.6.25=5(){7 a=F n.o.1m(4.C,4.C);4.2e=4.W.2f(a)};D.6.2K=5(){7 c=4.k.p;7 a=4.W.1y();9(a!==t&&4.Q.17()>a){4.Z.1F();j}9(c<4.13){4.Z.1F();j}7 b=4.W.23().p;7 d=4.W.2H()(4.k,b);4.Z.3h(4.C);4.Z.3i(d);4.Z.2a()};D.6.2N=5(a){7 i;9(4.k.1d){j 4.k.1d(a)!==-1}L{B(i=0;i<4.k.p;i++){9(a===4.k[i]){j H}}}j w};5 8(a,c,b){4.V(8,n.o.2Z);c=c||[];b=b||{};4.k=[];4.E=[];4.1j=[];4.1e=t;4.1i=w;4.T=b.3U||3S;4.13=b.3R||2;4.1W=b.2C||t;4.M=b.3Q||[];4.2d=b.14||"";4.1z=H;9(b.2A!==15){4.1z=b.2A}4.18=w;9(b.2k!==15){4.18=b.2k}4.1a=w;9(b.2x!==15){4.1a=b.2x}4.1l=w;9(b.2w!==15){4.1l=b.2w}4.1I=b.3O||8.2u;4.1t=b.3L||8.2g;4.1c=b.3J||8.2r;4.1T=b.3H||8.2p;4.1R=b.3G||8.2n;4.1v=b.3D||8.2m;4.1S=b.3C||"P";9(3K.3y.3M().1d("3x")!==-1){4.1R=4.1v}4.2q();4.2l(c,H);4.K(a)}8.6.2F=5(){7 a=4;4.1e=4.v();4.1i=H;4.1b();4.1j=[n.o.u.1G(4.v(),"3v",5(){a.1A(w);9(4.17()===(4.2i("3t")||0)||4.17()===4.2i("2C")){n.o.u.X(4,"2h")}}),n.o.u.1G(4.v(),"2h",5(){a.1n()})]};8.6.2Q=5(){7 i;B(i=0;i<4.k.p;i++){9(4.k[i].v()!==4.1e){4.k[i].K(4.1e)}}B(i=0;i<4.E.p;i++){4.E[i].1C()}4.E=[];B(i=0;i<4.1j.p;i++){n.o.u.3b(4.1j[i])}4.1j=[];4.1e=t;4.1i=w};8.6.38=5(){};8.6.2q=5(){7 i,1f;9(4.M.p>0){j}B(i=0;i<4.1c.p;i++){1f=4.1c[i];4.M.Y({3f:4.1I+(i+1)+"."+4.1t,1u:1f,1x:1f})}};8.6.3s=5(){7 i;7 a=4.1D();7 b=F n.o.1m();B(i=0;i<a.p;i++){b.V(a[i].S())}4.v().1V(b)};8.6.3c=5(){j 4.T};8.6.3r=5(a){4.T=a};8.6.2S=5(){j 4.13};8.6.3q=5(a){4.13=a};8.6.1y=5(){j 4.1W};8.6.40=5(a){4.1W=a};8.6.23=5(){j 4.M};8.6.3o=5(a){4.M=a};8.6.2G=5(){j 4.2d};8.6.3n=5(a){4.2d=a};8.6.2B=5(){j 4.1z};8.6.3m=5(a){4.1z=a};8.6.3a=5(){j 4.18};8.6.44=5(a){4.18=a};8.6.3l=5(){j 4.1a};8.6.3k=5(a){4.1a=a};8.6.3j=5(){j 4.1l};8.6.48=5(a){4.1l=a};8.6.5o=5(){j 4.1t};8.6.5n=5(a){4.1t=a};8.6.5l=5(){j 4.1I};8.6.5k=5(a){4.1I=a};8.6.5i=5(){j 4.1c};8.6.5h=5(a){4.1c=a};8.6.2H=5(){j 4.1T};8.6.5f=5(a){4.1T=a};8.6.5e=5(){j 4.1v};8.6.5d=5(a){4.1v=a};8.6.2y=5(){j 4.1S};8.6.5c=5(a){4.1S=a};8.6.1D=5(){j 4.k};8.6.5a=5(){j 4.k.p};8.6.59=5(){j 4.E};8.6.54=5(){j 4.E.p};8.6.1B=5(b,a){4.2b(b);9(!a){4.1n()}};8.6.2l=5(b,a){7 c;B(c 39 b){9(b.50(c)){4.2b(b[c])}}9(!a){4.1n()}};8.6.2b=5(b){9(b.4X()){7 a=4;n.o.u.1G(b,"4W",5(){9(a.1i){4.1p=w;a.1b()}})}b.1p=w;4.k.Y(b)};8.6.4U=5(c,a){7 b=4.29(c);9(!a&&b){4.1b()}j b};8.6.4S=5(a,c){7 i,r;7 b=w;B(i=0;i<a.p;i++){r=4.29(a[i]);b=b||r}9(!c&&b){4.1b()}j b};8.6.29=5(b){7 i;7 a=-1;9(4.k.1d){a=4.k.1d(b)}L{B(i=0;i<4.k.p;i++){9(b===4.k[i]){a=i;4Q}}}9(a===-1){j w}b.K(t);4.k.4P(a,1);j H};8.6.4M=5(){4.1A(H);4.k=[]};8.6.1b=5(){7 a=4.E.4L();4.E=[];4.1A(w);4.1n();1U(5(){7 i;B(i=0;i<a.p;i++){a[i].1C()}},0)};8.6.2f=5(d){7 f=4.37();7 c=F n.o.1q(d.27().O(),d.27().19());7 a=F n.o.1q(d.24().O(),d.24().19());7 e=f.1P(c);e.x+=4.T;e.y-=4.T;7 g=f.1P(a);g.x-=4.T;g.y+=4.T;7 b=f.32(e);7 h=f.32(g);d.V(b);d.V(h);j d};8.6.1n=5(){4.26(0)};8.6.1A=5(a){7 i,J;B(i=0;i<4.E.p;i++){4.E[i].1C()}4.E=[];B(i=0;i<4.k.p;i++){J=4.k[i];J.1p=w;9(a){J.K(t)}}};8.6.30=5(b,e){7 R=4E;7 g=(e.O()-b.O())*A.1K/1M;7 f=(e.19()-b.19())*A.1K/1M;7 a=A.1L(g/2)*A.1L(g/2)+A.31(b.O()*A.1K/1M)*A.31(e.O()*A.1K/1M)*A.1L(f/2)*A.1L(f/2);7 c=2*A.4C(A.2Y(a),A.2Y(1-a));7 d=R*c;j d};8.6.35=5(b,a){j a.2I(b.S())};8.6.33=5(c){7 i,d,P,1h;7 a=4z;7 b=t;B(i=0;i<4.E.p;i++){P=4.E[i];1h=P.2R();9(1h){d=4.30(1h,c.S());9(d<a){a=d;b=P}}}9(b&&b.2J(c)){b.1B(c)}L{P=F D(4);P.1B(c);4.E.Y(P)}};8.6.26=5(e){7 i,J;7 d;7 c=4;9(!4.1i){j}9(e===0){n.o.u.X(4,"4x",4);9(1Q 4.1g!=="15"){4w(4.1g);21 4.1g}}9(4.v().17()>3){d=F n.o.1m(4.v().1s().24(),4.v().1s().27())}L{d=F n.o.1m(F n.o.1q(34.4u,-2W.4t),F n.o.1q(-34.4s,2W.4r))}7 a=4.2f(d);7 b=A.22(e+4.1R,4.k.p);B(i=e;i<b;i++){J=4.k[i];9(!J.1p&&4.35(J,a)){9(!4.1a||(4.1a&&J.4q())){4.33(J)}}}9(b<4.k.p){4.1g=1U(5(){c.26(b)},0)}L{21 4.1g;n.o.u.X(4,"4Y",4)}};8.6.V=5(d,c){j(5(b){7 a;B(a 39 b.6){4.6[a]=b.6[a]}j 4}).4p(d,[c])};8.2p=5(a,c){7 f=0;7 b="";7 d=a.p.4o();7 e=d;4n(e!==0){e=12(e/10,10);f++}f=A.22(f,c);j{1w:d,2T:f,14:b}};8.2n=52;8.2m=4m;8.2u="4l://n-o-4k-58-4i.4h.4g/4f/4e/4d/4c/m";8.2g="4a";8.2r=[53,56,5j,49,47];9(1Q 3d.6.1N!==\'5\'){3d.6.1N=5(){j 4.46(/^\\s+|\\s+$/g,\'\')}}',62,336,"||||this|function|prototype|var|MarkerClusterer|if||||||||||return|markers_|||google|maps|length|div_|||null|event|getMap|false|||px|Math|for|center_|Cluster|clusters_|new|ClusterIcon|true|cluster_|marker|setMap|else|styles_|getMarkerClusterer|lat|cluster|map_||getPosition|gridSize_|style|extend|markerClusterer_|trigger|push|clusterIcon_|||parseInt|minClusterSize_|title|undefined|sums_|getZoom|averageCenter_|lng|ignoreHidden_|repaint|imageSizes_|indexOf|activeMap_|size|timerRefStatic|center|ready_|listeners_|height_|enableRetinaIcons_|LatLngBounds|redraw_|visible_|isAdded|LatLng|width_|getBounds|imageExtension_|height|batchSizeIE_|text|width|getMaxZoom|zoomOnClick_|resetViewport_|addMarker|remove|getMarkers|addDomListener|hide|addListener|left|imagePath_|top|PI|sin|180|trim|font|fromLatLngToDivPixel|typeof|batchSize_|clusterClass_|calculator_|setTimeout|fitBounds|maxZoom_|anchorText_|div|absolute|position|delete|min|getStyles|getSouthWest|calculateBounds_|createClusters_|getNorthEast|getPosFromLatLng_|removeMarker_|show|pushMarkerTo_|anchorIcon_|title_|bounds_|getExtendedBounds|IMAGE_EXTENSION|idle|get|stopPropagation|averageCenter|addMarkers|BATCH_SIZE_IE|BATCH_SIZE|textDecoration_|CALCULATOR|setupStyles_|IMAGE_SIZES|fontStyle_|fontWeight_|IMAGE_PATH|fontFamily_|enableRetinaIcons|ignoreHidden|getClusterClass|textSize_|zoomOnClick|getZoomOnClick|maxZoom|textColor_|className_|onAdd|getTitle|getCalculator|contains|isMarkerInClusterBounds|updateIcon_|mouseout|click|isMarkerAlreadyAdded_|url_|createCss|onRemove|getCenter|getMinimumClusterSize|index|mouseover|none|178|boundsChangedListener_|sqrt|OverlayView|distanceBetweenPoints_|cos|fromDivPixelToLatLng|addToClosestCluster_|85|isMarkerInBounds_|display|getProjection|draw|in|getAverageCenter|removeListener|getGridSize|String|parentNode|url|backgroundPosition_|setCenter|useStyle|getEnableRetinaIcons|setIgnoreHidden|getIgnoreHidden|setZoomOnClick|setTitle|setStyles|max|setMinimumClusterSize|setGridSize|fitMapToMarkers|minZoom|createElement|zoom_changed|cancelBubble|msie|userAgent|100|document|line|clusterClass|batchSizeIE|align|setZoom|batchSize|calculator|decoration|imageSizes|navigator|imageExtension|toLowerCase|weight|imagePath|family|styles|minimumClusterSize|60|color|gridSize|clusterclick|innerHTML|rect|clip|src|setMaxZoom|img|mousedown|cssText|setAverageCenter|getSize|replace|90|setEnableRetinaIcons|78|png|bounds_changed|images|markerclustererplus|trunk|svn|com|googlecode|v3|split|utility|http|500|while|toString|apply|getVisible|00048865625|08136444384544|48388434375|02070771743472|join|clearTimeout|clusteringbegin|pointer|40000|cursor|appendChild|atan2|backgroundPosition|6371|serif|sans|overlayMouseTarget|Arial|fontFamily|normal|slice|clearMarkers|fontStyle|getPanes|splice|break|bold|removeMarkers|fontWeight|removeMarker|textDecoration|dragend|getDraggable|clusteringend|removeChild|hasOwnProperty|textSize|2000||getTotalClusters|black||clearInstanceListeners|library|getClusters|getTotalMarkers|textColor|setClusterClass|setBatchSizeIE|getBatchSizeIE|setCalculator|anchorIcon|setImageSizes|getImageSizes|66|setImagePath|getImagePath|anchorText|setImageExtension|getImageExtension|className".split("|"),0,{})),function(){(function(n){var i=this||eval("this"),r=i.document,f=i.navigator,t=i.jQuery,u=i.JSON;(function(n){"function"==typeof define&&define.amd?define(["exports","require"],n):"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?n(module.exports||exports):n(i.ko={})})(function(e,o){function a(n,t){return null===n||typeof n in p?n===t:!1}function w(t,i){var r;return function(){r||(r=setTimeout(function(){r=n;t()},i))}}function b(n,t){var i;return function(){clearTimeout(i);i=setTimeout(n,t)}}function v(n,t,i,r){s.d[n]={init:function(n,u,f,e,o){var c,h;return s.w(function(){var l=s.a.c(u()),f=!i!=!l,e=!h;(e||t||f!==c)&&(e&&s.Z.oa()&&(h=s.a.la(s.e.childNodes(n),!0)),f?(e||s.e.T(n,s.a.la(h)),s.Ja(r?r(o,l):o,n)):s.e.ma(n),c=f)},null,{q:n}),{controlsDescendantBindings:!0}}};s.h.ka[n]=!1;s.e.R[n]=!0}var s="undefined"!=typeof e?e:{},p,h,c,y,l;s.b=function(n,t){for(var i=n.split("."),r=s,u=0;u<i.length-1;u++)r=r[i[u]];r[i[i.length-1]]=t};s.D=function(n,t,i){n[t]=i};s.version="3.3.0";s.b("version",s.version);s.a=function(){function o(n,t){for(var i in n)n.hasOwnProperty(i)&&t(i,n[i])}function l(n,t){if(t)for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}function a(n,t){return n.__proto__=t,n}function v(n,t,i,r){var u=n[t].match(c)||[];s.a.o(i.match(c),function(n){s.a.ga(u,n,r)});n[t]=u.join(" ")}var y={__proto__:[]}instanceof Array,h={},p={};h[f&&/Firefox\/2/i.test(f.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"];h.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" ");o(h,function(n,t){if(t.length)for(var i=0,r=t.length;i<r;i++)p[t[i]]=n});var w={propertychange:!0},e=r&&function(){for(var t=3,i=r.createElement("div"),u=i.getElementsByTagName("i");i.innerHTML="<!--[if gt IE "+ ++t+"]><i><\/i><![endif]-->",u[0];);return 4<t?t:n}(),c=/\S+/g;return{Bb:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],o:function(n,t){for(var i=0,r=n.length;i<r;i++)t(n[i],i)},m:function(n,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(n,t);for(var i=0,r=n.length;i<r;i++)if(n[i]===t)return i;return-1},vb:function(n,t,i){for(var r=0,u=n.length;r<u;r++)if(t.call(i,n[r],r))return n[r];return null},ya:function(n,t){var i=s.a.m(n,t);0<i?n.splice(i,1):0===i&&n.shift()},wb:function(n){n=n||[];for(var i=[],t=0,r=n.length;t<r;t++)0>s.a.m(i,n[t])&&i.push(n[t]);return i},Ka:function(n,t){n=n||[];for(var r=[],i=0,u=n.length;i<u;i++)r.push(t(n[i],i));return r},xa:function(n,t){n=n||[];for(var r=[],i=0,u=n.length;i<u;i++)t(n[i],i)&&r.push(n[i]);return r},ia:function(n,t){if(t instanceof Array)n.push.apply(n,t);else for(var i=0,r=t.length;i<r;i++)n.push(t[i]);return n},ga:function(n,t,i){var r=s.a.m(s.a.cb(n),t);0>r?i&&n.push(t):i||n.splice(r,1)},za:y,extend:l,Fa:a,Ga:y?a:l,A:o,pa:function(n,t){if(!n)return n;var r={},i;for(i in n)n.hasOwnProperty(i)&&(r[i]=t(n[i],i,n));return r},Ra:function(n){for(;n.firstChild;)s.removeNode(n.firstChild)},Jb:function(n){n=s.a.O(n);for(var i=(n[0]&&n[0].ownerDocument||r).createElement("div"),t=0,u=n.length;t<u;t++)i.appendChild(s.S(n[t]));return i},la:function(n,t){for(var r,i=0,f=n.length,u=[];i<f;i++)r=n[i].cloneNode(!0),u.push(t?s.S(r):r);return u},T:function(n,t){if(s.a.Ra(n),t)for(var i=0,r=t.length;i<r;i++)n.appendChild(t[i])},Qb:function(n,t){var r=n.nodeType?[n]:n;if(0<r.length){for(var f=r[0],e=f.parentNode,i=0,u=t.length;i<u;i++)e.insertBefore(t[i],f);for(i=0,u=r.length;i<u;i++)s.removeNode(r[i])}},na:function(n,t){if(n.length){for(t=8===t.nodeType&&t.parentNode||t;n.length&&n[0].parentNode!==t;)n.splice(0,1);if(1<n.length){var i=n[0],r=n[n.length-1];for(n.length=0;i!==r;)if(n.push(i),i=i.nextSibling,!i)return;n.push(r)}}return n},Sb:function(n,t){7>e?n.setAttribute("selected",t):n.selected=t},ib:function(t){return null===t||t===n?"":t.trim?t.trim():t.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Dc:function(n,t){return n=n||"",t.length>n.length?!1:n.substring(0,t.length)===t},jc:function(n,t){if(n===t)return!0;if(11===n.nodeType)return!1;if(t.contains)return t.contains(3===n.nodeType?n.parentNode:n);if(t.compareDocumentPosition)return 16==(t.compareDocumentPosition(n)&16);for(;n&&n!=t;)n=n.parentNode;return!!n},Qa:function(n){return s.a.jc(n,n.ownerDocument.documentElement)},tb:function(n){return!!s.a.vb(n,s.a.Qa)},v:function(n){return n&&n.tagName&&n.tagName.toLowerCase()},n:function(n,i,r){var o=e&&w[i],u,f;if(!o&&t)t(n).bind(i,r);else if(o||"function"!=typeof n.addEventListener)if("undefined"!=typeof n.attachEvent)u=function(t){r.call(n,t)},f="on"+i,n.attachEvent(f,u),s.a.C.fa(n,function(){n.detachEvent(f,u)});else throw Error("Browser doesn't support addEventListener or attachEvent");else n.addEventListener(i,r,!1)},qa:function(n,u){if(!n||!n.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var f;if("input"===s.a.v(n)&&n.type&&"click"==u.toLowerCase()?(f=n.type,f="checkbox"==f||"radio"==f):f=!1,t&&!f)t(n).trigger(u);else if("function"==typeof r.createEvent)if("function"==typeof n.dispatchEvent)f=r.createEvent(p[u]||"HTMLEvents"),f.initEvent(u,!0,!0,i,0,0,0,0,0,!1,!1,!1,!1,0,n),n.dispatchEvent(f);else throw Error("The supplied element doesn't support dispatchEvent");else if(f&&n.click)n.click();else if("undefined"!=typeof n.fireEvent)n.fireEvent("on"+u);else throw Error("Browser doesn't support triggering events");},c:function(n){return s.F(n)?n():n},cb:function(n){return s.F(n)?n.B():n},Ia:function(n,t,i){var r;t&&("object"==typeof n.classList?(r=n.classList[i?"add":"remove"],s.a.o(t.match(c),function(t){r.call(n.classList,t)})):"string"==typeof n.className.baseVal?v(n.className,"baseVal",t,i):v(n,"className",t,i))},Ha:function(t,i){var r=s.a.c(i),u;(null===r||r===n)&&(r="");u=s.e.firstChild(t);!u||3!=u.nodeType||s.e.nextSibling(u)?s.e.T(t,[t.ownerDocument.createTextNode(r)]):u.data=r;s.a.mc(t)},Rb:function(n,t){if(n.name=t,7>=e)try{n.mergeAttributes(r.createElement("<input name='"+n.name+"'/>"),!1)}catch(i){}},mc:function(n){9<=e&&(n=1==n.nodeType?n:n.parentNode,n.style&&(n.style.zoom=n.style.zoom))},kc:function(n){if(e){var t=n.style.width;n.style.width=0;n.style.width=t}},Bc:function(n,t){n=s.a.c(n);t=s.a.c(t);for(var r=[],i=n;i<=t;i++)r.push(i);return r},O:function(n){for(var i=[],t=0,r=n.length;t<r;t++)i.push(n[t]);return i},Hc:6===e,Ic:7===e,M:e,Db:function(n,t){for(var r=s.a.O(n.getElementsByTagName("input")).concat(s.a.O(n.getElementsByTagName("textarea"))),f="string"==typeof t?function(n){return n.name===t}:function(n){return t.test(n.name)},u=[],i=r.length-1;0<=i;i--)f(r[i])&&u.push(r[i]);return u},yc:function(n){return"string"==typeof n&&(n=s.a.ib(n))?u&&u.parse?u.parse(n):new Function("return "+n)():null},jb:function(n,t,i){if(!u||!u.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return u.stringify(s.a.c(n),t,i)},zc:function(n,t,i){var c,e,h,f,u,l;i=i||{};var a=i.params||{},v=i.includeFields||this.Bb,c=n;if("object"==typeof n&&"form"===s.a.v(n))for(c=n.action,e=v.length-1;0<=e;e--)for(h=s.a.Db(n,v[e]),f=h.length-1;0<=f;f--)a[h[f].name]=h[f].value;t=s.a.c(t);u=r.createElement("form");u.style.display="none";u.action=c;u.method="post";for(l in t)n=r.createElement("input"),n.type="hidden",n.name=l,n.value=s.a.jb(s.a.c(t[l])),u.appendChild(n);o(a,function(n,t){var i=r.createElement("input");i.type="hidden";i.name=n;i.value=t;u.appendChild(i)});r.body.appendChild(u);i.submitter?i.submitter(u):u.submit();setTimeout(function(){u.parentNode.removeChild(u)},0)}}}();s.b("utils",s.a);s.b("utils.arrayForEach",s.a.o);s.b("utils.arrayFirst",s.a.vb);s.b("utils.arrayFilter",s.a.xa);s.b("utils.arrayGetDistinctValues",s.a.wb);s.b("utils.arrayIndexOf",s.a.m);s.b("utils.arrayMap",s.a.Ka);s.b("utils.arrayPushAll",s.a.ia);s.b("utils.arrayRemoveItem",s.a.ya);s.b("utils.extend",s.a.extend);s.b("utils.fieldsIncludedWithJsonPost",s.a.Bb);s.b("utils.getFormFields",s.a.Db);s.b("utils.peekObservable",s.a.cb);s.b("utils.postJson",s.a.zc);s.b("utils.parseJson",s.a.yc);s.b("utils.registerEventHandler",s.a.n);s.b("utils.stringifyJson",s.a.jb);s.b("utils.range",s.a.Bc);s.b("utils.toggleDomNodeCssClass",s.a.Ia);s.b("utils.triggerEvent",s.a.qa);s.b("utils.unwrapObservable",s.a.c);s.b("utils.objectForEach",s.a.A);s.b("utils.addOrRemoveItem",s.a.ga);s.b("utils.setTextContent",s.a.Ha);s.b("unwrap",s.a.c);Function.prototype.bind||(Function.prototype.bind=function(n){var t=this,i;return 1===arguments.length?function(){return t.apply(n,arguments)}:(i=Array.prototype.slice.call(arguments,1),function(){var r=i.slice(0);return r.push.apply(r,arguments),t.apply(n,r)})});s.a.f=new function(){function r(r,f){var e=r[t];if(!e||"null"===e||!i[e]){if(!f)return n;e=r[t]="ko"+u++;i[e]={}}return i[e]}var u=0,t="__ko__"+(new Date).getTime(),i={};return{get:function(t,i){var u=r(t,!1);return u===n?n:u[i]},set:function(t,i,u){(u!==n||r(t,!1)!==n)&&(r(t,!0)[i]=u)},clear:function(n){var r=n[t];return r?(delete i[r],n[t]=null,!0):!1},I:function(){return u+++t}}};s.b("utils.domData",s.a.f);s.b("utils.domData.clear",s.a.f.clear);s.a.C=new function(){function i(t,i){var r=s.a.f.get(t,u);return r===n&&i&&(r=[],s.a.f.set(t,u,r)),r}function r(n){var t=i(n,!1),u;if(t)for(t=t.slice(0),u=0;u<t.length;u++)t[u](n);if(s.a.f.clear(n),s.a.C.cleanExternalData(n),f[n.nodeType])for(t=n.firstChild;n=t;)t=n.nextSibling,8===n.nodeType&&r(n)}var u=s.a.f.I(),e={1:!0,8:!0,9:!0},f={1:!0,9:!0};return{fa:function(n,t){if("function"!=typeof t)throw Error("Callback must be a function");i(n,!0).push(t)},Pb:function(t,r){var f=i(t,!1);f&&(s.a.ya(f,r),0==f.length&&s.a.f.set(t,u,n))},S:function(n){var t,i,u;if(e[n.nodeType]&&(r(n),f[n.nodeType]))for(t=[],s.a.ia(t,n.getElementsByTagName("*")),i=0,u=t.length;i<u;i++)r(t[i]);return n},removeNode:function(n){s.S(n);n.parentNode&&n.parentNode.removeChild(n)},cleanExternalData:function(n){t&&"function"==typeof t.cleanData&&t.cleanData([n])}}};s.S=s.a.C.S;s.removeNode=s.a.C.removeNode;s.b("cleanNode",s.S);s.b("removeNode",s.removeNode);s.b("utils.domNodeDisposal",s.a.C);s.b("utils.domNodeDisposal.addDisposeCallback",s.a.C.fa);s.b("utils.domNodeDisposal.removeDisposeCallback",s.a.C.Pb),function(){s.a.ca=function(n,u){var e,f;if(t){if(t.parseHTML)e=t.parseHTML(n,u)||[];else if((e=t.clean([n],u))&&e[0]){for(f=e[0];f.parentNode&&11!==f.parentNode.nodeType;)f=f.parentNode;f.parentNode&&f.parentNode.removeChild(f)}}else{(f=u)||(f=r);e=f.parentWindow||f.defaultView||i;var o=s.a.ib(n).toLowerCase(),f=f.createElement("div"),o=o.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","<\/table>"]||!o.indexOf("<tr")&&[2,"<table><tbody>","<\/tbody><\/table>"]||(!o.indexOf("<td")||!o.indexOf("<th"))&&[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"]||[0,"",""],h="ignored<div>"+o[1]+n+o[2]+"<\/div>";for("function"==typeof e.innerShiv?f.appendChild(e.innerShiv(h)):f.innerHTML=h;o[0]--;)f=f.lastChild;e=s.a.O(f.lastChild.childNodes)}return e};s.a.gb=function(i,r){if(s.a.Ra(i),r=s.a.c(r),null!==r&&r!==n)if("string"!=typeof r&&(r=r.toString()),t)t(i).html(r);else for(var f=s.a.ca(r,i.ownerDocument),u=0;u<f.length;u++)i.appendChild(f[u])}}();s.b("utils.parseHtmlFragment",s.a.ca);s.b("utils.setHtml",s.a.gb);s.H=function(){function i(n,t){var r;if(n)if(8==n.nodeType)r=s.H.Lb(n.nodeValue),null!=r&&t.push({ic:n,wc:r});else if(1==n.nodeType)for(var r=0,u=n.childNodes,f=u.length;r<f;r++)i(u[r],t)}var t={};return{$a:function(n){if("function"!=typeof n)throw Error("You can only pass a function to ko.memoization.memoize()");var i=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return t[i]=n,"<!--[ko_memo:"+i+"]-->"},Wb:function(i,r){var u=t[i];if(u===n)throw Error("Couldn't find any memo with ID "+i+". Perhaps it's already been unmemoized.");try{return u.apply(null,r||[]),!0}finally{delete t[i]}},Xb:function(n,t){var f=[],u,o,r,e;for(i(n,f),u=0,o=f.length;u<o;u++)r=f[u].ic,e=[r],t&&s.a.ia(e,t),s.H.Wb(f[u].wc,e),r.nodeValue="",r.parentNode&&r.parentNode.removeChild(r)},Lb:function(n){return(n=n.match(/^\[ko_memo\:(.*?)\]$/))?n[1]:null}}}();s.b("memoization",s.H);s.b("memoization.memoize",s.H.$a);s.b("memoization.unmemoize",s.H.Wb);s.b("memoization.parseMemoText",s.H.Lb);s.b("memoization.unmemoizeDomNodeAndDescendants",s.H.Xb);s.Sa={throttle:function(n,t){n.throttleEvaluation=t;var i=null;return s.j({read:n,write:function(r){clearTimeout(i);i=setTimeout(function(){n(r)},t)}})},rateLimit:function(n,t){var i,r,u;"number"==typeof t?i=t:(i=t.timeout,r=t.method);u="notifyWhenChangesStop"==r?b:w;n.Za(function(n){return u(n,i)})},notify:function(n,t){n.equalityComparer="always"==t?null:a}};p={undefined:1,boolean:1,number:1,string:1};s.b("extenders",s.Sa);s.Ub=function(n,t,i){this.da=n;this.La=t;this.hc=i;this.Gb=!1;s.D(this,"dispose",this.p)};s.Ub.prototype.p=function(){this.Gb=!0;this.hc()};s.Q=function(){s.a.Ga(this,s.Q.fn);this.G={};this.rb=1};h={U:function(n,t,i){var r=this,u;return i=i||"change",u=new s.Ub(r,t?n.bind(t):n,function(){s.a.ya(r.G[i],u);r.ua&&r.ua(i)}),r.ja&&r.ja(i),r.G[i]||(r.G[i]=[]),r.G[i].push(u),u},notifySubscribers:function(n,t){if(t=t||"change","change"===t&&this.Yb(),this.Ba(t))try{s.k.xb();for(var u=this.G[t].slice(0),r=0,i;i=u[r];++r)i.Gb||i.La(n)}finally{s.k.end()}},Aa:function(){return this.rb},pc:function(n){return this.Aa()!==n},Yb:function(){++this.rb},Za:function(n){var t=this,e=s.F(t),r,u,i,f;t.ta||(t.ta=t.notifySubscribers,t.notifySubscribers=function(n,i){i&&"change"!==i?"beforeChange"===i?t.pb(n):t.ta(n,i):t.qb(n)});f=n(function(){e&&i===t&&(i=t());r=!1;t.Wa(u,i)&&t.ta(u=i)});t.qb=function(n){r=!0;i=n;f()};t.pb=function(n){r||(u=n,t.ta(n,"beforeChange"))}},Ba:function(n){return this.G[n]&&this.G[n].length},nc:function(n){if(n)return this.G[n]&&this.G[n].length||0;var t=0;return s.a.A(this.G,function(n,i){t+=i.length}),t},Wa:function(n,t){return!this.equalityComparer||!this.equalityComparer(n,t)},extend:function(n){var t=this;return n&&s.a.A(n,function(n,i){var r=s.Sa[n];"function"==typeof r&&(t=r(t,i)||t)}),t}};s.D(h,"subscribe",h.U);s.D(h,"extend",h.extend);s.D(h,"getSubscriptionsCount",h.nc);s.a.za&&s.a.Fa(h,Function.prototype);s.Q.fn=h;s.Hb=function(n){return null!=n&&"function"==typeof n.U&&"function"==typeof n.notifySubscribers};s.b("subscribable",s.Q);s.b("isSubscribable",s.Hb);s.Z=s.k=function(){function t(t){r.push(n);n=t}function i(){n=r.pop()}var r=[],n,u=0;return{xb:t,end:i,Ob:function(t){if(n){if(!s.Hb(t))throw Error("Only subscribable things can act as dependencies");n.La(t,t.ac||(t.ac=++u))}},u:function(n,r,u){try{return t(),n.apply(r,u||[])}finally{i()}},oa:function(){if(n)return n.w.oa()},Ca:function(){if(n)return n.Ca}}}();s.b("computedContext",s.Z);s.b("computedContext.getDependenciesCount",s.Z.oa);s.b("computedContext.isInitial",s.Z.Ca);s.b("computedContext.isSleeping",s.Z.Jc);s.b("ignoreDependencies",s.Gc=s.k.u);s.r=function(n){function t(){return 0<arguments.length?(t.Wa(i,arguments[0])&&(t.X(),i=arguments[0],t.W()),this):(s.k.Ob(t),i)}var i=n;return s.Q.call(t),s.a.Ga(t,s.r.fn),t.B=function(){return i},t.W=function(){t.notifySubscribers(i)},t.X=function(){t.notifySubscribers(i,"beforeChange")},s.D(t,"peek",t.B),s.D(t,"valueHasMutated",t.W),s.D(t,"valueWillMutate",t.X),t};s.r.fn={equalityComparer:a};c=s.r.Ac="__ko_proto__";s.r.fn[c]=s.r;s.a.za&&s.a.Fa(s.r.fn,s.Q.fn);s.Ta=function(t,i){return null===t||t===n||t[c]===n?!1:t[c]===i?!0:s.Ta(t[c],i)};s.F=function(n){return s.Ta(n,s.r)};s.Da=function(n){return"function"==typeof n&&n[c]===s.r||"function"==typeof n&&n[c]===s.j&&n.qc?!0:!1};s.b("observable",s.r);s.b("isObservable",s.F);s.b("isWriteableObservable",s.Da);s.b("isWritableObservable",s.Da);s.ba=function(n){if(n=n||[],"object"!=typeof n||!("length"in n))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return n=s.r(n),s.a.Ga(n,s.ba.fn),n.extend({trackArrayChanges:!0})};s.ba.fn={remove:function(n){for(var u,r=this.B(),i=[],f="function"!=typeof n||s.F(n)?function(t){return t===n}:n,t=0;t<r.length;t++)u=r[t],f(u)&&(0===i.length&&this.X(),i.push(u),r.splice(t,1),t--);return i.length&&this.W(),i},removeAll:function(t){if(t===n){var i=this.B(),r=i.slice(0);return this.X(),i.splice(0,i.length),this.W(),r}return t?this.remove(function(n){return 0<=s.a.m(t,n)}):[]},destroy:function(n){var i=this.B(),r="function"!=typeof n||s.F(n)?function(t){return t===n}:n,t;for(this.X(),t=i.length-1;0<=t;t--)r(i[t])&&(i[t]._destroy=!0);this.W()},destroyAll:function(t){return t===n?this.destroy(function(){return!0}):t?this.destroy(function(n){return 0<=s.a.m(t,n)}):[]},indexOf:function(n){var t=this();return s.a.m(t,n)},replace:function(n,t){var i=this.indexOf(n);0<=i&&(this.X(),this.B()[i]=t,this.W())}};s.a.o("pop push reverse shift sort splice unshift".split(" "),function(n){s.ba.fn[n]=function(){var t=this.B();return this.X(),this.yb(t,n,arguments),t=t[n].apply(t,arguments),this.W(),t}});s.a.o(["slice"],function(n){s.ba.fn[n]=function(){var t=this();return t[n].apply(t,arguments)}});s.a.za&&s.a.Fa(s.ba.fn,s.r.fn);s.b("observableArray",s.ba);s.Sa.trackArrayChanges=function(n){function o(){var e,f;i||(i=!0,e=n.notifySubscribers,n.notifySubscribers=function(n,t){return t&&"change"!==t||++r,e.apply(this,arguments)},f=[].concat(n.B()||[]),t=null,u=n.U(function(i){if(i=[].concat(i||[]),n.Ba("arrayChange")){var u;(!t||1<r)&&(t=s.a.Ma(f,i,{sparse:!0}));u=t}f=i;t=null;r=0;u&&u.length&&n.notifySubscribers(u,"arrayChange")}))}if(!n.yb){var i=!1,t=null,u,r=0,f=n.ja,e=n.ua;n.ja=function(t){f&&f.call(n,t);"arrayChange"===t&&o()};n.ua=function(t){e&&e.call(n,t);"arrayChange"!==t||n.Ba("arrayChange")||(u.p(),i=!1)};n.yb=function(n,u,f){function c(n,t,i){return l[l.length]={status:n,value:t,index:i}}if(i&&!r){var l=[],e=n.length,h=f.length,o=0;switch(u){case"push":o=e;case"unshift":for(u=0;u<h;u++)c("added",f[u],o+u);break;case"pop":o=e-1;case"shift":e&&c("deleted",n[o],o);break;case"splice":u=Math.min(Math.max(0,0>f[0]?e+f[0]:f[0]),e);for(var e=1===h?e:Math.min(u+(f[1]||0),e),h=u+h-2,o=Math.max(e,h),a=[],v=[],y=2;u<o;++u,++y)u<e&&v.push(c("deleted",n[u],u)),u<h&&a.push(c("added",f[y],u));s.a.Cb(v,a);break;default:return}t=l}}}};s.w=s.j=function(t,i,r){function rt(n,t,i){if(g&&t===u)throw Error("A 'pure' computed must not be called recursively");f[n]=i;i.sa=o++;i.ea=t.Aa()}function b(){var n,t;for(n in f)if(f.hasOwnProperty(n)&&(t=f[n],t.da.pc(t.ea)))return!0}function ut(){!e&&f&&s.a.A(f,function(n,t){t.p&&t.p()});f=null;o=0;y=!0;e=c=!1}function ft(){var n=u.throttleEvaluation;n&&0<=n?(clearTimeout(st),st=setTimeout(function(){a(!0)},n)):u.nb?u.nb():a(!0)}function a(t){var v;if(!k&&!y){if(it&&it()){if(!d){p();return}}else d=!1;k=!0;try{var r=f,a=o,b=g?n:!o;s.k.xb({La:function(n,t){y||(a&&r[t]?(rt(t,n,r[t]),delete r[t],--a):f[t]||rt(t,n,e?{da:n}:n.U(ft)))},w:u,Ca:b});f={};o=0;try{v=i?l.call(i):l()}finally{s.k.end();a&&!e&&s.a.A(r,function(n,t){t.p&&t.p()});c=!1}u.Wa(h,v)&&(e||w(h,"beforeChange"),h=v,e?u.Yb():t&&w(h));b&&w(h,"awake")}finally{k=!1}o||p()}}function u(){if(0<arguments.length){if("function"==typeof nt)nt.apply(i,arguments);else throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return this}return s.k.Ob(u),(c||e&&b())&&a(),h}function et(){return(c&&!o||e&&b())&&a(),h}function ot(){return c||0<o}function w(n,t){u.notifySubscribers(n,t)}var h,c=!0,k=!1,d=!1,y=!1,l=t,g=!1,e=!1,ht;if(l&&"object"==typeof l?(r=l,l=r.read):(r=r||{},l||(l=r.read)),"function"!=typeof l)throw Error("Pass a function that returns the value of the ko.computed");var nt=r.write,v=r.disposeWhenNodeIsRemoved||r.q||null,tt=r.disposeWhen||r.Pa,it=tt,p=ut,f={},o=0,st=null;return i||(i=r.owner),s.Q.call(u),s.a.Ga(u,s.j.fn),u.B=et,u.oa=function(){return o},u.qc="function"==typeof nt,u.p=function(){p()},u.$=ot,ht=u.Za,u.Za=function(n){ht.call(u,n);u.nb=function(){u.pb(h);c=!0;u.qb(u)}},r.pure?(e=g=!0,u.ja=function(n){if(!y&&e&&"change"==n){if(e=!1,c||b())f=null,o=0,c=!0,a();else{var t=[];s.a.A(f,function(n,i){t[i.sa]=n});s.a.o(t,function(n,t){var r=f[n],i=r.da.U(ft);i.sa=t;i.ea=r.ea;f[n]=i})}y||w(h,"awake")}},u.ua=function(t){y||"change"!=t||u.Ba("change")||(s.a.A(f,function(n,t){t.p&&(f[n]={da:t.da,sa:t.sa,ea:t.ea},t.p())}),e=!0,w(n,"asleep"))},u.bc=u.Aa,u.Aa=function(){return e&&(c||b())&&a(),u.bc()}):r.deferEvaluation&&(u.ja=function(n){"change"!=n&&"beforeChange"!=n||et()}),s.D(u,"peek",u.B),s.D(u,"dispose",u.p),s.D(u,"isActive",u.$),s.D(u,"getDependenciesCount",u.oa),v&&(d=!0,v.nodeType&&(it=function(){return!s.a.Qa(v)||tt&&tt()})),e||r.deferEvaluation||a(),v&&ot()&&v.nodeType&&(p=function(){s.a.C.Pb(v,p);ut()},s.a.C.fa(v,p)),u};s.sc=function(n){return s.Ta(n,s.j)};h=s.r.Ac;s.j[h]=s.r;s.j.fn={equalityComparer:a};s.j.fn[h]=s.j;s.a.za&&s.a.Fa(s.j.fn,s.Q.fn);s.b("dependentObservable",s.j);s.b("computed",s.j);s.b("isComputed",s.sc);s.Nb=function(n,t){return"function"==typeof n?s.w(n,t,{pure:!0}):(n=s.a.extend({},n),n.pure=!0,s.w(n,t))};s.b("pureComputed",s.Nb),function(){function t(u,f,e){if(e=e||new i,u=f(u),"object"!=typeof u||null===u||u===n||u instanceof Date||u instanceof String||u instanceof Number||u instanceof Boolean)return u;var o=u instanceof Array?[]:{};return e.save(u,o),r(u,function(i){var r=f(u[i]),s;switch(typeof r){case"boolean":case"number":case"string":case"function":o[i]=r;break;case"object":case"undefined":s=e.get(r);o[i]=s!==n?s:t(r,f,e)}}),o}function r(n,t){if(n instanceof Array){for(var i=0;i<n.length;i++)t(i);"function"==typeof n.toJSON&&t("toJSON")}else for(i in n)t(i)}function i(){this.keys=[];this.mb=[]}s.Vb=function(n){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return t(n,function(n){for(var t=0;s.F(n)&&10>t;t++)n=n();return n})};s.toJSON=function(n,t,i){return n=s.Vb(n),s.a.jb(n,t,i)};i.prototype={save:function(n,t){var i=s.a.m(this.keys,n);0<=i?this.mb[i]=t:(this.keys.push(n),this.mb.push(t))},get:function(t){return t=s.a.m(this.keys,t),0<=t?this.mb[t]:n}}}();s.b("toJS",s.Vb);s.b("toJSON",s.toJSON),function(){s.i={s:function(t){switch(s.a.v(t)){case"option":return!0===t.__ko__hasDomDataOptionValue__?s.a.f.get(t,s.d.options.ab):7>=s.a.M?t.getAttributeNode("value")&&t.getAttributeNode("value").specified?t.value:t.text:t.value;case"select":return 0<=t.selectedIndex?s.i.s(t.options[t.selectedIndex]):n;default:return t.value}},Y:function(t,i,r){switch(s.a.v(t)){case"option":switch(typeof i){case"string":s.a.f.set(t,s.d.options.ab,n);"__ko__hasDomDataOptionValue__"in t&&delete t.__ko__hasDomDataOptionValue__;t.value=i;break;default:s.a.f.set(t,s.d.options.ab,i);t.__ko__hasDomDataOptionValue__=!0;t.value="number"==typeof i?i:""}break;case"select":(""===i||null===i)&&(i=n);for(var f=-1,u=0,o=t.options.length,e;u<o;++u)if(e=s.i.s(t.options[u]),e==i||""==e&&i===n){f=u;break}(r||0<=f||i===n&&1<t.size)&&(t.selectedIndex=f);break;default:(null===i||i===n)&&(i="");t.value=i}}}}();s.b("selectExtensions",s.i);s.b("selectExtensions.readValue",s.i.s);s.b("selectExtensions.writeValue",s.i.Y);s.h=function(){function n(n){var c,u,i;n=s.a.ib(n);123===n.charCodeAt(0)&&(n=n.slice(1,-1));var a=[],h=n.match(t),o,r=[],l=0;if(h)for(h.push(","),c=0;u=h[c];++c){if(i=u.charCodeAt(0),44===i){if(0>=l){a.push(o&&r.length?{key:o,value:r.join("")}:{unknown:o||r.join("")});o=l=0;r=[];continue}}else if(58===i){if(!l&&!o&&1===r.length){o=r.pop();continue}}else 47===i&&c&&1<u.length?(i=h[c-1].match(f))&&!e[i[0]]&&(n=n.substr(n.indexOf(u)+1),h=n.match(t),h.push(","),c=-1,u="/"):40===i||123===i||91===i?++l:41===i||125===i||93===i?--l:o||r.length||34!==i&&39!==i||(u=u.slice(1,-1));r.push(u)}return a}var r=["true","false","null","undefined"],u=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,t=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),f=/[\])"'A-Za-z0-9_$]+$/,e={"in":1,"return":1,"typeof":1},i={};return{ka:[],V:i,bb:n,Ea:function(t,f){function e(n,t){var a,f;if(!l){if(f=s.getBindingHandler(n),f&&f.preprocess&&!(t=f.preprocess(t,n,e)))return;(f=i[n])&&(a=t,0<=s.a.m(r,a)?a=!1:(f=a.match(u),a=null===f?!1:f[1]?"Object("+f[1]+")"+f[2]:a),f=a);f&&o.push("'"+n+"':function(_z){"+a+"=_z}")}c&&(t="function(){return "+t+" }");h.push("'"+n+"':"+t)}f=f||{};var h=[],o=[],c=f.valueAccessors,l=f.bindingParams,a="string"==typeof t?n(t):t;return s.a.o(a,function(n){e(n.key||n.unknown,n.value)}),o.length&&e("_ko_property_writers","{"+o.join(",")+" }"),h.join(",")},vc:function(n,t){for(var i=0;i<n.length;i++)if(n[i].key==t)return!0;return!1},ra:function(n,t,i,r,u){n&&s.F(n)?!s.Da(n)||u&&n.B()===r||n(r):(n=t.get("_ko_property_writers"))&&n[i]&&n[i](r)}}}();s.b("expressionRewriting",s.h);s.b("expressionRewriting.bindingRewriteValidators",s.h.ka);s.b("expressionRewriting.parseObjectLiteral",s.h.bb);s.b("expressionRewriting.preProcessBindings",s.h.Ea);s.b("expressionRewriting._twoWayBindings",s.h.V);s.b("jsonExpressionRewriting",s.h);s.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",s.h.Ea),function(){function n(n){return 8==n.nodeType&&e.test(t?n.text:n.nodeValue)}function i(n){return 8==n.nodeType&&o.test(t?n.text:n.nodeValue)}function u(t,r){for(var u=t,f=1,e=[];u=u.nextSibling;){if(i(u)&&(f--,0===f))return e;e.push(u);n(u)&&f++}if(!r)throw Error("Cannot find closing comment tag to match: "+t.nodeValue);return null}function f(n,t){var i=u(n,t);return i?0<i.length?i[i.length-1].nextSibling:n.nextSibling:null}var t=r&&"<!--test-->"===r.createComment("test").text,e=t?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,o=t?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,h={ul:!0,ol:!0};s.e={R:{},childNodes:function(t){return n(t)?u(t):t.childNodes},ma:function(t){if(n(t)){t=s.e.childNodes(t);for(var i=0,r=t.length;i<r;i++)s.removeNode(t[i])}else s.a.Ra(t)},T:function(t,i){if(n(t)){s.e.ma(t);for(var u=t.nextSibling,r=0,f=i.length;r<f;r++)u.parentNode.insertBefore(i[r],u)}else s.a.T(t,i)},Mb:function(t,i){n(t)?t.parentNode.insertBefore(i,t.nextSibling):t.firstChild?t.insertBefore(i,t.firstChild):t.appendChild(i)},Fb:function(t,i,r){r?n(t)?t.parentNode.insertBefore(i,r.nextSibling):r.nextSibling?t.insertBefore(i,r.nextSibling):t.appendChild(i):s.e.Mb(t,i)},firstChild:function(t){return n(t)?!t.nextSibling||i(t.nextSibling)?null:t.nextSibling:t.firstChild},nextSibling:function(t){return n(t)&&(t=f(t)),t.nextSibling&&i(t.nextSibling)?null:t.nextSibling},oc:n,Fc:function(n){return(n=(t?n.text:n.nodeValue).match(e))?n[1]:null},Kb:function(t){var o,r,u,e;if(h[s.a.v(t)]&&(o=t.firstChild,o))do if(1===o.nodeType){if(r=o.firstChild,u=null,r)do u?u.push(r):n(r)?(e=f(r,!0),e?r=e:u=[r]):i(r)&&(u=[r]);while(r=r.nextSibling);if(r=u)for(u=o.nextSibling,e=0;e<r.length;e++)u?t.insertBefore(r[e],u):t.appendChild(r[e])}while(o=o.nextSibling)}}}();s.b("virtualElements",s.e);s.b("virtualElements.allowedBindings",s.e.R);s.b("virtualElements.emptyNode",s.e.ma);s.b("virtualElements.insertAfter",s.e.Fb);s.b("virtualElements.prepend",s.e.Mb);s.b("virtualElements.setDomNodeChildren",s.e.T),function(){s.L=function(){this.ec={}};s.a.extend(s.L.prototype,{nodeHasBindings:function(n){switch(n.nodeType){case 1:return null!=n.getAttribute("data-bind")||s.g.getComponentNameForNode(n);case 8:return s.e.oc(n);default:return!1}},getBindings:function(n,t){var i=this.getBindingsString(n,t),i=i?this.parseBindingsString(i,t,n):null;return s.g.sb(i,n,t,!1)},getBindingAccessors:function(n,t){var i=this.getBindingsString(n,t),i=i?this.parseBindingsString(i,t,n,{valueAccessors:!0}):null;return s.g.sb(i,n,t,!0)},getBindingsString:function(n){switch(n.nodeType){case 1:return n.getAttribute("data-bind");case 8:return s.e.Fc(n);default:return null}},parseBindingsString:function(n,t,i,r){var u,f,e,h,c;try{return u=this.ec,f=n+(r&&r.valueAccessors||""),(e=u[f])||(c="with($context){with($data||{}){return{"+s.h.Ea(n,r)+"}}}",h=new Function("$context","$element",c),e=u[f]=h),e(t,i)}catch(o){throw o.message="Unable to parse bindings.\nBindings value: "+n+"\nMessage: "+o.message,o;}}});s.L.instance=new s.L}();s.b("bindingProvider",s.L),function(){function v(n){return function(){return n}}function u(n){return n()}function o(n){return s.a.pa(s.k.u(n),function(t,i){return function(){return n()[i]}})}function y(n,t,i){return"function"==typeof n?o(n.bind(null,t,i)):s.a.pa(n,v)}function p(n,t){return o(this.getBindings.bind(this,n,t))}function h(n,t,i){var r,u=s.e.firstChild(t),f=s.L.instance,e=f.preprocessNode;if(e){for(;r=u;)u=s.e.nextSibling(r),e.call(f,r);u=s.e.firstChild(t)}for(;r=u;)u=s.e.nextSibling(r),c(n,r,i)}function c(n,t,i){var u=!0,r=1===t.nodeType;r&&s.e.Kb(t);(r&&i||s.L.instance.nodeHasBindings(t))&&(u=l(t,null,n,i).shouldBindDescendants);u&&!a[s.a.v(t)]&&h(n,t,!r)}function w(n){var i=[],r={},t=[];return s.a.A(n,function u(f){if(!r[f]){var e=s.getBindingHandler(f);e&&(e.after&&(t.push(f),s.a.o(e.after,function(i){if(n[i]){if(-1!==s.a.m(t,i))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+t.join(", "));u(i)}}),t.length--),i.push({key:f,Eb:e}));r[f]=!0}}),i}function l(t,i,r,e){var v=s.a.f.get(t,f),o,l,a,c;if(!i){if(v)throw Error("You cannot apply bindings multiple times to the same element.");s.a.f.set(t,f,!0)}if(!v&&e&&s.Tb(t,r),i&&"function"!=typeof i)o=i;else{var y=s.L.instance,b=y.getBindingAccessors||p,h=s.j(function(){return(o=i?i(r,t):b.call(y,t,r))&&r.K&&r.K(),o},null,{q:t});o&&h.$()||(h=null)}return o&&(a=h?function(n){return function(){return u(h()[n])}}:function(n){return o[n]},c=function(){return s.a.pa(h?h():o,u)},c.get=function(n){return o[n]&&u(a(n))},c.has=function(n){return n in o},e=w(o),s.a.o(e,function(i){var e=i.Eb.init,h=i.Eb.update,u=i.key;if(8===t.nodeType&&!s.e.R[u])throw Error("The binding '"+u+"' cannot be used with virtual elements");try{"function"==typeof e&&s.k.u(function(){var i=e(t,a(u),c,r.$data,r);if(i&&i.controlsDescendantBindings){if(l!==n)throw Error("Multiple bindings ("+l+" and "+u+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");l=u}});"function"==typeof h&&s.j(function(){h(t,a(u),c,r.$data,r)},null,{q:t})}catch(f){throw f.message='Unable to process binding "'+u+": "+o[u]+'"\nMessage: '+f.message,f;}})),{shouldBindDescendants:l===n}}function r(n){return n&&n instanceof s.N?n:new s.N(n)}var a,f,e;s.d={};a={script:!0,textarea:!0};s.getBindingHandler=function(n){return s.d[n]};s.N=function(t,i,r,u){var f=this,h="function"==typeof t&&!s.F(t),o,e=s.j(function(){var o=h?t():t,n=s.a.c(o);return i?(i.K&&i.K(),s.a.extend(f,i),e&&(f.K=e)):(f.$parents=[],f.$root=n,f.ko=s),f.$rawData=o,f.$data=n,r&&(f[r]=n),u&&u(f,i,n),f.$data},null,{Pa:function(){return o&&!s.a.tb(o)},q:!0});e.$()&&(f.K=e,e.equalityComparer=null,o=[],e.Zb=function(t){o.push(t);s.a.C.fa(t,function(t){s.a.ya(o,t);o.length||(e.p(),f.K=e=n)})})};s.N.prototype.createChildContext=function(n,t,i){return new s.N(n,this,t,function(n,t){n.$parentContext=t;n.$parent=t.$data;n.$parents=(t.$parents||[]).slice(0);n.$parents.unshift(n.$parent);i&&i(n)})};s.N.prototype.extend=function(n){return new s.N(this.K||this.$data,this,null,function(t,i){t.$rawData=i.$rawData;s.a.extend(t,"function"==typeof n?n():n)})};f=s.a.f.I();e=s.a.f.I();s.Tb=function(n,t){if(2==arguments.length)s.a.f.set(n,e,t),t.K&&t.K.Zb(n);else return s.a.f.get(n,e)};s.va=function(n,t,i){return 1===n.nodeType&&s.e.Kb(n),l(n,t,r(i),!0)};s.cc=function(n,t,i){return i=r(i),s.va(n,y(t,i,n),i)};s.Ja=function(n,t){1!==t.nodeType&&8!==t.nodeType||h(r(n),t,!0)};s.ub=function(n,u){if(!t&&i.jQuery&&(t=i.jQuery),u&&1!==u.nodeType&&8!==u.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");u=u||i.document.body;c(r(n),u,!0)};s.Oa=function(t){switch(t.nodeType){case 1:case 8:var i=s.Tb(t);if(i)return i;if(t.parentNode)return s.Oa(t.parentNode)}return n};s.gc=function(t){return(t=s.Oa(t))?t.$data:n};s.b("bindingHandlers",s.d);s.b("applyBindings",s.ub);s.b("applyBindingsToDescendants",s.Ja);s.b("applyBindingAccessorsToNode",s.va);s.b("applyBindingsToNode",s.cc);s.b("contextFor",s.Oa);s.b("dataFor",s.gc)}(),function(n){function u(t,u){var e=i.hasOwnProperty(t)?i[t]:n,o;e?e.U(u):(e=i[t]=new s.Q,e.U(u),f(t,function(n,u){var f=!(!u||!u.synchronous);r[t]={definition:n,tc:f};delete i[t];o||f?e.notifySubscribers(n):setTimeout(function(){e.notifySubscribers(n)},0)}),o=!0)}function f(n,i){t("getConfig",[n],function(r){r?t("loadComponent",[n,r],function(n){i(n,r)}):i(null,null)})}function t(i,r,u,f){var e,o,h;if(f||(f=s.g.loaders.slice(0)),e=f.shift(),e)if(o=e[i],o){if(h=!1,o.apply(e,r.concat(function(n){h?u(null):null!==n?u(n):t(i,r,u,f)}))!==n&&(h=!0,!e.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.");}else t(i,r,u,f);else u(null)}var i={},r={};s.g={get:function(t,i){var f=r.hasOwnProperty(t)?r[t]:n;f?f.tc?s.k.u(function(){i(f.definition)}):setTimeout(function(){i(f.definition)},0):u(t,i)},zb:function(n){delete r[n]},ob:t};s.g.loaders=[];s.b("components",s.g);s.b("components.get",s.g.get);s.b("components.clearCachedDefinition",s.g.zb)}(),function(){function l(n,i,r,f){function e(){0==--c&&f(o)}var o={},c=2,h=r.template;r=r.viewModel;h?u(i,h,function(t){s.g.ob("loadTemplate",[n,t],function(n){o.template=n;e()})}):e();r?u(i,r,function(i){s.g.ob("loadViewModel",[n,i],function(n){o[t]=n;e()})}):e()}function e(n,i,r){if("function"==typeof i)r(function(n){return new i(n)});else if("function"==typeof i[t])r(i[t]);else if("instance"in i){var u=i.instance;r(function(){return u})}else"viewModel"in i?e(n,i.viewModel,r):n("Unknown viewModel value: "+i)}function h(n){switch(s.a.v(n)){case"script":return s.a.ca(n.text);case"textarea":return s.a.ca(n.value);case"template":if(c(n.content))return s.a.la(n.content.childNodes)}return s.a.la(n.childNodes)}function c(n){return i.DocumentFragment?n instanceof DocumentFragment:n&&11===n.nodeType}function u(n,t,r){"string"==typeof t.require?o||i.require?(o||i.require)([t.require],r):n("Uses require, but no AMD loader is present"):r(t)}function f(n){return function(t){throw Error("Component '"+n+"': "+t);}}var n={},t;s.g.register=function(t,i){if(!i)throw Error("Invalid configuration for "+t);if(s.g.Xa(t))throw Error("Component "+t+" is already registered");n[t]=i};s.g.Xa=function(t){return t in n};s.g.Ec=function(t){delete n[t];s.g.zb(t)};s.g.Ab={getConfig:function(t,i){i(n.hasOwnProperty(t)?n[t]:null)},loadComponent:function(n,t,i){var r=f(n);u(r,t,function(t){l(n,r,t,i)})},loadTemplate:function(n,t,u){if(n=f(n),"string"==typeof t)u(s.a.ca(t));else if(t instanceof Array)u(t);else if(c(t))u(s.a.O(t.childNodes));else if(t.element)if(t=t.element,i.HTMLElement?t instanceof HTMLElement:t&&t.tagName&&1===t.nodeType)u(h(t));else if("string"==typeof t){var e=r.getElementById(t);e?u(h(e)):n("Cannot find element with ID "+t)}else n("Unknown element type: "+t);else n("Unknown template value: "+t)},loadViewModel:function(n,t,i){e(f(n),t,i)}};t="createViewModel";s.b("components.register",s.g.register);s.b("components.isRegistered",s.g.Xa);s.b("components.unregister",s.g.Ec);s.b("components.defaultLoader",s.g.Ab);s.g.loaders.push(s.g.Ab);s.g.$b=n}(),function(){function n(n,i){var r=n.getAttribute("params");if(r){var r=t.parseBindingsString(r,i,n,{valueAccessors:!0,bindingParams:!0}),r=s.a.pa(r,function(t){return s.w(t,null,{q:n})}),u=s.a.pa(r,function(t){var i=t.B();return t.$()?s.w({read:function(){return s.a.c(t())},write:s.Da(i)&&function(n){t()(n)},q:n}):i});return u.hasOwnProperty("$raw")||(u.$raw=r),u}return{$raw:{}}}s.g.getComponentNameForNode=function(n){return n=s.a.v(n),s.g.Xa(n)&&n};s.g.sb=function(t,i,r,u){var f,e;if(1===i.nodeType&&(f=s.g.getComponentNameForNode(i),f)){if(t=t||{},t.component)throw Error('Cannot use the "component" binding on a custom element matching a component');e={name:f,params:n(i,r)};t.component=u?function(){return e}:e}return t};var t=new s.L;9>s.a.M&&(s.g.register=function(n){return function(t){return r.createElement(t),n.apply(this,arguments)}}(s.g.register),r.createDocumentFragment=function(n){return function(){var i=n(),r=s.g.$b,t;for(t in r)r.hasOwnProperty(t)&&i.createElement(t);return i}}(r.createDocumentFragment))}(),function(n){function t(n,t,i){if(t=t.template,!t)throw Error("Component '"+n+"' has no template");n=s.a.la(t);s.e.T(i,n)}function i(n,t,i,r){var u=n.createViewModel;return u?u.call(n,r,{element:t,templateNodes:i}):r}var r=0;s.d.component={init:function(u,f,e,o,h){function a(){var n=c&&c.dispose;"function"==typeof n&&n.call(c);l=null}var c,l,v=s.a.O(s.e.childNodes(u));return s.a.C.fa(u,a),s.w(function(){var o=s.a.c(f()),e,y,p;if("string"==typeof o?e=o:(e=s.a.c(o.name),y=s.a.c(o.params)),!e)throw Error("No component name specified");p=l=++r;s.g.get(e,function(r){if(l===p){if(a(),!r)throw Error("Unknown component '"+e+"'");t(e,r,u);var f=i(r,u,v,y);r=h.createChildContext(f,n,function(n){n.$component=f;n.$componentTemplateNodes=v});c=f;s.Ja(r,u)}})},null,{q:u}),{controlsDescendantBindings:!0}}};s.e.R.component=!0}();y={"class":"className","for":"htmlFor"};s.d.attr={update:function(t,i){var r=s.a.c(i())||{};s.a.A(r,function(i,r){r=s.a.c(r);var u=!1===r||null===r||r===n;u&&t.removeAttribute(i);8>=s.a.M&&i in y?(i=y[i],u?t.removeAttribute(i):t[i]=r):u||t.setAttribute(i,r.toString());"name"===i&&s.a.Rb(t,u?"":r.toString())})}},function(){s.d.checked={after:["value","attr"],init:function(t,i,r){function c(){var c=t.checked,n=a?u():c,o;s.Z.Ca()||f&&!c||(o=s.k.u(i),e?h!==n?(c&&(s.a.ga(o,n,!0),s.a.ga(o,h,!1)),h=n):s.a.ga(o,n,c):s.h.ra(o,r,"checked",n,!0))}function l(){var n=s.a.c(i());t.checked=e?0<=s.a.m(n,u()):o?n:u()===n}var u=s.Nb(function(){return r.has("checkedValue")?s.a.c(r.get("checkedValue")):r.has("value")?s.a.c(r.get("value")):t.value}),o="checkbox"==t.type,f="radio"==t.type;if(o||f){var e=o&&s.a.c(i())instanceof Array,h=e?u():n,a=f||e;f&&!t.name&&s.d.uniqueName.init(t,function(){return!0});s.w(c,null,{q:t});s.a.n(t,"click",c);s.w(l,null,{q:t})}}};s.h.V.checked=!0;s.d.checkedValue={update:function(n,t){n.value=s.a.c(t())}}}();s.d.css={update:function(n,t){var i=s.a.c(t());null!==i&&"object"==typeof i?s.a.A(i,function(t,i){i=s.a.c(i);s.a.Ia(n,t,i)}):(i=String(i||""),s.a.Ia(n,n.__ko__cssValue,!1),n.__ko__cssValue=i,s.a.Ia(n,i,!0))}};s.d.enable={update:function(n,t){var i=s.a.c(t());i&&n.disabled?n.removeAttribute("disabled"):i||n.disabled||(n.disabled=!0)}};s.d.disable={update:function(n,t){s.d.enable.update(n,function(){return!s.a.c(t())})}};s.d.event={init:function(n,t,i,r,u){var f=t()||{};s.a.A(f,function(f){"string"==typeof f&&s.a.n(n,f,function(n){var o,h=t()[f],e;if(h){try{e=s.a.O(arguments);r=u.$data;e.unshift(r);o=h.apply(r,e)}finally{!0!==o&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}!1===i.get(f+"Bubble")&&(n.cancelBubble=!0,n.stopPropagation&&n.stopPropagation())}})})}};s.d.foreach={Ib:function(n){return function(){var i=n(),t=s.a.cb(i);return!t||"number"==typeof t.length?{foreach:i,templateEngine:s.P.Va}:(s.a.c(i),{foreach:t.data,as:t.as,includeDestroyed:t.includeDestroyed,afterAdd:t.afterAdd,beforeRemove:t.beforeRemove,afterRender:t.afterRender,beforeMove:t.beforeMove,afterMove:t.afterMove,templateEngine:s.P.Va})}},init:function(n,t){return s.d.template.init(n,s.d.foreach.Ib(t))},update:function(n,t,i,r,u){return s.d.template.update(n,s.d.foreach.Ib(t),i,r,u)}};s.h.ka.foreach=!1;s.e.R.foreach=!0;s.d.hasfocus={init:function(n,t,i){function r(r){var u,f;if(n.__ko_hasfocusUpdating=!0,u=n.ownerDocument,"activeElement"in u){try{f=u.activeElement}catch(e){f=u.body}r=f===n}u=t();s.h.ra(u,i,"hasfocus",r,!0);n.__ko_hasfocusLastValue=r;n.__ko_hasfocusUpdating=!1}var u=r.bind(null,!0),f=r.bind(null,!1);s.a.n(n,"focus",u);s.a.n(n,"focusin",u);s.a.n(n,"blur",f);s.a.n(n,"focusout",f)},update:function(n,t){var i=!!s.a.c(t());n.__ko_hasfocusUpdating||n.__ko_hasfocusLastValue===i||(i?n.focus():n.blur(),s.k.u(s.a.qa,null,[n,i?"focusin":"focusout"]))}};s.h.V.hasfocus=!0;s.d.hasFocus=s.d.hasfocus;s.h.V.hasFocus=!0;s.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(n,t){s.a.gb(n,t())}};v("if");v("ifnot",!1,!0);v("with",!0,!1,function(n,t){return n.createChildContext(t)});l={};s.d.options={init:function(n){if("select"!==s.a.v(n))throw Error("options binding applies only to SELECT elements");for(;0<n.length;)n.remove(0);return{controlsDescendantBindings:!0}},update:function(t,i,r){function v(){return s.a.xa(t.options,function(n){return n.selected})}function y(n,t,i){var r=typeof t;return"function"==r?t(n):"string"==r?n[t]:i}function p(n,i){if(o&&e)s.i.Y(t,s.a.c(r.get("value")),!0);else if(f.length){var u=0<=s.a.m(f,s.i.s(i[0]));s.a.Sb(i[0],u);o&&!u&&s.k.u(s.a.qa,null,[t,"change"])}}var h=t.multiple,c=0!=t.length&&h?t.scrollTop:null,u=s.a.c(i()),e=r.get("valueAllowUnset")&&r.has("value"),w=r.get("optionsIncludeDestroyed"),a,f,o;i={};f=[];e||(h?f=s.a.Ka(v(),s.i.s):0<=t.selectedIndex&&f.push(s.i.s(t.options[t.selectedIndex])));u&&("undefined"==typeof u.length&&(u=[u]),a=s.a.xa(u,function(t){return w||t===n||null===t||!s.a.c(t._destroy)}),r.has("optionsCaption")&&(u=s.a.c(r.get("optionsCaption")),null!==u&&u!==n&&a.unshift(l)));o=!1;i.beforeRemove=function(n){t.removeChild(n)};u=p;r.has("optionsAfterRender")&&"function"==typeof r.get("optionsAfterRender")&&(u=function(t,i){p(0,i);s.k.u(r.get("optionsAfterRender"),null,[i[0],t!==l?t:n])});s.a.fb(t,a,function(i,u,h){return h.length&&(f=!e&&h[0].selected?[s.i.s(h[0])]:[],o=!0),u=t.ownerDocument.createElement("option"),i===l?(s.a.Ha(u,r.get("optionsCaption")),s.i.Y(u,n)):(h=y(i,r.get("optionsValue"),i),s.i.Y(u,s.a.c(h)),i=y(i,r.get("optionsText"),h),s.a.Ha(u,i)),[u]},i,u);s.k.u(function(){e?s.i.Y(t,s.a.c(r.get("value")),!0):(h?f.length&&v().length<f.length:f.length&&0<=t.selectedIndex?s.i.s(t.options[t.selectedIndex])!==f[0]:f.length||0<=t.selectedIndex)&&s.a.qa(t,"change")});s.a.kc(t);c&&20<Math.abs(c-t.scrollTop)&&(t.scrollTop=c)}};s.d.options.ab=s.a.f.I();s.d.selectedOptions={after:["options","foreach"],init:function(n,t,i){s.a.n(n,"change",function(){var u=t(),r=[];s.a.o(n.getElementsByTagName("option"),function(n){n.selected&&r.push(s.i.s(n))});s.h.ra(u,i,"selectedOptions",r)})},update:function(n,t){if("select"!=s.a.v(n))throw Error("values binding applies only to SELECT elements");var i=s.a.c(t());i&&"number"==typeof i.length&&s.a.o(n.getElementsByTagName("option"),function(n){var t=0<=s.a.m(i,s.i.s(n));s.a.Sb(n,t)})}};s.h.V.selectedOptions=!0;s.d.style={update:function(t,i){var r=s.a.c(i()||{});s.a.A(r,function(i,r){r=s.a.c(r);(null===r||r===n||!1===r)&&(r="");t.style[i]=r})}};s.d.submit={init:function(n,t,i,r,u){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");s.a.n(n,"submit",function(i){var r,f=t();try{r=f.call(u.$data,n)}finally{!0!==r&&(i.preventDefault?i.preventDefault():i.returnValue=!1)}})}};s.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(n,t){s.a.Ha(n,t())}};s.e.R.text=!0,function(){if(i&&i.navigator)var t=function(n){if(n)return parseFloat(n[1])},e=i.opera&&i.opera.version&&parseInt(i.opera.version()),r=i.navigator.userAgent,o=t(r.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),h=t(r.match(/Firefox\/([^ ]*)/));if(10>s.a.M)var u=s.a.f.I(),f=s.a.f.I(),c=function(n){var t=this.activeElement;(t=t&&s.a.f.get(t,f))&&t(n)},l=function(n,t){var i=n.ownerDocument;s.a.f.get(i,u)||(s.a.f.set(i,u,!0),s.a.n(i,"selectionchange",c));s.a.f.set(n,f,t)};s.d.textInput={init:function(t,i,r){function u(n,i){s.a.n(t,n,i)}function p(){var r=s.a.c(i());(null===r||r===n)&&(r="");v!==n&&r===v?setTimeout(p,4):t.value!==r&&(y=r,t.value=r)}function c(){a||(v=t.value,a=setTimeout(f,4))}function f(){clearTimeout(a);v=a=n;var u=t.value;y!==u&&(y=u,s.h.ra(i(),r,"textInput",u))}var y=t.value,a,v;10>s.a.M?(u("propertychange",function(n){"value"===n.propertyName&&f()}),8==s.a.M&&(u("keyup",f),u("keydown",f)),8<=s.a.M&&(l(t,f),u("dragend",c))):(u("input",f),5>o&&"textarea"===s.a.v(t)?(u("keydown",c),u("paste",c),u("cut",c)):11>e?u("keydown",c):4>h&&(u("DOMAutoComplete",f),u("dragdrop",f),u("drop",f)));u("change",f);s.w(p,null,{q:t})}};s.h.V.textInput=!0;s.d.textinput={preprocess:function(n,t,i){i("textInput",n)}}}();s.d.uniqueName={init:function(n,t){if(t()){var i="ko_unique_"+ ++s.d.uniqueName.fc;s.a.Rb(n,i)}}};s.d.uniqueName.fc=0;s.d.value={after:["options","foreach"],init:function(n,t,i){var o,h;if("input"!=n.tagName.toLowerCase()||"checkbox"!=n.type&&"radio"!=n.type){var r=["change"],u=i.get("valueUpdate"),f=!1,e=null;u&&("string"==typeof u&&(u=[u]),s.a.ia(r,u),r=s.a.wb(r));o=function(){e=null;f=!1;var r=t(),u=s.i.s(n);s.h.ra(r,i,"value",u)};!s.a.M||"input"!=n.tagName.toLowerCase()||"text"!=n.type||"off"==n.autocomplete||n.form&&"off"==n.form.autocomplete||-1!=s.a.m(r,"propertychange")||(s.a.n(n,"propertychange",function(){f=!0}),s.a.n(n,"focus",function(){f=!1}),s.a.n(n,"blur",function(){f&&o()}));s.a.o(r,function(t){var i=o;s.a.Dc(t,"after")&&(i=function(){e=s.i.s(n);setTimeout(o,0)},t=t.substring(5));s.a.n(n,t,i)});h=function(){var r=s.a.c(t()),u=s.i.s(n),f;null!==e&&r===e?setTimeout(h,0):r!==u&&("select"===s.a.v(n)?(f=i.get("valueAllowUnset"),u=function(){s.i.Y(n,r,f)},u(),f||r===s.i.s(n)?setTimeout(u,0):s.k.u(s.a.qa,null,[n,"change"])):s.i.Y(n,r))};s.w(h,null,{q:n})}else s.va(n,{checkedValue:t})},update:function(){}};s.h.V.value=!0;s.d.visible={update:function(n,t){var i=s.a.c(t()),r="none"!=n.style.display;i&&!r?n.style.display="":!i&&r&&(n.style.display="none")}},function(n){s.d[n]={init:function(t,i,r,u,f){return s.d.event.init.call(this,t,function(){var t={};return t[n]=i(),t},r,u,f)}}}("click");s.J=function(){};s.J.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource");};s.J.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock");};s.J.prototype.makeTemplateSource=function(n,t){if("string"==typeof n){t=t||r;var i=t.getElementById(n);if(!i)throw Error("Cannot find template with ID "+n);return new s.t.l(i)}if(1==n.nodeType||8==n.nodeType)return new s.t.ha(n);throw Error("Unknown template type: "+n);};s.J.prototype.renderTemplate=function(n,t,i,r){return n=this.makeTemplateSource(n,r),this.renderTemplateSource(n,t,i,r)};s.J.prototype.isTemplateRewritten=function(n,t){return!1===this.allowTemplateRewriting?!0:this.makeTemplateSource(n,t).data("isRewritten")};s.J.prototype.rewriteTemplate=function(n,t,i){n=this.makeTemplateSource(n,i);t=t(n.text());n.text(t);n.data("isRewritten",!0)};s.b("templateEngine",s.J);s.kb=function(){function n(n,t,i,r){var o,f,u,e;for(n=s.h.bb(n),o=s.h.ka,f=0;f<n.length;f++)if(u=n[f].key,o.hasOwnProperty(u))if(e=o[u],"function"==typeof e){if(u=e(n[f].value))throw Error(u);}else if(!e)throw Error("This template engine does not support the '"+u+"' binding within its templates");return i="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+s.h.Ea(n,{valueAccessors:!0})+" } })()},'"+i.toLowerCase()+"')",r.createJavaScriptEvaluatorBlock(i)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,i=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{lc:function(n,t,i){t.isTemplateRewritten(n,i)||t.rewriteTemplate(n,function(n){return s.kb.xc(n,t)},i)},xc:function(r,u){return r.replace(t,function(t,i,r,f,e){return n(e,i,r,u)}).replace(i,function(t,i){return n(i,"<!-- ko -->","#comment",u)})},dc:function(n,t){return s.H.$a(function(i,r){var u=i.nextSibling;u&&u.nodeName.toLowerCase()===t&&s.va(u,n,r)})}}}();s.b("__tr_ambtns",s.kb.dc),function(){var i,t;s.t={};s.t.l=function(n){this.l=n};s.t.l.prototype.text=function(){var n=s.a.v(this.l),n="script"===n?"text":"textarea"===n?"value":"innerHTML",t;if(0==arguments.length)return this.l[n];t=arguments[0];"innerHTML"===n?s.a.gb(this.l,t):this.l[n]=t};i=s.a.f.I()+"_";s.t.l.prototype.data=function(n){if(1===arguments.length)return s.a.f.get(this.l,i+n);s.a.f.set(this.l,i+n,arguments[1])};t=s.a.f.I();s.t.ha=function(n){this.l=n};s.t.ha.prototype=new s.t.l;s.t.ha.prototype.text=function(){if(0==arguments.length){var i=s.a.f.get(this.l,t)||{};return i.lb===n&&i.Na&&(i.lb=i.Na.innerHTML),i.lb}s.a.f.set(this.l,t,{lb:arguments[0]})};s.t.l.prototype.nodes=function(){if(0==arguments.length)return(s.a.f.get(this.l,t)||{}).Na;s.a.f.set(this.l,t,{Na:arguments[0]})};s.b("templateSources",s.t);s.b("templateSources.domElement",s.t.l);s.b("templateSources.anonymousTemplate",s.t.ha)}(),function(){function t(n,t,i){var r;for(t=s.e.nextSibling(t);n&&(r=n)!==t;)n=s.e.nextSibling(r),i(r,n)}function f(n,i){if(n.length){var r=n[0],u=n[n.length-1],f=r.parentNode,e=s.L.instance,o=e.preprocessNode;if(o){if(t(r,u,function(n,t){var f=n.previousSibling,i=o.call(e,n);i&&(n===r&&(r=i[0]||t),n===u&&(u=i[i.length-1]||f))}),n.length=0,!r)return;r===u?n.push(r):(n.push(r,u),s.a.na(n,f))}t(r,u,function(n){1!==n.nodeType&&8!==n.nodeType||s.ub(i,n)});t(r,u,function(n){1!==n.nodeType&&8!==n.nodeType||s.H.Xb(n,[i])});s.a.na(n,f)}}function i(n){return n.nodeType?n:0<n.length?n[0]:null}function e(n,t,u,e,o){o=o||{};var h=(n&&i(n)||u||{}).ownerDocument,c=o.templateEngine||r;if(s.kb.lc(u,c,h),u=c.renderTemplate(u,e,o,h),"number"!=typeof u.length||0<u.length&&"number"!=typeof u[0].nodeType)throw Error("Template engine must return an array of DOM nodes");h=!1;switch(t){case"replaceChildren":s.e.T(n,u);h=!0;break;case"replaceNode":s.a.Qb(n,u);h=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+t);}return h&&(f(u,e),o.afterRender&&s.k.u(o.afterRender,null,[u,e.$data])),u}function o(n,t,i){return s.F(n)?n():"function"==typeof n?n(t,i):n}var r,u;s.hb=function(t){if(t!=n&&!(t instanceof s.J))throw Error("templateEngine must inherit from ko.templateEngine");r=t};s.eb=function(t,u,f,h,c){if(f=f||{},(f.templateEngine||r)==n)throw Error("Set a template engine before calling renderTemplate");if(c=c||"replaceChildren",h){var l=i(h);return s.j(function(){var n=u&&u instanceof s.N?u:new s.N(s.a.c(u)),r=o(t,n.$data,n),n=e(h,c,r,n,f);"replaceNode"==c&&(h=n,l=i(h))},null,{Pa:function(){return!l||!s.a.Qa(l)},q:l&&"replaceNode"==c?l.parentNode:l})}return s.H.$a(function(n){s.eb(t,u,f,n,"replaceNode")})};s.Cc=function(t,i,r,u,h){function l(n,t){f(t,c);r.afterRender&&r.afterRender(t,n);c=null}function a(n,i){c=h.createChildContext(n,r.as,function(n){n.$index=i});var u=o(t,n,c);return e(null,"ignoreTargetNode",u,c,r)}var c;return s.j(function(){var t=s.a.c(i)||[];"undefined"==typeof t.length&&(t=[t]);t=s.a.xa(t,function(t){return r.includeDestroyed||t===n||null===t||!s.a.c(t._destroy)});s.k.u(s.a.fb,null,[u,t,a,r,l])},null,{q:u})};u=s.a.f.I();s.d.template={init:function(n,t){var i=s.a.c(t());if("string"==typeof i||i.name)s.e.ma(n);else{if("nodes"in i){if(i=i.nodes||[],s.F(i))throw Error('The "nodes" option must be a plain, non-observable array.');}else i=s.e.childNodes(n);i=s.a.Jb(i);new s.t.ha(n).nodes(i)}return{controlsDescendantBindings:!0}},update:function(t,i,r,f,e){var h=i(),o;i=s.a.c(h);r=!0;f=null;"string"==typeof i?i={}:(h=i.name,"if"in i&&(r=s.a.c(i["if"])),r&&"ifnot"in i&&(r=!s.a.c(i.ifnot)),o=s.a.c(i.data));"foreach"in i?f=s.Cc(h||t,r&&i.foreach||[],i,t,e):r?(e="data"in i?e.createChildContext(o,i.as):e,f=s.eb(h||t,e,i,t)):s.e.ma(t);e=f;(o=s.a.f.get(t,u))&&"function"==typeof o.p&&o.p();s.a.f.set(t,u,e&&e.$()?e:n)}};s.h.ka.template=function(n){return n=s.h.bb(n),1==n.length&&n[0].unknown||s.h.vc(n,"name")?null:"This template engine does not support anonymous templates nested within its templates"};s.e.R.template=!0}();s.b("setTemplateEngine",s.hb);s.b("renderTemplate",s.eb);s.a.Cb=function(n,t,i){if(n.length&&t.length)for(var o,r,f,e,u=o=0;(!i||u<i)&&(f=n[o]);++o){for(r=0;e=t[r];++r)if(f.value===e.value){f.moved=e.index;e.moved=f.index;t.splice(r,1);u=r=0;break}u+=r}};s.a.Ma=function(){function n(n,t,i,r,u){for(var o=Math.min,l=Math.max,a=[],c=n.length,f,h=t.length,v=h-c||1,w=c+h+1,y,p,b,e=0;e<=c;e++)for(p=y,a.push(y=[]),b=o(h,e+v),f=l(0,e-1);f<=b;f++)y[f]=f?e?n[e-1]===t[f-1]?p[f-1]:o(p[f]||w,y[f-1]||w)+1:f+1:e+1;for(o=[],l=[],v=[],e=c,f=h;e||f;)h=a[e][f]-1,f&&h===a[e][f-1]?l.push(o[o.length]={status:i,value:t[--f],index:f}):e&&h===a[e-1][f]?v.push(o[o.length]={status:r,value:n[--e],index:e}):(--f,--e,u.sparse||o.push({status:"retained",value:t[f]}));return s.a.Cb(l,v,10*c),o.reverse()}return function(t,i,r){return r="boolean"==typeof r?{dontLimitMoves:r}:r||{},t=t||[],i=i||[],t.length<=i.length?n(t,i,"added","deleted",r):n(i,t,"deleted","added",r)}}();s.b("utils.compareArrays",s.a.Ma),function(){function i(t,i,r,u,f){var e=[],o=s.j(function(){var n=i(r,f,s.a.na(e,t))||[];0<e.length&&(s.a.Qb(e,n),u&&s.k.u(u,null,[r,n,f]));e.length=0;s.a.ia(e,n)},null,{q:t,Pa:function(){return!s.a.tb(e)}});return{aa:e,j:o.$()?o:n}}var t=s.a.f.I();s.a.fb=function(r,u,f,e,o){function rt(n,t){h=d[t];nt!==t&&(it[n]=h);h.Ua(nt++);s.a.na(h.aa,r);g.push(h);w.push(h)}function y(n,t){if(n)for(var i=0,r=t.length;i<r;i++)t[i]&&s.a.o(t[i].aa,function(r){n(r,i,t[i].wa)})}var c,v,ut;u=u||[];e=e||{};var v=s.a.f.get(r,t)===n,d=s.a.f.get(r,t)||[],p=s.a.Ka(d,function(n){return n.wa}),l=s.a.Ma(p,u,e.dontLimitMoves),g=[],a=0,nt=0,tt=[],w=[];u=[];for(var it=[],p=[],h,c=0,b,k;b=l[c];c++)switch(k=b.moved,b.status){case"deleted":k===n&&(h=d[a],h.j&&h.j.p(),tt.push.apply(tt,s.a.na(h.aa,r)),e.beforeRemove&&(u[c]=h,w.push(h)));a++;break;case"retained":rt(c,a++);break;case"added":k!==n?rt(c,k):(h={wa:b.value,Ua:s.r(nt++)},g.push(h),w.push(h),v||(p[c]=h))}for(y(e.beforeMove,it),s.a.o(tt,e.beforeRemove?s.S:s.removeNode),c=0,v=s.e.firstChild(r);h=w[c];c++){for(h.aa||s.a.extend(h,i(r,f,h.wa,o,h.Ua)),a=0;l=h.aa[a];v=l.nextSibling,ut=l,a++)l!==v&&s.e.Fb(r,l,ut);!h.rc&&o&&(o(h.wa,h.aa,h.Ua),h.rc=!0)}y(e.beforeRemove,u);y(e.afterMove,it);y(e.afterAdd,p);s.a.f.set(r,t,g)}}();s.b("utils.setDomNodeChildrenFromArrayMapping",s.a.fb);s.P=function(){this.allowTemplateRewriting=!1};s.P.prototype=new s.J;s.P.prototype.renderTemplateSource=function(n,t,i,r){return(t=(9>s.a.M?0:n.nodes)?n.nodes():null)?s.a.O(t.cloneNode(!0).childNodes):(n=n.text(),s.a.ca(n,r))};s.P.Va=new s.P;s.hb(s.P.Va);s.b("nativeTemplateEngine",s.P),function(){s.Ya=function(){var n=this.uc=function(){if(!t||!t.tmpl)return 0;try{if(0<=t.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(n){}return 1}();this.renderTemplateSource=function(i,u,f,e){if(e=e||r,f=f||{},2>n)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var o=i.data("precompiled");return o||(o=i.text()||"",o=t.template(null,"{{ko_with $item.koBindingContext}}"+o+"{{/ko_with}}"),i.data("precompiled",o)),i=[u.$data],u=t.extend({koBindingContext:u},f.templateOptions),u=t.tmpl(o,i,u),u.appendTo(e.createElement("div")),t.fragments={},u};this.createJavaScriptEvaluatorBlock=function(n){return"{{ko_code ((function() { return "+n+" })()) }}"};this.addTemplate=function(n,t){r.write("<script type='text/html' id='"+n+"'>"+t+"<\/script>")};0<n&&(t.tmpl.tag.ko_code={open:"__.push($1 || '');"},t.tmpl.tag.ko_with={open:"with($1) {",close:"} "})};s.Ya.prototype=new s.J;var n=new s.Ya;0<n.uc&&s.hb(n);s.b("jqueryTmplTemplateEngine",s.Ya)}()})})()}(),function(n){typeof require=="function"&&typeof exports=="object"&&typeof module=="object"?n(require("knockout"),exports):typeof define=="function"&&define.amd?define(["knockout","exports"],n):n(ko,ko.validation={})}(function(n,t){function s(n,i,r){return i.validator(n(),r.params===undefined?!0:r.params)?!0:(n.error=t.formatMessage(r.message||i.message,r.params),n.__valid__(!1),!1)}function h(n,i,r){n.isValidating(!0);var u=function(u){var f=!1,e="";if(!n.__valid__()){n.isValidating(!1);return}u.message?(f=u.isValid,e=u.message):f=u;f||(n.error=t.formatMessage(e||r.message||i.message,r.params),n.__valid__(f));n.isValidating(!1)};i.validator(n(),r.params||!0,u)}var o;if(typeof n===undefined)throw"Knockout is required, please ensure it is loaded before loading this validation plug-in";typeof define=="function"&&define.amd&&(t=n.validation={});var f={registerExtenders:!0,messagesOnModified:!0,errorsAsTitleOnModified:!1,messageTemplate:null,insertMessages:!0,parseInputAttributes:!1,writeInputAttributes:!1,decorateElement:!1,errorClass:null,errorElementClass:"validationElement",errorMessageClass:"validationMessage",grouping:{deep:!1,observable:!0}},u=n.utils.extend({},f),e=["required","pattern","min","max","step"],c=function(n){window.setImmediate?window.setImmediate(n):window.setTimeout(n,0)},i=function(){var r=(new Date).getTime(),t={},n="__ko_validation__";return{isArray:function(n){return n.isArray||Object.prototype.toString.call(n)==="[object Array]"},isObject:function(n){return n!==null&&typeof n=="object"},values:function(n){var i=[],t;for(t in n)n.hasOwnProperty(t)&&i.push(n[t]);return i},getValue:function(n){return typeof n=="function"?n():n},hasAttribute:function(n,t){return n.getAttribute(t)!==null},isValidatable:function(n){return n&&n.rules&&n.isValid&&n.isModified},insertAfter:function(n,t){n.parentNode.insertBefore(t,n.nextSibling)},newId:function(){return r+=1},getConfigOptions:function(n){var t=i.contextFor(n);return t||u},setDomData:function(r,u){var f=r[n];f||(r[n]=f=i.newId());t[f]=u},getDomData:function(i){var r=i[n];return r?t[r]:undefined},contextFor:function(n){switch(n.nodeType){case 1:case 8:var t=i.getDomData(n);if(t)return t;if(n.parentNode)return i.contextFor(n.parentNode)}return undefined},isEmptyVal:function(n){return n===undefined?!0:n===null?!0:n===""?!0:void 0}}}(),r=function(){var r=0;return{utils:i,init:function(i,f){r>0&&!f||(i=i||{},i.errorElementClass=i.errorElementClass||i.errorClass||u.errorElementClass,i.errorMessageClass=i.errorMessageClass||i.errorClass||u.errorMessageClass,n.utils.extend(u,i),u.registerExtenders&&t.registerExtenders(),r=1)},configure:function(n){t.init(n)},reset:function(){u=$.extend(u,f)},group:function(t,r){var r=n.utils.extend(u.grouping,r),e=n.observableArray([]),f=null,o=function s(t,u){var o=[],f=n.utils.unwrapObservable(t);u=u!==undefined?u:r.deep?1:-1;n.isObservable(t)&&(t.isValid||t.extend({validatable:!0}),e.push(t));f&&(i.isArray(f)?o=f:i.isObject(f)&&(o=i.values(f)));u!==0&&n.utils.arrayForEach(o,function(n){n&&!n.nodeType&&s(n,u+1)})};return r.observable?(o(t),f=n.computed(function(){var t=[];return n.utils.arrayForEach(e(),function(n){n.isValid()||t.push(n.error)}),t})):f=function(){var i=[];return e([]),o(t),n.utils.arrayForEach(e(),function(n){n.isValid()||i.push(n.error)}),i},f.showAllMessages=function(t){t==undefined&&(t=!0);f();n.utils.arrayForEach(e(),function(n){n.isModified(t)})},t.errors=f,t.isValid=function(){return t.errors().length===0},t.isAnyMessageShown=function(){var t=!1;return f(),n.utils.arrayForEach(e(),function(n){!n.isValid()&&n.isModified()&&(t=!0)}),t},f},formatMessage:function(n,t){return typeof n=="function"?n(t):n.replace(/\{0\}/gi,t)},addRule:function(n,t){return n.extend({validatable:!0}),n.rules.push(t),n},addAnonymousRule:function(n,r){var u=i.newId();r.message===undefined&&(r.message="Error");t.rules[u]=r;t.addRule(n,{rule:u,params:r.params})},addExtender:function(r){n.extenders[r]=function(n,u){return u.message||u.onlyIf?t.addRule(n,{rule:r,message:u.message,params:i.isEmptyVal(u.params)?!0:u.params,condition:u.onlyIf}):t.addRule(n,{rule:r,params:u})}},registerExtenders:function(){if(u.registerExtenders)for(var i in t.rules)t.rules.hasOwnProperty(i)&&(n.extenders[i]||t.addExtender(i))},insertValidationMessage:function(n){var t=document.createElement("SPAN");return t.className=i.getConfigOptions(n).errorMessageClass,i.insertAfter(n,t),t},parseInputValidationAttributes:function(r,u){n.utils.arrayForEach(e,function(n){i.hasAttribute(r,n)&&t.addRule(u(),{rule:n,params:r.getAttribute(n)||!0})})},writeInputValidationAttributes:function(t,i){var r=i(),u;r&&r.rules&&(u=r.rules(),n.utils.arrayForEach(e,function(i){var f,r=n.utils.arrayFirst(u,function(n){return n.rule.toLowerCase()===i.toLowerCase()});r&&(f=r.params,r.rule=="pattern"&&r.params instanceof RegExp&&(f=r.params.source),t.setAttribute(i,f))}),u=null)}}}();r.rules={};r.rules.required={validator:function(n,t){var i;return n===undefined||n===null?!t:(i=n,typeof n=="string"&&(i=n.replace(/^\s+|\s+$/g,"")),t?(i+"").length>0:!0)},message:"This field is required."};r.rules.min={validator:function(n,t){return i.isEmptyVal(n)||n>=t},message:"Please enter a value greater than or equal to {0}."};r.rules.max={validator:function(n,t){return i.isEmptyVal(n)||n<=t},message:"Please enter a value less than or equal to {0}."};r.rules.minLength={validator:function(n,t){return i.isEmptyVal(n)||n.length>=t},message:"Please enter at least {0} characters."};r.rules.maxLength={validator:function(n,t){return i.isEmptyVal(n)||n.length<=t},message:"Please enter no more than {0} characters."};r.rules.pattern={validator:function(n,t){return i.isEmptyVal(n)||n.match(t)!=null},message:"Please check this value."};r.rules.step={validator:function(n,t){return i.isEmptyVal(n)||n*100%(t*100)==0},message:"The value must increment by {0}"};r.rules.email={validator:function(n,t){return t?i.isEmptyVal(n)||t&&/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(n):!0},message:"Please enter a proper email address"};r.rules.date={validator:function(n,t){return t?i.isEmptyVal(n)||t&&!/Invalid|NaN/.test(new Date(n)):!0},message:"Please enter a proper date"};r.rules.dateISO={validator:function(n,t){return t?i.isEmptyVal(n)||t&&/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(n):!0},message:"Please enter a proper date"};r.rules.number={validator:function(n,t){return t?i.isEmptyVal(n)||t&&/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(n):!0},message:"Please enter a number"};r.rules.digit={validator:function(n,t){return t?i.isEmptyVal(n)||t&&/^\d+$/.test(n):!0},message:"Please enter a digit"};r.rules.phoneUS={validator:function(n,t){return t?typeof n!="string"?!1:i.isEmptyVal(n)?!0:(n=n.replace(/\s+/g,""),t&&n.length>9&&n.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)):!0},message:"Please specify a valid phone number"};r.rules.equal={validator:function(n,t){var r=t;return n===i.getValue(r)},message:"Values must equal"};r.rules.notEqual={validator:function(n,t){var r=t;return n!==i.getValue(r)},message:"Please choose another value."};r.rules.unique={validator:function(t,r){var u=i.getValue(r.collection),f=i.getValue(r.externalValue),e=0;return!t||!u?!0:(n.utils.arrayFilter(n.utils.unwrapObservable(u),function(n){t===(r.valueAccessor?r.valueAccessor(n):n)&&e++}),e<(f!==undefined&&t!==f?1:2))},message:"Please make sure the value is unique."},function(){r.registerExtenders()}();n.bindingHandlers.validationCore=function(){return{init:function(r,u){var f=i.getConfigOptions(r),e;f.parseInputAttributes&&c(function(){t.parseInputValidationAttributes(r,u)});f.insertMessages&&i.isValidatable(u())&&(e=t.insertValidationMessage(r),f.messageTemplate?n.renderTemplate(f.messageTemplate,{field:u()},null,e,"replaceNode"):n.applyBindingsToNode(e,{validationMessage:u()}));f.writeInputAttributes&&i.isValidatable(u())&&t.writeInputValidationAttributes(r,u);f.decorateElement&&i.isValidatable(u())&&n.applyBindingsToNode(r,{validationElement:u()})},update:function(){}}}(),function(){var t=n.bindingHandlers.value.init;n.bindingHandlers.value.init=function(i,r,u,f,e){return t(i,r,u),n.bindingHandlers.validationCore.init(i,r,u,f,e)}}();n.bindingHandlers.validationMessage={update:function(t,r){var u=r(),h=i.getConfigOptions(t),c=n.utils.unwrapObservable(u),f=!1,e=!1,o,s;u.extend({validatable:!0});f=u.isModified();e=u.isValid();o=function(){return!h.messagesOnModified||f?e?null:u.error:null};s=function(){return f?!e:!1};n.bindingHandlers.text.update(t,o);n.bindingHandlers.visible.update(t,s)}};n.bindingHandlers.validationElement={update:function(t,r){var u=r(),f=i.getConfigOptions(t),a=n.utils.unwrapObservable(u),e=!1,o=!1,s;u.extend({validatable:!0});e=u.isModified();o=u.isValid();s=function(){var n={},t=e?!o:!1;return f.decorateElement||(t=!1),n[f.errorElementClass]=t,n};n.bindingHandlers.css.update(t,s);var h=t.getAttribute("data-orig-title"),c=t.title,v=t.getAttribute("data-orig-title")=="true",l=function(){if(!f.errorsAsTitleOnModified||e)return o?{title:h||c,"data-orig-title":null}:{title:u.error,"data-orig-title":h||c}};n.bindingHandlers.attr.update(t,l)}};n.bindingHandlers.validationOptions=function(){return{init:function(t,r){var e=n.utils.unwrapObservable(r()),f;e&&(f=n.utils.extend({},u),n.utils.extend(f,e),i.setDomData(t,f))}}}();n.extenders.validation=function(r,u){return n.utils.arrayForEach(i.isArray(u)?u:[u],function(n){t.addAnonymousRule(r,n)}),r};n.extenders.validatable=function(r,u){var f,e;return u&&!i.isValidatable(r)?(r.error=null,r.rules=n.observableArray(),r.isValidating=n.observable(!1),r.__valid__=n.observable(!0),r.isModified=n.observable(!1),f=n.computed(function(){var n=r(),i=r.rules();return t.validateObservable(r),!0}),r.isValid=n.computed(function(){return r.__valid__()}),e=r.subscribe(function(){r.isModified(!0)}),r._disposeValidation=function(){r.isValid.dispose();r.rules.removeAll();r.isModified._subscriptions.change=[];r.isValidating._subscriptions.change=[];r.__valid__._subscriptions.change=[];e.dispose();f.dispose();delete r.rules;delete r.error;delete r.isValid;delete r.isValidating;delete r.__valid__;delete r.isModified}):u===!1&&i.isValidatable(r)&&r._disposeValidation&&r._disposeValidation(),r};r.validateObservable=function(n){for(var u=0,r,i,f=n.rules(),e=f.length;u<e;u++)if(i=f[u],!i.condition||i.condition())if(r=t.rules[i.rule],r.async||i.async)h(n,r,i);else if(!s(n,r,i))return!1;return n.error=null,n.__valid__(!0),!0};n.validatedObservable=function(i){if(!t.utils.isObject(i))return n.observable(i).extend({validatable:!0});var r=n.observable(i);return r.errors=t.group(i),r.isValid=n.computed(function(){return r.errors().length===0}),r};r.localize=function(n){var i;for(i in n)t.rules.hasOwnProperty(i)&&(t.rules[i].message=n[i])};n.applyBindingsWithValidation=function(i,r,u){var o=arguments.length,f,e;o>2?(f=r,e=u):o<2?f=document.body:arguments[1].nodeType?f=r:e=arguments[1];t.init();e&&t.utils.setDomData(f,e);n.applyBindings(i,r)};o=n.applyBindings;n.applyBindings=function(n,i){t.init();o(n,i)};n.utils.extend(t,r)}),function(){"use strict";var h=this,g=h.Chart,t=function(t){var u=this,i,r;return this.canvas=t.canvas,this.ctx=t,i=this.width=t.canvas.width,r=this.height=t.canvas.height,this.aspectRatio=this.width/this.height,n.retinaScale(this),this};t.defaults={global:{animation:!0,animationSteps:60,animationEasing:"easeOutQuart",showScale:!0,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleIntegersOnly:!0,scaleBeginAtZero:!1,scaleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",responsive:!1,maintainAspectRatio:!0,showTooltips:!0,tooltipEvents:["mousemove","touchstart","touchmove","mouseout"],tooltipFillColor:"rgba(0,0,0,0.8)",tooltipFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipFontSize:14,tooltipFontStyle:"normal",tooltipFontColor:"#fff",tooltipTitleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipTitleFontSize:14,tooltipTitleFontStyle:"bold",tooltipTitleFontColor:"#fff",tooltipYPadding:6,tooltipXPadding:6,tooltipCaretSize:8,tooltipCornerRadius:6,tooltipXOffset:10,tooltipTemplate:"<%if (label){%><%=label%>: <%}%><%= value %>",multiTooltipTemplate:"<%= value %>",multiTooltipKeyBackground:"#fff",onAnimationProgress:function(){},onAnimationComplete:function(){}}};t.types={};var n=t.helpers={},i=n.each=function(n,t,i){var f=Array.prototype.slice.call(arguments,3),r,u;if(n)if(n.length===+n.length)for(r=0;r<n.length;r++)t.apply(i,[n[r],r].concat(f));else for(u in n)t.apply(i,[n[u],u].concat(f))},l=n.clone=function(n){var t={};return i(n,function(i,r){n.hasOwnProperty(r)&&(t[r]=i)}),t},r=n.extend=function(n){return i(Array.prototype.slice.call(arguments,1),function(t){i(t,function(i,r){t.hasOwnProperty(r)&&(n[r]=i)})}),n},nt=n.merge=function(){var n=Array.prototype.slice.call(arguments,0);return n.unshift({}),r.apply(null,n)},tt=n.indexOf=function(n,t){if(Array.prototype.indexOf)return n.indexOf(t);for(var i=0;i<n.length;i++)if(n[i]===t)return i;return-1},vt=n.where=function(t,i){var r=[];return n.each(t,function(n){i(n)&&r.push(n)}),r},yt=n.findNextWhere=function(n,t,i){var r,u;for(i||(i=-1),r=i+1;r<n.length;r++)if(u=n[r],t(u))return u},pt=n.findPreviousWhere=function(n,t,i){var r,u;for(i||(i=n.length),r=i-1;r>=0;r--)if(u=n[r],t(u))return u},p=n.inherits=function(n){var i=this,t=n&&n.hasOwnProperty("constructor")?n.constructor:function(){return i.apply(this,arguments)},u=function(){this.constructor=t};return u.prototype=i.prototype,t.prototype=new u,t.extend=p,n&&r(t.prototype,n),t.__super__=i.prototype,t},a=n.noop=function(){},it=n.uid=function(){var n=0;return function(){return"chart-"+n++}}(),rt=n.warn=function(n){window.console&&typeof window.console.warn=="function"&&console.warn(n)},ut=n.amd=typeof define=="function"&&define.amd,u=n.isNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n)},c=n.max=function(n){return Math.max.apply(Math,n)},o=n.min=function(n){return Math.min.apply(Math,n)},wt=n.cap=function(n,t,i){if(u(t)){if(n>t)return t}else if(u(i)&&n<i)return i;return n},w=n.getDecimalPlaces=function(n){return n%1!=0&&u(n)?n.toString().split(".")[1].length:0},v=n.radians=function(n){return n*(Math.PI/180)},bt=n.getAngleFromPoint=function(n,t){var i=t.x-n.x,r=t.y-n.y,f=Math.sqrt(i*i+r*r),u=Math.PI*2+Math.atan2(r,i);return i<0&&r<0&&(u+=Math.PI*2),{angle:u,distance:f}},b=n.aliasPixel=function(n){return n%2==0?0:.5},kt=n.splineCurve=function(n,t,i,r){var u=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),f=Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2)),e=r*u/(u+f),o=r*f/(u+f);return{inner:{x:t.x-e*(i.x-n.x),y:t.y-e*(i.y-n.y)},outer:{x:t.x+o*(i.x-n.x),y:t.y+o*(i.y-n.y)}}},ft=n.calculateOrderOfMagnitude=function(n){return Math.floor(Math.log(n)/Math.LN10)},dt=n.calculateScaleRange=function(n,t,i,r,u){var w=2,v=Math.floor(t/(i*1.5)),y=w>=v,h=c(n),l=o(n);h===l&&(h+=.5,l>=.5&&!r?l-=.5:h+=.5);for(var b=Math.abs(h-l),s=ft(b),k=Math.ceil(h/(1*Math.pow(10,s)))*Math.pow(10,s),p=r?0:Math.floor(l/(1*Math.pow(10,s)))*Math.pow(10,s),a=k-p,f=Math.pow(10,s),e=Math.round(a/f);(e>v||e*2<v)&&!y;)if(e>v)f*=2,e=Math.round(a/f),e%1!=0&&(y=!0);else if(u&&s>=0)if(f/2%1==0)f/=2,e=Math.round(a/f);else break;else f/=2,e=Math.round(a/f);return y&&(e=w,f=a/e),{steps:e,stepValue:f,min:p,max:p+e*f}},f=n.template=function(n,t){function r(n,t){var r=/\W/.test(n)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+n.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):i[n]=i[n];return t?r(t):r}if(n instanceof Function)return n(t);var i={};return r(n,t)},gt=n.generateLabels=function(n,t,r,u){var e=new Array(t);return labelTemplateString&&i(e,function(t,i){e[i]=f(n,{value:r+u*(i+1)})}),e},s=n.easingEffects={linear:function(n){return n},easeInQuad:function(n){return n*n},easeOutQuad:function(n){return-1*n*(n-2)},easeInOutQuad:function(n){return(n/=1/2)<1?1/2*n*n:-1/2*(--n*(n-2)-1)},easeInCubic:function(n){return n*n*n},easeOutCubic:function(n){return 1*((n=n/1-1)*n*n+1)},easeInOutCubic:function(n){return(n/=1/2)<1?1/2*n*n*n:1/2*((n-=2)*n*n+2)},easeInQuart:function(n){return n*n*n*n},easeOutQuart:function(n){return-1*((n=n/1-1)*n*n*n-1)},easeInOutQuart:function(n){return(n/=1/2)<1?1/2*n*n*n*n:-1/2*((n-=2)*n*n*n-2)},easeInQuint:function(n){return 1*(n/=1)*n*n*n*n},easeOutQuint:function(n){return 1*((n=n/1-1)*n*n*n*n+1)},easeInOutQuint:function(n){return(n/=1/2)<1?1/2*n*n*n*n*n:1/2*((n-=2)*n*n*n*n+2)},easeInSine:function(n){return-1*Math.cos(n/1*(Math.PI/2))+1},easeOutSine:function(n){return 1*Math.sin(n/1*(Math.PI/2))},easeInOutSine:function(n){return-1/2*(Math.cos(Math.PI*n/1)-1)},easeInExpo:function(n){return n===0?1:1*Math.pow(2,10*(n/1-1))},easeOutExpo:function(n){return n===1?1:1*(-Math.pow(2,-10*n)+1)},easeInOutExpo:function(n){return n===0?0:n===1?1:(n/=1/2)<1?1/2*Math.pow(2,10*(n-1)):1/2*(-Math.pow(2,-10*--n)+2)},easeInCirc:function(n){return n>=1?n:-1*(Math.sqrt(1-(n/=1)*n)-1)},easeOutCirc:function(n){return 1*Math.sqrt(1-(n=n/1-1)*n)},easeInOutCirc:function(n){return(n/=1/2)<1?-1/2*(Math.sqrt(1-n*n)-1):1/2*(Math.sqrt(1-(n-=2)*n)+1)},easeInElastic:function(n){var r=1.70158,t=0,i=1;return n===0?0:(n/=1)==1?1:(t||(t=1*.3),i<Math.abs(1)?(i=1,r=t/4):r=t/(2*Math.PI)*Math.asin(1/i),-(i*Math.pow(2,10*(n-=1))*Math.sin((n*1-r)*2*Math.PI/t)))},easeOutElastic:function(n){var r=1.70158,t=0,i=1;return n===0?0:(n/=1)==1?1:(t||(t=1*.3),i<Math.abs(1)?(i=1,r=t/4):r=t/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*n)*Math.sin((n*1-r)*2*Math.PI/t)+1)},easeInOutElastic:function(n){var r=1.70158,t=0,i=1;return n===0?0:(n/=1/2)==2?1:(t||(t=1*.3*1.5),i<Math.abs(1)?(i=1,r=t/4):r=t/(2*Math.PI)*Math.asin(1/i),n<1)?-.5*i*Math.pow(2,10*(n-=1))*Math.sin((n*1-r)*2*Math.PI/t):i*Math.pow(2,-10*(n-=1))*Math.sin((n*1-r)*2*Math.PI/t)*.5+1},easeInBack:function(n){var t=1.70158;return 1*(n/=1)*n*((t+1)*n-t)},easeOutBack:function(n){var t=1.70158;return 1*((n=n/1-1)*n*((t+1)*n+t)+1)},easeInOutBack:function(n){var t=1.70158;return(n/=1/2)<1?1/2*n*n*(((t*=1.525)+1)*n-t):1/2*((n-=2)*n*(((t*=1.525)+1)*n+t)+2)},easeInBounce:function(n){return 1-s.easeOutBounce(1-n)},easeOutBounce:function(n){return(n/=1)<1/2.75?1*7.5625*n*n:n<2/2.75?1*(7.5625*(n-=1.5/2.75)*n+.75):n<2.5/2.75?1*(7.5625*(n-=2.25/2.75)*n+.9375):1*(7.5625*(n-=2.625/2.75)*n+.984375)},easeInOutBounce:function(n){return n<1/2?s.easeInBounce(n*2)*.5:s.easeOutBounce(n*2-1)*.5+1*.5}},k=n.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){return window.setTimeout(n,1e3/60)}}(),ni=n.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(n){return window.clearTimeout(n,1e3/60)}}(),ti=n.animationLoop=function(n,t,i,r,u,f){var e=0,h=s[i]||s.linear,o=function(){e++;var i=e/t,s=h(i);n.call(f,s,i,e);r.call(f,s,i);e<t?f.animationFrame=k(o):u.apply(f)};k(o)},ii=n.getRelativePosition=function(n){var r,u,t=n.originalEvent||n,f=n.currentTarget||n.srcElement,i=f.getBoundingClientRect();return t.touches?(r=t.touches[0].clientX-i.left,u=t.touches[0].clientY-i.top):(r=t.clientX-i.left,u=t.clientY-i.top),{x:r,y:u}},et=n.addEvent=function(n,t,i){n.addEventListener?n.addEventListener(t,i):n.attachEvent?n.attachEvent("on"+t,i):n["on"+t]=i},ot=n.removeEvent=function(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent?n.detachEvent("on"+t,i):n["on"+t]=a},ri=n.bindEvents=function(n,t,r){n.events||(n.events={});i(t,function(t){n.events[t]=function(){r.apply(n,arguments)};et(n.chart.canvas,t,n.events[t])})},st=n.unbindEvents=function(n,t){i(t,function(t,i){ot(n.chart.canvas,i,t)})},ht=n.getMaximumWidth=function(n){var t=n.parentNode;return t.clientWidth},ct=n.getMaximumHeight=function(n){var t=n.parentNode;return t.clientHeight},ui=n.getMaximumSize=n.getMaximumWidth,lt=n.retinaScale=function(n){var t=n.ctx,i=n.canvas.width,r=n.canvas.height;window.devicePixelRatio&&(t.canvas.style.width=i+"px",t.canvas.style.height=r+"px",t.canvas.height=r*window.devicePixelRatio,t.canvas.width=i*window.devicePixelRatio,t.scale(window.devicePixelRatio,window.devicePixelRatio))},at=n.clear=function(n){n.ctx.clearRect(0,0,n.width,n.height)},e=n.fontString=function(n,t,i){return t+" "+n+"px "+i},y=n.longestText=function(n,t,r){n.font=t;var u=0;return i(r,function(t){var i=n.measureText(t).width;u=i>u?i:u}),u},d=n.drawRoundedRectangle=function(n,t,i,r,u,f){n.beginPath();n.moveTo(t+f,i);n.lineTo(t+r-f,i);n.quadraticCurveTo(t+r,i,t+r,i+f);n.lineTo(t+r,i+u-f);n.quadraticCurveTo(t+r,i+u,t+r-f,i+u);n.lineTo(t+f,i+u);n.quadraticCurveTo(t,i+u,t,i+u-f);n.lineTo(t,i+f);n.quadraticCurveTo(t,i,t+f,i);n.closePath()};t.instances={};t.Type=function(n,i,r){this.options=i;this.chart=r;this.id=it();t.instances[this.id]=this;i.responsive&&this.resize();this.initialize.call(this,n)};r(t.Type.prototype,{initialize:function(){return this},clear:function(){return at(this.chart),this},stop:function(){return n.cancelAnimFrame.call(h,this.animationFrame),this},resize:function(n){this.stop();var t=this.chart.canvas,i=ht(this.chart.canvas),r=this.options.maintainAspectRatio?i/this.chart.aspectRatio:ct(this.chart.canvas);return t.width=this.chart.width=i,t.height=this.chart.height=r,lt(this.chart),typeof n=="function"&&n.apply(this,Array.prototype.slice.call(arguments,1)),this},reflow:a,render:function(t){return t&&this.reflow(),this.options.animation&&!t?n.animationLoop(this.draw,this.options.animationSteps,this.options.animationEasing,this.options.onAnimationProgress,this.options.onAnimationComplete,this):(this.draw(),this.options.onAnimationComplete.call(this)),this},generateLegend:function(){return f(this.options.legendTemplate,this)},destroy:function(){this.clear();st(this,this.events);delete t.instances[this.id]},showTooltip:function(r,u){var h,l,e,s;if(typeof this.activeElements=="undefined"&&(this.activeElements=[]),h=function(n){var t=!1;return n.length!==this.activeElements.length?t=!0:(i(n,function(n,i){n!==this.activeElements[i]&&(t=!0)},this),t)}.call(this,r),h||u)this.activeElements=r;else return;if(this.draw(),r.length>0)if(this.datasets&&this.datasets.length>1){for(s=this.datasets.length-1;s>=0;s--)if(l=this.datasets[s].points||this.datasets[s].bars||this.datasets[s].segments,e=tt(l,r[0]),e!==-1)break;var a=[],v=[],y=function(){var f=[],t,i=[],r=[],s,h,u,l;return n.each(this.datasets,function(n){t=n.points||n.bars||n.segments;t[e]&&t[e].hasValue()&&f.push(t[e])}),n.each(f,function(t){i.push(t.x);r.push(t.y);a.push(n.template(this.options.multiTooltipTemplate,t));v.push({fill:t._saved.fillColor||t.fillColor,stroke:t._saved.strokeColor||t.strokeColor})},this),l=o(r),h=c(r),u=o(i),s=c(i),{x:u>this.chart.width/2?u:s,y:(l+h)/2}}.call(this,e);new t.MultiTooltip({x:y.x,y:y.y,xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,xOffset:this.options.tooltipXOffset,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,titleTextColor:this.options.tooltipTitleFontColor,titleFontFamily:this.options.tooltipTitleFontFamily,titleFontStyle:this.options.tooltipTitleFontStyle,titleFontSize:this.options.tooltipTitleFontSize,cornerRadius:this.options.tooltipCornerRadius,labels:a,legendColors:v,legendColorBackground:this.options.multiTooltipKeyBackground,title:r[0].label,chart:this.chart,ctx:this.chart.ctx}).draw()}else i(r,function(n){var i=n.tooltipPosition();new t.Tooltip({x:Math.round(i.x),y:Math.round(i.y),xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,caretHeight:this.options.tooltipCaretSize,cornerRadius:this.options.tooltipCornerRadius,text:f(this.options.tooltipTemplate,n),chart:this.chart}).draw()},this);return this},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)}});t.Type.extend=function(n){var i=this,u=function(){return i.apply(this,arguments)},f,e;return u.prototype=l(i.prototype),r(u.prototype,n),u.extend=t.Type.extend,n.name||i.prototype.name?(f=n.name||i.prototype.name,e=t.defaults[i.prototype.name]?l(t.defaults[i.prototype.name]):{},t.defaults[f]=r(e,n.defaults),t.types[f]=u,t.prototype[f]=function(n,i){var r=nt(t.defaults.global,t.defaults[f],i||{});return new u(n,r,this)}):rt("Name not provided for this chart, so it hasn't been registered"),i};t.Element=function(n){r(this,n);this.initialize.apply(this,arguments);this.save()};r(t.Element.prototype,{initialize:function(){},restore:function(n){return n?i(n,function(n){this[n]=this._saved[n]},this):r(this,this._saved),this},save:function(){return this._saved=l(this),delete this._saved._saved,this},update:function(n){return i(n,function(n,t){this._saved[t]=this[t];this[t]=n},this),this},transition:function(n,t){return i(n,function(n,i){this[i]=(n-this._saved[i])*t+this._saved[i]},this),this},tooltipPosition:function(){return{x:this.x,y:this.y}},hasValue:function(){return u(this.value)}});t.Element.extend=p;t.Point=t.Element.extend({display:!0,inRange:function(n,t){var i=this.hitDetectionRadius+this.radius;return Math.pow(n-this.x,2)+Math.pow(t-this.y,2)<Math.pow(i,2)},draw:function(){if(this.display){var n=this.ctx;n.beginPath();n.arc(this.x,this.y,this.radius,0,Math.PI*2);n.closePath();n.strokeStyle=this.strokeColor;n.lineWidth=this.strokeWidth;n.fillStyle=this.fillColor;n.fill();n.stroke()}}});t.Arc=t.Element.extend({inRange:function(t,i){var r=n.getAngleFromPoint(this,{x:t,y:i}),u=r.angle>=this.startAngle&&r.angle<=this.endAngle,f=r.distance>=this.innerRadius&&r.distance<=this.outerRadius;return u&&f},tooltipPosition:function(){var n=this.startAngle+(this.endAngle-this.startAngle)/2,t=(this.outerRadius-this.innerRadius)/2+this.innerRadius;return{x:this.x+Math.cos(n)*t,y:this.y+Math.sin(n)*t}},draw:function(n){var i=n||1,t=this.ctx;t.beginPath();t.arc(this.x,this.y,this.outerRadius,this.startAngle,this.endAngle);t.arc(this.x,this.y,this.innerRadius,this.endAngle,this.startAngle,!0);t.closePath();t.strokeStyle=this.strokeColor;t.lineWidth=this.strokeWidth;t.fillStyle=this.fillColor;t.fill();t.lineJoin="bevel";this.showStroke&&t.stroke()}});t.Rectangle=t.Element.extend({draw:function(){var n=this.ctx,f=this.width/2,t=this.x-f,i=this.x+f,r=this.base-(this.base-this.y),u=this.strokeWidth/2;this.showStroke&&(t+=u,i-=u,r+=u);n.beginPath();n.fillStyle=this.fillColor;n.strokeStyle=this.strokeColor;n.lineWidth=this.strokeWidth;n.moveTo(t,this.base);n.lineTo(t,r);n.lineTo(i,r);n.lineTo(i,this.base);n.fill();this.showStroke&&n.stroke()},height:function(){return this.base-this.y},inRange:function(n,t){return n>=this.x-this.width/2&&n<=this.x+this.width/2&&t>=this.y&&t<=this.base}});t.Tooltip=t.Element.extend({draw:function(){var n=this.chart.ctx,r,u;n.font=e(this.fontSize,this.fontStyle,this.fontFamily);this.xAlign="center";this.yAlign="above";var t=2,i=n.measureText(this.text).width+2*this.xPadding,f=this.fontSize+2*this.yPadding,o=f+this.caretHeight+t;this.x+i/2>this.chart.width?this.xAlign="left":this.x-i/2<0&&(this.xAlign="right");this.y-o<0&&(this.yAlign="below");r=this.x-i/2;u=this.y-o;n.fillStyle=this.fillColor;switch(this.yAlign){case"above":n.beginPath();n.moveTo(this.x,this.y-t);n.lineTo(this.x+this.caretHeight,this.y-(t+this.caretHeight));n.lineTo(this.x-this.caretHeight,this.y-(t+this.caretHeight));n.closePath();n.fill();break;case"below":u=this.y+t+this.caretHeight;n.beginPath();n.moveTo(this.x,this.y+t);n.lineTo(this.x+this.caretHeight,this.y+t+this.caretHeight);n.lineTo(this.x-this.caretHeight,this.y+t+this.caretHeight);n.closePath();n.fill()}switch(this.xAlign){case"left":r=this.x-i+(this.cornerRadius+this.caretHeight);break;case"right":r=this.x-(this.cornerRadius+this.caretHeight)}d(n,r,u,i,f,this.cornerRadius);n.fill();n.fillStyle=this.textColor;n.textAlign="center";n.textBaseline="middle";n.fillText(this.text,r+i/2,u+f/2)}});t.MultiTooltip=t.Element.extend({initialize:function(){var n;this.font=e(this.fontSize,this.fontStyle,this.fontFamily);this.titleFont=e(this.titleFontSize,this.titleFontStyle,this.titleFontFamily);this.height=this.labels.length*this.fontSize+(this.labels.length-1)*(this.fontSize/2)+this.yPadding*2+this.titleFontSize*1.5;this.ctx.font=this.titleFont;var t=this.ctx.measureText(this.title).width,i=y(this.ctx,this.font,this.labels)+this.fontSize+3,r=c([i,t]);this.width=r+this.xPadding*2;n=this.height/2;this.y-n<0?this.y=n:this.y+n>this.chart.height&&(this.y=this.chart.height-n);this.x>this.chart.width/2?this.x-=this.xOffset+this.width:this.x+=this.xOffset},getLineHeight:function(n){var t=this.y-this.height/2+this.yPadding,i=n-1;return n===0?t+this.titleFontSize/2:t+(this.fontSize*1.5*i+this.fontSize/2)+this.titleFontSize*1.5},draw:function(){d(this.ctx,this.x,this.y-this.height/2,this.width,this.height,this.cornerRadius);var t=this.ctx;t.fillStyle=this.fillColor;t.fill();t.closePath();t.textAlign="left";t.textBaseline="middle";t.fillStyle=this.titleTextColor;t.font=this.titleFont;t.fillText(this.title,this.x+this.xPadding,this.getLineHeight(0));t.font=this.font;n.each(this.labels,function(n,i){t.fillStyle=this.textColor;t.fillText(n,this.x+this.xPadding+this.fontSize+3,this.getLineHeight(i+1));t.fillStyle=this.legendColorBackground;t.fillRect(this.x+this.xPadding,this.getLineHeight(i+1)-this.fontSize/2,this.fontSize,this.fontSize);t.fillStyle=this.legendColors[i].fill;t.fillRect(this.x+this.xPadding,this.getLineHeight(i+1)-this.fontSize/2,this.fontSize,this.fontSize)},this)}});t.Scale=t.Element.extend({initialize:function(){this.fit()},buildYLabels:function(){var t,n;for(this.yLabels=[],t=w(this.stepValue),n=0;n<=this.steps;n++)this.yLabels.push(f(this.templateString,{value:(this.min+n*this.stepValue).toFixed(t)}));this.yLabelWidth=this.display&&this.showLabels?y(this.ctx,this.font,this.yLabels):0},addXLabel:function(n){this.xLabels.push(n);this.valuesCount++;this.fit()},removeXLabel:function(){this.xLabels.shift();this.valuesCount--;this.fit()},fit:function(){this.startPoint=this.display?this.fontSize:0;this.endPoint=this.display?this.height-this.fontSize*1.5-5:this.height;this.startPoint+=this.padding;this.endPoint-=this.padding;var n=this.endPoint-this.startPoint,t;for(this.calculateYRange(n),this.buildYLabels(),this.calculateXLabelRotation();n>this.endPoint-this.startPoint;)n=this.endPoint-this.startPoint,t=this.yLabelWidth,this.calculateYRange(n),this.buildYLabels(),t<this.yLabelWidth&&this.calculateXLabelRotation()},calculateXLabelRotation:function(){var n,r,u,e,t,i,f;if(this.ctx.font=this.font,n=this.ctx.measureText(this.xLabels[0]).width,r=this.ctx.measureText(this.xLabels[this.xLabels.length-1]).width,this.xScalePaddingRight=r/2+3,this.xScalePaddingLeft=n/2>this.yLabelWidth+10?n/2:this.yLabelWidth+10,this.xLabelRotation=0,this.display){for(t=y(this.ctx,this.font,this.xLabels),this.xLabelWidth=t,f=Math.floor(this.calculateX(1)-this.calculateX(0))-6;this.xLabelWidth>f&&this.xLabelRotation===0||this.xLabelWidth>f&&this.xLabelRotation<=90&&this.xLabelRotation>0;)i=Math.cos(v(this.xLabelRotation)),u=i*n,e=i*r,u+this.fontSize/2>this.yLabelWidth+8&&(this.xScalePaddingLeft=u+this.fontSize/2),this.xScalePaddingRight=this.fontSize/2,this.xLabelRotation++,this.xLabelWidth=i*t;this.xLabelRotation>0&&(this.endPoint-=Math.sin(v(this.xLabelRotation))*t+3)}else this.xLabelWidth=0,this.xScalePaddingRight=this.padding,this.xScalePaddingLeft=this.padding},calculateYRange:a,drawingArea:function(){return this.startPoint-this.endPoint},calculateY:function(n){var t=this.drawingArea()/(this.min-this.max);return this.endPoint-t*(n-this.min)},calculateX:function(n){var u=this.xLabelRotation>0,r=this.width-(this.xScalePaddingLeft+this.xScalePaddingRight),t=r/(this.valuesCount-(this.offsetGridLines?0:1)),i=t*n+this.xScalePaddingLeft;return this.offsetGridLines&&(i+=t/2),Math.round(i)},update:function(t){n.extend(this,t);this.fit()},draw:function(){var t=this.ctx,u=(this.endPoint-this.startPoint)/this.steps,r=Math.round(this.xScalePaddingLeft);this.display&&(t.fillStyle=this.textColor,t.font=this.font,i(this.yLabels,function(i,f){var o=this.endPoint-u*f,e=Math.round(o);t.textAlign="right";t.textBaseline="middle";this.showLabels&&t.fillText(i,r-10,o);t.beginPath();f>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor);e+=n.aliasPixel(t.lineWidth);t.moveTo(r,e);t.lineTo(this.width,e);t.stroke();t.closePath();t.lineWidth=this.lineWidth;t.strokeStyle=this.lineColor;t.beginPath();t.moveTo(r-5,e);t.lineTo(r,e);t.stroke();t.closePath()},this),i(this.xLabels,function(n,i){var f=this.calculateX(i)+b(this.lineWidth),r=this.calculateX(i-(this.offsetGridLines?.5:0))+b(this.lineWidth),u=this.xLabelRotation>0;t.beginPath();i>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor);t.moveTo(r,this.endPoint);t.lineTo(r,this.startPoint-3);t.stroke();t.closePath();t.lineWidth=this.lineWidth;t.strokeStyle=this.lineColor;t.beginPath();t.moveTo(r,this.endPoint);t.lineTo(r,this.endPoint+5);t.stroke();t.closePath();t.save();t.translate(f,u?this.endPoint+12:this.endPoint+8);t.rotate(v(this.xLabelRotation)*-1);t.font=this.font;t.textAlign=u?"right":"center";t.textBaseline=u?"middle":"top";t.fillText(n,0,0);t.restore()},this))}});t.RadialScale=t.Element.extend({initialize:function(){this.size=o([this.height,this.width]);this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2},calculateCenterOffset:function(n){var t=this.drawingArea/(this.max-this.min);return(n-this.min)*t},update:function(){this.lineArc?this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2:this.setScaleSize();this.buildYLabels()},buildYLabels:function(){var t,n;for(this.yLabels=[],t=w(this.stepValue),n=0;n<=this.steps;n++)this.yLabels.push(f(this.templateString,{value:(this.min+n*this.stepValue).toFixed(t)}))},getCircumference:function(){return Math.PI*2/this.valuesCount},setScaleSize:function(){var y=o([this.height/2-this.pointLabelFontSize-5,this.width/2]),t,n,i,h,c=this.width,a,p,l=0,v,w,b,k,r,s;for(this.ctx.font=e(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),n=0;n<this.valuesCount;n++)t=this.getPointPosition(n,y),i=this.ctx.measureText(f(this.templateString,{value:this.labels[n]})).width+5,n===0||n===this.valuesCount/2?(h=i/2,t.x+h>c&&(c=t.x+h,a=n),t.x-h<l&&(l=t.x-h,v=n)):n<this.valuesCount/2?t.x+i>c&&(c=t.x+i,a=n):n>this.valuesCount/2&&t.x-i<l&&(l=t.x-i,v=n);b=l;k=Math.ceil(c-this.width);p=this.getIndexAngle(a);w=this.getIndexAngle(v);r=k/Math.sin(p+Math.PI/2);s=b/Math.sin(w+Math.PI/2);r=u(r)?r:0;s=u(s)?s:0;this.drawingArea=y-(s+r)/2;this.setCenterPoint(s,r)},setCenterPoint:function(n,t){var i=this.width-t-this.drawingArea,r=n+this.drawingArea;this.xCenter=(r+i)/2;this.yCenter=this.height/2},getIndexAngle:function(n){var t=Math.PI*2/this.valuesCount;return n*t-Math.PI/2},getPointPosition:function(n,t){var i=this.getIndexAngle(n);return{x:Math.cos(i)*t+this.xCenter,y:Math.sin(i)*t+this.yCenter}},draw:function(){var n,t,u,f;if(this.display&&(n=this.ctx,i(this.yLabels,function(t,i){var f,o,r,u,s;if(i>0){if(f=i*(this.drawingArea/this.steps),o=this.yCenter-f,this.lineWidth>0)if(n.strokeStyle=this.lineColor,n.lineWidth=this.lineWidth,this.lineArc)n.beginPath(),n.arc(this.xCenter,this.yCenter,f,0,Math.PI*2),n.closePath(),n.stroke();else{for(n.beginPath(),u=0;u<this.valuesCount;u++)r=this.getPointPosition(u,this.calculateCenterOffset(this.min+i*this.stepValue)),u===0?n.moveTo(r.x,r.y):n.lineTo(r.x,r.y);n.closePath();n.stroke()}this.showLabels&&(n.font=e(this.fontSize,this.fontStyle,this.fontFamily),this.showLabelBackdrop&&(s=n.measureText(t).width,n.fillStyle=this.backdropColor,n.fillRect(this.xCenter-s/2-this.backdropPaddingX,o-this.fontSize/2-this.backdropPaddingY,s+this.backdropPaddingX*2,this.fontSize+this.backdropPaddingY*2)),n.textAlign="center",n.textBaseline="middle",n.fillStyle=this.fontColor,n.fillText(t,this.xCenter,o))}},this),!this.lineArc))for(n.lineWidth=this.angleLineWidth,n.strokeStyle=this.angleLineColor,t=this.valuesCount-1;t>=0;t--){this.angleLineWidth>0&&(u=this.getPointPosition(t,this.calculateCenterOffset(this.max)),n.beginPath(),n.moveTo(this.xCenter,this.yCenter),n.lineTo(u.x,u.y),n.stroke(),n.closePath());f=this.getPointPosition(t,this.calculateCenterOffset(this.max)+5);n.font=e(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily);n.fillStyle=this.pointLabelFontColor;var s=this.labels.length,o=this.labels.length/2,r=o/2,h=t<r||t>s-r,c=t===r||t===s-r;n.textAlign=t===0?"center":t===o?"center":t<o?"left":"right";n.textBaseline=c?"middle":h?"bottom":"top";n.fillText(this.labels[t],f.x,f.y)}}});n.addEvent(window,"resize",function(){var n;return function(){clearTimeout(n);n=setTimeout(function(){i(t.instances,function(n){n.options.responsive&&n.resize(n.render,!0)})},50)}}());ut?define(function(){return t}):typeof module=="object"&&module.exports&&(module.exports=t);h.Chart=t;t.noConflict=function(){return h.Chart=g,t}}.call(this),function(){"use strict";var i=this,t=i.Chart,n=t.helpers;t.Type.extend({name:"Bar",defaults:{scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"><\/span><%if(datasets[i].label){%><%=datasets[i].label%><%}%><\/li><%}%><\/ul>'},initialize:function(i){var r=this.options;this.ScaleClass=t.Scale.extend({offsetGridLines:!0,calculateBarX:function(n,t,i){var f=this.calculateBaseWidth(),e=this.calculateX(i)-f/2,u=this.calculateBarWidth(n);return e+u*t+t*r.barDatasetSpacing+u/2},calculateBaseWidth:function(){return this.calculateX(1)-this.calculateX(0)-2*r.barValueSpacing},calculateBarWidth:function(n){var t=this.calculateBaseWidth()-(n-1)*r.barDatasetSpacing;return t/n}});this.datasets=[];this.options.showTooltips&&n.bindEvents(this,this.options.tooltipEvents,function(t){var i=t.type!=="mouseout"?this.getBarsAtEvent(t):[];this.eachBars(function(n){n.restore(["fillColor","strokeColor"])});n.each(i,function(n){n.fillColor=n.highlightFill;n.strokeColor=n.highlightStroke});this.showTooltip(i)});this.BarClass=t.Rectangle.extend({strokeWidth:this.options.barStrokeWidth,showStroke:this.options.barShowStroke,ctx:this.chart.ctx});n.each(i.datasets,function(t){var r={label:t.label||null,fillColor:t.fillColor,strokeColor:t.strokeColor,bars:[]};this.datasets.push(r);n.each(t.data,function(n,u){r.bars.push(new this.BarClass({value:n,label:i.labels[u],datasetLabel:t.label,strokeColor:t.strokeColor,fillColor:t.fillColor,highlightFill:t.highlightFill||t.fillColor,highlightStroke:t.highlightStroke||t.strokeColor}))},this)},this);this.buildScale(i.labels);this.BarClass.prototype.base=this.scale.endPoint;this.eachBars(function(t,i,r){n.extend(t,{width:this.scale.calculateBarWidth(this.datasets.length),x:this.scale.calculateBarX(this.datasets.length,r,i),y:this.scale.endPoint});t.save()},this);this.render()},update:function(){this.scale.update();n.each(this.activeElements,function(n){n.restore(["fillColor","strokeColor"])});this.eachBars(function(n){n.save()});this.render()},eachBars:function(t){n.each(this.datasets,function(i,r){n.each(i.bars,t,this,r)},this)},getBarsAtEvent:function(t){for(var u=[],f=n.getRelativePosition(t),e=function(n){u.push(n.bars[i])},i,r=0;r<this.datasets.length;r++)for(i=0;i<this.datasets[r].bars.length;i++)if(this.datasets[r].bars[i].inRange(f.x,f.y))return n.each(this.datasets,e),u;return u},buildScale:function(t){var r=this,u=function(){var n=[];return r.eachBars(function(t){n.push(t.value)}),n},i={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:t.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var i=n.calculateScaleRange(u(),t,this.fontSize,this.beginAtZero,this.integersOnly);n.extend(this,i)},xLabels:t,font:n.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.barShowStroke?this.options.barStrokeWidth:0,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&n.extend(i,{calculateYRange:n.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth});this.scale=new this.ScaleClass(i)},addData:function(t,i){n.each(t,function(n,t){this.datasets[t].bars.push(new this.BarClass({value:n,label:i,x:this.scale.calculateBarX(this.datasets.length,t,this.scale.valuesCount+1),y:this.scale.endPoint,width:this.scale.calculateBarWidth(this.datasets.length),base:this.scale.endPoint,strokeColor:this.datasets[t].strokeColor,fillColor:this.datasets[t].fillColor}))},this);this.scale.addXLabel(i);this.update()},removeData:function(){this.scale.removeXLabel();n.each(this.datasets,function(n){n.bars.shift()},this);this.update()},reflow:function(){n.extend(this.BarClass.prototype,{y:this.scale.endPoint,base:this.scale.endPoint});var t=n.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var i=t||1,r;this.clear();r=this.chart.ctx;this.scale.draw(i);n.each(this.datasets,function(t,r){n.each(t.bars,function(n,t){n.hasValue()&&(n.base=this.scale.endPoint,n.transition({x:this.scale.calculateBarX(this.datasets.length,r,t),y:this.scale.calculateY(n.value),width:this.scale.calculateBarWidth(this.datasets.length)},i).draw())},this)},this)}})}.call(this),function(){"use strict";var r=this,t=r.Chart,n=t.helpers,i={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"><\/span><%if(segments[i].label){%><%=segments[i].label%><%}%><\/li><%}%><\/ul>'};t.Type.extend({name:"Doughnut",defaults:i,initialize:function(i){this.segments=[];this.outerRadius=(n.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2;this.SegmentArc=t.Arc.extend({ctx:this.chart.ctx,x:this.chart.width/2,y:this.chart.height/2});this.options.showTooltips&&n.bindEvents(this,this.options.tooltipEvents,function(t){var i=t.type!=="mouseout"?this.getSegmentsAtEvent(t):[];n.each(this.segments,function(n){n.restore(["fillColor"])});n.each(i,function(n){n.fillColor=n.highlightColor});this.showTooltip(i)});this.calculateTotal(i);n.each(i,function(n,t){this.addData(n,t,!0)},this);this.render()},getSegmentsAtEvent:function(t){var i=[],r=n.getRelativePosition(t);return n.each(this.segments,function(n){n.inRange(r.x,r.y)&&i.push(n)},this),i},addData:function(n,t,i){var r=t||this.segments.length;this.segments.splice(r,0,new this.SegmentArc({value:n.value,outerRadius:this.options.animateScale?0:this.outerRadius,innerRadius:this.options.animateScale?0:this.outerRadius/100*this.options.percentageInnerCutout,fillColor:n.color,highlightColor:n.highlight||n.color,showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,startAngle:Math.PI*1.5,circumference:this.options.animateRotate?0:this.calculateCircumference(n.value),label:n.label}));i||(this.reflow(),this.update())},calculateCircumference:function(n){return Math.PI*2*(n/this.total)},calculateTotal:function(t){this.total=0;n.each(t,function(n){this.total+=n.value},this)},update:function(){this.calculateTotal(this.segments);n.each(this.activeElements,function(n){n.restore(["fillColor"])});n.each(this.segments,function(n){n.save()});this.render()},removeData:function(t){var i=n.isNumber(t)?t:this.segments.length-1;this.segments.splice(i,1);this.reflow();this.update()},reflow:function(){n.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2});this.outerRadius=(n.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2;n.each(this.segments,function(n){n.update({outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout})},this)},draw:function(t){var i=t?t:1;this.clear();n.each(this.segments,function(n,t){n.transition({circumference:this.calculateCircumference(n.value),outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout},i);n.endAngle=n.startAngle+n.circumference;n.draw();t===0&&(n.startAngle=Math.PI*1.5);t<this.segments.length-1&&(this.segments[t+1].startAngle=n.endAngle)},this)}});t.types.Doughnut.extend({name:"Pie",defaults:n.merge(i,{percentageInnerCutout:0})})}.call(this),function(){"use strict";var i=this,t=i.Chart,n=t.helpers;t.Type.extend({name:"Line",defaults:{scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"><\/span><%if(datasets[i].label){%><%=datasets[i].label%><%}%><\/li><%}%><\/ul>'},initialize:function(i){this.PointClass=t.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx,inRange:function(n){return Math.pow(n-this.x,2)<Math.pow(this.radius+this.hitDetectionRadius,2)}});this.datasets=[];this.options.showTooltips&&n.bindEvents(this,this.options.tooltipEvents,function(t){var i=t.type!=="mouseout"?this.getPointsAtEvent(t):[];this.eachPoints(function(n){n.restore(["fillColor","strokeColor"])});n.each(i,function(n){n.fillColor=n.highlightFill;n.strokeColor=n.highlightStroke});this.showTooltip(i)});n.each(i.datasets,function(t){var r={label:t.label||null,fillColor:t.fillColor,strokeColor:t.strokeColor,pointColor:t.pointColor,pointStrokeColor:t.pointStrokeColor,points:[]};this.datasets.push(r);n.each(t.data,function(n,u){r.points.push(new this.PointClass({value:n,label:i.labels[u],datasetLabel:t.label,strokeColor:t.pointStrokeColor,fillColor:t.pointColor,highlightFill:t.pointHighlightFill||t.pointColor,highlightStroke:t.pointHighlightStroke||t.pointStrokeColor}))},this);this.buildScale(i.labels);this.eachPoints(function(t,i){n.extend(t,{x:this.scale.calculateX(i),y:this.scale.endPoint});t.save()},this)},this);this.render()},update:function(){this.scale.update();n.each(this.activeElements,function(n){n.restore(["fillColor","strokeColor"])});this.eachPoints(function(n){n.save()});this.render()},eachPoints:function(t){n.each(this.datasets,function(i){n.each(i.points,t,this)},this)},getPointsAtEvent:function(t){var i=[],r=n.getRelativePosition(t);return n.each(this.datasets,function(t){n.each(t.points,function(n){n.inRange(r.x,r.y)&&i.push(n)})},this),i},buildScale:function(i){var u=this,f=function(){var n=[];return u.eachPoints(function(t){n.push(t.value)}),n},r={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:i.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var i=n.calculateScaleRange(f(),t,this.fontSize,this.beginAtZero,this.integersOnly);n.extend(this,i)},xLabels:i,font:n.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.pointDotRadius+this.options.pointDotStrokeWidth,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&n.extend(r,{calculateYRange:n.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth});this.scale=new t.Scale(r)},addData:function(t,i){n.each(t,function(n,t){this.datasets[t].points.push(new this.PointClass({value:n,label:i,x:this.scale.calculateX(this.scale.valuesCount+1),y:this.scale.endPoint,strokeColor:this.datasets[t].pointStrokeColor,fillColor:this.datasets[t].pointColor}))},this);this.scale.addXLabel(i);this.update()},removeData:function(){this.scale.removeXLabel();n.each(this.datasets,function(n){n.points.shift()},this);this.update()},reflow:function(){var t=n.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var u=t||1;this.clear();var i=this.chart.ctx,r=function(n){return n.value!==null},e=function(t,i,u){return n.findNextWhere(i,r,u)||t},f=function(t,i,u){return n.findPreviousWhere(i,r,u)||t};this.scale.draw(u);n.each(this.datasets,function(t){var o=n.where(t.points,r);n.each(t.points,function(n,t){n.hasValue()&&n.transition({y:this.scale.calculateY(n.value),x:this.scale.calculateX(t)},u)},this);this.options.bezierCurve&&n.each(o,function(t,i){var r=i>0&&i<o.length-1?this.options.bezierCurveTension:0;t.controlPoints=n.splineCurve(f(t,o,i),t,e(t,o,i),r);t.controlPoints.outer.y>this.scale.endPoint?t.controlPoints.outer.y=this.scale.endPoint:t.controlPoints.outer.y<this.scale.startPoint&&(t.controlPoints.outer.y=this.scale.startPoint);t.controlPoints.inner.y>this.scale.endPoint?t.controlPoints.inner.y=this.scale.endPoint:t.controlPoints.inner.y<this.scale.startPoint&&(t.controlPoints.inner.y=this.scale.startPoint)},this);i.lineWidth=this.options.datasetStrokeWidth;i.strokeStyle=t.strokeColor;i.beginPath();n.each(o,function(n,t){if(t===0)i.moveTo(n.x,n.y);else if(this.options.bezierCurve){var r=f(n,o,t);i.bezierCurveTo(r.controlPoints.outer.x,r.controlPoints.outer.y,n.controlPoints.inner.x,n.controlPoints.inner.y,n.x,n.y)}else i.lineTo(n.x,n.y)},this);i.stroke();this.options.datasetFill&&o.length>0&&(i.lineTo(o[o.length-1].x,this.scale.endPoint),i.lineTo(o[0].x,this.scale.endPoint),i.fillStyle=t.fillColor,i.closePath(),i.fill());n.each(o,function(n){n.draw()})},this)}})}.call(this),function(){"use strict";var i=this,t=i.Chart,n=t.helpers;t.Type.extend({name:"PolarArea",defaults:{scaleShowLabelBackdrop:!0,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBeginAtZero:!0,scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,scaleShowLine:!0,segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"><\/span><%if(segments[i].label){%><%=segments[i].label%><%}%><\/li><%}%><\/ul>'},initialize:function(i){this.segments=[];this.SegmentArc=t.Arc.extend({showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,ctx:this.chart.ctx,innerRadius:0,x:this.chart.width/2,y:this.chart.height/2});this.scale=new t.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,lineArc:!0,width:this.chart.width,height:this.chart.height,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,valuesCount:i.length});this.updateScaleRange(i);this.scale.update();n.each(i,function(n,t){this.addData(n,t,!0)},this);this.options.showTooltips&&n.bindEvents(this,this.options.tooltipEvents,function(t){var i=t.type!=="mouseout"?this.getSegmentsAtEvent(t):[];n.each(this.segments,function(n){n.restore(["fillColor"])});n.each(i,function(n){n.fillColor=n.highlightColor});this.showTooltip(i)});this.render()},getSegmentsAtEvent:function(t){var i=[],r=n.getRelativePosition(t);return n.each(this.segments,function(n){n.inRange(r.x,r.y)&&i.push(n)},this),i},addData:function(n,t,i){var r=t||this.segments.length;this.segments.splice(r,0,new this.SegmentArc({fillColor:n.color,highlightColor:n.highlight||n.color,label:n.label,value:n.value,outerRadius:this.options.animateScale?0:this.scale.calculateCenterOffset(n.value),circumference:this.options.animateRotate?0:this.scale.getCircumference(),startAngle:Math.PI*1.5}));i||(this.reflow(),this.update())},removeData:function(t){var i=n.isNumber(t)?t:this.segments.length-1;this.segments.splice(i,1);this.reflow();this.update()},calculateTotal:function(t){this.total=0;n.each(t,function(n){this.total+=n.value},this);this.scale.valuesCount=this.segments.length},updateScaleRange:function(t){var i=[],r;n.each(t,function(n){i.push(n.value)});r=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:n.calculateScaleRange(i,n.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);n.extend(this.scale,r,{size:n.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2})},update:function(){this.calculateTotal(this.segments);n.each(this.segments,function(n){n.save()});this.render()},reflow:function(){n.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2});this.updateScaleRange(this.segments);this.scale.update();n.extend(this.scale,{xCenter:this.chart.width/2,yCenter:this.chart.height/2});n.each(this.segments,function(n){n.update({outerRadius:this.scale.calculateCenterOffset(n.value)})},this)},draw:function(t){var i=t||1;this.clear();n.each(this.segments,function(n,t){n.transition({circumference:this.scale.getCircumference(),outerRadius:this.scale.calculateCenterOffset(n.value)},i);n.endAngle=n.startAngle+n.circumference;t===0&&(n.startAngle=Math.PI*1.5);t<this.segments.length-1&&(this.segments[t+1].startAngle=n.endAngle);n.draw()},this);this.scale.draw()}})}.call(this),function(){"use strict";var i=this,t=i.Chart,n=t.helpers;t.Type.extend({name:"Radar",defaults:{scaleShowLine:!0,angleShowLineOut:!0,scaleShowLabels:!1,scaleBeginAtZero:!0,angleLineColor:"rgba(0,0,0,.1)",angleLineWidth:1,pointLabelFontFamily:"'Arial'",pointLabelFontStyle:"normal",pointLabelFontSize:10,pointLabelFontColor:"#666",pointDot:!0,pointDotRadius:3,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"><\/span><%if(datasets[i].label){%><%=datasets[i].label%><%}%><\/li><%}%><\/ul>'},initialize:function(i){this.PointClass=t.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx});this.datasets=[];this.buildScale(i);this.options.showTooltips&&n.bindEvents(this,this.options.tooltipEvents,function(t){var i=t.type!=="mouseout"?this.getPointsAtEvent(t):[];this.eachPoints(function(n){n.restore(["fillColor","strokeColor"])});n.each(i,function(n){n.fillColor=n.highlightFill;n.strokeColor=n.highlightStroke});this.showTooltip(i)});n.each(i.datasets,function(t){var r={label:t.label||null,fillColor:t.fillColor,strokeColor:t.strokeColor,pointColor:t.pointColor,pointStrokeColor:t.pointStrokeColor,points:[]};this.datasets.push(r);n.each(t.data,function(n,u){var f;this.scale.animation||(f=this.scale.getPointPosition(u,this.scale.calculateCenterOffset(n)));r.points.push(new this.PointClass({value:n,label:i.labels[u],datasetLabel:t.label,x:this.options.animation?this.scale.xCenter:f.x,y:this.options.animation?this.scale.yCenter:f.y,strokeColor:t.pointStrokeColor,fillColor:t.pointColor,highlightFill:t.pointHighlightFill||t.pointColor,highlightStroke:t.pointHighlightStroke||t.pointStrokeColor}))},this)},this);this.render()},eachPoints:function(t){n.each(this.datasets,function(i){n.each(i.points,t,this)},this)},getPointsAtEvent:function(t){var f=n.getRelativePosition(t),r=n.getAngleFromPoint({x:this.scale.xCenter,y:this.scale.yCenter},f),e=Math.PI*2/this.scale.valuesCount,i=Math.round((r.angle-Math.PI*1.5)/e),u=[];return(i>=this.scale.valuesCount||i<0)&&(i=0),r.distance<=this.scale.drawingArea&&n.each(this.datasets,function(n){u.push(n.points[i])}),u},buildScale:function(n){this.scale=new t.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,angleLineColor:this.options.angleLineColor,angleLineWidth:this.options.angleShowLineOut?this.options.angleLineWidth:0,pointLabelFontColor:this.options.pointLabelFontColor,pointLabelFontSize:this.options.pointLabelFontSize,pointLabelFontFamily:this.options.pointLabelFontFamily,pointLabelFontStyle:this.options.pointLabelFontStyle,height:this.chart.height,width:this.chart.width,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,labels:n.labels,valuesCount:n.datasets[0].data.length});this.scale.setScaleSize();this.updateScaleRange(n.datasets);this.scale.buildYLabels()},updateScaleRange:function(t){var i=function(){var i=[];return n.each(t,function(t){t.data?i=i.concat(t.data):n.each(t.points,function(n){i.push(n.value)})}),i}(),r=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:n.calculateScaleRange(i,n.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);n.extend(this.scale,r)},addData:function(t,i){this.scale.valuesCount++;n.each(t,function(n,t){var r=this.scale.getPointPosition(this.scale.valuesCount,this.scale.calculateCenterOffset(n));this.datasets[t].points.push(new this.PointClass({value:n,label:i,x:r.x,y:r.y,strokeColor:this.datasets[t].pointStrokeColor,fillColor:this.datasets[t].pointColor}))},this);this.scale.labels.push(i);this.reflow();this.update()},removeData:function(){this.scale.valuesCount--;this.scale.labels.shift();n.each(this.datasets,function(n){n.points.shift()},this);this.reflow();this.update()},update:function(){this.eachPoints(function(n){n.save()});this.reflow();this.render()},reflow:function(){n.extend(this.scale,{width:this.chart.width,height:this.chart.height,size:n.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2});this.updateScaleRange(this.datasets);this.scale.setScaleSize();this.scale.buildYLabels()},draw:function(t){var r=t||1,i=this.chart.ctx;this.clear();this.scale.draw();n.each(this.datasets,function(t){n.each(t.points,function(n,t){n.hasValue()&&n.transition(this.scale.getPointPosition(t,this.scale.calculateCenterOffset(n.value)),r)},this);i.lineWidth=this.options.datasetStrokeWidth;i.strokeStyle=t.strokeColor;i.beginPath();n.each(t.points,function(n,t){t===0?i.moveTo(n.x,n.y):i.lineTo(n.x,n.y)},this);i.closePath();i.stroke();i.fillStyle=t.fillColor;i.fill();n.each(t.points,function(n){n.hasValue()&&n.draw()})},this)}})}.call(this);Mailcheck={domainThreshold:4,topLevelThreshold:3,defaultDomains:"yahoo.com google.com hotmail.com gmail.com me.com aol.com mac.com live.com comcast.net googlemail.com msn.com hotmail.co.uk yahoo.co.uk facebook.com verizon.net sbcglobal.net att.net gmx.com mail.com outlook.com icloud.com".split(" "),defaultTopLevelDomains:"co.jp co.uk com net org info edu gov mil ca dk se it".split(" "),run:function(n){n.domains=n.domains||Mailcheck.defaultDomains;n.topLevelDomains=n.topLevelDomains||Mailcheck.defaultTopLevelDomains;n.distanceFunction=n.distanceFunction||Mailcheck.sift3Distance;var t=function(n){return n},i=n.suggested||t,t=n.empty||t;return(n=Mailcheck.suggest(Mailcheck.encodeEmail(n.email),n.domains,n.topLevelDomains,n.distanceFunction))?i(n):t()},suggest:function(n,t,i,r){if(n=n.toLowerCase(),n=this.splitEmail(n),t=this.findClosestDomain(n.domain,t,r,this.domainThreshold)){if(t!=n.domain)return{address:n.address,domain:t,full:n.address+"@"+t}}else if(i=this.findClosestDomain(n.topLevelDomain,i,r,this.topLevelThreshold),n.domain&&i&&i!=n.topLevelDomain)return r=n.domain,t=r.substring(0,r.lastIndexOf(n.topLevelDomain))+i,{address:n.address,domain:t,full:n.address+"@"+t};return!1},findClosestDomain:function(n,t,i,r){var o,f,e,u;if(r=r||this.topLevelThreshold,f=99,e=null,!n||!t)return!1;for(i||(i=this.sift3Distance),u=0;u<t.length;u++){if(n===t[u])return n;o=i(n,t[u]);o<f&&(f=o,e=t[u])}return f<=r&&null!==e?e:!1},sift3Distance:function(n,t){var r;if(null==n||0===n.length)return null==t||0===t.length?0:t.length;if(null==t||0===t.length)return n.length;for(var i=0,u=0,f=0,e=0;i+u<n.length&&i+f<t.length;){if(n.charAt(i+u)==t.charAt(i+f))e++;else for(r=f=u=0;5>r;r++){if(i+r<n.length&&n.charAt(i+r)==t.charAt(i)){u=r;break}if(i+r<t.length&&n.charAt(i)==t.charAt(i+r)){f=r;break}}i++}return(n.length+t.length)/2-e},splitEmail:function(n){var t;if(n=n.trim().split("@"),2>n.length)return!1;for(t=0;t<n.length;t++)if(""===n[t])return!1;var u=n.pop(),i=u.split("."),r="";if(0==i.length)return!1;if(1==i.length)r=i[0];else{for(t=1;t<i.length;t++)r+=i[t]+".";2<=i.length&&(r=r.substring(0,r.length-1))}return{topLevelDomain:r,domain:u,address:n.join("@")}},encodeEmail:function(n){return n=encodeURI(n),n.replace("%20"," ").replace("%25","%").replace("%5E","^").replace("%60","`").replace("%7B","{").replace("%7C","|").replace("%7D","}")}};"undefined"!=typeof module&&module.exports&&(module.exports=Mailcheck);"undefined"!=typeof window&&window.jQuery&&function(n){n.fn.mailcheck=function(n){var t=this,i,r;n.suggested&&(i=n.suggested,n.suggested=function(n){i(t,n)});n.empty&&(r=n.empty,n.empty=function(){r.call(null,t)});n.email=this.val();Mailcheck.run(n)}}(jQuery);jQuery(document).ready(function(){jQuery(".tabs .tab-links a").on("click",function(n){var i=jQuery(this).attr("href"),f=$(".tab").first(),t=$(".tabs "+i),r=f.height(),u;jQuery(".tabs "+i).show().siblings().hide();t.css("height","auto");u=t.height();u<=r?t.height(r):t.css("height","auto");jQuery(this).parent("li").addClass("active").siblings().removeClass("active");n.preventDefault()})}),function(n){var t={isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(n){return!n||/^\s*$/.test(n)},escapeRegExChars:function(n){return n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(n){return typeof n=="string"},isNumber:function(n){return typeof n=="number"},isArray:n.isArray,isFunction:n.isFunction,isObject:n.isPlainObject,isUndefined:function(n){return typeof n=="undefined"},bind:n.proxy,each:function(t,i){function r(n,t){return i(t,n)}n.each(t,r)},map:n.map,filter:n.grep,every:function(t,i){var r=!0;return t?(n.each(t,function(n,u){if(!(r=i.call(null,u,n,t)))return!1}),!!r):r},some:function(t,i){var r=!1;return t?(n.each(t,function(n,u){if(r=i.call(null,u,n,t))return!1}),!!r):r},mixin:n.extend,getUniqueId:function(){var n=0;return function(){return n++}}(),templatify:function(t){function i(){return String(t)}return n.isFunction(t)?t:i},defer:function(n){setTimeout(n,0)},debounce:function(n,t,i){var r,u;return function(){var f=this,e=arguments,o,s;return o=function(){r=null;i||(u=n.apply(f,e))},s=i&&!r,clearTimeout(r),r=setTimeout(o,t),s&&(u=n.apply(f,e)),u}},throttle:function(n,t){var u,f,i,e,r,o;return r=0,o=function(){r=new Date;i=null;e=n.apply(u,f)},function(){var s=new Date,h=t-(s-r);return u=this,f=arguments,h<=0?(clearTimeout(i),i=null,r=s,e=n.apply(u,f)):i||(i=setTimeout(o,h)),e}},noop:function(){}},l="0.10.2",a=function(){function n(n){return n.split(/\s+/)}function t(n){return n.split(/\W+/)}function i(n){return function(t){return function(i){return n(i[t])}}}return{nonword:t,whitespace:n,obj:{nonword:i(t),whitespace:i(n)}}}(),o=function(){function n(n){this.maxSize=n||100;this.size=0;this.hash={};this.list=new i}function i(){this.head=this.tail=null}function r(n,t){this.key=n;this.val=t;this.prev=this.next=null}return t.mixin(n.prototype,{set:function(n,t){var u=this.list.tail,i;this.size>=this.maxSize&&(this.list.remove(u),delete this.hash[u.key]);(i=this.hash[n])?(i.val=t,this.list.moveToFront(i)):(i=new r(n,t),this.list.add(i),this.hash[n]=i,this.size++)},get:function(n){var t=this.hash[n];if(t)return this.list.moveToFront(t),t.val}}),t.mixin(i.prototype,{add:function(n){this.head&&(n.next=this.head,this.head.prev=n);this.head=n;this.tail=this.tail||n},remove:function(n){n.prev?n.prev.next=n.next:this.head=n.next;n.next?n.next.prev=n.prev:this.tail=n.prev},moveToFront:function(n){this.remove(n);this.add(n)}}),n}(),v=function(){function r(n){this.prefix=["__",n,"__"].join("");this.ttlKey="__ttl__";this.keyMatcher=new RegExp("^"+this.prefix)}function u(){return(new Date).getTime()}function f(n){return JSON.stringify(t.isUndefined(n)?null:n)}function e(n){return JSON.parse(n)}var n,i;try{n=window.localStorage;n.setItem("~~~","!");n.removeItem("~~~")}catch(o){n=null}return i=n&&window.JSON?{_prefix:function(n){return this.prefix+n},_ttlKey:function(n){return this._prefix(n)+this.ttlKey},get:function(t){return this.isExpired(t)&&this.remove(t),e(n.getItem(this._prefix(t)))},set:function(i,r,e){return t.isNumber(e)?n.setItem(this._ttlKey(i),f(u()+e)):n.removeItem(this._ttlKey(i)),n.setItem(this._prefix(i),f(r))},remove:function(t){return n.removeItem(this._ttlKey(t)),n.removeItem(this._prefix(t)),this},clear:function(){for(var r,i=[],u=n.length,t=0;t<u;t++)(r=n.key(t)).match(this.keyMatcher)&&i.push(r.replace(this.keyMatcher,""));for(t=i.length;t--;)this.remove(i[t]);return this},isExpired:function(i){var r=e(n.getItem(this._ttlKey(i)));return t.isNumber(r)&&u()>r?!0:!1}}:{get:t.noop,set:t.noop,remove:t.noop,clear:t.noop,isExpired:t.noop},t.mixin(r.prototype,i),r}(),s=function(){function i(t){t=t||{};this._send=t.transport?s(t.transport):n.ajax;this._get=t.rateLimiter?t.rateLimiter(this._get):this._get}function s(i){return function(r,u){function e(n){t.defer(function(){f.resolve(n)})}function o(n){t.defer(function(){f.reject(n)})}var f=n.Deferred();return i(r,u,e,o),f}}var r=0,u={},e=6,f=new o(10);return i.setMaxPendingRequests=function(n){e=n},i.resetCache=function(){f=new o(10)},t.mixin(i.prototype,{_get:function(n,t,i){function h(t){i&&i(null,t);f.set(n,t)}function c(){i&&i(!0)}function l(){r--;delete u[n];o.onDeckRequestArgs&&(o._get.apply(o,o.onDeckRequestArgs),o.onDeckRequestArgs=null)}var o=this,s;(s=u[n])?s.done(h).fail(c):r<e?(r++,u[n]=this._send(n,t).done(h).fail(c).always(l)):this.onDeckRequestArgs=[].slice.call(arguments,0)},get:function(n,i,r){var u;return t.isFunction(i)&&(r=i,i={}),(u=f.get(n))?t.defer(function(){r&&r(null,u)}):this._get(n,i,r),!!u}}),i}(),y=function(){function i(t){t=t||{};t.datumTokenizer&&t.queryTokenizer||n.error("datumTokenizer and queryTokenizer are both required");this.datumTokenizer=t.datumTokenizer;this.queryTokenizer=t.queryTokenizer;this.reset()}function r(n){return n=t.filter(n,function(n){return!!n}),t.map(n,function(n){return n.toLowerCase()})}function u(){return{ids:[],children:{}}}function f(n){for(var i={},r=[],t=0;t<n.length;t++)i[n[t]]||(i[n[t]]=!0,r.push(n[t]));return r}function e(n,t){function f(n,t){return n-t}var i=0,r=0,u=[];for(n=n.sort(f),t=t.sort(f);i<n.length&&r<t.length;)n[i]<t[r]?i++:n[i]>t[r]?r++:(u.push(n[i]),i++,r++);return u}return t.mixin(i.prototype,{bootstrap:function(n){this.datums=n.datums;this.trie=n.trie},add:function(n){var i=this;n=t.isArray(n)?n:[n];t.each(n,function(n){var f,e;f=i.datums.push(n)-1;e=r(i.datumTokenizer(n));t.each(e,function(n){for(var r,t=i.trie,e=n.split("");r=e.shift();)t=t.children[r]||(t.children[r]=u()),t.ids.push(f)})})},get:function(n){var u=this,o,i;return o=r(this.queryTokenizer(n)),t.each(o,function(n){var t,r,o,f;if(i&&i.length===0)return!1;for(t=u.trie,r=n.split("");t&&(o=r.shift());)t=t.children[o];if(t&&r.length===0)f=t.ids.slice(0),i=i?e(i,f):f;else return i=[],!1}),i?t.map(f(i),function(n){return u.datums[n]}):[]},reset:function(){this.datums=[];this.trie=u()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),i}(),f=function(){function i(n){return n.local||null}function r(i){var r,u;return u={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(r=i.prefetch||null)&&(r=t.isString(r)?{url:r}:r,r=t.mixin(u,r),r.thumbprint=l+r.thumbprint,r.ajax.type=r.ajax.type||"GET",r.ajax.dataType=r.ajax.dataType||"json",r.url||n.error("prefetch requires url to be set")),r}function u(i){function f(n){return function(i){return t.debounce(i,n)}}function e(n){return function(i){return t.throttle(i,n)}}var r,u;return u={url:null,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(r=i.remote||null)&&(r=t.isString(r)?{url:r}:r,r=t.mixin(u,r),r.rateLimiter=/^throttle$/i.test(r.rateLimitBy)?e(r.rateLimitWait):f(r.rateLimitWait),r.ajax.type=r.ajax.type||"GET",r.ajax.dataType=r.ajax.dataType||"json",delete r.rateLimitBy,delete r.rateLimitWait,r.url||n.error("remote requires url to be set")),r}return{local:i,prefetch:r,remote:u}}(),r,i;(function(i){function u(t){t&&(t.local||t.prefetch||t.remote)||n.error("one of local, prefetch, or remote is required");this.limit=t.limit||5;this.sorter=o(t.sorter);this.dupDetector=t.dupDetector||h;this.local=f.local(t);this.prefetch=f.prefetch(t);this.remote=f.remote(t);this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null;this.index=new y({datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer});this.storage=this.cacheKey?new v(this.cacheKey):null}function o(n){function i(t){return t.sort(n)}function r(n){return n}return t.isFunction(n)?i:r}function h(){return!1}var e,r;return e=i.Bloodhound,r={data:"data",protocol:"protocol",thumbprint:"thumbprint"},i.Bloodhound=u,u.noConflict=function(){return i.Bloodhound=e,u},u.tokenizers=a,t.mixin(u.prototype,{_loadPrefetch:function(t){function f(n){i.clear();i.add(t.filter?t.filter(n):n);i._saveToStorage(i.index.serialize(),t.thumbprint,t.ttl)}var i=this,u,r;return(u=this._readFromStorage(t.thumbprint))?(this.index.bootstrap(u),r=n.Deferred().resolve()):r=n.ajax(t.url,t.ajax).done(f),r},_getFromRemote:function(n,t){function f(n,r){n?t([]):t(i.remote.filter?i.remote.filter(r):r)}var i=this,r,u;return n=n||"",u=encodeURIComponent(n),r=this.remote.replace?this.remote.replace(this.remote.url,n):this.remote.url.replace(this.remote.wildcard,u),this.transport.get(r,this.remote.ajax,f)},_saveToStorage:function(n,t,i){this.storage&&(this.storage.set(r.data,n,i),this.storage.set(r.protocol,location.protocol,i),this.storage.set(r.thumbprint,t,i))},_readFromStorage:function(n){var t={},i;return this.storage&&(t.data=this.storage.get(r.data),t.protocol=this.storage.get(r.protocol),t.thumbprint=this.storage.get(r.thumbprint)),i=t.thumbprint!==n||t.protocol!==location.protocol,t.data&&!i?t.data:null},_initialize:function(){function f(){u.add(t.isFunction(i)?i():i)}var u=this,i=this.local,r;return r=this.prefetch?this._loadPrefetch(this.prefetch):n.Deferred().resolve(),i&&r.done(f),this.transport=this.remote?new s(this.remote):null,this.initPromise=r.promise()},initialize:function(n){return!this.initPromise||n?this._initialize():this.initPromise},add:function(n){this.index.add(n)},get:function(n,i){function e(n){var f=r.slice(0);t.each(n,function(n){var i;return i=t.some(f,function(t){return u.dupDetector(n,t)}),i||f.push(n),f.length<u.limit});i&&i(u.sorter(f))}var u=this,r=[],f=!1;r=this.index.get(n);r=this.sorter(r).slice(0,this.limit);r.length<this.limit&&this.transport&&(f=this._getFromRemote(n,e));f||(r.length>0||!this.transport)&&i&&i(r)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&s.resetCache()},ttAdapter:function(){return t.bind(this.get,this)}}),u})(this);r={wrapper:'<span class="twitter-typeahead"><\/span>',dropdown:'<span class="tt-dropdown-menu"><\/span>',dataset:'<div class="tt-dataset-%CLASS%"><\/div>',suggestions:'<span class="tt-suggestions"><\/span>',suggestion:'<div class="tt-suggestion"><\/div>'};i={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};t.isMsie()&&t.mixin(i.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"});t.isMsie()&&t.isMsie()<=7&&t.mixin(i.input,{marginTop:"-1px"});var h=function(){function i(t){t&&t.el||n.error("EventBus initialized without el");this.$el=n(t.el)}var r="typeahead:";return t.mixin(i.prototype,{trigger:function(n){var t=[].slice.call(arguments,1);this.$el.trigger(r+n,t)}}),i}(),e=function(){function t(t,i,r,u){var f;if(!r)return this;for(i=i.split(n),r=u?h(r,u):r,this._callbacks=this._callbacks||{};f=i.shift();)this._callbacks[f]=this._callbacks[f]||{sync:[],async:[]},this._callbacks[f][t].push(r);return this}function u(n,i,r){return t.call(this,"async",n,i,r)}function f(n,i,r){return t.call(this,"sync",n,i,r)}function e(t){var i;if(!this._callbacks)return this;for(t=t.split(n);i=t.shift();)delete this._callbacks[i];return this}function o(t){var u,f,e,o,s;if(!this._callbacks)return this;for(t=t.split(n),e=[].slice.call(arguments,1);(u=t.shift())&&(f=this._callbacks[u]);)o=i(f.sync,this,[u].concat(e)),s=i(f.async,this,[u].concat(e)),o()&&r(s);return this}function i(n,t,i){function r(){for(var u,r=0;!u&&r<n.length;r+=1)u=n[r].apply(t,i)===!1;return!u}return r}function s(){return window.setImmediate?function(n){setImmediate(function(){n()})}:function(n){setTimeout(function(){n()},0)}}function h(n,t){return n.bind?n.bind(t):function(){n.apply(t,[].slice.call(arguments,0))}}var n=/\s+/,r=s();return{onSync:f,onAsync:u,off:e,trigger:o}}(),p=function(n){function r(n,i,r){for(var f=[],e,u=0;u<n.length;u++)f.push(t.escapeRegExChars(n[u]));return e=r?"\\b("+f.join("|")+")\\b":"("+f.join("|")+")",i?new RegExp(e):new RegExp(e,"i")}var i={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(u){function o(t){var i,r;return(i=f.exec(t.data))&&(wrapperNode=n.createElement(u.tagName),u.className&&(wrapperNode.className=u.className),r=t.splitText(i.index),r.splitText(i[0].length),wrapperNode.appendChild(r.cloneNode(!0)),t.parentNode.replaceChild(wrapperNode,r)),!!i}function e(n,t){for(var r,i=0;i<n.childNodes.length;i++)r=n.childNodes[i],r.nodeType===3?i+=t(r)?1:0:e(r,t)}var f;(u=t.mixin({},i,u),u.node&&u.pattern)&&(u.pattern=t.isArray(u.pattern)?u.pattern:[u.pattern],f=r(u.pattern,u.caseSensitive,u.wordsOnly),e(u.node,o))}}(window.document),c=function(){function i(i){var u=this,e,o,s,h;if(i=i||{},i.input||n.error("input is missing"),e=t.bind(this._onBlur,this),o=t.bind(this._onFocus,this),s=t.bind(this._onKeydown,this),h=t.bind(this._onInput,this),this.$hint=n(i.hint),this.$input=n(i.input).on("blur.tt",e).on("focus.tt",o).on("keydown.tt",s),this.$hint.length===0&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=t.noop),t.isMsie())this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(n){r[n.which||n.keyCode]||t.defer(t.bind(u._onInput,u,n))});else this.$input.on("input.tt",h);this.query=this.$input.val();this.$overflowHelper=f(this.$input)}function f(t){return n('<pre aria-hidden="true"><\/pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:t.css("font-family"),fontSize:t.css("font-size"),fontStyle:t.css("font-style"),fontVariant:t.css("font-variant"),fontWeight:t.css("font-weight"),wordSpacing:t.css("word-spacing"),letterSpacing:t.css("letter-spacing"),textIndent:t.css("text-indent"),textRendering:t.css("text-rendering"),textTransform:t.css("text-transform"),margin:0,display:"none"}).insertAfter(t)}function o(n,t){return i.normalizeQuery(n)===i.normalizeQuery(t)}function u(n){return n.altKey||n.ctrlKey||n.metaKey||n.shiftKey}var r;return r={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},i.normalizeQuery=function(n){return(n||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},t.mixin(i.prototype,e,{_onBlur:function(){this.resetInputValue();this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(n){var t=r[n.which||n.keyCode];this._managePreventDefault(t,n);t&&this._shouldTrigger(t,n)&&this.trigger(t+"Keyed",n)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(n,t){var i,r,f;switch(n){case"tab":r=this.getHint();f=this.getInputValue();i=r&&r!==f&&!u(t);break;case"up":case"down":i=!u(t);break;default:i=!1}i&&t.preventDefault()},_shouldTrigger:function(n,t){var i;switch(n){case"tab":i=!u(t);break;default:i=!0}return i},_checkInputValue:function(){var n,t,i;n=this.getInputValue();t=o(n,this.query);i=t?this.query.length!==n.length:!1;t?i&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query=n)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(n){this.query=n},getInputValue:function(){return this.$input.val()},setInputValue:function(n,t){this.$input.val(n);t?this.clearHint():this._checkInputValue()},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(n){this.$hint.val(n)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var n,t,i,r;n=this.getInputValue();t=this.getHint();i=n!==t&&t.indexOf(n)===0;r=n!==""&&i&&!this.hasOverflow();r||this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var n=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=n},isCursorAtEnd:function(){var n,i,r;return(n=this.$input.val().length,i=this.$input[0].selectionStart,t.isNumber(i))?i===n:document.selection?(r=document.selection.createRange(),r.moveStart("character",-n),n===r.text.length):!0},destroy:function(){this.$hint.off(".tt");this.$input.off(".tt");this.$hint=this.$input=this.$overflowHelper=null}}),i}(),u=function(){function u(i){i=i||{};i.templates=i.templates||{};i.source||n.error("missing source");i.name&&!l(i.name)&&n.error("invalid dataset name: "+i.name);this.query=null;this.highlight=!!i.highlight;this.name=i.name||t.getUniqueId();this.source=i.source;this.displayFn=h(i.display||i.displayKey);this.templates=c(i.templates,this.displayFn);this.$el=n(r.dataset.replace("%CLASS%",this.name))}function h(n){function i(t){return t[n]}return n=n||"value",t.isFunction(n)?n:i}function c(n,i){function r(n){return"<p>"+i(n)+"<\/p>"}return{empty:n.empty&&t.templatify(n.empty),header:n.header&&t.templatify(n.header),footer:n.footer&&t.templatify(n.footer),suggestion:n.suggestion||r}}function l(n){return/^[_a-zA-Z0-9-]+$/.test(n)}var f="ttDataset",o="ttValue",s="ttDatum";return u.extractDatasetName=function(t){return n(t).data(f)},u.extractValue=function(t){return n(t).data(o)},u.extractDatum=function(t){return n(t).data(s)},t.mixin(u.prototype,e,{_render:function(u,e){function v(){return h.templates.empty({query:u,isEmpty:!0})}function y(){function a(t){var u;return u=n(r.suggestion).append(h.templates.suggestion(t)).data(f,h.name).data(o,h.displayFn(t)).data(s,t),u.children().each(function(){n(this).css(i.suggestionChild)}),u}var c,l;return c=n(r.suggestions).css(i.suggestions),l=t.map(e,a),c.append.apply(c,l),h.highlight&&p({node:c[0],pattern:u}),c}function l(){return h.templates.header({query:u,isEmpty:!c})}function a(){return h.templates.footer({query:u,isEmpty:!c})}if(this.$el){var h=this,c;this.$el.empty();c=e&&e.length;!c&&this.templates.empty?this.$el.html(v()).prepend(h.templates.header?l():null).append(h.templates.footer?a():null):c&&this.$el.html(y()).prepend(h.templates.header?l():null).append(h.templates.footer?a():null);this.trigger("rendered")}},getRoot:function(){return this.$el},update:function(n){function i(i){t.canceled||n!==t.query||t._render(n,i)}var t=this;this.query=n;this.canceled=!1;this.source(n,i)},cancel:function(){this.canceled=!0},clear:function(){this.cancel();this.$el.empty();this.trigger("rendered")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=null}}),u}(),w=function(){function r(i){var r=this,u,e,o;i=i||{};i.menu||n.error("menu is required");this.isOpen=!1;this.isEmpty=!0;this.datasets=t.map(i.datasets,f);u=t.bind(this._onSuggestionClick,this);e=t.bind(this._onSuggestionMouseEnter,this);o=t.bind(this._onSuggestionMouseLeave,this);this.$menu=n(i.menu).on("click.tt",".tt-suggestion",u).on("mouseenter.tt",".tt-suggestion",e).on("mouseleave.tt",".tt-suggestion",o);t.each(this.datasets,function(n){r.$menu.append(n.getRoot());n.onSync("rendered",r._onRendered,r)})}function f(n){return new u(n)}return t.mixin(r.prototype,e,{_onSuggestionClick:function(t){this._setCursor(n(t.currentTarget),!0);this.trigger("suggestionClicked",n(t.currentTarget))},_onSuggestionMouseEnter:function(t){this._removeCursor();this._setCursor(n(t.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){function n(n){return n.isEmpty()}this.isEmpty=t.every(this.datasets,n);this.isEmpty?this._hide():this.isOpen&&this._show();this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(n,t){n.first().addClass("tt-cursor");t||this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(n){var i,r,t,u;if(this.isOpen){if(r=this._getCursor(),i=this._getSuggestions(),this._removeCursor(),t=i.index(r)+n,t=(t+1)%(i.length+1)-1,t===-1){this.trigger("cursorRemoved");return}t<-1&&(t=i.length-1);this._setCursor(u=i.eq(t));this._ensureVisible(u)}},_ensureVisible:function(n){var t,i,r,u;t=n.position().top;i=t+n.outerHeight(!0);r=this.$menu.scrollTop();u=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10);t<0?this.$menu.scrollTop(r+t):u<i&&this.$menu.scrollTop(r+(i-u))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,this.isEmpty||this._show(),this.trigger("opened"))},setLanguageDirection:function(n){this.$menu.css(n==="ltr"?i.ltr:i.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(n){var t=null;return n.length&&(t={raw:u.extractDatum(n),value:u.extractValue(n),datasetName:u.extractDatasetName(n)}),t},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(n){function i(t){t.update(n)}t.each(this.datasets,i)},empty:function(){function n(n){n.clear()}t.each(this.datasets,n);this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){function n(n){n.destroy()}this.$menu.off(".tt");this.$menu=null;t.each(this.datasets,n)}}),r}(),b=function(){function f(i){var r,u,f;i=i||{};i.input||n.error("missing input");this.isActivated=!1;this.autoselect=!!i.autoselect;this.minLength=t.isNumber(i.minLength)?i.minLength:1;this.$node=e(i.input,i.withHint);r=this.$node.find(".tt-dropdown-menu");u=this.$node.find(".tt-input");f=this.$node.find(".tt-hint");u.on("blur.tt",function(n){var i,f,e;i=document.activeElement;f=r.is(i);e=r.has(i).length>0;t.isMsie()&&(f||e)&&(n.preventDefault(),n.stopImmediatePropagation(),t.defer(function(){u.focus()}))});r.on("mousedown.tt",function(n){n.preventDefault()});this.eventBus=i.eventBus||new h({el:u});this.dropdown=new w({menu:r,datasets:i.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this);this.input=new c({input:u,hint:f}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this);this._setLanguageDirection()}function e(t,f){var e,h,c,s;e=n(t);h=n(r.wrapper).css(i.wrapper);c=n(r.dropdown).css(i.dropdown);s=e.clone().css(i.hint).css(o(e));s.val("").removeData().addClass("tt-hint").removeAttr("id name placeholder").prop("disabled",!0).attr({autocomplete:"off",spellcheck:"false"});e.data(u,{dir:e.attr("dir"),autocomplete:e.attr("autocomplete"),spellcheck:e.attr("spellcheck"),style:e.attr("style")});e.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(f?i.input:i.inputWithNoHint);try{e.attr("dir")||e.attr("dir","auto")}catch(l){}return e.wrap(h).parent().prepend(f?s:null).append(c)}function o(n){return{backgroundAttachment:n.css("background-attachment"),backgroundClip:n.css("background-clip"),backgroundColor:n.css("background-color"),backgroundImage:n.css("background-image"),backgroundOrigin:n.css("background-origin"),backgroundPosition:n.css("background-position"),backgroundRepeat:n.css("background-repeat"),backgroundSize:n.css("background-size")}}function s(n){var i=n.find(".tt-input");t.each(i.data(u),function(n,r){t.isUndefined(n)?i.removeAttr(r):i.attr(r,n)});i.detach().removeData(u).removeClass("tt-input").insertAfter(n);n.remove()}var u="ttAttrs";return t.mixin(f.prototype,{_onSuggestionClicked:function(n,t){var i;(i=this.dropdown.getDatumForSuggestion(t))&&this._select(i)},_onCursorMoved:function(){var n=this.dropdown.getDatumForCursor();this.input.setInputValue(n.value,!0);this.eventBus.trigger("cursorchanged",n.raw,n.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue();this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint();this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint();this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0;this.dropdown.open()},_onBlurred:function(){this.isActivated=!1;this.dropdown.empty();this.dropdown.close()},_onEnterKeyed:function(n,t){var i,r;i=this.dropdown.getDatumForCursor();r=this.dropdown.getDatumForTopSuggestion();i?(this._select(i),t.preventDefault()):this.autoselect&&r&&(this._select(r),t.preventDefault())},_onTabKeyed:function(n,t){var i;(i=this.dropdown.getDatumForCursor())?(this._select(i),t.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close();this.input.resetInputValue()},_onUpKeyed:function(){var n=this.input.getQuery();this.dropdown.isEmpty&&n.length>=this.minLength?this.dropdown.update(n):this.dropdown.moveCursorUp();this.dropdown.open()},_onDownKeyed:function(){var n=this.input.getQuery();this.dropdown.isEmpty&&n.length>=this.minLength?this.dropdown.update(n):this.dropdown.moveCursorDown();this.dropdown.open()},_onLeftKeyed:function(){this.dir==="rtl"&&this._autocomplete()},_onRightKeyed:function(){this.dir==="ltr"&&this._autocomplete()},_onQueryChanged:function(n,t){this.input.clearHintIfInvalid();t.length>=this.minLength?this.dropdown.update(t):this.dropdown.empty();this.dropdown.open();this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint();this.dropdown.open()},_setLanguageDirection:function(){var n;this.dir!==(n=this.input.getLanguageDirection())&&(this.dir=n,this.$node.css("direction",n),this.dropdown.setLanguageDirection(n))},_updateHint:function(){var n,i,u,f,e,r;n=this.dropdown.getDatumForTopSuggestion();n&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(i=this.input.getInputValue(),u=c.normalizeQuery(i),f=t.escapeRegExChars(u),e=new RegExp("^(?:"+f+")(.+$)","i"),r=e.exec(n.value),r?this.input.setHint(i+r[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(n){var i,r,u,t;i=this.input.getHint();r=this.input.getQuery();u=n||this.input.isCursorAtEnd();i&&r!==i&&u&&(t=this.dropdown.getDatumForTopSuggestion(),t&&this.input.setInputValue(t.value),this.eventBus.trigger("autocompleted",t.raw,t.datasetName))},_select:function(n){this.input.setQuery(n.value);this.input.setInputValue(n.value,!0);this._setLanguageDirection();this.eventBus.trigger("selected",n.raw,n.datasetName);this.dropdown.close();t.defer(t.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(n){this.isActivated?this.input.setInputValue(n):(this.input.setQuery(n),this.input.setInputValue(n,!0));this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){this.input.destroy();this.dropdown.destroy();s(this.$node);this.$node=null}}),f}();(function(){var u,i,r;u=n.fn.typeahead;i="ttTypeahead";r={initialize:function(r,u){function f(){var f=n(this),o,e;t.each(u,function(n){n.highlight=!!r.highlight});e=new b({input:f,eventBus:o=new h({el:f}),withHint:t.isUndefined(r.hint)?!0:!!r.hint,minLength:r.minLength,autoselect:r.autoselect,datasets:u});f.data(i,e)}return u=t.isArray(u)?u:[].slice.call(arguments,1),r=r||{},this.each(f)},open:function(){function t(){var r=n(this),t;(t=r.data(i))&&t.open()}return this.each(t)},close:function(){function t(){var r=n(this),t;(t=r.data(i))&&t.close()}return this.each(t)},val:function(t){function r(){var u=n(this),r;(r=u.data(i))&&r.setVal(t)}function u(n){var t,r;return(t=n.data(i))&&(r=t.getVal()),r}return arguments.length?this.each(r):u(this.first())},destroy:function(){function t(){var t=n(this),r;(r=t.data(i))&&(r.destroy(),t.removeData(i))}return this.each(t)}};n.fn.typeahead=function(n){return r[n]?r[n].apply(this,[].slice.call(arguments,1)):r.initialize.apply(this,arguments)};n.fn.typeahead.noConflict=function(){return n.fn.typeahead=u,this}})()}(window.jQuery);!function(n){function i(){}function t(n){function u(t){t.prototype.option||(t.prototype.option=function(t){n.isPlainObject(t)&&(this.options=n.extend(!0,this.options,t))})}function f(i,u){n.fn[i]=function(f){var h,e,s;if("string"==typeof f){for(var c=r.call(arguments,1),o=0,l=this.length;l>o;o++)if(h=this[o],e=n.data(h,i),e)if(n.isFunction(e[f])&&"_"!==f.charAt(0)){if(s=e[f].apply(e,c),void 0!==s)return s}else t("no such method '"+f+"' for "+i+" instance");else t("cannot call methods on "+i+" prior to initialization; attempted to call '"+f+"'");return this}return this.each(function(){var t=n.data(this,i);t?(t.option(f),t._init()):(t=new u(this,f),n.data(this,i,t))})}}if(n){var t="undefined"==typeof console?i:function(n){console.error(n)};return n.bridget=function(n,t){u(t);f(n,t)},n.bridget}}var r=Array.prototype.slice;"function"==typeof define&&define.amd?define("jquery-bridget/jquery.bridget",["jquery"],t):t(n.jQuery)}(window),function(n){function f(t){var i=n.event;return i.target=i.target||i.srcElement||t,i}var t=document.documentElement,u=function(){},i,r;t.addEventListener?u=function(n,t,i){n.addEventListener(t,i,!1)}:t.attachEvent&&(u=function(n,t,i){n[t+i]=i.handleEvent?function(){var t=f(n);i.handleEvent.call(i,t)}:function(){var t=f(n);i.call(n,t)};n.attachEvent("on"+t,n[t+i])});i=function(){};t.removeEventListener?i=function(n,t,i){n.removeEventListener(t,i,!1)}:t.detachEvent&&(i=function(n,t,i){n.detachEvent("on"+t,n[t+i]);try{delete n[t+i]}catch(r){n[t+i]=void 0}});r={bind:u,unbind:i};"function"==typeof define&&define.amd?define("eventie/eventie",r):"object"==typeof exports?module.exports=r:n.eventie=r}(this),function(n){function t(n){"function"==typeof n&&(t.isReady?n():u.push(n))}function i(n){var o="readystatechange"===n.type&&"complete"!==r.readyState,i,f,e;if(!t.isReady&&!o)for(t.isReady=!0,i=0,f=u.length;f>i;i++)e=u[i],e()}function f(u){return u.bind(r,"DOMContentLoaded",i),u.bind(r,"readystatechange",i),u.bind(n,"load",i),t}var r=n.document,u=[];t.isReady=!1;"function"==typeof define&&define.amd?(t.isReady="function"==typeof requirejs,define("doc-ready/doc-ready",["eventie/eventie"],f)):n.docReady=f(n.eventie)}(this),function(){function t(){}function r(n,t){for(var i=n.length;i--;)if(n[i].listener===t)return i;return-1}function i(n){return function(){return this[n].apply(this,arguments)}}var n=t.prototype,u=this,f=u.EventEmitter;n.getListeners=function(n){var r,t,i=this._getEvents();if(n instanceof RegExp){r={};for(t in i)i.hasOwnProperty(t)&&n.test(t)&&(r[t]=i[t])}else r=i[n]||(i[n]=[]);return r};n.flattenListeners=function(n){for(var i=[],t=0;t<n.length;t+=1)i.push(n[t].listener);return i};n.getListenersAsObject=function(n){var t,i=this.getListeners(n);return i instanceof Array&&(t={},t[n]=i),t||i};n.addListener=function(n,t){var i,u=this.getListenersAsObject(n),f="object"==typeof t;for(i in u)u.hasOwnProperty(i)&&-1===r(u[i],t)&&u[i].push(f?t:{listener:t,once:!1});return this};n.on=i("addListener");n.addOnceListener=function(n,t){return this.addListener(n,{listener:t,once:!0})};n.once=i("addOnceListener");n.defineEvent=function(n){return this.getListeners(n),this};n.defineEvents=function(n){for(var t=0;t<n.length;t+=1)this.defineEvent(n[t]);return this};n.removeListener=function(n,t){var f,i,u=this.getListenersAsObject(n);for(i in u)u.hasOwnProperty(i)&&(f=r(u[i],t),-1!==f&&u[i].splice(f,1));return this};n.off=i("removeListener");n.addListeners=function(n,t){return this.manipulateListeners(!1,n,t)};n.removeListeners=function(n,t){return this.manipulateListeners(!0,n,t)};n.manipulateListeners=function(n,t,i){var r,u,f=n?this.removeListener:this.addListener,e=n?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=i.length;r--;)f.call(this,t,i[r]);else for(r in t)t.hasOwnProperty(r)&&(u=t[r])&&("function"==typeof u?f.call(this,r,u):e.call(this,r,u));return this};n.removeEvent=function(n){var t,r=typeof n,i=this._getEvents();if("string"===r)delete i[n];else if(n instanceof RegExp)for(t in i)i.hasOwnProperty(t)&&n.test(t)&&delete i[t];else delete this._events;return this};n.removeAllListeners=i("removeEvent");n.emitEvent=function(n,t){var i,f,r,e,u=this.getListenersAsObject(n);for(r in u)if(u.hasOwnProperty(r))for(f=u[r].length;f--;)i=u[r][f],i.once===!0&&this.removeListener(n,i.listener),e=i.listener.apply(this,t||[]),e===this._getOnceReturnValue()&&this.removeListener(n,i.listener);return this};n.trigger=i("emitEvent");n.emit=function(n){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(n,t)};n.setOnceReturnValue=function(n){return this._onceReturnValue=n,this};n._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0};n._getEvents=function(){return this._events||(this._events={})};t.noConflict=function(){return u.EventEmitter=f,t};"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:this.EventEmitter=t}.call(this),function(n){function t(n){if(n){if("string"==typeof r[n])return n;n=n.charAt(0).toUpperCase()+n.slice(1);for(var t,u=0,f=i.length;f>u;u++)if(t=i[u]+n,"string"==typeof r[t])return t}}var i="Webkit Moz ms Ms O".split(" "),r=document.documentElement.style;"function"==typeof define&&define.amd?define("get-style-property/get-style-property",[],function(){return t}):"object"==typeof exports?module.exports=t:n.getStyleProperty=t}(window),function(n){function i(n){var t=parseFloat(n),i=-1===n.indexOf("%")&&!isNaN(t);return i&&t}function e(){for(var r,i={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},n=0,u=t.length;u>n;n++)r=t[n],i[r]=0;return i}function r(n){function s(n){var s,u,a,c,v,y;if("string"==typeof n&&(n=document.querySelector(n)),n&&"object"==typeof n&&n.nodeType){if(s=f(n),"none"===s.display)return e();u={};u.width=n.offsetWidth;u.height=n.offsetHeight;for(var nt=u.isBorderBox=!(!r||!s[r]||"border-box"!==s[r]),l=0,tt=t.length;tt>l;l++)a=t[l],c=s[a],c=h(n,c),v=parseFloat(c),u[a]=isNaN(v)?0:v;var p=u.paddingLeft+u.paddingRight,w=u.paddingTop+u.paddingBottom,it=u.marginLeft+u.marginRight,rt=u.marginTop+u.marginBottom,b=u.borderLeftWidth+u.borderRightWidth,k=u.borderTopWidth+u.borderBottomWidth,d=nt&&o,g=i(s.width);return g!==!1&&(u.width=g+(d?0:p+b)),y=i(s.height),y!==!1&&(u.height=y+(d?0:w+k)),u.innerWidth=u.width-(p+b),u.innerHeight=u.height-(w+k),u.outerWidth=u.width+it,u.outerHeight=u.height+rt,u}}function h(n,t){if(u||-1===t.indexOf("%"))return t;var i=n.style,e=i.left,r=n.runtimeStyle,f=r&&r.left;return f&&(r.left=n.currentStyle.left),i.left=t,t=i.pixelLeft,i.left=e,f&&(r.left=f),t}var o,r=n("boxSizing");return function(){var n,t,u;r&&(n=document.createElement("div"),n.style.width="200px",n.style.padding="1px 2px 3px 4px",n.style.borderStyle="solid",n.style.borderWidth="1px 2px 3px 4px",n.style[r]="border-box",t=document.body||document.documentElement,t.appendChild(n),u=f(n),o=200===i(u.width),t.removeChild(n))}(),s}var u=n.getComputedStyle,f=u?function(n){return u(n,null)}:function(n){return n.currentStyle},t=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];"function"==typeof define&&define.amd?define("get-size/get-size",["get-style-property/get-style-property"],r):"object"==typeof exports?module.exports=r(require("get-style-property")):n.getSize=r(n.getStyleProperty)}(window),function(n,t){function r(n,t){return n[f](t)}function u(n){if(!n.parentNode){var t=document.createDocumentFragment();t.appendChild(n)}}function s(n,t){u(n);for(var r=n.parentNode.querySelectorAll(t),i=0,f=r.length;f>i;i++)if(r[i]===n)return!0;return!1}function h(n,t){return u(n),r(n,t)}var i,f=function(){var u,i;if(t.matchesSelector)return"matchesSelector";for(var r=["webkit","moz","ms","o"],n=0,f=r.length;f>n;n++)if(u=r[n],i=u+"MatchesSelector",t[i])return i}(),e,o;f?(e=document.createElement("div"),o=r(e,"div"),i=o?r:h):i=s;"function"==typeof define&&define.amd?define("matches-selector/matches-selector",[],function(){return i}):window.matchesSelector=i}(this,Element.prototype),function(n){function r(n,t){for(var i in t)n[i]=t[i];return n}function u(n){for(var t in n)return!1;return t=null,!0}function f(n){return n.replace(/([A-Z])/g,function(n){return"-"+n.toLowerCase()})}function t(n,t,i){function o(n,t){n&&(this.element=n,this.layout=t,this.position={x:0,y:0},this._create())}var s=i("transition"),h=i("transform"),w=s&&h,b=!!i("perspective"),c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"}[s],l=["transform","transition","transitionDuration","transitionProperty"],k=function(){for(var n,t,u={},r=0,f=l.length;f>r;r++)n=l[r],t=i(n),t&&t!==n&&(u[n]=t);return u}(),a,v,y,p;return r(o.prototype,n.prototype),o.prototype._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}};this.css({position:"absolute"})},o.prototype.handleEvent=function(n){var t="on"+n.type;this[t]&&this[t](n)},o.prototype.getSize=function(){this.size=t(this.element)},o.prototype.css=function(n){var r=this.element.style,t,i;for(t in n)i=k[t]||t,r[i]=n[t]},o.prototype.getPosition=function(){var r=e(this.element),u=this.layout.options,f=u.isOriginLeft,o=u.isOriginTop,n=parseInt(r[f?"left":"right"],10),t=parseInt(r[o?"top":"bottom"],10),i;n=isNaN(n)?0:n;t=isNaN(t)?0:t;i=this.layout.size;n-=f?i.paddingLeft:i.paddingRight;t-=o?i.paddingTop:i.paddingBottom;this.position.x=n;this.position.y=t},o.prototype.layoutPosition=function(){var t=this.layout.size,i=this.layout.options,n={};i.isOriginLeft?(n.left=this.position.x+t.paddingLeft+"px",n.right=""):(n.right=this.position.x+t.paddingRight+"px",n.left="");i.isOriginTop?(n.top=this.position.y+t.paddingTop+"px",n.bottom=""):(n.bottom=this.position.y+t.paddingBottom+"px",n.top="");this.css(n);this.emitEvent("layout",[this])},a=b?function(n,t){return"translate3d("+n+"px, "+t+"px, 0)"}:function(n,t){return"translate("+n+"px, "+t+"px)"},o.prototype._transitionTo=function(n,t){this.getPosition();var e=this.position.x,o=this.position.y,s=parseInt(n,10),h=parseInt(t,10),c=s===this.position.x&&h===this.position.y;if(this.setPosition(n,t),c&&!this.isTransitioning)return void this.layoutPosition();var i=n-e,r=t-o,u={},f=this.layout.options;i=f.isOriginLeft?i:-i;r=f.isOriginTop?r:-r;u.transform=a(i,r);this.transition({to:u,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})},o.prototype.goTo=function(n,t){this.setPosition(n,t);this.layoutPosition()},o.prototype.moveTo=w?o.prototype._transitionTo:o.prototype.goTo,o.prototype.setPosition=function(n,t){this.position.x=parseInt(n,10);this.position.y=parseInt(t,10)},o.prototype._nonTransition=function(n){this.css(n.to);n.isCleaning&&this._removeStyles(n.to);for(var t in n.onTransitionEnd)n.onTransitionEnd[t].call(this)},o.prototype._transition=function(n){var i,t,r;if(!parseFloat(this.layout.options.transitionDuration))return void this._nonTransition(n);i=this._transn;for(t in n.onTransitionEnd)i.onEnd[t]=n.onTransitionEnd[t];for(t in n.to)i.ingProperties[t]=!0,n.isCleaning&&(i.clean[t]=!0);n.from&&(this.css(n.from),r=this.element.offsetHeight,r=null);this.enableTransition(n.to);this.css(n.to);this.isTransitioning=!0},v=h&&f(h)+",opacity",o.prototype.enableTransition=function(){this.isTransitioning||(this.css({transitionProperty:v,transitionDuration:this.layout.options.transitionDuration}),this.element.addEventListener(c,this,!1))},o.prototype.transition=o.prototype[s?"_transition":"_nonTransition"],o.prototype.onwebkitTransitionEnd=function(n){this.ontransitionend(n)},o.prototype.onotransitionend=function(n){this.ontransitionend(n)},y={"-webkit-transform":"transform","-moz-transform":"transform","-o-transform":"transform"},o.prototype.ontransitionend=function(n){var t,i,r;n.target===this.element&&(t=this._transn,i=y[n.propertyName]||n.propertyName,(delete t.ingProperties[i],u(t.ingProperties)&&this.disableTransition(),i in t.clean&&(this.element.style[n.propertyName]="",delete t.clean[i]),i in t.onEnd)&&(r=t.onEnd[i],r.call(this),delete t.onEnd[i]),this.emitEvent("transitionEnd",[this]))},o.prototype.disableTransition=function(){this.removeTransitionStyles();this.element.removeEventListener(c,this,!1);this.isTransitioning=!1},o.prototype._removeStyles=function(n){var t={},i;for(i in n)t[i]="";this.css(t)},p={transitionProperty:"",transitionDuration:""},o.prototype.removeTransitionStyles=function(){this.css(p)},o.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element);this.emitEvent("remove",[this])},o.prototype.remove=function(){if(!s||!parseFloat(this.layout.options.transitionDuration))return void this.removeElem();var n=this;this.on("transitionEnd",function(){return n.removeElem(),!0});this.hide()},o.prototype.reveal=function(){delete this.isHidden;this.css({display:""});var n=this.layout.options;this.transition({from:n.hiddenStyle,to:n.visibleStyle,isCleaning:!0})},o.prototype.hide=function(){this.isHidden=!0;this.css({display:""});var n=this.layout.options;this.transition({from:n.visibleStyle,to:n.hiddenStyle,isCleaning:!0,onTransitionEnd:{opacity:function(){this.isHidden&&this.css({display:"none"})}}})},o.prototype.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},o}var i=n.getComputedStyle,e=i?function(n){return i(n,null)}:function(n){return n.currentStyle};"function"==typeof define&&define.amd?define("outlayer/item",["eventEmitter/EventEmitter","get-size/get-size","get-style-property/get-style-property"],t):(n.Outlayer={},n.Outlayer.Item=t(n.EventEmitter,n.getSize,n.getStyleProperty))}(window),function(n){function t(n,t){for(var i in t)n[i]=t[i];return n}function c(n){return"[object Array]"===a.call(n)}function u(n){var t=[],i,r;if(c(n))t=n;else if(n&&"number"==typeof n.length)for(i=0,r=n.length;r>i;i++)t.push(n[i]);else t.push(n);return t}function e(n,t){var i=v(t,n);-1!==i&&t.splice(i,1)}function l(n){return n.replace(/(.)([A-Z])/g,function(n,t,i){return t+"-"+i}).toLowerCase()}function o(o,c,a,v,y,p){function w(n,i){if("string"==typeof n&&(n=s.querySelector(n)),!n||!f(n))return void(r&&r.error("Bad "+this.constructor.namespace+" element: "+n));this.element=n;this.options=t({},this.constructor.defaults);this.option(i);var u=++k;this.element.outlayerGUID=u;b[u]=this;this._create();this.options.isInitLayout&&this.layout()}var k=0,b={};return w.namespace="outlayer",w.Item=p,w.defaults={containerStyle:{position:"relative"},isInitLayout:!0,isOriginLeft:!0,isOriginTop:!0,isResizeBound:!0,isResizingContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}},t(w.prototype,a.prototype),w.prototype.option=function(n){t(this.options,n)},w.prototype._create=function(){this.reloadItems();this.stamps=[];this.stamp(this.options.stamp);t(this.element.style,this.options.containerStyle);this.options.isResizeBound&&this.bindResize()},w.prototype.reloadItems=function(){this.items=this._itemize(this.element.children)},w.prototype._itemize=function(n){for(var u,f,i=this._filterFindItemElements(n),e=this.constructor.Item,r=[],t=0,o=i.length;o>t;t++)u=i[t],f=new e(u,this),r.push(f);return r},w.prototype._filterFindItemElements=function(n){var t;n=u(n);for(var r=this.options.itemSelector,i=[],e=0,h=n.length;h>e;e++)if(t=n[e],f(t))if(r){y(t,r)&&i.push(t);for(var s=t.querySelectorAll(r),o=0,c=s.length;c>o;o++)i.push(s[o])}else i.push(t);return i},w.prototype.getItemElements=function(){for(var t=[],n=0,i=this.items.length;i>n;n++)t.push(this.items[n].element);return t},w.prototype.layout=function(){this._resetLayout();this._manageStamps();var n=void 0!==this.options.isLayoutInstant?this.options.isLayoutInstant:!this._isLayoutInited;this.layoutItems(this.items,n);this._isLayoutInited=!0},w.prototype._init=w.prototype.layout,w.prototype._resetLayout=function(){this.getSize()},w.prototype.getSize=function(){this.size=v(this.element)},w.prototype._getMeasurement=function(n,t){var r,i=this.options[n];i?("string"==typeof i?r=this.element.querySelector(i):f(i)&&(r=i),this[n]=r?v(r)[t]:i):this[n]=0},w.prototype.layoutItems=function(n,t){n=this._getItemsForLayout(n);this._layoutItems(n,t);this._postLayout()},w.prototype._getItemsForLayout=function(n){for(var i,r=[],t=0,u=n.length;u>t;t++)i=n[t],i.isIgnored||r.push(i);return r},w.prototype._layoutItems=function(n,t){function f(){e.emitEvent("layoutComplete",[e,n])}var e=this,i,r;if(!n||!n.length)return void f();this._itemsOn(n,"layout",f);for(var o=[],u=0,s=n.length;s>u;u++)i=n[u],r=this._getItemLayoutPosition(i),r.item=i,r.isInstant=t||i.isLayoutInstant,o.push(r);this._processLayoutQueue(o)},w.prototype._getItemLayoutPosition=function(){return{x:0,y:0}},w.prototype._processLayoutQueue=function(n){for(var t,i=0,r=n.length;r>i;i++)t=n[i],this._positionItem(t.item,t.x,t.y,t.isInstant)},w.prototype._positionItem=function(n,t,i,r){r?n.goTo(t,i):n.moveTo(t,i)},w.prototype._postLayout=function(){this.resizeContainer()},w.prototype.resizeContainer=function(){if(this.options.isResizingContainer){var n=this._getContainerSize();n&&(this._setContainerMeasure(n.width,!0),this._setContainerMeasure(n.height,!1))}},w.prototype._getContainerSize=h,w.prototype._setContainerMeasure=function(n,t){if(void 0!==n){var i=this.size;i.isBorderBox&&(n+=t?i.paddingLeft+i.paddingRight+i.borderLeftWidth+i.borderRightWidth:i.paddingBottom+i.paddingTop+i.borderTopWidth+i.borderBottomWidth);n=Math.max(n,0);this.element.style[t?"width":"height"]=n+"px"}},w.prototype._itemsOn=function(n,t,i){function e(){return u++,u===o&&i.call(s),!0}for(var f,u=0,o=n.length,s=this,r=0,h=n.length;h>r;r++){f=n[r];f.on(t,e)}},w.prototype.ignore=function(n){var t=this.getItem(n);t&&(t.isIgnored=!0)},w.prototype.unignore=function(n){var t=this.getItem(n);t&&delete t.isIgnored},w.prototype.stamp=function(n){var t,i,r;if(n=this._find(n))for(this.stamps=this.stamps.concat(n),t=0,i=n.length;i>t;t++)r=n[t],this.ignore(r)},w.prototype.unstamp=function(n){var t,r,i;if(n=this._find(n))for(t=0,r=n.length;r>t;t++)i=n[t],e(i,this.stamps),this.unignore(i)},w.prototype._find=function(n){if(n)return("string"==typeof n&&(n=this.element.querySelectorAll(n)),n=u(n))},w.prototype._manageStamps=function(){var n,t,i;if(this.stamps&&this.stamps.length)for(this._getBoundingRect(),n=0,t=this.stamps.length;t>n;n++)i=this.stamps[n],this._manageStamp(i)},w.prototype._getBoundingRect=function(){var t=this.element.getBoundingClientRect(),n=this.size;this._boundingRect={left:t.left+n.paddingLeft+n.borderLeftWidth,top:t.top+n.paddingTop+n.borderTopWidth,right:t.right-(n.paddingRight+n.borderRightWidth),bottom:t.bottom-(n.paddingBottom+n.borderBottomWidth)}},w.prototype._manageStamp=h,w.prototype._getElementOffset=function(n){var t=n.getBoundingClientRect(),i=this._boundingRect,r=v(n);return{left:t.left-i.left-r.marginLeft,top:t.top-i.top-r.marginTop,right:i.right-t.right-r.marginRight,bottom:i.bottom-t.bottom-r.marginBottom}},w.prototype.handleEvent=function(n){var t="on"+n.type;this[t]&&this[t](n)},w.prototype.bindResize=function(){this.isResizeBound||(o.bind(n,"resize",this),this.isResizeBound=!0)},w.prototype.unbindResize=function(){this.isResizeBound&&o.unbind(n,"resize",this);this.isResizeBound=!1},w.prototype.onresize=function(){function t(){n.resize();delete n.resizeTimeout}this.resizeTimeout&&clearTimeout(this.resizeTimeout);var n=this;this.resizeTimeout=setTimeout(t,100)},w.prototype.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},w.prototype.needsResizeLayout=function(){var n=v(this.element),t=this.size&&n;return t&&n.innerWidth!==this.size.innerWidth},w.prototype.addItems=function(n){var t=this._itemize(n);return t.length&&(this.items=this.items.concat(t)),t},w.prototype.appended=function(n){var t=this.addItems(n);t.length&&(this.layoutItems(t,!0),this.reveal(t))},w.prototype.prepended=function(n){var t=this._itemize(n),i;t.length&&(i=this.items.slice(0),this.items=t.concat(i),this._resetLayout(),this._manageStamps(),this.layoutItems(t,!0),this.reveal(t),this.layoutItems(i))},w.prototype.reveal=function(n){var i=n&&n.length,t,r;if(i)for(t=0;i>t;t++)r=n[t],r.reveal()},w.prototype.hide=function(n){var i=n&&n.length,t,r;if(i)for(t=0;i>t;t++)r=n[t],r.hide()},w.prototype.getItem=function(n){for(var i,t=0,r=this.items.length;r>t;t++)if(i=this.items[t],i.element===n)return i},w.prototype.getItems=function(n){var u,i;if(n&&n.length){for(var r=[],t=0,f=n.length;f>t;t++)u=n[t],i=this.getItem(u),i&&r.push(i);return r}},w.prototype.remove=function(n){var t,i,f,r;if(n=u(n),t=this.getItems(n),t&&t.length)for(this._itemsOn(t,"remove",function(){this.emitEvent("removeComplete",[this,t])}),i=0,f=t.length;f>i;i++)r=t[i],r.remove(),e(r,this.items)},w.prototype.destroy=function(){var t=this.element.style,n,r,u;for(t.height="",t.position="",t.width="",n=0,r=this.items.length;r>n;n++)u=this.items[n],u.destroy();this.unbindResize();delete this.element.outlayerGUID;i&&i.removeData(this.element,this.constructor.namespace)},w.data=function(n){var t=n&&n.outlayerGUID;return t&&b[t]},w.create=function(n,u){function f(){w.apply(this,arguments)}return Object.create?f.prototype=Object.create(w.prototype):t(f.prototype,w.prototype),f.prototype.constructor=f,f.defaults=t({},w.defaults),t(f.defaults,u),f.prototype.settings={},f.namespace=n,f.data=w.data,f.Item=function(){p.apply(this,arguments)},f.Item.prototype=new p,c(function(){for(var a,t,e,v,o=l(n),h=s.querySelectorAll(".js-"+o),c="data-"+o+"-options",u=0,y=h.length;y>u;u++){t=h[u];e=t.getAttribute(c);try{a=e&&JSON.parse(e)}catch(p){r&&r.error("Error parsing "+c+" on "+t.nodeName.toLowerCase()+(t.id?"#"+t.id:"")+": "+p);continue}v=new f(t,a);i&&i.data(t,n,v)}}),i&&i.bridget&&i.bridget(n,f),f},w.Item=p,w}var s=n.document,r=n.console,i=n.jQuery,h=function(){},a=Object.prototype.toString,f="object"==typeof HTMLElement?function(n){return n instanceof HTMLElement}:function(n){return n&&"object"==typeof n&&1===n.nodeType&&"string"==typeof n.nodeName},v=Array.prototype.indexOf?function(n,t){return n.indexOf(t)}:function(n,t){for(var i=0,r=n.length;r>i;i++)if(n[i]===t)return i;return-1};"function"==typeof define&&define.amd?define("outlayer/outlayer",["eventie/eventie","doc-ready/doc-ready","eventEmitter/EventEmitter","get-size/get-size","matches-selector/matches-selector","./item"],o):n.Outlayer=o(n.eventie,n.docReady,n.EventEmitter,n.getSize,n.matchesSelector,n.Outlayer.Item)}(window),function(n){function t(n,t){var r=n.create("masonry");return r.prototype._resetLayout=function(){this.getSize();this._getMeasurement("columnWidth","outerWidth");this._getMeasurement("gutter","outerWidth");this.measureColumns();var n=this.cols;for(this.colYs=[];n--;)this.colYs.push(0);this.maxY=0},r.prototype.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var n=this.items[0],i=n&&n.element;this.columnWidth=i&&t(i).outerWidth||this.containerWidth}this.columnWidth+=this.gutter;this.cols=Math.floor((this.containerWidth+this.gutter)/this.columnWidth);this.cols=Math.max(this.cols,1)},r.prototype.getContainerWidth=function(){var i=this.options.isFitWidth?this.element.parentNode:this.element,n=t(i);this.containerWidth=n&&n.innerWidth},r.prototype._getItemLayoutPosition=function(n){n.getSize();var e=n.size.outerWidth%this.columnWidth,s=e&&1>e?"round":"ceil",t=Math[s](n.size.outerWidth/this.columnWidth);t=Math.min(t,this.cols);for(var r=this._getColGroup(t),u=Math.min.apply(Math,r),o=i(r,u),h={x:this.columnWidth*o,y:u},c=u+n.size.outerHeight,l=this.cols+1-r.length,f=0;l>f;f++)this.colYs[o+f]=c;return h},r.prototype._getColGroup=function(n){var r;if(2>n)return this.colYs;for(var i=[],u=this.cols+1-n,t=0;u>t;t++)r=this.colYs.slice(t,t+n),i[t]=Math.max.apply(Math,r);return i},r.prototype._manageStamp=function(n){var e=t(n),u=this._getElementOffset(n),o=this.options.isOriginLeft?u.left:u.right,s=o+e.outerWidth,f=Math.floor(o/this.columnWidth),i,h,r;for(f=Math.max(0,f),i=Math.floor(s/this.columnWidth),i-=s%this.columnWidth?0:1,i=Math.min(this.cols-1,i),h=(this.options.isOriginTop?u.top:u.bottom)+e.outerHeight,r=f;i>=r;r++)this.colYs[r]=Math.max(h,this.colYs[r])},r.prototype._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var n={height:this.maxY};return this.options.isFitWidth&&(n.width=this._getContainerFitWidth()),n},r.prototype._getContainerFitWidth=function(){for(var n=0,t=this.cols;--t&&0===this.colYs[t];)n++;return(this.cols-n)*this.columnWidth-this.gutter},r.prototype.needsResizeLayout=function(){var n=this.containerWidth;return this.getContainerWidth(),n!==this.containerWidth},r}var i=Array.prototype.indexOf?function(n,t){return n.indexOf(t)}:function(n,t){for(var u,i=0,r=n.length;r>i;i++)if(u=n[i],u===t)return i;return-1};"function"==typeof define&&define.amd?define(["outlayer/outlayer","get-size/get-size"],t):n.Masonry=t(n.Outlayer,n.getSize)}(window);window.startLocations={"www.findroommate.dk":{coords:{latitude:56.155467,longitude:10.430995},zoom:6},"www.findroommate.se":{coords:{latitude:62.71020270791913,longitude:14.935972520312436},zoom:4},"www.findroommate.com":{coords:{latitude:53.832207083351612,longitude:10.275948124999998},zoom:4},"www.findroommate.fr":{coords:{latitude:47.882679,longitude:1.905871},zoom:6},"www.findroommate.nl":{coords:{latitude:52.308859,longitude:4.814856},zoom:8}};window.frm={settings:{sizes:{tablet:768}},ko:{extensions:{}},events:{},maps:{places:{}},models:{abtest:{},admin:{},mobile:{},search:{},tenant:{},landlord:{},campaigns:{},popup:{membership:{}}},ui:{views:{admin:{},accounts:{},mobile:{},search:{},tenant:{},landlord:{},misc:{},log:{},campaigns:{},popup:{membership:{}}},layout:{admin:{},accounts:{},mobile:{},search:{},tenant:{},landlord:{},misc:{},log:{},campaigns:{},popup:{membership:{}}},states:{}},security:{},services:{admin:{},profile:{},tenant:{},search:{},campaigns:{},payment:{},landlord:{}},current:{},utils:{}};frm.utils.debounce=function(n,t,i){var r;return function(){var u=this,f=arguments;clearTimeout(r);r=setTimeout(function(){r=null;i||n.apply(u,f)},t);i&&!r&&n.apply(u,f)}};frm.utils.encodeFriendlyUrl=function(n){return n=n.trim(),ko.utils.arrayMap(n,function(n){switch(n){case" ":return"-";case",":return"";case"ø":case"ö":return"oe";case"æ":case"ä":return"ae";case"å":return"aa";case"ó":case"ò":return"o";case"é":case"è":return"e";case"á":case"à":return"a";default:return n}}).join("")};frm.utils.decodeFriendlyUrl=function(n){return n=n.trim(),ko.utils.arrayMap(n,function(n){return n==="-"?" ":n}).join("")};frm.utils.arrayReplace=function(n,t){n.removeAll();ko.utils.arrayPushAll(n,t)};Array.prototype.indexOf||(Array.prototype.indexOf=function(n){var i=this.length>>>0,t=Number(arguments[1])||0;for(t=t<0?Math.ceil(t):Math.floor(t),t<0&&(t+=i);t<i;t++)if(t in this&&this[t]===n)return t;return-1});frm.utils.loadScript=function(n,t){var i,u=document.getElementsByTagName("head")[0],r=!1;i=document.createElement("script");i.type="text/javascript";i.src=n;i.async=!0;i.onload=i.onreadystatechange=function(){r||this.readyState&&this.readyState!="complete"||(r=!0,t())};u.appendChild(i)};$(function(){$(function(){function n(){var n=this;n.$html=$("html");n.$body=$(document.body);n.$viewport=n.$body.find("#viewport");n.$html.on("touchstart click MSPointerDown","body.burger-open #viewport",function(t){var i=$(t.target);i.parents(".burger").length<=0&&(n.$body.removeClass("burger-open"),n.$viewport.find(".burger.left").removeClass("left"),n.onClose&&n.onClose(),t.preventDefault())})}n.prototype.openBurger=function(n,t){t=t||{};n.addClass("left");this.$body.addClass("burger-open");this.onClose=t.onClose};window.AppState=new n})});$(function(){toastr.options={closeButton:!0,debug:!0,newestOnTop:!1,progressBar:!1,positionClass:"toast-bottom-left",preventDuplicates:!1,onclick:null,showDuration:"600",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"slideDown",hideMethod:"slideUp"};var n=$("input#js-profile");switch(n.val()){case"MembershipPopup":frm.ui.initJsonify();frm.current.view=new frm.ui.views.popup.membership.MembershipView;break;case"SearchAreas":frm.services.initApi();frm.current.masterView=new frm.ui.views.MasterView;frm.current.view=new frm.ui.views.tenant.SearchAreasView;break;case"Landlord/Property":frm.ui.initJsonify();frm.services.initApi();frm.current.masterView=new frm.ui.views.MasterView;frm.current.view=new frm.ui.views.landlord.PropertyView;break;case"Landlord/Room":frm.ui.initJsonify();frm.services.initApi();frm.current.masterView=new frm.ui.views.MasterView;frm.current.view=new frm.ui.views.landlord.RoomView;break;case"Landlord/ExternRoom":frm.ui.initJsonify();frm.services.initApi();frm.current.masterView=new frm.ui.views.MasterView;frm.current.view=new frm.ui.views.landlord.ExternRoomView;break;case"Tenant/Profile":frm.ui.initJsonify();frm.services.initApi();frm.current.masterView=new frm.ui.views.MasterView;frm.current.view=new frm.ui.views.tenant.ProfileView;break;case"Homepage":frm.current.masterView=new frm.ui.views.MasterView;frm.current.view=new frm.ui.views.misc.HomepageView;break;case"CreateAccount":frm.current.view=new frm.ui.views.accounts.CreateAccountView}});frm.events.addListener=function(n,t){frm.events.globalReactor||(frm.events.globalReactor=new frm.events.Reactor);frm.events.globalReactor.addListener(n,t)};frm.events.removeListener=function(n,t){frm.events.globalReactor||(frm.events.globalReactor=new frm.events.Reactor);frm.events.globalReactor.removeListener(n,t)};frm.events.suppressFor=function(n,t){frm.events.globalReactor&&(frm.events.globalReactor.setPaused(n,!0),t(),frm.events.globalReactor.setPaused(n,!1))};frm.events.dispatch=function(){frm.events.globalReactor&&frm.events.globalReactor.dispatch.apply(frm.events.globalReactor,arguments)};frm.events.Event=function(n){this.name=n;this.callbacks=[];this.paused=!1};frm.events.Event.prototype.registerCallback=function(n){this.callbacks.push(n)};frm.events.Event.prototype.unregisterCallback=function(n){this.callbacks.splice(this.callbacks.indexOf(n),1)};frm.events.Event.prototype.setPaused=function(n){this.paused=n};frm.events.Reactor=function(){this.events={}};frm.events.Reactor.prototype.dispatch=function(n){var r,i,u,t;if(n in this.events&&(r=this.events[n],!r.paused))for(i=r.callbacks,u=Array.prototype.slice.call(arguments),t=0;t<i.length;t++)i[t].apply(i[t],u.slice(1))};frm.events.Reactor.prototype.setPaused=function(n,t){n in this.events&&this.events[n].setPaused(t)};frm.events.Reactor.prototype.addListener=function(n,t){n in this.events||(this.events[n]=new frm.events.Event(n));this.events[n].registerCallback(t)};frm.events.Reactor.prototype.removeListener=function(n,t){this.events.hasOwnProperty(n)&&this.events[n].unregisterCallback(t)};frm.security.facebookAuth=function(n){var t=this;FB.init({appId:"340386656058979",channelUrl:"/Pages/FBLoginChannelFile.aspx",status:!0,cookie:!0,xfbml:!0});FB.login(function(t){t.authResponse&&n(t.authResponse)},{scope:"email,user_interests,user_relationships,user_birthday,publish_stream"})};frm.security.facebookLogin=function(n,t,i,r){this.facebookAuth(function(u){var f={fuId:u.userID,accessToken:u.accessToken,ContactUsername:null,UserType:i!=0?1:0,aditionalData:JSON.stringify(t)||"",remember:$("[name='Remember']").is(":checked"),contactingLandlordId:r=="undefined"?r:""};$.ajax({type:"POST",url:"/API/User/Login.asmx/FacebookFRMLogin",data:JSON.stringify(f),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){n(t.d.IsValid,t.d.ReturnURL,t.d.IsCurrentUserPayingMember,t.d.IsCurrentUserLoggedIn,t.d.ReturnValue,t.d.ReturnData)}})})},function(n){var t=function(){function l(){var i,t;for(i in n)n.hasOwnProperty(i)&&(t=n[i],t.id="__CR_"+i+"__",t.save="save"in t?t.save.replace("{{id}}",t.id):t.id,t.rRestore=new RegExp(t.id,"g"))}function e(n,t){var i=[],r;for(n.lastIndex=0;r=n.exec(t);)i.push(r[1]);return i}function a(n){return e(r,n)}function v(t){return e(n.OP.rgx,t)}function y(n,r){return n=n||"",n&&(t===i?n=n.replace(h,""):t===f&&(n=n.replace(c,"")),n=o(n,"rgx","save"),n=n.replace(s,"\\$&"),n=o(n,"rRestore","res"),t===i&&(n="\\/?"+n)),t!==u&&(n+="\\/?"),new RegExp("^"+n+"$",r?"i":"")}function o(t,i,r){var u,f;for(f in n)n.hasOwnProperty(f)&&(u=n[f],t=t.replace(u[i],u[r]));return t}function p(n,t,i){var r=t.exec(n);return r&&(r.shift(),i&&(r=typecastArrayValues(r))),r}function w(t,i){if(typeof t!="string")throw new Error("Route pattern should be a string.");var u=function(n,t){var r,u,f;if(t=t.substr(0,1)==="?"?t.substr(1):t,i[t]!=null){if(typeof i[t]=="object"){u=[];for(f in i[t])u.push(encodeURI(f+"="+i[t][f]));r="?"+u.join("&")}else r=String(i[t]);if(n.indexOf("*")===-1&&r.indexOf("/")!==-1)throw new Error('Invalid value "'+r+'" for segment "'+n+'".');}else if(n.indexOf("{")!==-1)throw new Error("The segment "+n+" is required.");else r="";return r};return n.OS.trail||(n.OS.trail=new RegExp("(?:"+n.OS.id+")+$")),t.replace(n.OS.rgx,n.OS.save).replace(r,u).replace(n.OS.trail,"").replace(n.OS.rRestore,"/")}var s=/[\\.+*?\^$\[\](){}\/'#]/g,h=/^\/|\/$/g,c=/\/$/g,r=/(?:\{|:)([^}:]+)(?:\}|:)/g,n={OS:{rgx:/([:}]|\w(?=\/))\/?(:|(?:\{\?))/g,save:"$1{{id}}$2",res:"\\/?"},RS:{rgx:/([:}])\/?(\{)/g,save:"$1{{id}}$2",res:"\\/"},RQ:{rgx:/\{\?([^}]+)\}/g,res:"\\?([^#]+)"},OQ:{rgx:/:\?([^:]+):/g,res:"(?:\\?([^#]*))?"},OR:{rgx:/:([^:]+)\*:/g,res:"(.*)?"},RR:{rgx:/\{([^}]+)\*\}/g,res:"(.+)"},RP:{rgx:/\{([^}]+)\}/g,res:"([^\\/?]+)"},OP:{rgx:/:([^:]+):/g,res:"([^\\/?]+)?/?"}},i=1,u=2,f=3,t=i;return l(),{strict:function(){t=u},loose:function(){t=i},legacy:function(){t=f},getParamIds:a,getOptionalParamsIds:v,getParamValues:p,compilePattern:y,interpolate:w}}(),i=function(){return function(n){this.pattern=n;this.regExp=t.compilePattern(n,!0);this.match=function(n){return this.regExp.test(n)};this.getParamsArray=function(n){for(var o=!1,u=t.getParamValues(n,this.regExp,o),e={},r=u.length,f,i;r--;)i=u[r],this._paramsIds&&(f=this._paramsIds[r],f.indexOf("?")===0&&i&&(e[f+"_"]=i,i=decodeQueryString(i,o),u[r]=i),_hasOptionalGroupBug&&i===""&&arrayIndexOf(this._optionalParamsIds,f)!==-1&&(i=void 0,u[r]=i),e[f]=i),e[r]=i;return u}}}();n.Router=function(){function n(n){var t,r;this.routes=[];this.routeHandlers={};for(t in n)n.hasOwnProperty(t)&&(r=new i(t),this.routes.push(r),this.routeHandlers[t]=n[t])}var t={getMatches:function(n,t){for(var r=[],u=t.length,i;i=t[--u];)if((!r.length||!0)&&i.match(n)){r.push({route:i,params:i.getParamsArray(n)});break}return r}};return n.prototype.getMatch=function(n){var i=t.getMatches(n,this.routes);if(i.length==0)throw new Error("No route found for '"+n+"'");return i},n.prototype.redirect=function(n){var t=this.getMatch(n)[0];this.routeHandlers[t.route.pattern].apply(window,t.params)},n}()}(frm),function(){if(App.settings.account.isLoggedIn){var n=$.connection.NotificationHub;$.connection.hub.logging=!0;$.extend(n.client,{updateNotifications:function(n){frm.events.dispatch("notification:count:updated",n.UpdatedCount);frm.events.dispatch("notification:new:add",n.Notifications)},notificationsChecked:function(){frm.events.dispatch("notification:count:updated",0)},messageRecieved:function(n){frm.events.dispatch("chat:message:received",n)},messageRead:function(n){frm.events.dispatch("chat:message:participant:read",n)},matchRecieved:function(n){frm.events.dispatch("matchmaking:match:received",n)},matchSavo:function(n){frm.events.dispatch("matchmaking:match:savo",n)}});$.connection.hub.qs="accountId="+App.settings.account.id+"&siteId="+App.settings.currentSiteId+"&cultureCode="+App.settings.cultureCode;$.connection.hub.start().done(function(){window.CONNECTION_ESTABLISHED._deferral.resolve()})}}(),function(){var n=null;ko.bindingHandlers.chart={update:function(t,i,r){var h=$(t),s=r(),e=i(),u=s.chart.type,o={labels:ko.utils.unwrapObservable(e.labels),datasets:ko.utils.arrayMap(ko.utils.unwrapObservable(e.datasets),function(n){return{label:n()[0],fillColor:"rgba("+n()[1]+", 0.2)",strokeColor:"rgba("+n()[1]+", 1)",pointColor:"rgba("+n()[1]+", 1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:ko.utils.unwrapObservable(n()[2])}})},f;n!=null&&n.destroy();f=t.getContext("2d");(u=="line"||u==undefined)&&(n=new Chart(f).Line(o,{animation:!0,responsive:!0,multiTooltipTemplate:"<%= datasetLabel %> - <%= value %>"}));u=="bar"&&(n=new Chart(f).Bar(o,{animation:!0,responsive:!0,multiTooltipTemplate:"<%= datasetLabel %>: <%= value %>"}))}}}(),function(){function r(){var n=new $.Deferred;return t===null?frm.services.CountryService.fetch().then(function(i){t=i.data;n.resolve(t)}):(n.resolve(t),n.promise())}var n={CONTAINER:"country-box",HEADER:"country-box-header",CLOSE_BUTTON:"close-button",LIST:"country-list",LIST_SUBCLASS:{FLAGS:"flags",PERCENT_ROW:"percent-row"},ITEM:"item",ITEM_SUBCLASS:{COL:"col",COL3:"col-md-3"}},i="country-data",t=null;ko.bindingHandlers.nationality={init:function(u,f,e){var l=$(u),c=f(),s=e(),o=s.Options,h=ko.observable(!1);$parent=o!=undefined&&o.renderIn!=undefined?$("#"+o.renderIn):$("body");$container=$(document.createElement("div"));$header=$(document.createElement("div"));$closeBtn=$(document.createElement("a"));$list=$(document.createElement("div"));$parent.prepend($container);$header.append($closeBtn);$container.append($header);$container.append($list);$container.addClass(n.CONTAINER);$header.addClass(n.HEADER);$closeBtn.addClass(n.CLOSE_BUTTON);$list.addClass(n.LIST);$list.addClass(n.LIST_SUBCLASS.FLAGS);$list.addClass(n.LIST_SUBCLASS.PERCENT_ROW);startUp=function(){r().then(function(){ko.utils.arrayForEach(t,function(t){$list.append($(document.createElement("a")).addClass(n.ITEM).addClass(n.ITEM_SUBCLASS.COL3).addClass(n.ITEM_SUBCLASS.COL).attr("href","#").data(i,t).html('<div style="display:inline-block; max-height:20px;"><span class="'+t.FlagClass+'"><\/span><\/div><span>'+t.Name+"<\/span>"));typeof s.nationalityOptions!="undefined"&&s.nationalityOptions.callOnInit&&s.nationalityOptions.initValue==t.CountryCode&&c(t)})})};toggleVisibility=function(){h()?hideBox():showBox();o&&o.isVisible&&o.isVisible()};hideBox=function(){$("."+n.CONTAINER).hide();h(!1)};showBox=function(){$("."+n.CONTAINER).show();h(!0)};l.on("click",function(){toggleVisibility()});$closeBtn.on("click",function(){hideBox()});$list.on("click","."+n.ITEM,function(n){var t=$(this);itemValue=t.data(i);c(itemValue);hideBox();n.preventDefault()});startUp();hideBox();ko.utils.domNodeDisposal.addDisposeCallback(u,function(){$("."+n.CONTAINER).remove()})}}}();ko.bindingHandlers.numeric={init:function(n){$(n).on("keydown",function(n){n.keyCode==46||n.keyCode==8||n.keyCode==9||n.keyCode==27||n.keyCode==13||n.keyCode==65&&n.ctrlKey===!0||n.keyCode>=35&&n.keyCode<=39||(n.shiftKey||(n.keyCode<48||n.keyCode>57)&&(n.keyCode<96||n.keyCode>105))&&n.preventDefault()})}},function(){var r="mail-check-container",u="mail-suggestion-container",i="suggested-email",f="mail-input",e="address",o="domain",n="show-suggestion",s="email-exists-error",t="show-error";ko.bindingHandlers.checkmail={init:function(h,c,l){var a=$(h),p=c(),g=l(),w=g.mailcheckOptions,ut=w.translation,ft=w.checkExistingMail,tt=w.initialEmail,et=w.existingMailTranslation,it=$(document.createElement("div")),v=$(document.createElement("div")),nt=$(document.createElement("a")),b=$(document.createElement("span")),k=$(document.createElement("span")),y=$(document.createElement("div")),rt=$(document.createElement("span")),d;a.addClass(f);it.addClass(r);v.addClass(u);y.addClass(s);nt.addClass(i);b.addClass(e);k.addClass(o);a.wrap(it);a.after(v);v.html(nt);a.after(y);y.html(rt);rt.html(et||undefined);a.on("blur",function(){a.mailcheck({suggested:function(t,i){v.addClass(n);b.html(i.address);k.html(i.domain);nt.html(ut+" "+b.html()+"@"+k.html()+"?");var r=b.html()+"@"+k.html(),u=a.val(),f=ko.utils.arrayFilter(p(),function(n){return n.suggestion==r&&n.written==u}).length>=1;f||p.push({suggestion:r,written:u,clicked:!1,exists:!1});d()},empty:function(){v.removeClass(n);d()}})});v.on("click","."+i,function(t){var r=p(),i=r[r.length-1];i.clicked=!0;typeof g.value!="undefined"?g.value(i.suggestion):a.val(i.suggestion);v.removeClass(n);t.preventDefault();d()});d=function(){if(ft){y.removeClass(t);var n=a.val();n!=undefined&&(tt?n!==tt:!0)&&frm.services.accountService.checkEmail(n).then(function(i){i.data?(y.addClass(t),p.push({suggestion:n,written:n,clicked:!1,exists:!0})):(y.removeClass(t),p.push({suggestion:n,written:n,clicked:!1,exists:!1}))})}}}}}(),function(){var t={isConnectionOpen:function(){var n=$.connection.hub,t=n.state,i=$.signalR.connectionState.disconnected;return n&&t===i?!1:!0},restartConnection:function(){return $.connection.hub.start()}},i={messageSent:function(){frm.events.dispatch("messageinput:message:sent")}},n={INPUT:{_MAIN:"message-input-widget",_LOADSTATE:"message-input-loadstate",_ERRORSTATE:"message-input-error",TEXTAREA:"message-input-textarea",FOOTER:"message-input-footer"},TEMPLATE:{_MAIN:"template-widget-container",DROPDOWN:"template-widget-dropdown-list"}},r={AUTOGROW:", autogrow: true"},u=function(n){var i="",t;for(t in n)n.hasOwnProperty(t)&&(i+=typeof n[t]=="string"?t+": '"+n[t]+"', ":t+": "+n[t]+", ");return i.substring(0,i.length-2)},f=function(n){return $matchContainer=$(document.createElement("div")).addClass("pull-left").attr("data-bind","with: MessageMatchViewModel"),$matchBtn=$(document.createElement("a")),$matchBtn.css({"margin-left":"15px"}),$matchBtn.attr("href","#"),$matchBtn.attr("data-bind","click: RemoveMatch"),$matchBtn.html(n.texts.removeMatchBtn),$matchContainer.append($matchBtn),$matchContainer},e=function(t){var i=t.templateOptions.texts;return $templateContainer=$(document.createElement("div")).addClass(n.TEMPLATE._MAIN+" pull-left").attr("data-bind","with: TemplateViewModel"),$helperText=$(document.createElement("span")).attr("data-bind","visible: TemplateList().length == 0").html(i.templateHelperText).addClass("template-helper-text"),$templateDropDown=$(document.createElement("div")).addClass(n.TEMPLATE.DROPDOWN),$templateList=$(document.createElement("ul")).html('<!-- ko if : TemplateList().length > 0  --> <!-- ko foreach : TemplateList --> <li class="template-item" data-bind="text:Name, click: $parent.SelectTemplate"><\/li> <!-- /ko --> <!-- /ko -->'),$templateBtn=$(document.createElement("a")),$templateBtn.html('<a class="btn white btn-small"><i class="fa fa-file-text-o fa-lg" aria-hidden="true"><\/i><\/a><span class="LoadSpinner small" data-bind="visible: DropDownLoading"><\/span>'),$templateBtn.attr("href","#"),$templateBtn.attr("data-bind","click: ToggleDropDown"),$templateDropDown.attr("data-bind","slideVisibleFast: DropDownVisible, slideVisibleSettings: { enableClose: true }"),$templateDropDown.append($helperText),$templateDropDown.append($templateList),$templateList.append($(document.createElement("li")).addClass("divider")),$templateList.append($(document.createElement("li")).attr("data-bind","click: StartCreateTemplate").html('<i class="fa fa-plus" aria-hidden="true"><\/i>'+i.createTemplate).addClass("template-action")),$templateList.append($(document.createElement("li")).html('<i class="fa fa-pencil" aria-hidden="true"><\/i>'+i.editTemplate).addClass("template-action").attr("data-bind","click: StartEditTemplate, visible: TemplateList().length > 0")),$templateContainer.append($templateBtn),$templateContainer.append($templateDropDown),$templateContainer},o=function(t,i){var o=i;$loadingOverlay=$(document.createElement("div"));$errorOverlay=$(document.createElement("div"));$errroText=$(document.createElement("div"));$errorCloseBtn=$(document.createElement("a"));$loader=$(document.createElement("div"));$formWrapper=$(document.createElement("form"));$textArea=$(document.createElement("textarea"));$footer=$(document.createElement("div"));$sendButton=$(document.createElement("input"));t.autoGrowOptions!=undefined&&(r.AUTOGROW=", autogrow : {"+u(t.autoGrowOptions)+"}");$formWrapper.attr("method","post");$formWrapper.attr("data-bind","submit: SendMessage, disable: Form.IsDisabled, css: {'mobile-input' : IsMobile() === true}");$sendButton.attr("type","submit");$sendButton.attr("data-bind","disable: Form.IsDisabled");$textArea.attr("data-bind","textInput: MessageModel.Message, value: MessageModel.Message,  disable: Form.IsDisabled"+r.AUTOGROW);$loadingOverlay.attr("data-bind","visible: Loading()");$errorOverlay.attr("data-bind","slideVisible: ErrorStat.Status()");$errroText.attr("data-bind","text: ErrorStat.Message()");$errorCloseBtn.attr("href","#");$errorCloseBtn.attr("data-bind","click: CloseError");$errorCloseBtn.html('<i class="fa fa-times fa-lg" aria-hidden="true"><\/i>');$sendButton.attr("value",t.inputOptions.texts.sendBtn);$textArea.attr("placeholder",t.inputOptions.texts.textAreaPlaceholder);o.addClass(n.INPUT._MAIN);$loadingOverlay.addClass(n.INPUT._LOADSTATE);$errorOverlay.addClass(n.INPUT._ERRORSTATE);$loader.addClass("LoadSpinner");$textArea.addClass(n.INPUT.TEXTAREA);$textArea.addClass("form-control message-input-textarea");$footer.addClass(n.INPUT.FOOTER);$sendButton.addClass("btn blue pull-right");$formWrapper.append($textArea);$formWrapper.append($footer);$footer.append($sendButton);$loadingOverlay.append($loader);$errorOverlay.append($errorCloseBtn);$errorOverlay.append($errroText);o.append($errorOverlay);o.append($loadingOverlay);o.append($formWrapper);t.inputOptions.isLoggedIn&&($saveAsTemplateBtnContainer=$(document.createElement("div")).addClass("save-as-template-container"),$saveAsTemplateBtn=$(document.createElement("a")).html(t.templateOptions.texts.saveAsTemplate).attr("data-bind","click: TemplateViewModel.StartCreateTemplate, visible: MessageModel.HasChanged").attr("href","#"),$saveAsTemplateBtnContainer.append($saveAsTemplateBtn),$footer.append($saveAsTemplateBtnContainer),$footer.append(e(t)),t.matchOptions!=undefined&&$footer.append(f(t.matchOptions)))};ko.bindingHandlers.messageInput={init:function(n,r,u){var f=this,c=$(n),a=r(),l=u(),s,e,h;f.Options=ko.observable(l.messageInput.options);f.TemplateViewModel=new frm.models.MessageTemplateViewModel;f.Options().matchOptions&&(s=f.Options().matchOptions,f.MessageMatchViewModel=function(){var n=this;n.RemoveMatch=function(){var n=s.matchId;s.callBacks.removeMatch(n)}});e={sendMessage:function(n){typeof n.Message!="undefined"&&n.Message.trim()!==""&&(f.EnsureInputState(!0),window.CONNECTION_ESTABLISHED.$promise.done(function(){$.connection.NotificationHub.server.sendChatMessage(n).then(function(){f.ClearMessageModel();f.Options().inputOptions.callBacks.onSuccessSend();f.EnsureInputState(!1);EnsureErrorStat({Status:!1});i.messageSent()},function(){f.Options().inputOptions.callBacks.onFailureSend();f.EnsureInputState(!1);EnsureErrorStat({Status:!0,Message:f.Options().inputOptions.texts.errors.unknownError})})}).fail(function(){f.EnsureInputState(!1);EnsureErrorStat({Status:!0,Message:f.Options().inputOptions.texts.errors.unknownError})}))},replyMessage:function(n){return typeof n.Message=="undefined"||n.Message.trim()===""?null:(f.EnsureInputState(!0),window.CONNECTION_ESTABLISHED.$promise.done(function(){return $.connection.NotificationHub.server.replyChatMessage(n).then(function(){f.ClearMessageModel();f.Options().inputOptions.callBacks.onSuccessSend();f.EnsureInputState(!1);EnsureErrorStat({Status:!1});i.messageSent()},function(){f.Options().inputOptions.callBacks.onFailureSend();f.EnsureInputState(!1);EnsureErrorStat({Status:!0,Message:f.Options().inputOptions.texts.errors.unknownError})})}).fail(function(){f.EnsureInputState(!1);EnsureErrorStat({Status:!0,Message:f.Options().inputOptions.texts.errors.unknownError})}))},createPaymentAction:function(n){f.EnsureInputState(!0);var i=n.Message.replace(/\r\n|\n|\r/g,"<br>").replace(/'/g,"\\'"),r={Event:"Message",EventData:JSON.stringify({RecipientAccountId:n.recipientAccountId,Message:i,TemplateId:n.TemplateId,TemplateWasChanged:n.TemplateWasChanged})},t=f.Options().inputOptions.paymentCenterUrl;frm.services.PaymentActionService.create(r).then(function(n){if(t=t+"&paymentactionId="+n.data,f.Options().inputOptions.isLoggedIn)window.location.href=t;else{f.Options().inputOptions.callBacks.onPaymentActionSuccess(t);f.EnsureInputState(!1);EnsureErrorStat({Status:!1})}})},sendCategoryBulkMessage:function(n){var t,u,r,e;if(typeof n.Message=="undefined"||n.Message.trim()==="")return null;if(t=f.Options().inputOptions.texts.bulk.warningPreSend,u=t.inboxWarning,n.CategoryId!=undefined)for(r in t)if(t.hasOwnProperty(r)&&r===n.CategoryId.toString()){u=t[r];continue}(e=confirm(u),e!=!1)&&(f.EnsureInputState(!0),f.Options().inputOptions.preCallBacks.onPreSend(),window.CONNECTION_ESTABLISHED.$promise.done(function(){$.connection.NotificationHub.invoke("BulkMessageList",n).then(function(){f.ClearMessageModel();f.Options().inputOptions.callBacks.onSuccessSend();f.EnsureInputState(!1);EnsureErrorStat({Status:!1});i.messageSent()},function(){f.Options().inputOptions.callBacks.onFailureSend();f.EnsureInputState(!1);EnsureErrorStat({Status:!0,Message:f.Options().inputOptions.texts.errors.unknownError})})}).fail(function(){f.EnsureInputState(!1);EnsureErrorStat({Status:!0,Message:f.Options().inputOptions.texts.errors.unknownError})}))}};f.IsMobile=ko.observable(!0);f.Loading=ko.observable(!1);f.ErrorStat={Status:ko.observable(!1),Message:ko.observable()};f.Form={IsDisabled:ko.observable(f.Options().inputOptions.isMessagingDisabled||!1)};f.MessageModel={HasChanged:ko.observable(!1),Message:ko.observable(),TemplateId:ko.observable()};f.SendMessage=function(){var n;if(!f.Loading()&&!f.Form.IsDisabled()&&!f.Options().inputOptions.isMessagingDisabled&&f.MessageModel.Message()!=undefined){if(f.Options().inputOptions.isPaymentAction){n={recipientAccountId:f.Options().inputOptions.recipientAccountId,Message:f.MessageModel.Message(),TemplateId:f.MessageModel.TemplateId(),TemplateWasChanged:f.MessageModel.HasChanged()};e.createPaymentAction(n);return}if(f.Options().inputOptions.isCategoryBulkMessage!=undefined&&f.Options().inputOptions.isCategoryBulkMessage==!0){n={Sender:f.Options().inputOptions.senderAccountId,CategoryId:f.Options().inputOptions.categoryId,Message:f.MessageModel.Message(),TemplateId:f.MessageModel.TemplateId(),TemplateWasChanged:f.MessageModel.HasChanged()};t.isConnectionOpen()?e.sendCategoryBulkMessage(n):t.restartConnection().done(function(){e.sendCategoryBulkMessage(n)});return}f.Options().inputOptions.threadId!=undefined&&f.Options().inputOptions.threadId>0?(n={ThreadId:f.Options().inputOptions.threadId,Message:f.MessageModel.Message(),TemplateId:f.MessageModel.TemplateId(),TemplateWasChanged:f.MessageModel.HasChanged()},t.isConnectionOpen()?e.replyMessage(n):t.restartConnection().done(function(){e.replyMessage(n)})):(n={Recipients:[f.Options().inputOptions.recipientAccountId],Sender:f.Options().inputOptions.senderAccountId,Message:f.MessageModel.Message(),TemplateId:f.MessageModel.TemplateId(),TemplateWasChanged:f.MessageModel.HasChanged()},t.isConnectionOpen()?e.sendMessage(n):t.restartConnection().done(function(){e.sendMessage(n)}))}};f.EnsureInputState=function(n){f.Loading(n);f.Form.IsDisabled(n)};f.EnsureErrorStat=function(n){f.ErrorStat.Status(n.Status);n.Message?f.ErrorStat.Message(n.Message):f.ErrorStat.Message(f.Options().inputOptions.texts.errors.unknownError)};f.ClearMessageModel=function(){f.MessageModel.Message(undefined);f.MessageModel.TemplateId(undefined);f.MessageModel.HasChanged(!1)};f.CloseError=function(){f.ErrorStat.Status()==!0&&f.EnsureErrorStat({Status:!1})};f.TemplateViewModel.SelectTemplate=function(n){n!=undefined&&(f.MessageModel.Message(n.Message),f.MessageModel.TemplateId(n.Id),f.TemplateViewModel.ToggleDropDown(!1),f.MessageModel.HasChanged(!1))};f.TemplateViewModel.StartCreateTemplate=function(){var n=f.Options().templateOptions,t;n.messageModel=f.MessageModel;n.callback={onSuccess:function(n){f.TemplateViewModel.templatesLoaded()?f.TemplateViewModel.TemplateList.push(n):frm.events.dispatch("messagetemplate:edit:done")}};f.TemplateViewModel.ToggleDropDown(!1);t=f.TemplateViewModel.GetPopUp(n);frm.models.GenericPopupViewModel.create(t).then(function(){t.Areas.Templates.SetTemplateCreateFromMessageViewModel()})};f.TemplateViewModel.StartEditTemplate=function(){var t=f.Options().templateOptions,n;t.templates=f.TemplateViewModel.TemplateList();n=f.TemplateViewModel.GetPopUp(t);frm.models.GenericPopupViewModel.create(n).then(function(){n.Areas.Templates.SetEditTemplateViewModel()})};o(f.Options(),c);f.Options().inputOptions===undefined&&console.log("ERROR: Required options is not defined");f.MessageModel.Message.subscribe(function(n){n!=undefined?n!=""||n.length>0?f.MessageModel.HasChanged(!0):f.MessageModel.HasChanged(!1):f.MessageModel.HasChanged(!1)});$textArea.on("focus",function(){frm.events.dispatch("messageinput:textarea:focus");f.CloseError()});h=function(){$(window).width()<=767?f.IsMobile(!0):f.IsMobile(!1)};window.onresize=function(){h()};h()}}}(),function(){var n={CONTAINER:"switch",BASE_CLASS:"cmn-toggle",STYLE_CLASS:"cmn-toggle-round-flat"};ko.bindingHandlers.toggle={init:function(t,i,r){var e=$(t),u=i(),o=r(),f;r().toggleOptions&&(f=r().toggleOptions);$container=$(document.createElement("div"));$input=$(document.createElement("input")).attr({type:"checkbox",checked:u});$label=$(document.createElement("label"));$container.append($input);$container.append($label);e.append($container);$container.addClass(n.CONTAINER);$input.addClass(n.BASE_CLASS);$input.addClass(n.STYLE_CLASS);$container.on("click",function(){var t=$(this),n=t.find("input");u=!n.prop("checked");n.prop("checked",u);f.onClick&&f.onClick()})}}}(),function(){var n={MAIN:"sidebar-menu",SIDEBAR_COLLAPSED:"sidebar-collapsed",SIDEBAR_MENU_ITEM:"sidebar-menu-item",ACTIVE_MENU:"active"};ko.bindingHandlers.sidebarmenu={init:function(t,i,r){var u=$(t),o=i(),s=r(),e=$("."+n.SIDEBAR_MENU_ITEM),f={isMobileView:ko.observable(!1)};u.addClass(n.MAIN);u.addClass(n.SIDEBAR_COLLAPSED);u.children().addClass(n.SIDEBAR_MENU_ITEM);detectMobile=function(){$(window).width()<=768?f.isMobileView(!0):f.isMobileView(!1)};u.on("mouseover",function(){detectMobile();f.isMobileView()||u.removeClass(n.SIDEBAR_COLLAPSED)});u.on("mouseout",function(){detectMobile();f.isMobileView()||u.addClass(n.SIDEBAR_COLLAPSED)});e.on("click",function(){e.removeClass(n.ACTIVE_MENU);$(this).addClass(n.ACTIVE_MENU)})}}}(),function(){var i="data-stickyitem",t={OFFSET:70,SCROLLSPEED:700},n={MAIN:"sticky-sidebar",_STICK:"stick",ANCHOR:"sticky-list-anchor",NONE_LIST:"sticky-none-list",LIST:"sticky-list",CONTAINER:"sticky-list-items-container",ITEM:"item",ACTIVE:"active"};ko.bindingHandlers.stickyNavigation={init:function(n,t){$(function(){var r=ko.unwrap(t()),i={},u={isScrolling:!1},f={onScroll:function(){var n=i.$window.scrollTop()+r.offset,o=i.$anchor.offset().top,e;if(i.$stickyContainer.attr("style",""),n>o&&i.$stickyContainer.css({position:"fixed",top:r.offset}),i.$endPoint.length>0){var t=i.$endPoint.offset().top-r.offset,s=i.$stickyContainer.offset().top,f=i.$stickyContainer.outerHeight(!0);s+f>=t&&i.$stickyContainer.css({position:"absolute",top:t-f,left:0})}u.isScrolling||($(".active",i.$stickyItems).removeClass("active"),e=$(function(){var t=$(".item",i.$stickyItems).filter(function(){var i=$(this),t=$(i.data("target"));return t.length>0?n>=t.offset().top:!1});return t[t.length-1]}()),e.addClass("active"))},onItemClick:function(n){var t=$(this),e=$(t.data("target")),f=t.attr("href");f!==""&&f!=="#"&&history.pushState({},"",f);$(".active",i.$stickyItems).removeClass("active");t.addClass("active");e.length>0&&(i.$body.stop(),u.isScrolling=!0,i.$body.animate({scrollTop:e.offset().top-r.offset},700,function(){u.isScrolling=!1}));n.preventDefault()}};i.$window=$(window);i.$body=$("body");i.$element=$(n);i.$anchor=i.$element.find(".sticky-list-anchor");i.$stickyContainer=i.$element.find(".sticky-list");i.$stickyItems=i.$element.find(".sticky-items");i.$endPoint=$(r.endpoint);i.$element.on("click",".sticky-items .item",f.onItemClick);i.$window.on("scroll",f.onScroll);f.onScroll()})}};ko.bindingHandlers.stickysidebarmenu={init:function(r,u,f){var a=$(r),s=u(),h=f(),o=this,b=h.stickyOptions.noneListItems,k=h.stickyOptions.startItem,v=h.stickyOptions.endPoint,y=h.stickyOptions.offSet,p=$(document.createElement("div")),c=$(document.createElement("div")),e=$(document.createElement("div")),l=$(document.createElement("div")),w;a.addClass(n.MAIN);p.addClass(n.ANCHOR);c.addClass(n.CONTAINER);e.addClass(n.LIST);l.addClass(n.NONE_LIST);a.append(p);a.append(e);e.append(l);e.append(c);ko.utils.arrayForEach(b,function(t){var i=$(document.createElement("a")).addClass(n.ITEM).attr("href",t.url).html("<span>"+t.name+"<\/span>");l.prepend(i)});ko.utils.arrayForEach(s,function(t){var r=$(document.createElement("a")).addClass(n.ITEM).data(i,t).html("<span>"+t.name+"<\/span>");t.class&&r.addClass(t.class);c.append(r)});o.CanScroll=ko.observable(!1);o.ScrollMenu=ko.observable(!0);c.on("click","."+n.ITEM,function(r){var e,f,c,s;o.ScrollMenu(!1);r.preventDefault();var l=$(this),u=l.data(i),h=$(u.target);for(u.url&&u.url!=undefined&&history.pushState({},"",u.url),$("."+n.CONTAINER+" ."+n.ITEM).removeClass(n.ACTIVE),e=$("."+n.CONTAINER).children(),f=0;f<e.length;f++)c=$(e[f]).data(i),c.target==u.target&&$(e[f]).addClass(n.ACTIVE);h.length&&(s=$("html, body"),s.stop(),s.animate({scrollTop:h.offset().top-t.OFFSET},t.SCROLLSPEED,function(){o.ScrollMenu(!0)}))});o.stickyMenu=function(){var u=$(window).scrollTop()+t.OFFSET,f=$("."+n.ANCHOR).offset().top,i,r;u>f?(e.addClass(n._STICK),e.attr("style","")):(e.removeClass(n._STICK),e.attr("style",""));v&&(i=$(v).offset().top,r=e.offset().top+e.outerHeight(!0),r>=i&&(e.removeClass(n._STICK),e.css({position:"absolute",top:i-e.offset().top-e.outerHeight(!0)-t.OFFSET,left:0})))};o.currentMenu=function(){var h,r,f,e,u,l;if(o.ScrollMenu())for(h=$(window).scrollTop()+t.OFFSET,$("."+n.CONTAINER+" ."+n.ITEM).removeClass(n.ACTIVE),r=0;r<s.length;r++)if(f=$(s[r].target),f.length>0){var a=f.offset(),c=a.top,v=f.height()+60;if(h>=c&&h<c+v)for($("."+n.CONTAINER+" ."+n.ITEM).removeClass(n.ACTIVE),e=$("."+n.CONTAINER).children(),u=0;u<e.length;u++)l=$(e[u]).data(i),l.target==s[r].target&&$(e[u]).addClass(n.ACTIVE)}};o.SetStartMenu=function(){var n=k||undefined;n!=undefined&&setTimeout(function(){var i=$(n),r=i.offset().top-t.OFFSET;$(document).scrollTop(r)},1e3);o.CanScroll(!0)};$(window).scroll(function(){o.stickyMenu();o.CanScroll()&&o.currentMenu()});y&&l.css("padding-top",y);w=$("."+n.CONTAINER).children();$(w[0]).addClass(n.ACTIVE);o.SetStartMenu()}}}();ko.bindingHandlers.fadeVisible={init:function(n,t){var i=t();$(n).toggle(ko.unwrap(i))},update:function(n,t){var i=t();ko.unwrap(i)?$(n).fadeIn():$(n).fadeOut()}};ko.bindingHandlers.fadeVisibleFast={init:function(n,t){var i=t();$(n).toggle(ko.unwrap(i))},update:function(n,t){var i=t();ko.unwrap(i)?$(n).fadeIn(220):$(n).fadeOut(220)}};ko.bindingHandlers.fadeVisibleIn={init:function(n,t){var i=t();$(n).toggle(ko.unwrap(i))},update:function(n,t){var i=$(n),r=t(),u=ko.unwrap(r);u?i.fadeIn():i.hide()}};ko.bindingHandlers.confirmButton={init:function(n,t,i,r){var u=$(n),f=t();u.one("click",function(n){u.html(f.confirmText);u.one("click",function(n){f.click(r);n.preventDefault()});n.preventDefault()})}};ko.bindingHandlers.equalHeight={init:function(n,t){var r=$(n),u=t(),f=r.find(u),e={getHeighest:function(){var t=$(this),n=t.height();n>i&&(i=n)}},i=0;setTimeout(function(){f.each(e.getHeighest).css({"min-height":i+"px"})},10)}};ko.bindingHandlers.slideVisible={init:function(n,t){var i=t();$(n).toggle(ko.unwrap(i))},update:function(n,t){var i=t();ko.unwrap(i)?$(n).slideDown():$(n).slideUp()}},function(){var n=function(n,t){return function(i){!n.has($(i.target)).length&&t()&&t()(!1)}};ko.bindingHandlers.slideVisibleFast={init:function(n,t){var i=t();$(n).toggle(ko.unwrap(i))},update:function(t,i,r){var o=ko.unwrap(i()),u=$(t),f=$("body"),s=ko.unwrap(r()),e=s.slideVisibleSettings;if(typeof e!="undefined"){if(u.data("closeEvent",function(){if(e.enableClose)f.on("click",n(u,i))}),o){u.slideDown(100,u.data("closeEvent"));return}f.off("click")}u.slideUp(100)}}}(),function(){ko.bindingHandlers.clickOutside={init:function(n,t){$(function(){var i=$(n),r=$("body");r.on("click touchstart",function(n){t().model()&&!i.has($(n.target)).length&&i[0]!==n.target&&(t().callback(),n.preventDefault())})})}}}();ko.bindingHandlers.masonry={init:function(n,t,i){function f(){r.masonry({itemSelector:".search-result",transitionDuration:0,columnWidth:310})}function e(){r.masonry("destroy").css("height","auto");f(r)}var u=i(),r=$(n);u.foreach.afterAdd=function(n){n.nodeType===1&&r.masonry("appended",n)};u.foreach.beforeRemove=function(n){$(n).remove();r.children(".search-result").length==0&&e()};f()}};ko.bindingHandlers.slider={init:function(n,t,i){var u=t(),e=i(),r=e.sliderOptions||{},f=$(n),o=frm.utils.debounce(function(){r.onChange&&r.onChange()},200);f.slider({max:r.max,min:r.min,step:r.step||1,value:ko.utils.unwrapObservable(u)}).on("slide",function(n,t){u(t.value);o()});u.subscribe(function(n){f.slider("value",parseInt(n))})}};ko.bindingHandlers.rangeSlider={init:function(n,t,i){function o(n){var t=r.max();n!==""&&(n<f&&(r.min(f),n=f),n>=t&&(r.min(t),n=t),u.slider("values",0,n),r.ui.min(n),e())}function s(n){u.slider("values",1,n);r.ui.max(n);e()}var r=t(),u=$(n),f=u.attr("data-min"),h=u.attr("data-max"),l=i(),c=r.step||100,e=frm.utils.debounce(function(){r.onChange&&r.onChange()},200);u.slider({range:!0,min:parseInt(f),max:parseInt(h),step:c,values:[r.min(),r.max()]}).on("slide",function(n,t){typeof r.ui!="undefined"&&(r.ui.min(t.values[0]),r.ui.max(t.values[1]))}).on("slidechange",function(n,t){r.min(t.values[0]);r.max(t.values[1]);e()});r.min.subscribe(o);r.ui.min.subscribe(o);r.max.subscribe(s);r.ui.max.subscribe(s)}};ko.bindingHandlers.show={update:function(n,t){var r="ko-hidden",i=ko.utils.unwrapObservable(t());return i&&$(n).removeClass(r),i||$(n).addClass(r),!i}},function(){function n(n){var t=n.terms,r=ko.utils.arrayMap(n.terms,function(n){return n.value}).join(", "),i=t[0].value+" ",u=t.length;return u>1&&(t.splice(0,1),i+="<span class='text-xsmall text-inverted'>",i+=ko.utils.arrayMap(t,function(n){return n.value}).join(", "),i+="<\/span>"),{html:i,key:r,data:n}}ko.bindingHandlers.typeahead={init:function(t,i,r){var u=$(t),f=r(),o=i(),e={source:[],autoselect:!0},s={};f.typeaheadOptions&&(f.typeaheadOptions.onlyAddress==!0&&(s.onlyAddress=!0),$.each(f.typeaheadOptions,function(n,t){e[n]=t}));var c=f.typeaheadOptions.googleMap||t,h=new frm.services.GoogleSuggestionService("DK",c,s),l=o.subscribe(function(n){if(typeof n!="undefined"&&n!==null&&n.length>0&&n!==u.typeahead("val")){u.one("custom:typeahead:loaded",function(){var n=$.Event("keydown");n.keyCode=$.ui.keyCode.ENTER;u.trigger(n)});u.typeahead("val",n);var t=$.Event("keydown");t.keyCode=$.ui.keyCode.DOWN;u.trigger(t);u.typeahead("val","");u.typeahead("close")}else typeof n!="undefined"&&n!==null&&n.length==0&&u.typeahead("val","")});u.attr("autocomplete","off").val(o()).typeahead(e,{source:function(t,i){if(typeof t=="undefined"||t.length==0){i([]);return}h.getSuggestions(t).then(function(t){if(t.length===0){e.onSelected(null);return}var r=ko.utils.arrayMap(t,n);i(r);u.trigger("custom:typeahead:loaded")})},displayKey:"key",templates:{suggestion:function(n){return"<p>"+n.html+"<\/p>"}}}).on("typeahead:selected",function(n,t){u.blur();h.geocode(t.data).then(function(n){e.onSelected(n)})}).on("keyup",function(){u.val()===""&&o("")});ko.utils.domNodeDisposal.addDisposeCallback(t,function(){l.dispose()})}}}(),function(){ko.bindingHandlers.transitionend={init:function(n,t,i){var f=$(n),e=t(),r=i(),u=function(n){return frm.utils.debounce(function(){e(n)},300)};f.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(n){r.transitionListener?r.transitionListener==n.originalEvent.propertyName&&u(n)():u(n)();n.preventDefault()})}}}(),function(){ko.bindingHandlers.preventTransitionBubbleing={init:function(n,t,i){var r=$(n),u=t(),f=i();r.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(n){ko.utils.unwrapObservable(u)&&n.stopPropagation()})}}}(),function(){var n={EVENT_NAME:"scroll.ko.scrollHandler"},t=$(window);ko.bindingHandlers.infiniteScroll={init:function(i,r,u){var f=$(i),e=u().infiniteScrollOptions;e.itemSelector!==undefined?(i.setAttribute("data-isObject",!0),f.data("container",$(e.itemSelector))):f.data("container",t);ko.utils.domNodeDisposal.addDisposeCallback(i,function(){var t=f.data("container");t.off(n.EVENT_NAME)})},update:function(t,i,r){var s=$(t),f=r().infiniteScrollOptions,e=f.offset||0,o=f.onNextPage,h=ko.utils.unwrapObservable(i()),c=t.hasAttribute("data-isObject"),u=s.data("container"),l=function(){var f=$(document),s=f.height(),i=u.height(),r=u.scrollTop()||0,h=t.hasAttribute("data-loading"),l=i-r,a=i+r,n;h||(e>=l&&c?(n=o(),n!==null&&n!==undefined&&(t.setAttribute("data-loading","true"),n.then(function(){t.removeAttribute("data-loading")}))):s-e<=i+r&&(n=o(),n!==null&&n!==undefined&&(t.setAttribute("data-loading","true"),n.then(function(){t.removeAttribute("data-loading")}))))};if(h)u.off(n.EVENT_NAME);else u.on(n.EVENT_NAME,frm.utils.debounce(l,60))}}}(),function(){ko.bindingHandlers.mobileBurger={init:function(n,t,i){var u=$(n),f=t(),e=i(),r=e.burgerOptions||{};u.on("click",function(){window.AppState.openBurger($(f),{onClose:function(){r.onClose&&r.onClose()}})})}}}();ko.bindingHandlers.money={update:function(n,t){var r=$(n),i=ko.utils.unwrapObservable(t());i=Math.round(i);r.text(i.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."))}};ko.bindingHandlers.inputSlider={init:function(n){var t=$(n),i=t.find(".query");if(!t.hasClass("input-group"))throw new Error("InputSlider do only work for input group");},update:function(){}},function(){var n="ss-open",t="ss-item",i="optionValue";ko.bindingHandlers.simpleSelect={init:function(r,u,f){var h=$(r),l=u()||ko.observable(),v=f(),e=v.simpleSelectOptions,s=ko.utils.unwrapObservable(e.options),o=$(document.createElement("div")),a=$(document.createElement("a")),y=ko.unwrap(l),c=null,p=(u()===null&&typeof e.selectedValue=="function"?ko.utils.arrayFirst(s,function(n){return e.selectedValue(n.value)}):ko.utils.arrayFirst(s,function(n){return n.value===y}))||s[0];ko.utils.arrayForEach(s,function(n){o.append($(document.createElement("a")).addClass(t).attr("href","#").data(i,n.value).text(n.text))});ko.isObservable(e.options)&&e.options.subscribe(function(n){o.html("");ko.utils.arrayForEach(n,function(n){o.append($(document.createElement("a")).addClass(t).attr("href","#").data(i,n.value).text(n.text))})});o.addClass("ss-list").on("click","."+t,function(t){var u=$(this),r=u.data(i);if(l(r),typeof e.onSelect=="function")e.onSelect(r);h.removeClass(n);t.preventDefault()});a.addClass("ss-selected").attr("href","#").on("click",function(t){h.toggleClass(n);t.preventDefault()}).text(p.text);h.addClass("simpleSelect").append(a).append(o).on("mouseenter",function(){c!==null&&(clearTimeout(c),c=null)}).on("mouseleave",function(){c=setTimeout(function(){o.slideUp(200,function(){o.css("display","");h.removeClass(n)})},500)});l.subscribe(function(n){var t=ko.utils.arrayFirst(s,function(t){return t.value===n});t!==null&&a.text(t.text)})}}}(),function(){function t(n,t,i){var r;return function(){var u=this,f=arguments,e=function(){r=null;i||n.apply(u,f)},o=i&&!r;clearTimeout(r);r=setTimeout(e,t);o&&n.apply(u,f)}}function n(n,t){var i={itemSelector:t.itemSelector||undefined,transitionDuration:t.transitionDuration,columnWidth:t.columnWidth},r=new Masonry(n,i)}ko.bindingHandlers.masonry={makeTemplateValueAccessor:function(i,r,u){return function(){var e=u(),o=ko.utils.peekObservable(e),f=[],s=t(function(){var t=Masonry.data(i);typeof t=="undefined"?n(i,r):t.appended(f);f=[]},200),h=t(function(){var n=Masonry.data(i);typeof n!="undefined"&&n.layout()},200),c=function(n){n.nodeType===1&&(f.push(n),s())},l=function(n){$(n).remove();h()};return{foreach:o.data,afterAdd:c,beforeRemove:l,templateEngine:ko.nativeTemplateEngine.instance}}},initializeTemplateValueAccessor:function(n,t,i){return function(){var n=i(),t=ko.utils.peekObservable(n);return{foreach:t.data,templateEngine:ko.nativeTemplateEngine.instance}}},init:function(t,i){var u=$(t),r=i();return typeof r.data=="undefined"?(n(t,r),null):ko.bindingHandlers.template.init(t,ko.bindingHandlers.masonry.initializeTemplateValueAccessor(t,r,i))},update:function(n,t,i,r,u){var e=$(n),f=t();return ko.bindingHandlers.template.update(n,ko.bindingHandlers.masonry.makeTemplateValueAccessor(n,f,t),i,r,u)}}}(),function(){function n(n){var i=[],t;if(typeof n!="undefined"&&n.length>0)for(t=0;t<n.length;t++)i.push($(document.createElement("li")).text(n[t]));return $(document.createElement("ul")).addClass("fake-input").attr("tabIndex","-1").append(i)}ko.bindingHandlers["autocomplete-tagged"]={init:function(t,i){var f=$(t),r=ko.unwrap(i()),u=n(r.value()),e=typeof r.tags!="string"?r.tags:function(n){return $.ajax({url:r.tags,data:{query:n}}).then(function(n){return n})};u.on("tagit-tag-added tagit-tag-removed",function(){var n=u.tagit("getTags");r.value(n)});u.tagit({tags:e});f.append(u)}}}();ko.bindingHandlers.number={init:function(n,t,i){var r=t(),u=i().value;if(typeof u=="undefined")throw new Exception("You need a value-binding to use the number-binding");u.subscribe(function(n){var t=parseInt(n);t<r.min&&u(r.min);t>r.max&&u(r.max)})}},function(){ko.bindingHandlers.datepicker={init:function(n,t,i){var u=$(n),r=t(),e=i(),o=$.extend({onSelect:function(n,t){r(t.selectedMonth+1+"-"+t.selectedDay+"-"+t.selectedYear)}},e.datepickerOptions),s=u.datepicker(o),f;r()!=""&&r()!=null&&(u.datepicker("setDate",r()),f=s.datepicker("getDate"),r(f.getMonth()+1+"-"+f.getDate()+"-"+f.getFullYear()));u.on("keyup",function(n){var t=u.val();t==""&&r(undefined);n.preventDefault()})}};ko.bindingHandlers.datepickerV2={init:function(n,t,i){var r=$(n),u=t(),f=i(),e=$.extend({onSelect:function(){u(r.datepicker("getDate").toISOString())}},f.datepickerOptions);r.datepicker(e);u()!=""&&u()!=null&&r.datepicker("setDate",u());r.on("keyup",function(n){var t=r.val();t==""&&u(undefined);n.preventDefault()})}}}(),function(){ko.bindingHandlers.gallery={init:function(n,t,i,r,u){var e=$(n),s=t(),h=i(),f={current:{pictureUrl:ko.observable(),description:ko.observable(),pictureId:ko.observable(),$element:ko.observable()},changePicture:function(n,t,i,r){f.current.$element($(i.currentTarget));f.current.pictureUrl(n);f.current.pictureId(r);f.current.description(t.replace("§","'"))},toggleFullscreen:function(){e.toggleClass("gallery-state-zoomed")},nextPicture:function(){var n=f.current.$element();n!==undefined&&(n.is(":last-child")?e.find(".gallery-thumb:first").trigger("click"):n.next().trigger("click"))}},o=u.createChildContext(f);return ko.applyBindingsToDescendants(o,n,!0),e.find(".gallery-thumb:first").trigger("click"),{controlsDescendantBindings:!0}}}}(),function(){ko.bindingHandlers.uploadForm={init:function(n,t,i){var f=$(n),e=i(),r=t(),u;if(!r.src)throw new Error("'src' is required");if(f.has("input[type='file']:not([name])").length>0)throw new Error("All file input must have a name for UploadForm-binding to work proberly!");u=$("<iframe />").attr({id:"iframe-file-upload",name:"iframe-file-upload",width:0,height:0,border:0,scroll:"no"}).css({position:"absolute","z-index":-999,border:"0",width:"0px",height:"0px"});f.attr({target:u.attr("id"),method:"POST",enctype:"multipart/form-data",action:r.src}).on("submit",function(){if(typeof r.validation!="undefined"&&!r.validation())return!1;typeof r.beforeSave!="undefined"&&r.beforeSave()}).append(u);u.on("load",function(){var i=u.contents(),n=i.text(),t=typeof n!="undefined"&&n.length>0?JSON.parse(n):null;t!==null&&typeof r.afterSave!="undefined"&&r.afterSave(t)})}}}(),function(){ko.bindingHandlers.map={init:function(n,t){var i=ko.unwrap(t()),u=i.latitude,f=i.longitude,r={mapTypeId:google.maps.MapTypeId.ROADMAP,minZoom:7,center:new google.maps.LatLng(u,f),zoom:13,scrollwheel:!1};this.map=new google.maps.Map(n,r);this.marker=new google.maps.Marker({map:map,position:r.center,icon:"/Content/Images/Search/Maps/pin_exact.png"})}}}();ko.bindingHandlers.dictionary={transformObject:function(n){var i=[],t;for(t in n)n.hasOwnProperty(t)&&i.push({key:t,value:n[t]});return i},init:function(n,t,i,r,u){var f=ko.utils.unwrapObservable(t()),e=ko.bindingHandlers.foreachprop.transformObject(f);return ko.applyBindingsToNode(n,{foreach:e},u),{controlsDescendantBindings:!0}}},function(){var n={getWindowHeight:function(){return $(window).height()},getMaxHeight:function(t){return t/100*n.getWindowHeight()}};ko.bindingHandlers.autogrow={init:function(t,i,r){var f=$(t),u=i(),s=r(),c=typeof u=="object"&&u.isEnabled||!!u,e=!0,o=typeof u=="object"&&u.maxHeight,h;c&&(typeof u=="object"&&(h=$(u.wrapper),t.addEventListener("autosize:resized",function(){if(e){var n=h.outerHeight(!0),t=n-f.data("previous-height");if(typeof u.onChanged!="undefined")u.onChanged(n,t);f.data("previous-height",n)}}),f.data("previous-height",f.outerHeight(!0))),o!=undefined&&o!=!1?autosize(t,{maxHeight:n.getMaxHeight(o)}):autosize(t),s.value&&s.value.subscribe(function(){if(e=!1,autosize.update(t),typeof u=="object"&&typeof u.onReset!="undefined"){var n=$(u.wrapper);u.onReset(n.outerHeight(!0))}e=!0}))}}}(),function(){ko.bindingHandlers.membershipDialog={init:function(n,t,i){var u=$(n),f=i(),r=t();u.on("click",function(n){r.isAuthorized||(frm.services.ModalService.open({href:r.url,width:460,height:600,onAfterClose:typeof r.onClose=="function"?r.onClose:undefined}),n.preventDefault())})}}}();ko.bindingHandlers.stopBinding={init:function(){return{controlsDescendantBindings:!0}}};ko.virtualElements.allowedBindings.stopBinding=!0,function(){ko.bindingHandlers.slimScroll={PerserveScrollingEvents:{PREPARE:"PREPARE",RESTORE:"RESTORE",HEIGHT_UPDATED:"HEIGHT_UPDATED"},init:function(n,t,i){$(function(){function e(){function t(){var n=r.data("scrollPosition"),t=r.prop("scrollHeight"),i=t-(r.data("scrollHeight")||0),u=r.outerHeight(!0);typeof n=="undefined"||t-n-i===u?r.slimScroll({scrollTo:r.prop("scrollHeight")+20}):r.slimScroll({scrollTo:r.data("scrollPosition")})}if(r.slimScroll(f),typeof u.onReachTop!="undefined"||typeof u.onReachBottom!="undefined"){r.on("slimscroll",function(n,t){var i=typeof u.isEventEnabled=="undefined"||typeof u.isEventEnabled=="function"&&u.isEventEnabled();if(i){if(typeof u.onReachTop!="undefined"&&t==="top"){u.onReachTop();return}if(typeof u.onReachBottom!="undefined"&&t==="bottom"){u.onReachBottom();return}}});setTimeout(function(){r.prop("scrollHeight")==r.outerHeight(!0)&&r.trigger("slimscroll","bottom")},2e3)}if(typeof u.perserveScrollPosition!="undefined"){r.data("previousScrollHeightMinusTop",0);var i=u.perserveScrollPosition.subscribe(function(n){switch(n){case ko.bindingHandlers.slimScroll.PerserveScrollingEvents.RESTORE:r.slimScroll({scrollTo:r.prop("scrollHeight")-r.data("previousScrollHeightMinusTop")});break;case ko.bindingHandlers.slimScroll.PerserveScrollingEvents.PREPARE:r.data("previousScrollHeightMinusTop",r.prop("scrollHeight")-r.scrollTop());break;default:throw new Error(n+" is not valid persevescrolling action");}});ko.utils.domNodeDisposal.addDisposeCallback(n,function(){i.dispose()})}if(typeof u.scroll!="undefined"&&u.scroll.subscribe(function(n){var i,u,e;n.event==="RESET"?(i=r.prop("scrollTop"),u=r.prop("scrollHeight"),r.data("scrollPosition",i+n.height+20),r.data("scrollHeight",u),t()):(e=r.scrollTop()+n.diff,r.slimScroll({destroy:!0}),r.slimScroll(f),r.slimScroll({scrollTo:e}))}),ko.utils.domNodeDisposal.addDisposeCallback(n,function(){r.slimScroll({destroy:!0});r.data("initialized",!1)}),typeof u.delayed=="function"&&f.start==="bottom"){r.on("scroll",function(){var n=r.prop("scrollTop"),t=r.prop("scrollHeight");r.data("scrollPosition",n);r.data("scrollHeight",t)});u.delayed.subscribe(function(n){n&&t()})}r.data("initialized",!0)}var r=$(n),o=i(),u=t(),f=u.options||{height:"200px"};typeof u.delayed=="function"?u.delayed.subscribe(function(){r.data("initialized")||e()},null,"beforeChange"):e()})}}}(),function(){ko.bindingHandlers.scrollTo={init:function(n,t,i){var r=$(n),u=t(),f=i().scrollToOptions||{};ko.unwrap(u)&&setTimeout(function(){var n=f.offsetTop||0;$("html, body").animate({scrollTop:r.offset().top-n})},500)}}}(),function(){var n=5e3;ko.bindingHandlers.bubbles={init:function(t,i){var r=i();r.subscribe(function(i){var u=document.createElement("div"),r;u.className="notification-center notification-bubbles";r=document.createElement("div");r.className="notification-center-list";u.appendChild(r);t.appendChild(u);i.forEach(function(t){var i=document.createElement("a");i.className="notification-center-item";i.href=t.Url;i.style.display="none";i.addEventListener("click",function(n){return(n.target||{}).href=(n.currentTarget||{}).href=t.NotificationUrl,!0});r.appendChild(i);ko.renderTemplate("NoticationTemplate$"+t.ItemType+"$"+t.Group,t,{afterRender:function(){var t=$(i);t.fadeIn(700,function(){setTimeout(function(){t.fadeOut(700)},n)});$(i).fadeIn()}},i,"replaceChildren")})})}}}(),function(){function n(n,t){var r=this,i=$("<div />").css({position:"absolute",left:0,top:0,"min-height":"5px",width:"100%","z-index":9});n.prepend(i);r.handleScroll=function(){var r=n.scrollTop();i.css("top",r);t.each(function(){var n=$(this),t=n.position().top;t>n.height()||i.html("").append(n.clone())})};n.on("scroll",function(){r.handleScroll()})}n.init=function(t,i){if($(window).width()>700)return new n(t,$(i))};ko.bindingHandlers.stickyHeader={init:function(t,i){var r=$(t),u=i();n.init(r,u)}}}(),function(){ko.bindingHandlers.smartForEach={init:function(n,t,i,r,u){return ko.bindingHandlers.foreach.init(n,t,i,r,u)},update:function(n,t,i,r,u){var f=t(),e=f.afterRender;return f.afterRender=function(){n.children.length===f.data().length&&f.onRendered();typeof e=="function"&&e.apply(this,arguments)},ko.bindingHandlers.foreach.update(n,ko.observable(f),i,r,u)}}}(),function(){ko.bindingHandlers.executeOnEnter={init:function(n,t,i,r){var u=t();$(n).keypress(function(n){var t=n.which?n.which:n.keyCode;return t===13?(u.call(r),!1):!0})}}}(),function(){ko.bindingHandlers.signUpBlock={init:function(n,t,i){var f=$(n),r=t(),u=i();$(window).on("scroll",function(){u.hardClose()||r(!0)})}}}();frm.ko.extensions.enableSneakyObservable=function(n){return n.pauseNotifications=!1,n.notifySubscribers=function(t,i){n.pauseNotifications||ko.subscribable.fn.notifySubscribers.call(n,t,i)},n.setSilent=function(t){n.pauseNotifications=!0;n(t);n.pauseNotifications=!1},n},function(n){var t=function(n){var t=this,i="?t=1";t.ViewContainer=$(".view-container");t.SearchUrl=ko.observable(n.searchUrl);t.StartUrl=ko.observable(undefined);t.HasSelectedSearchArea=ko.observable(!1);t.CurrentView={Name:ko.observable(),Model:ko.observable(null)};t.SetAuthenticationView=function(){t.ChangeView({Name:"view--signup",Model:r(n,t)})};t.SetAboutView=function(){t.ChangeView({Name:"view--about",Model:o(n,t)})};t.SetThanksView=function(){t.ChangeView({Name:"view--thanks",Model:null})};t.SetSearchAreaView=function(){t.ChangeView({Name:"view--searcharea",Model:u(n,t)})};t.SetRentView=function(){t.ChangeView({Name:"view--rent",Model:f(n,t)})};t.SetMoveInDateView=function(){t.ChangeView({Name:"view--moveindate",Model:e(n,t)})};t.SetRoommateView=function(){t.ChangeView({Name:"view--roommate",Model:s(n,t)})};t.SetReadyView=function(){t.ChangeView({Name:"view--ready",Model:h(n,t)})};t.ChangeView=function(n){t.ViewContainer.fadeOut("normal");setTimeout(function(){t.CurrentView.Name(n.Name);t.CurrentView.Model(n.Model)},399);t.ViewContainer.fadeIn("normal")};t.AutoChangeView=function(n,t){n();setTimeout(function(){t()},3e3)};var r=function(n,t){ko.validation.rules.acceptTerms={validator:function(n){return!!n}};ko.validation.registerExtenders();ko.validation.configure({decorateElement:!0,registerExtenders:!0,messagesOnModified:!0,insertMessages:!1,parseInputAttributes:!0,messageTemplate:null});var r=this,u={defaultAuth:function(){return frm.services.accountService.createOnlyEmail(AccountInfo.Email,1,{emailChecks:AccountInfo.SuggestedEmails,voucherCode:AccountInfo.VoucherCode,url:n.currentUrl})},facebookAuth:function(){return frm.services.accountService.createThroughFacebook({userType:1})},googleAuth:function(){return frm.services.accountService.createThroughGoogle({userType:1})},trackingHelper:function(n,t){return frm.services.accountService.trackingHelper.addTrackingParameter(n,t,i)}};r.Loading=ko.observable(!1);r.AcceptedTerms=ko.observable(!1).extend({acceptTerms:{message:"Accept terms please"}});r.AccountInfo={Id:ko.observable(),Email:ko.observable(),SuggestedEmails:ko.observableArray(),VoucherCode:ko.observable("")};r.ErrorModel={Message:ko.observable(),HasError:ko.observable(!1)};r.UpdateStartUrl=function(n){t.StartUrl(n)};r.NextView=function(){typeof n.onAccountCreated!="undefined"&&n.onAccountCreated();t.SetSearchAreaView()};r.CreateFacebook=function(){if(!r.Loading()){var t=ko.validation.group([r.AcceptedTerms]);if(t().length>0)return t.showAllMessages(),r.Loading(!1),null;r.Loading(!0);u.facebookAuth().then(function(t){if(t.data.isExistingUser){window.location.replace(n.startUrl);return}r.NextView();r.ErrorModel.HasError(!1);r.Loading(!1)},function(){r.ErrorModel.Message(n.errorMessages.unknownError);r.Loading(!1)})}};r.CreateGoogle=function(){if(!r.Loading()){var t=ko.validation.group([r.AcceptedTerms]);if(t().length>0)return t.showAllMessages(),r.Loading(!1),null;r.Loading(!0);u.googleAuth().then(function(t){if(t.data.isExistingUser){window.location.replace(n.startUrl);return}r.NextView();r.ErrorModel.HasError(!1);r.Loading(!1)},function(){r.ErrorModel.Message(n.errorMessages.unknownError);r.Loading(!1)})}};r.CreateNormal=function(){if(!r.Loading()){if(r.ErrorModel.HasError(!1),r.ErrorModel.Message(undefined),r.AccountInfo.Email()==undefined||r.AccountInfo.Email()=="")return r.ErrorModel.HasError(!0),r.ErrorModel.Message(n.errorMessages.missingEmail),r.Loading(!1),null;var t=ko.validation.group([r.AcceptedTerms],[r.AccountInfo.Email]);if(t().length>0)return t.showAllMessages(),r.Loading(!1),null;r.Loading(!0);u.defaultAuth().then(function(n){n.status=="success"?(r.ErrorModel.HasError(!1),r.NextView()):(r.ErrorModel.HasError(!0),r.ErrorModel.Message(n.Message));r.Loading(!1)},function(t){r.ErrorModel.HasError(!0);t.statusText=="Conflict"?r.ErrorModel.Message(n.errorMessages.duplicateEmail):t.responseJSON.data?t.responseJSON.data.type=="invalidEmail"?r.ErrorModel.Message(n.errorMessages.invalidEmail):r.ErrorModel.Message(n.errorMessages.unknownError):r.ErrorModel.Message(n.errorMessages.unknownError);r.Loading(!1)})}}},u=function(n,t){var i=this,r=new frm.services.SearchService,u=new frm.services.TenantService;i.ErrorModel={HasError:ko.observable(!1),Message:ko.observable(undefined)};i.Query=ko.observable();i.Loading=ko.observable(!1);i.SearchAreaModel={SearchArea:ko.observable(),Coordinates:{Longitude:ko.observable(),Latitude:ko.observable()},CountryCode:ko.observable()};i.Continue=function(){if(!i.Loading()){if(i.ErrorModel.HasError(!1),i.ErrorModel.Message(undefined),i.SearchAreaModel.SearchArea()==undefined||i.SearchAreaModel.SearchArea()==""){i.ErrorModel.HasError(!0);i.ErrorModel.Message(n.errorMessages.missingSearchArea);i.Loading(!1);return}i.ErrorModel.HasError(!1);i.Loading(!0);u.createSearchArea(i.SearchAreaModel.SearchArea(),i.SearchAreaModel.Coordinates.Latitude(),i.SearchAreaModel.Coordinates.Longitude(),i.SearchAreaModel.CountryCode()).then(function(){i.Loading(!1);i.ErrorModel.HasError(!1);t.HasSelectedSearchArea(!0);t.SetRentView()},function(){i.ErrorModel.HasError(!0);i.ErrorModel.Message(n.errorMessages.unknownError);i.Loading(!1)})}};i.onQueryChange=function(n){var u=r.getRedirectParameters(n),f=r.getUrl("default",App.settings.searchSettings.roomBasePath,u.locality,u.sublocality,u.country);t.SearchUrl(f);i.SearchAreaModel.SearchArea(n.address);i.SearchAreaModel.Coordinates.Longitude(n.location.lng);i.SearchAreaModel.Coordinates.Latitude(n.location.lat);i.SearchAreaModel.CountryCode(n.countryCode)}},f=function(n,t){var i=this,r=new frm.services.TenantService;i.Loading=ko.observable(!1);i.ErrorModel={HasError:ko.observable(!1),Message:ko.observable(undefined)};i.RentModel={Rent:ko.observable(),Currency:ko.observable(n.defaultCurrency||null)};i.CurrencyList=ko.observableArray(n.currency);i.Continue=function(){if(!i.Loading()){var u=i.RentModel.Rent();if(u==undefined||u==""){i.ErrorModel.HasError(!0);i.ErrorModel.Message(n.errorMessages.missingRent);i.Loading(!1);return}i.ErrorModel.HasError(!1);i.Loading(!0);r.saveRentAndCurrency(i.RentModel.Rent(),i.RentModel.Currency()).then(function(){i.Loading(!1);i.ErrorModel.HasError(!1);t.SearchUrl(t.SearchUrl()+"?rentMax="+i.RentModel.Rent());t.SetMoveInDateView()},function(){i.ErrorModel.HasError(!0);i.ErrorModel.Message(n.errorMessages.unknownError);i.Loading(!1)})}}},e=function(n,t){var i=this,r=new frm.services.TenantService;i.Loading=ko.observable(!1);i.ErrorModel={HasError:ko.observable(!1),Message:ko.observable(undefined)};i.MoveInDate=ko.observable();i.Continue=function(){if(!i.Loading()){if(i.MoveInDate()===undefined||i.MoveInDate()===""){i.ErrorModel.HasError(!0);i.ErrorModel.Message(n.errorMessages.missingMoveInDate);i.Loading(!1);return}i.Loading(!0);r.saveMoveInDate(i.MoveInDate()).then(function(){i.Loading(!1);i.ErrorModel.HasError(!1);t.SetAboutView()},function(){i.ErrorModel.HasError(!0);i.ErrorModel.Message(n.errorMessages.unknownError);i.Loading(!1)})}}},o=function(n,t){var i=this,r=frm.services.accountService;ko.validation.registerExtenders();ko.validation.configure({decorateElement:!0,registerExtenders:!0,messagesOnModified:!0,insertMessages:!1,parseInputAttributes:!0,messageTemplate:null});i.Loading=ko.observable(!1);i.ErrorModel={HasError:ko.observable(!1),Message:ko.observable(undefined)};i.UserInfo={Firstname:ko.observable(),Lastname:ko.observable(),Nationality:ko.observable(undefined),Gender:ko.observable(null),Age:ko.observable()};i.Country={name:ko.observable(),flagClass:ko.observable()};i.GenderList=ko.observableArray(n.gender);i.ChooseCountry=function(n){i.UserInfo.Nationality(undefined);i.Country.name(n.Name);i.UserInfo.Nationality(n.CountryCode);i.Country.flagClass(n.FlagClass)};i.Continue=function(){i.Loading()||(i.ErrorModel.HasError(!1),i.Loading(!0),i.UserInfo.Gender()==9999&&i.UserInfo.Gender(null),r.updatePartialAccountUserInfo(ko.toJS(i.UserInfo)).then(function(){i.Loading(!1);t.SetRoommateView()},function(){i.ErrorModel.HasError(!0);i.ErrorModel.Message(n.errorMessages.unknownError);i.Loading(!1)}))}},s=function(n,t){var i=this,r=frm.services.accountService;i.Loading=ko.observable(!1);i.ErrorModel={HasError:ko.observable(!1),Message:ko.observable(undefined)};i.GenderList=ko.observableArray(n.gender);i.Roommate={Gender:ko.observable(null),AgeFrom:ko.observable(),AgeTo:ko.observable()};i.Continue=function(){i.Loading()||(i.Loading(!0),i.ErrorModel.HasError(!1),r.updatePartialRoommateInfo(ko.toJS(i.Roommate)).then(function(){t.SetReadyView();i.Loading(!1)},function(){i.ErrorModel.HasError(!0);i.ErrorModel.Message(n.errorMessages.unknownError);i.Loading(!1)}))}},h=function(n,t){var r=this;r.StartSearch=function(){location.href=frm.services.accountService.trackingHelper.buildTrackingUrl(t.SearchUrl(),i)};r.GotoDashboar=function(){location.href=frm.services.accountService.trackingHelper.buildTrackingUrl(n.startUrl,i)}};t.CurrentView.Name("view--signup");t.CurrentView.Model(r(n,t))};n.CreateAccountSignUpFlowViewModel=t}(frm.models,frm.services);UpdateHomeInfoViewModel=function(n){function t(t){t=t||{};this.roomId=t.roomId;this.isRented=n.observable(t.isRented);this.isContactable=n.observable(t.isContactable);this.defaultRentedTextPlaceHolder=n.observable(t.defaultRentedTextPlaceHolder);this.rentedText=n.observable(null);this.rentedTextBoxVisible=n.observable(!1);this.questionBoxVisible=n.observable(!1);this.sentMessage=n.observable(!0);this.starRented=function(){this.rentedText(null);this.questionBoxVisible(!0);this.rentedTextBoxVisible(!1)};this.optionYes=function(){this.questionBoxVisible(!1);this.rentedTextBoxVisible(!0)};this.optionNo=function(){this.questionBoxVisible(!1)};this.noMessage=function(){this.questionBoxVisible(!1);this.sentMessage(!1)};this.optionCancel=function(){this.rentedText(null);this.questionBoxVisible(!1);this.rentedTextBoxVisible(!1)}}return t.prototype.setRented=function(n,t,i){function r(){this.isRented(u);alert("Der skete en fejl!")}var u=i.isRented,f=i.rentedText()!=null?i.rentedText():null;i.isRented(n);frm.services.RoomService.flagRented(i.roomId,n,f,t).fail($.proxy(r,this));this.questionBoxVisible(!1);this.rentedTextBoxVisible(!1)},t.prototype.setContactable=function(n,t){function i(){this.isContactable(r);alert("Der skete en fejl!")}var r=t.isContactable;t.isContactable(n);frm.services.RoomService.flagContactable(t.roomId,n,null).fail($.proxy(i,this))},t}(ko);RoomViewModel=function(n){function t(t){var u,i;t=t||{};u=new frm.services.TenantService;i=this;this.createEmailAccount=new frm.models.CreateAccountViewModel(t);this.roomId=t.roomId;this.isRented=n.observable(t.isRented);this.isContactable=n.observable(t.isContactable);this.googleMapData=t.googleMapData;var r=function(){return t.popupOptions.EpayParameters={overwriteProductId:0,returnUrl:t.popupOptions.returnUrl,internalReferralId:t.roomAccountId,internalReferralType:2,paymentActionId:0,anonymousPaymentAction:0},new frm.models.GenericPopupViewModel(t.popupOptions)},f=function(n){return new frm.models.GenericPopupViewModel(n)},e=function(n){return new frm.models.GenericPopupViewModel(n)},s=function(n){return new frm.models.GenericPopupViewModel(n)},o=function(n){u.createSearchAreaByRoom(n)};i.HasStartedMessage=!1;i.MessageStatus=n.observable("new");i.MessageInputOptions={inputOptions:{recipientAccountId:t.roomAccountId,senderAccountId:App.settings.account.id,isLoggedIn:t.isLoggedIn,isPaymentAction:!t.isAllowed,isMessagingDisabled:t.isMessagingDisabled,paymentCenterUrl:t.paymentUrl,callBacks:{onSuccessSend:function(){i.MessageStatus("sent");o(t.roomId)},onFailureSend:function(){},onPaymentActionSuccess:function(n){i.TriggerAnonymousPaymentActionPopup(n)}},texts:t.texts},templateOptions:{texts:t.texts.template}};i.ApprovalViewModel=function(){var n=this,i={approve:function(n,t){return frm.services.accountService.approveExternalForFeed(n,t)},approveInternal:function(n,t){return frm.services.accountService.approveInternal(n,t)}};n.Approve=function(){i.approve(t.roomAccountId,!0).then(function(){alert("Annoncen er nu godkendt")})};n.ApproveInternal=function(){i.approveInternal(t.roomAccountId,!0).then(function(){alert("Annoncen er nu godkendt til intern brug")})}};i.TriggerPayment=function(){frm.utils.PaymentUrlHelper(r,t.paymentUrl)};i.CreateUser=function(){var n,r;i.HasStartedMessage=!0;n=t.popupOptions;n;n.returnUrl=t.paymentUrl;r=e(n);frm.models.GenericPopupViewModel.create(r).then(function(){r.Areas.SignUp.RoomListingSignUpView()})};i.SetNewMessage=function(){i.MessageStatus("new")};i.StartStaffChat=function(){var i={messageInputOptions:{inputOptions:{recipientAccountId:"624292ae-99af-4122-9ebd-ab06332c18b4",senderAccountId:App.settings.account.id,isLoggedIn:t.isLoggedIn,isPaymentAction:!1,isMessagingDisabled:!1,paymentCenterUrl:t.paymentUrl,callBacks:{onSuccessSend:function(){},onFailureSend:function(){},onPaymentActionSuccess:function(){}},texts:t.texts},templateOptions:{texts:t.texts.template}}},n=r();frm.models.GenericPopupViewModel.create(n).then(function(){n.Areas.Chat.SetWriteStaffViewModel(i)})};i.RentConsultingViewModel=function(){n.options=_options;var n=this;n.messageOptions={inputOptions:{recipientAccountId:"",senderAccountId:App.settings.account.id,isLoggedIn:t.isLoggedIn,isPaymentAction:!1,isMessagingDisabled:!1,paymentCenterUrl:t.paymentUrl,callBacks:{onSuccessSend:function(){},onFailureSend:function(){},onPaymentActionSuccess:function(){}},texts:t.texts},templateOptions:{texts:t.texts.template}}};i.TriggerAnonymousPaymentActionPopup=function(n){var r=t.popupOptions,i;r.returnUrl=n+"&AnonymousPaymentAction=1";i=f(r);frm.models.GenericPopupViewModel.create(i).then(function(){i.Areas.SignUp.MessagePaymentActionSignUpView()})};frm.events.addListener("messageinput:textarea:focus",function(){i.HasStartedMessage=!0});setTimeout(function(){if(t.popupOptions.trigger){var n=r();frm.models.GenericPopupViewModel.create(n,{onClose:function(){location.href=t.instantPopupOptions.onCloseRedirectUrl}}).then(function(){n.Areas.SignUp.RoomListingSignUpView()})}},3e3)}return t.prototype.queuePicture=function(n){frm.services.PictureService.queue(n).then(function(){alert("SAT I KØ")})},t.prototype.setContactable=function(n,t){function i(){this.isContactable(r);alert("Der skete en fejl!")}var r=t.isContactable;t.isContactable(n);frm.services.RoomService.flagContactable(t.roomId,n).fail($.proxy(i,this))},t.prototype.setRented=function(n,t){function i(){this.isRented(r);alert("Der skete en fejl!")}var r=t.isRented;t.isRented(n);frm.services.RoomService.flagRented(t.roomId,n).fail($.proxy(i,this))},t}(ko),function(n){var t=function(n){function f(){var n=!0;t.PhoneNumberVerifiedOriginal()==!1?n=!1:t.Model.PhoneNumber()!=t.Model.PhoneNumberOriginal()?n=!1:t.Model.PhonePrefix()!=t.Model.PhonePrefixOriginal()&&(n=!1);t.PhoneNumberVerified(n)}var i=n.data.account,t=this,u=!0,r;t.isChanged=ko.observable(!1);t.MailSettings=new frm.models.MailSubscriptionViewModel(n);t.PhoneSettings=new frm.models.PhoneSubscriptionViewModel(n);t.VoucherService=new frm.models.RedeemVoucherViewModel;t.UserTypes=ko.observableArray(n.accountSettings.userTypes);t.CurrencyList=ko.observableArray(n.currencyList);t.PhonePrefixList=ko.observableArray(n.phonePrefixList);t.PhoneNumberChanged=ko.observable(!1);t.PhoneNumberVerified=ko.observable(i.PhoneNumberVerified);t.PhoneNumberVerifiedOriginal=ko.observable(i.PhoneNumberVerified);t.PhoneNumberVerificationInput=ko.observable(0);t.PhoneNumberVerificationShowInput=ko.observable(!1);t.SuggestedEmails=ko.observableArray();t.InitialEmail=i.Email;t.DoReload=ko.observable(!1);t.Model={UserType:ko.observable(i.UserType),Nationality:ko.observable(i.Nationality),Currency:ko.observable(i.Currency||null),Firstname:ko.observable(i.Firstname).extend({required:!0}),Lastname:ko.observable(i.Lastname).extend({required:!0}),Username:ko.observable(i.Username).extend({required:!0}),Email:ko.observable(i.Email).extend({required:!0}),Password:ko.observable(null),PhonePrefix:ko.observable(i.PhonePrefix||null),PhonePrefixOriginal:ko.observable(i.PhonePrefix||null),PhoneNumber:ko.observable(i.PhoneNumber),PhoneNumberOriginal:ko.observable(i.PhoneNumber)};t.Country={name:ko.observable(i.CountryName),flagClass:ko.observable("flag flag-"+i.Nationality)};t.isLoading=ko.observable(!1);t.changeCountry=function(n){t.Country.name(n.Name);t.Model.Nationality(n.CountryCode);t.Country.flagClass(n.FlagClass)};t.Model.PhoneNumber.subscribe(function(){f()});t.Model.PhonePrefix.subscribe(function(){f()});t.Model.UserType.subscribe(function(n){n!==i.UserType?t.DoReload(!0):t.DoReload(!1)});for(r in t.Model)t.Model.hasOwnProperty(r)&&t.Model[r].subscribe(function(){u||t.isChanged(!0)}),1;t.SaveChanges=function(){var n=new jQuery.Deferred,i=ko.validation.group([t.Model.Email,t.Model.Username]);return i().length>0?(n.reject(),n.promise()):(t.isChanged()?frm.services.accountService.manage.updateAccount(ko.toJS(t.Model)).then(function(){t.isChanged(!1);n.resolve()}).fail(function(){n.reject.apply(this,arguments)}):(t.isChanged(!1),n.resolve()),n.promise())};t.SendVerificationCode=function(){t.SaveChanges();frm.services.accountService.phone.sendVerificationCode().then(function(n){n.status==="success"&&t.PhoneNumberVerificationShowInput(!0)})};t.InsertVerificationCode=function(){frm.services.accountService.phone.insertVerificationCode(ko.toJS(t.PhoneNumberVerificationInput)).then(function(n){console.log(n.status);n.status==="success"&&t.PhoneNumberVerified(!0)})};setTimeout(function(){u=!1},25)};n.AccountSettingsViewModel=t}(frm.models,frm.services),function(n){var t=function(n){var i=n.data.tenant,t=this,u=!0,r;t.isChanged=ko.observable(!1);t.CurrencyList=ko.observableArray(n.homeWishes.currencyList);t.RentalPeriodList=ko.observableArray(n.homeWishes.rentalPeriod);t.OwnRoom=ko.observableArray(n.homeWishes.ownRoom);t.AnimalsAllowed=ko.observableArray(n.homeWishes.animalsAllowed);t.SmokingAllowed=ko.observableArray(n.homeWishes.smokingAllowed);t.Model={Id:ko.observable(i.Id),Rent:ko.observable(i.Rent).extend({required:!0}),Deposit:ko.observable(i.Deposit),RentalPeriod:ko.observableArray(i.RentalPeriod===null||typeof i.RentalPeriod=="undefined"?[]:i.RentalPeriod),MoveInDate:ko.observable(i.MoveInDateString),OwnRoom:ko.observable(i.OwnRoom),AnimalsAllowed:ko.observable(i.AnimalsAllowed),SmokingAllowed:ko.observable(i.SmokingAllowed),SizeType:ko.observable(),Currency:ko.observable(i.ValutaId)};for(r in t.Model)t.Model.hasOwnProperty(r)&&t.Model[r].subscribe(function(){u||t.isChanged(!0)});t.SaveChanges=function(){var n=new jQuery.Deferred;return t.isChanged()?(frm.services.accountService.manage.updateHomeWishes(ko.toJS(t.Model)).then(function(){n.resolve()}),function(){n.reject()}):n.resolve(),t.isChanged(!1),n.promise()};setTimeout(function(){u=!1},25)};n.HomeWishesSettingsViewModel=t}(frm.models,frm.services),function(n){var t=function(n){var i=n.data.roommate,t=this,u=!0,r;t.isChanged=ko.observable(!1);t.Gender=ko.observableArray(n.roommate.gender);t.Smoker=ko.observableArray(n.roommate.smoker);t.AnimalsAllowed=ko.observableArray(n.roommate.animalsAllowed);t.Children=ko.observableArray(n.roommate.children);t.Cleanliness=ko.observableArray(n.roommate.cleanliness);t.Snorring=ko.observable(n.roommate.snorring);t.PartyHabits=ko.observable(n.roommate.partyHabits);t.Model={Id:ko.observable(i.ID),Gender:ko.observable(i.Gender),AgeFrom:ko.observable(i.AgeFrom),AgeTo:ko.observable(i.AgeTo),Smoker:ko.observableArray(i.SmokerList),HasAnimals:ko.observable(i.HasAnimals),HasChildren:ko.observable(i.ChildrenAllowed),Cleanliness:ko.observable(i.CleanlynessList),Snorring:ko.observable(i.SnorringList),PartyHabits:ko.observable(i.PartyHabitsList)};for(r in t.Model)t.Model.hasOwnProperty(r)&&t.Model[r].subscribe(function(){u||t.isChanged(!0)});t.SaveChanges=function(){var n=new jQuery.Deferred;return t.isChanged()?(frm.services.accountService.manage.updateRoommate(ko.toJS(t.Model)).then(function(){n.resolve()}),function(){n.reject()}):n.resolve(),t.isChanged(!1),n.promise()};setTimeout(function(){u=!1},25)};n.RoommateCriteriaSettingsViewModel=t}(frm.models,frm.services),function(n){var t=function(n){var t=this,i=n.data.personal,u=!0,r;t.isChanged=ko.observable(!1);t.Gender=ko.observableArray(n.personalSettings.gender);t.PartnerStatus=ko.observableArray(n.personalSettings.partnerStatus);t.Smoker=ko.observableArray(n.personalSettings.smoker);t.Sexuality=ko.observableArray(n.personalSettings.sexuality);t.PetType=ko.observableArray(n.personalSettings.petType);t.Children=ko.observableArray(n.personalSettings.children);t.Occupation=ko.observableArray(n.personalSettings.occupation);t.Education=ko.observableArray(n.personalSettings.education);t.Cleanliness=ko.observableArray(n.personalSettings.cleanliness);t.Snoring=ko.observableArray(n.personalSettings.snoring);t.PartyHabits=ko.observableArray(n.personalSettings.partyHabits);t.Model={Id:ko.observable(i.ID),Gender:ko.observable(i.Gender),Age:ko.observable(i.Age||0),PartnerStatus:ko.observable(i.Partner||0),Smoker:ko.observable(i.Smoker||0),Sexuality:ko.observable(i.SexualOrientation||0),PetType:ko.observable(i.AnimalsOwned||0),Children:ko.observable(i.ChildrenInPossesion),Occupation:ko.observable(i.Occupation||0),Education:ko.observable(i.Education||0),Cleanliness:ko.observable(i.Cleanlyness||0),Snoring:ko.observable(i.Snorring||0),PartyHabits:ko.observable(i.PartyHabits||0),Tagline:ko.observable(i.Tagline||undefined).extend({required:!0}),Text:ko.observable(i.Text||undefined).extend({required:!0}),Interests:ko.observableArray(n.data.interests||undefined),OldInterests:ko.observableArray(n.data.interests||undefined)};t.isLoading=ko.observable(!1);for(r in t.Model)t.Model.hasOwnProperty(r)&&t.Model[r].subscribe(function(){u||t.isChanged(!0)});t.SaveChanges=function(){var n=new jQuery.Deferred;return t.isChanged()?(frm.services.accountService.manage.updatePersonal(ko.toJS(t.Model)).then(function(){n.resolve()}),function(){n.reject()}):n.resolve(),t.isChanged(!1),n.promise()};setTimeout(function(){u=!1},25)};n.PersonalSettingsViewModel=t}(frm.models,frm.services),function(n){var t=function(n){var i=this,t=n.data.room.data,u=!0,r;i.isChanged=ko.observable(!1);i.legacyView=new UpdateHomeInfoViewModel(n.data.room.legacyData);i.Query=ko.observable();i.Model={Rent:ko.observable(t.Rent||undefined),Deposit:ko.observable(t.Deposit||undefined),Size:ko.observable(t.Kvm||undefined),SizeType:ko.observable(t.IsSquareFeet==1?2:1),Currency:ko.observable(t.ValutaId||undefined),RentalPeriod:ko.observable(t.RentalPeriod===null||typeof t.RentalPeriod=="undefined"?null:t.RentalPeriod),MoveInDate:ko.observable(t.MoveInDateString||undefined),OwnRoom:ko.observable(t.OwnRoom||null),AnimalsAllowed:ko.observable(t.AnimalsAllowed===null||typeof t.AnimalsAllowed=="undefined"?null:t.AnimalsAllowed),SmokingAllowed:ko.observable(t.SmokingAllowed===null||typeof t.SmokingAllowed=="undefined"?null:t.SmokingAllowed),WifiAvailable:ko.observable(t.WifiAvailable===null||typeof t.WifiAvailable=="undefined"?null:t.WifiAvailable),CableTvAvailable:ko.observable(t.CableTvAvailable===null||typeof t.CableTvAvailable=="undefined"?null:t.CableTvAvailable),WasherAvailable:ko.observable(t.WasherAvailable===null||typeof t.WasherAvailable=="undefined"?null:t.WasherAvailable),DishWasherAvailable:ko.observable(t.DishWasherAvailable===null||typeof t.DishWasherAvailable=="undefined"?null:t.DishWasherAvailable),AddressFormattedName:ko.observable(t.AddressFormattedName||undefined),Address:ko.observable(t.Address||undefined),AddressNumber:ko.observable(t.AddressNumber||undefined),ZipCode:ko.observable(t.ZipCode||undefined),City:ko.observable(t.City||undefined),GeoRoute:ko.observable(t.GeoRoute||undefined),GeoZipCode:ko.observable(t.GeoZipCode||undefined),GeoCountry:ko.observable(t.GeoCountry||undefined),GeoCountryCodeShort:ko.observable(t.GeoCountryCodeShort||undefined),GeoLocality:ko.observable(t.GeoLocality||undefined),GeoState:ko.observable(t.GeoState||undefined),Latitude:ko.observable(t.Lat||undefined),Longitude:ko.observable(t.Long||undefined)};i.onQueryChange=function(n){i.Model.AddressFormattedName(n.address);i.Model.Address(n.street);i.Model.GeoRoute(n.street);i.Model.AddressNumber(n.streetNumber);i.Model.GeoLocality(n.locality);i.Model.GeoZipCode(n.postalCode);i.Model.ZipCode(n.postalCode);i.Model.GeoCountry(n.country);i.Model.GeoCountryCodeShort(n.countryCode);i.Model.GeoState(n.state);i.Model.City(n.locality);i.Model.Latitude(n.location.lat);i.Model.Longitude(n.location.lng)};for(r in i.Model)i.Model.hasOwnProperty(r)&&i.Model[r].subscribe(function(){u||i.isChanged(!0)});i.SaveChanges=function(){var t=new jQuery.Deferred;return i.isChanged()?(frm.services.accountService.manage.updateRoom(ko.toJS(i.Model),n.data.accountId).then(function(){t.resolve()}),function(){t.reject()}):t.resolve(),i.isChanged(!1),t.promise()};setTimeout(function(){u=!1},25)};n.HousingSettingsViewModel=t}(frm.models,frm.services),function(n){var t=function(n){var t,r,i;ko.validation.registerExtenders();ko.validation.configure({decorateElement:!0,registerExtenders:!0,messagesOnModified:!0,insertMessages:!1,parseInputAttributes:!0,messageTemplate:null});t=this;r={saveSettings:function(n){return frm.services.accountService.saveAccountSettings(n)}};t.AccountSettings=new frm.models.AccountSettingsViewModel(n);t.PersonalSettings=new frm.models.PersonalSettingsViewModel(n);t.HomeWishesSettings=new frm.models.HomeWishesSettingsViewModel(n);t.RoommateCriteriaSettings=new frm.models.RoommateCriteriaSettingsViewModel(n);t.HousingSettings=new frm.models.HousingSettingsViewModel(n);t.StatusStyle=ko.observable(undefined);t.CanScroll=ko.observable(!1);t.ShowSuccessMessage=ko.observable(!1);t.Loading=ko.observable(!1);t.ErrorModel={HasError:ko.observable(!1),ErrorMessage:ko.observable()};t.HasIncompleteFields=ko.observable(!1);t.HasChanges=ko.computed(function(){return t.AccountSettings.isChanged()||t.PersonalSettings.isChanged()||t.HomeWishesSettings.isChanged()||t.RoommateCriteriaSettings.isChanged()||t.HousingSettings.isChanged()});t.ShowLoadingIcon=ko.observable(!1);t.CheckIncomplete=function(){var i=!0,u=[t.AccountSettings.Model.Firstname,t.AccountSettings.Model.Lastname,t.PersonalSettings.Model.AdText,t.PersonalSettings.Model.AdHeadline],f=t.AccountSettings.Model.UserType(),r,e;f===1&&u.push(t.HomeWishesSettings.Model.Rent);r=ko.validation.group(u);r().length>0&&(r.showAllMessages(),i=!1);!n.IncompleteFields.HasPicture&&i&&(i=!1);f===1&&i&&(e=t.HomeWishesSettings.Model.Rent(),(e<=0||!n.IncompleteFields.HasSearchArea)&&(i=!1));(t.PersonalSettings.Model.Tagline()==undefined||t.PersonalSettings.Model.Tagline()=="")&&(i=!1);(t.PersonalSettings.Model.Text()==undefined||t.PersonalSettings.Model.Text()=="")&&(i=!1);t.HasIncompleteFields(!i)};t.SaveSettings=function(){var i=[t.AccountSettings.SaveChanges(),t.PersonalSettings.SaveChanges(),t.HomeWishesSettings.SaveChanges(),t.RoommateCriteriaSettings.SaveChanges(),t.HousingSettings.SaveChanges()];t.Loading(!0);t.ErrorModel.HasError(!1);i[0].fail(function(i){if(arguments.length>0){if(t.ErrorModel.HasError(!0),i.responseJSON.data)switch(i.responseJSON.data.type){case"username":t.ErrorModel.ErrorMessage(n.errorMessage.userNameInUse);return;case"invalidEmail":t.ErrorModel.ErrorMessage(n.errorMessage.invalidEmail);return;case"email":t.ErrorModel.ErrorMessage(n.errorMessage.invalidEmail);return}t.ErrorModel.ErrorMessage(n.errorMessage.unknownError)}});jQuery.when(jQuery,i).then(function(){return t.SetStatusStyle(undefined),t.ErrorModel.HasError(!1),t.ErrorModel.ErrorMessage(""),t.SetStatusStyle("success-save",!0),t.AccountSettings.DoReload()&&frm.services.ModalService.open({template:$("#ChangeUserTypePopUp").html(),width:400,height:"auto",events:[{event:"click touchend",selector:".ok-btn",func:function(){frm.services.ModalService.close()}}],onAfterClose:function(){location.reload(!0)}}),t.Loading(!1),t.ShowLoadingIcon(!1),frm.services.accountService.saveAccountSettings()},function(){t.ErrorModel.HasError(!0);t.ErrorModel.ErrorMessage(n.errorMessage.missingFields);t.SetStatusStyle("fail-save",!1);t.Loading(!1);t.ShowLoadingIcon(!1)}).then(function(){t.CheckIncomplete()})};t.SetStatusStyle=function(n,i){if(n==undefined){t.ShowSuccessMessage(!1);return}t.StatusStyle(n);t.ShowSuccessMessage(!0);i&&setTimeout(function(){t.ShowSuccessMessage(!1)},1500)};t.HasChanges.subscribe(function(n){n==!0&&(setTimeout(function(){t.HasChanges()&&t.ShowLoadingIcon(!0)},4e3),setTimeout(function(){t.HasChanges()&&t.SaveSettings()},5e3))});t.CheckIncomplete();i=n.page||undefined;i!=undefined&&$(function(){var n=$(".setting-box#"+i),t;n.length>0&&(t=n.offset().top-70,$(document).scrollTop(t))})};n.SettingsViewModel=t}(frm.models,frm.services),function(n,t){var r=function(n,t,r){var u=this,f={setView:function(n,t){u.currentView({name:n,model:t});u.TextBoxVisible(!1);u.isEdit(!1);u.isCreate(!1);$(".textBox").hide();u.closeSidebar()},create:function(){var n=ko.toJS(u.ItemModel);return frm.services.WallService.create(n)},edit:function(){var n=ko.toJS(u.ItemModel);return frm.services.WallService.edit(n)}};u.layout={filterButton:$(".filter-button"),closeSideBarButton:$(".side-bar-close-item"),menu:$(".sidebar-menu"),menuItem:$(".sidebar-menu-item:not(.side-bar-close-item)"),cssClass:"sidebar-collapsed",cssFilterClass:"open-filter",cssAlwaysVisible:"always-visible",countryButton:$(".toggleCountryBox"),flagItem:$(".flag-item"),searchAreaInput:$("#WallOverview .query")};u.isMobileView=ko.observable(!1);u.currentView=ko.observable();u.isLoading=ko.observable(!1);u.Error=ko.observable(!1);u.TextBoxVisible=ko.observable(!1);u.SideBarVisible=ko.observable(!1);u.isEdit=ko.observable(!1);u.isCreate=ko.observable(!1);u.itemToEdit=ko.observable();u.ItemModel={Id:ko.observable(),BodyText:ko.observable()};u.countryBoxVisible=ko.observable(!1);u.searchAreaQuery=ko.observable();u.genderFilter=r.genderFilter;u.Filter={Coordinates:ko.observable(undefined),Gender:ko.observable(""),Nationality:ko.observable(undefined)};u.CountryName=ko.observable(undefined);u.startMenu=ko.observable(!1);u.myPostMenu=ko.observable(!1);u.favoriteMenu=ko.observable(!1);u.getCountryData=function(n){u.Filter.Nationality(n.CountryCode);u.CountryName(n.Name)};u.setIndexView=function(){u.ClearMenu();u.startMenu(!0);f.setView("wall-index",new i.index({stateMachine:u}))};u.setFavoriteView=function(){u.ClearMenu();u.favoriteMenu(!0);f.setView("wall-favorite-view",new i.myFavorites({stateMachine:u}))};u.setMyPostsView=function(){u.ClearMenu();u.myPostMenu(!0);f.setView("wall-my-posts-view",new i.myPosts({stateMachine:u}))};u.StartTextBox=function(n){$(".textBox").slideDown();u.TextBoxVisible(!0);u.isEdit()?(u.ItemModel.BodyText(n.WallText),u.ItemModel.Id(n.Id),u.itemToEdit(n)):(u.ItemModel.BodyText(null),u.itemToEdit(undefined),u.isCreate(!0))};u.EndTextBox=function(){$(".textBox").slideUp();u.TextBoxVisible(!1);u.isEdit(!1);u.isCreate(!1);u.itemToEdit(undefined)};u.Save=function(){$(".textBox").slideUp();u.TextBoxVisible(!1);u.isEdit()?f.edit().then(function(){u.setMyPostsView()}):u.isCreate()&&f.create().then(function(){u.setIndexView()});u.isEdit(!1);u.isCreate(!1)};u.ClearMenu=function(){u.startMenu(!1);u.favoriteMenu(!1);u.myPostMenu(!1)};u.changeCountry=function(n){u.Filter.Nationality(n.CountryCode);u.CountryCode(n.CountryCode);u.setCountryName(n.CountryCode);u.toggleCountryBox()};u.toggleCountryBox=function(){u.countryBoxVisible()==!0?u.countryBoxVisible(!1):u.countryBoxVisible(!0);u.layout.menu.toggleClass(u.layout.cssAlwaysVisible);u.layout.menu.toggleClass(u.layout.cssFilterClass);u.layout.menu.toggleClass(u.layout.cssClass)};u.showSideBarHover=function(){u.detectMobile();u.isMobileView()||u.SideBarVisible(!0)};u.closeSideBarHover=function(){u.detectMobile();u.isMobileView()||u.SideBarVisible(!1)};u.clearFilter=function(){u.isLoading()!=!0&&(u.layout.searchAreaInput.val(undefined),u.searchAreaQuery(),u.CountryName(undefined),u.countryBoxVisible(!1),u.Filter.Gender(""),u.Filter.Coordinates(undefined),u.Filter.Nationality(undefined))};u.onAreaSelected=function(n){u.Filter.Coordinates({Longitude:n.location.lng,Latitude:n.location.lat})};u.search=function(){u.isLoading()!=!0&&(u.closeSidebar(),u.countryBoxVisible(!1),u.layout.menuItem.show(),u.currentView().model.search())};u.closeSidebar=function(){u.layout.menu.removeClass(u.layout.cssAlwaysVisible);u.layout.menu.removeClass(u.layout.cssFilterClass);u.layout.menu.addClass(u.layout.cssClass)};u.sidebarToggle=function(){u.layout.menu.toggleClass(u.layout.cssAlwaysVisible);u.layout.menu.toggleClass(u.layout.cssFilterClass);u.layout.menu.addClass(u.layout.cssClass)};u.detectMobile=function(){$(window).width()<=768?u.isMobileView(!0):u.isMobileView(!1)};u.openSidebar=function(){u.layout.menuItem.is(":visible")?u.layout.menuItem.hide():u.layout.menuItem.show();u.sidebarToggle()};u.detectMobile();u.setIndexView()},i={index:function(n){var i,r,u;n.stateMachine.Error(!1);i=this;r={fetch:function(n,t){return frm.services.WallService.get(n,t)},addToFavorite:function(n){frm.services.WallService.addToFavorite(n)},removeFromFavorite:function(n){frm.services.WallService.removeFromFavorite(n)}};i.Posts=ko.observableArray();i.paging={isLoadingNextPage:ko.observable(!1),isLastPage:ko.observable(!1),currentPageIndex:ko.observable(0)};i.IsTemplateLoaded=ko.observable(!1);i.search=function(){i.getdata().then(function(n){frm.utils.arrayReplace(i.Posts,n)})};i.getdata=function(){return n.stateMachine.isLoading(!0),r.fetch(ko.toJS(i.paging.currentPageIndex),ko.toJS(n.stateMachine.Filter)).then(function(t){var i=t.data;return ko.utils.arrayForEach(i,function(n){n.IsFavorite=ko.observable(n.IsFavorite);n.AmountOfFavorites=ko.observable(n.AmountOfFavorites)}),n.stateMachine.isLoading(!1),i})};i.addItems=function(n){ko.utils.arrayPushAll(i.Posts,n)};i.nextPage=function(){return i.paging.currentPageIndex(i.paging.currentPageIndex()+1),i.paging.isLoadingNextPage(!0),r.fetch(ko.toJS(i.paging.currentPageIndex),ko.toJS(n.stateMachine.Filter)).then(function(n){ko.utils.arrayForEach(n.data,function(n){n.IsFavorite=ko.observable(n.IsFavorite);n.AmountOfFavorites=ko.observable(n.AmountOfFavorites)});i.addItems(n.data);i.paging.isLoadingNextPage(!1)},function(){i.paging.isLoadingNextPage(!1)})};i.toggleFavorite=function(n){var t;n.IsFavorite()?n.IsFavorite()&&(n.IsFavorite(!1),t=n.AmountOfFavorites()-1,n.AmountOfFavorites(t),r.removeFromFavorite(n.Id)):(n.IsFavorite(!0),t=n.AmountOfFavorites()+1,n.AmountOfFavorites(t),r.addToFavorite(n.Id))};u=[i.getdata(),t.WallService.requestTemplates()];jQuery.when.apply(jQuery,u).done(function(t){n.stateMachine.isLoading(!1);frm.utils.arrayReplace(i.Posts,t)})},myPosts:function(n){n.stateMachine.Error(!1);var t=this,i={fetch:function(n){return frm.services.WallService.getOwn(n)},deletePost:function(n){frm.services.WallService.deletePost(n)},deleteAttachment:function(n){frm.services.WallService.deleteAttachment(n)}};t.Posts=ko.observableArray();t.paging={isLoadingNextPage:ko.observable(!1),isLastPage:ko.observable(!1),currentPageIndex:ko.observable(0)};t.search=function(){t.getdata()};t.getdata=function(){n.stateMachine.isLoading(!0);i.fetch(ko.toJS(t.paging.currentPageIndex),ko.toJS(n.stateMachine.Filter)).then(function(i){var r=i.data;ko.utils.arrayForEach(r,function(n){n.IsFavorite=ko.observable(n.IsFavorite);n.AmountOfFavorites=ko.observable(n.AmountOfFavorites)});n.stateMachine.isLoading(!1);frm.utils.arrayReplace(t.Posts,r)})};t.addItems=function(n){ko.utils.arrayPushAll(t.Posts,n)};t.nextPage=function(){return t.paging.currentPageIndex(t.paging.currentPageIndex()+1),t.paging.isLoadingNextPage(!0),i.fetch(ko.toJS(t.paging.currentPageIndex),ko.toJS(n.stateMachine.Filter)).then(function(n){ko.utils.arrayForEach(n.data,function(n){n.IsFavorite=ko.observable(n.IsFavorite);n.AmountOfFavorites=ko.observable(n.AmountOfFavorites)});t.addItems(n.data);t.paging.isLoadingNextPage(!1)},function(){t.paging.isLoadingNextPage(!1)})};t.DeletePost=function(n){t.Posts.remove(n);i.deletePost(n.Id)};t.EditPost=function(t){n.stateMachine.isEdit(!0);n.stateMachine.StartTextBox(t)};t.DeleteAttachment=function(n){var r={Type:n.AttachmentType,Id:n.AttachmentId};i.deleteAttachment({Type:n.AttachmentType,Id:n.AttachmentId});t.getdata()};t.updatePost=function(n,i){var u=i(),r=ko.utils.arrayFirst(t.Posts(),function(n){return u===n});r&&r.WallText(n)};t.getdata()},myFavorites:function(n){n.stateMachine.Error(!1);var t=this,i={fetch:function(n){return frm.services.WallService.getFavorite(n)},removeFromFavorite:function(n){frm.services.WallService.removeFromFavorite(n)}};t.Posts=ko.observableArray();t.paging={isLoadingNextPage:ko.observable(!1),isLastPage:ko.observable(!1),currentPageIndex:ko.observable(0)};t.search=function(){t.getdata()};t.getdata=function(){n.stateMachine.isLoading(!0);i.fetch(ko.toJS(t.paging.currentPageIndex),ko.toJS(n.stateMachine.Filter)).then(function(i){var r=i.data;ko.utils.arrayForEach(r,function(n){n.IsFavorite=ko.observable(n.IsFavorite);n.AmountOfFavorites=ko.observable(n.AmountOfFavorites)});n.stateMachine.isLoading(!1);frm.utils.arrayReplace(t.Posts,r)})};t.addItems=function(n){ko.utils.arrayPushAll(t.Posts,n)};t.nextPage=function(){return t.paging.currentPageIndex(t.paging.currentPageIndex()+1),t.paging.isLoadingNextPage(!0),i.fetch(ko.toJS(t.paging.currentPageIndex),ko.toJS(n.stateMachine.Filter)).then(function(n){ko.utils.arrayForEach(n.data,function(n){n.IsFavorite=ko.observable(n.IsFavorite);n.AmountOfFavorites=ko.observable(n.AmountOfFavorites)});t.addItems(n.data);t.paging.isLoadingNextPage(!1)},function(){t.paging.isLoadingNextPage(!1)})};t.RemoveFavorite=function(n){t.Posts.remove(n);i.removeFromFavorite(n.Id)};t.getdata()}};n.WallViewModel=r}(frm.models,frm.services),function(n){var t=function(){var n=this;n.Email=ko.observable("");n.MailError=ko.observable(!1);n.Loading=ko.observable(!1);n.Success=ko.observable(!1);n.Subscribe=function(){if(n.CheckEmail())n.Loading(!0),n.MailError(!1),frm.services.EbookSubscriberService.addEmail(ko.toJS(n.Email())).then(function(t,i){i=="success"?n.Success(!0):n.Success(!1);n.Loading(!1)});else{n.MailError(!0);return}};n.CheckEmail=function(){return n.Email().length>0?!0:!1}};n.EbookSubscriberViewModel=t}(frm.models,frm.services),function(n){var t=function(){var n=this,t={getRoommateMatches:function(){return frm.services.RoommateMatchWidgetService.getRoommateMatches()}};n.RoommateIsLoading=ko.observable(!0);n.Roommates=ko.observableArray();n.ShowMore=ko.observable(!1);n.tries=0;n.Fetch=function(){n.RoommateIsLoading(!0);t.getRoommateMatches().then(function(t){frm.utils.arrayReplace(n.Roommates,t.data);n.Roommates().length==0?n.RetryFetch():n.RoommateIsLoading(!1)})};n.RetryFetch=function(){n.tries<3?(n.tries=n.tries+1,setTimeout(function(){n.Fetch()},5e3)):n.RoommateIsLoading(!1)};n.ShowMoreBtn=function(){n.ShowMore(!n.ShowMore())};setTimeout(function(){n.Fetch()},10)};n.RoommateMatchWidgetViewModel=t}(frm.models,frm.services),function(n){var t=function(n){var t=this;privates={get:function(n,t){return frm.services.PropertyService.getSimilarProperties(n,t)}};t.Loading=ko.observable(!1);t.Properties=ko.observableArray();t.Initialize=function(){if(n){t.Loading(!0);var i=n.propertyId,r=n.top;privates.get(i,r).then(function(n){frm.utils.arrayReplace(t.Properties,n.data);t.Loading(!1)})}};t.Initialize()};n.SimilarPropertiesWidgetViewModel=t}(frm.models,frm.services),function(n){var t=function(n){self.options=n;self.StaffPicks=ko.observableArray(n.staffPicks);self.ShowMore=ko.observable(!1);self.Endorsements=n.amountOfEndorsements||0;self.ShowMoreStaffPicks=function(){self.ShowMore(!0)};self.IsWallTemplatesLoaded=ko.observable(!1);frm.services.WallService.requestTemplates().then(function(){self.IsWallTemplatesLoaded(!0)});this.RoommateMatchWidget=new frm.models.RoommateMatchWidgetViewModel(n);this.PropertyMatchWidget=new frm.models.PropertyMatchWidgetViewModel(n)};n.DashboardViewModel=t}(frm.models,frm.services),function(n){var t=function(n){var t=this,i={addTenantEndorsement:function(n){return frm.services.TenantEndorsementService.addTenantEndorsement(n)},addTenantEndorsementComment:function(n){return frm.services.TenantEndorsementService.addTenantEndorsementComment(n)},deleteTenantEndorsementComment:function(n){return frm.services.TenantEndorsementService.deleteTenantEndorsementComment(n)},pinTenantEndorsementComment:function(n){return frm.services.TenantEndorsementService.pinTenantEndorsementComment(n)},unPinTenantEndorsementComment:function(n){return frm.services.TenantEndorsementService.unPinTenantEndorsementComment(n)}};t.AccountId=n.accountId;t.CanEndorse=ko.observable(n.canEndorse||!1);t.IsOwnProfile=ko.observable(n.isOwnProfile||!1);t.Endorsements=ko.observable(n.amountOfEndorsements||0);t.EndorsementComments=ko.observableArray(n.endorsementComments||undefined);t.EndrosementRelations=ko.observableArray(n.endrosementRelations||undefined);t.CommentIndex=ko.observable(0);t.EndCommentIndex=ko.observable(t.EndorsementComments().length>1?!1:!0);t.CommentModel={AccountId:ko.observable(n.accountId),Comment:ko.observable().extend({required:!0}),Name:ko.observable().extend({required:!0}),Relation:ko.observable("0")};t.ShowEndorsementBox=ko.observable(n.canEndorse&&!n.isOwnProfile||!1);t.ShowEndorseView=ko.observable(n.canEndorse&&!n.isOwnProfile||!1);t.ShowCommentView=ko.observable(!1);t.ShowThankYouView=ko.observable(!1);t.AddTenantEndorsement=function(){i.addTenantEndorsement(t.AccountId).then(function(){t.UpEndorsements();t.ShowCommentView(!0);t.ShowEndorseView(!1)})};t.EndCommentView=function(){t.ShowCommentView(!1);t.ShowThankYouView(!0)};t.SendComment=function(){t.IsValid()&&i.addTenantEndorsementComment(ko.toJS(t.CommentModel)).then(function(n){var r=ko.utils.arrayFirst(t.EndorsementComments(),function(n){return n.IsFocus===!0}),i=0;r!=null&&(i=1);t.EndorsementComments.splice(i,0,n.data);t.CommentIndex()>=t.EndorsementComments().length-1?t.EndCommentIndex(!0):t.EndCommentIndex(!1);t.EndCommentView()})};t.LoadMoreComments=function(){t.CommentIndex(t.CommentIndex()+5);t.CommentIndex()>=t.EndorsementComments().length?t.EndCommentIndex(!0):t.EndCommentIndex(!1)};t.UpEndorsements=function(){var n=t.Endorsements()+1;t.Endorsements(n)};t.DeleteComment=function(n){i.deleteTenantEndorsementComment(n.Id).then(function(){t.EndorsementComments.remove(n)})};t.PinComment=function(n){i.pinTenantEndorsementComment(n.Id).then(function(){var i=ko.utils.arrayFirst(t.EndorsementComments(),function(n){return n.IsFocus===!0});i!=null&&(t.EndorsementComments.remove(i),i.IsFocus=!1,t.EndorsementComments.splice(1,0,i));t.EndorsementComments.remove(n);n.IsFocus=!0;t.EndorsementComments.splice(0,0,n)})};t.UnPinComment=function(n){i.unPinTenantEndorsementComment(n.Id).then(function(){n.IsFocus=!1})};t.IsValid=function(){var n=ko.validation.group([t.CommentModel.Name,t.CommentModel.Comment]);return n().length>0?(n.showAllMessages(),!1):!0}};n.TenantEndorsementViewModel=t}(frm.models,frm.services),function(n){var t=function(n){var t=this,i={getSettings:function(){return frm.services.MailSubscriptionService.getSettings(n.accountId).then(function(n){var i=n.data;ko.utils.arrayForEach(i,function(n){n.Status=ko.observable(n.Status)});frm.utils.arrayReplace(t.Settings,i);t.Loading(!1)})},updateSetting:function(t){frm.services.MailSubscriptionService.updateSetting(t,n.accountId)},deactiveAllSettings:function(){frm.services.MailSubscriptionService.deactiveAllSettings(n.accountId).then(function(){i.getSettings()})}};t.Settings=ko.observableArray();t.Loading=ko.observable(!0);t.GetSettings=function(){t.Loading(!0);i.getSettings()};t.ToggleSetting=function(n){n.Status(!n.Status());var t=ko.toJS(n);i.updateSetting(t)};t.DeactiveAllSettings=function(){i.deactiveAllSettings()};t.GetSettings()};n.MailSubscriptionViewModel=t}(frm.models,frm.services),function(n){var t=function(n){var t=this,i={getSettings:function(){return frm.services.PhoneSubscriptionService.getSettings(n.accountId).then(function(n){var i=n.data;ko.utils.arrayForEach(i,function(n){n.Status=ko.observable(n.Status)});frm.utils.arrayReplace(t.Settings,i);t.Loading(!1)})},updateSetting:function(t){frm.services.PhoneSubscriptionService.updateSetting(t,n.accountId)},deactiveAllSettings:function(){frm.services.PhoneSubscriptionService.deactiveAllSettings(n.accountId).then(function(){i.getSettings()})}};t.Settings=ko.observableArray();t.Loading=ko.observable(!0);t.GetSettings=function(){t.Loading(!0);i.getSettings()};t.ToggleSetting=function(n){n.Status(!n.Status());var t=ko.toJS(n);i.updateSetting(t)};t.DeactiveAllSettings=function(){i.deactiveAllSettings()};t.GetSettings()};n.PhoneSubscriptionViewModel=t}(frm.models,frm.services),function(n){var i=function(n){var i=this,r={fetch:function(){return frm.services.CommentService.fetchComments(n.objectId,n.commentType,ko.toJS(i.paging.currentPageIndex()),n.commentId)},addComment:function(t){return frm.services.CommentService.addComment(t,n.commentType,ko.toJS(i.paging.currentPageIndex()))},deleteComment:function(t){return frm.services.CommentService.deleteComment(t,n.commentType,n.objectId,ko.toJS(i.paging.currentPageIndex()))}};i.isLoading=ko.observable(!1);i.Comments=ko.observableArray();i.CommentBody={Comment:ko.observable(),ObjectId:n.objectId};i.paging={isLastPage:ko.observable(!0),currentPageIndex:ko.observable(0)};i.ClearCommentBody=function(){i.CommentBody.Comment(null)};i.startDelete=function(n){n.IsDeleteStarted(!0)};i.cancelDelete=function(n){n.IsDeleteStarted(!1)};i.deleteComment=function(n){r.deleteComment(n.Comment).then(function(t){var r=t.data;r==!0?i.Comments.remove(n):(n.Comment.IsDeleted(!0),n.Comment.IsDeleteStarted(!1))})};i.addComment=function(){r.addComment(ko.toJS(i.CommentBody)).then(function(r){var u=r.data;u.IsDeleted=ko.observable(u.IsDeleted);u.IsDeleteStarted=ko.observable(!1);i.Comments.unshift(new t(u,n));i.ClearCommentBody();n.onCommentCreated&&n.onCommentCreated()})};i.GetComments=function(){r.fetch().then(function(r){var u;i.isLoading(!0);r.data!=undefined&&(u=r.data.Items,i.paging.isLastPage(r.data.IsLastPage==undefined?!0:r.data.IsLastPage),i.paging.currentPageIndex(r.data.Number),u=r.data.Items,ko.utils.arrayPushAll(i.Comments,ko.utils.arrayMap(u,function(i){return i.IsDeleted=ko.observable(i.IsDeleted),i.IsDeleteStarted=ko.observable(!1),i.IsHighlighted=i.CommentId==n.commentId||!1,new t(i,n)})));i.isLoading(!1);n.onLoadComplete&&n.onLoadComplete()})};i.getMore=function(){i.GetComments()};i.GetComments()},t=function(n,t){var i=this,r={fetchReplies:function(n){return frm.services.CommentService.fetchReplies(n,ko.toJS(i.paging.currentPageIndex()))},addComment:function(n){return frm.services.CommentService.addComment(n,t.commentType,ko.toJS(i.paging.currentPageIndex()))},deleteReply:function(n){return frm.services.CommentService.deleteComment(n,t.commentType,t.objectId,ko.toJS(i.paging.currentPageIndex()))}};i.isLoading=ko.observable(!1);i.IsHighlighted=n.IsHighlighted;i.Comment=n;i.Replies=ko.observableArray();i.ReplyCommentBody={Comment:ko.observable(),ParentId:n.CommentId,ObjectId:t.objectId};i.paging={isLastPage:ko.observable(!0),currentPageIndex:ko.observable(0),loadAllReplies:ko.observable(!1)};i.addReply=function(){r.addComment(ko.toJS(i.ReplyCommentBody)).then(function(n){if(i.paging.isLastPage()){var r=n.data;r.IsDeleted=ko.observable(r.IsDeleted);r.IsDeleteStarted=ko.observable(!1);i.Replies.push(r);i.ReplyCommentBody.Comment(null)}else i.paging.loadAllReplies(!0),i.getMoreReplies();t.onCommentCreated&&t.onCommentCreated()})};i.startDelete=function(n){n.IsDeleteStarted(!0)};i.cancelDelete=function(n){n.IsDeleteStarted(!1)};i.deleteComment=function(n){r.deleteReply(n).then(function(t){var r=t.data;r==!0?i.Replies.remove(n):(n.IsDeleted(!0),n.IsDeleteStarted(!1))})};i.getReplies=function(n){i.isLoading(!0);r.fetchReplies(n).then(function(n){if(n.data!=undefined){var t=n.data.Items;i.paging.isLastPage(n.data.IsLastPage==undefined?!0:n.data.IsLastPage);i.paging.currentPageIndex(n.data.Number);ko.utils.arrayPushAll(i.Replies,ko.utils.arrayMap(t,function(n){return n.IsDeleted=ko.observable(n.IsDeleted),n.IsDeleteStarted=ko.observable(!1),n}))}!i.paging.isLastPage()&&i.paging.loadAllReplies()?i.getMoreReplies():i.paging.loadAllReplies(!1);i.isLoading(!1)})};i.getMoreReplies=function(){i.getReplies(ko.toJS(i.Comment.CommentId))};i.getReplies(n.CommentId)};n.CommentViewModel=i}(frm.models,frm.services),function(n){var t=function(n){var t=this,i;n.trigger==null&&(n.trigger=!1);n.trackingLocation==null&&(n.trackingLocation="UNKNOWN");modalService=frm.services.ModalService;t.currentView=ko.observable();t.Loading=ko.observable(!1);t.isPaymentAction=ko.observable(!1);t.SetView=function(n,i){t.currentView({name:n,model:i})};t.isMobileView=function(){return $(window).width()<=768?!0:!1};t.TriggerPopup=function(i,r){var u=!1;(i&&(u=i),t.isPaymentAction(!1),r&&t.isPaymentAction(!0),n.trigger&&(!t.isMobileView()||i))&&($(function(){modalService.open({template:$("#OnLoadBecomeMemberPopup").html(),width:600,height:480});ko.applyBindings(t,document.getElementById("OnLoadBecomeMemberPopupBox"))}),App.settings.account.isLoggedIn&&analytics.identify(App.settings.account.id,{"Experiment Data: Prompt visitors to create a user on load V0":n.trackingLocation}))};t.SetSignUpView=function(){t.SetView("OnLoadPopUp-SignUpView",new i.SignUpView(t,n))};t.SetSignInView=function(){t.SetView("OnLoadPopUp-SignInView",new i.SignInView(t,n))};i={SignUpView:function(n,t){var i=this,r={defaultAuth:function(n){return frm.services.accountService.createPartial(n)},facebookAuth:function(){return frm.services.accountService.createThroughFacebook({userType:1})},googleAuth:function(){return frm.services.accountService.createThroughGoogle({userType:1})}};ko.validation.rules.acceptTerms={validator:function(n){return!!n}};i.RegistrationModel={UserType:ko.observable(1),Firstname:ko.observable().extend({required:!0}),Lastname:ko.observable().extend({required:!0}),Email:ko.observable().extend({required:!0}),emailChecks:ko.observableArray(),Password:ko.observable().extend({required:!0})};i.SignInModel={Username:ko.observable(),Password:ko.observable()};i.AcceptedTerms=ko.observable(!1).extend({acceptTerms:{message:"Accept terms please"}});i.ErrorModel={Message:ko.observable(),HasError:ko.observable(!1)};i.UseFacebook=function(){i.IsValid(!1)&&(n.Loading(!0),r.facebookAuth().then(function(){window.location.href=t.returnUrl},function(){i.ErrorModel.HasError(!0);i.ErrorModel.Message(t.errorMessages.unknownError);n.Loading(!1)}))};i.UseGoogle=function(){i.IsValid(!1)&&(n.Loading(!0),r.googleAuth().then(function(){window.location.href=t.returnUrl},function(){i.ErrorModel.HasError(!0);i.ErrorModel.Message(t.errorMessages.unknownError);n.Loading(!1)}))};i.DefaultSignUp=function(){i.IsValid(!0)&&(n.Loading(!0),i.ErrorModel.HasError(!1),r.defaultAuth(ko.toJS(i.RegistrationModel)).then(function(r){r.status=="success"?window.location.href=t.returnUrl:(i.ErrorModel.HasError(!0),i.ErrorModel.Message(r.Message));n.Loading(!1)},function(r){i.ErrorModel.HasError(!0);r.statusText=="Conflict"?i.ErrorModel.Message(t.errorMessages.duplicateEmail):r.responseJSON.data?r.responseJSON.data.type=="invalidEmail"?i.ErrorModel.Message(t.errorMessages.invalidEmail):i.ErrorModel.Message(t.errorMessages.unknownError):i.ErrorModel.Message(t.errorMessages.unknownError);n.Loading(!1)}))};i.IsValid=function(n){var r;return(n||(r=ko.validation.group([i.AcceptedTerms])),n&&(r=ko.validation.group([i.AcceptedTerms,i.RegistrationModel.Firstname,i.RegistrationModel.Lastname,i.RegistrationModel.Email,i.RegistrationModel.Password])),r().length>0)?(r.showAllMessages(),i.ErrorModel.HasError(!0),i.ErrorModel.Message(t.errorMessages.missingFields||t.errorMessages.unknownError),!1):!0}},SignInView:function(n,t){var i=this;i.ErrorModel={Message:ko.observable(),HasError:ko.observable(!1)};i.SignInViewModel=new frm.models.AccountSignInViewModel({onAuthenticated:function(){location.href=t.returnUrl},onAuthenticationFailed:function(n){n=n||{responseText:"{}",status:-1};switch(n.status){case 403:var r=JSON.parse(n.responseText);location.href=r.data.url;break;default:viewModel.isLoading(!1);switch(n.status){case 404:i.ErrorModel.HasError(!0);i.ErrorModel.Message(t.errorMessages.notFound);break;case 400:i.ErrorModel.HasError(!0);i.ErrorModel.Message(t.errorMessages.unknownError)}}}})}};t.SetSignUpView();t.TriggerPopup()};n.OnLoadBecomeMemberPopupViewModel=t}(frm.models,frm.services);var _genericPopuptrackingCode="?t=1",_genericPopupEpayParameters=null,_genericPopupEpayOptions=null,_shouldReload=!1,genericPopupViewHelper={services:{defaultAuth:function(n){return frm.services.accountService.createAccount(n,6)},facebookAuth:function(){return frm.services.accountService.createThroughFacebook({userType:1})},googleAuth:function(){return frm.services.accountService.createThroughGoogle({userType:1})},requestTemplates:function(){var n=[frm.services.TemplateService.request("/misc/templates/popup")];jQuery.when.apply(jQuery,n).done(function(){})},isEmailAvalible:function(n){return frm.services.accountService.checkEmail(n)},getPaymentInit:function(n){return $.ajax({url:"/Api/Web/Payment/GetPaymentInit",type:"GET",data:n})},checkOrderStatus:function(n){return $.ajax({url:"/Api/Web/Payment/IsProductOrderAccepted",type:"GET",data:{orderId:n}})},getModalService:function(){return frm.services.ModalService}},functions:{fbEventListiner:function(n,t){$(document).on(n,function(){t()})},fbRemoveVentListiner:function(n){$(document).off(n)},isValid:function(n){var t=ko.validation.group(n);return t().length>0?(t.showAllMessages(),!1):!0},removeValidationMessage:function(n){if(n!=undefined){var t=ko.validation.group(n);t.showAllMessages(!1)}},isMobile:function(){return $(window).width()<=768?!0:!1},isLowRes:function(){return $(window).height()<=724?!0:!1},setInnerFixedHeight:function(){var n=$(".fancybox-inner"),i=$(".fancybox-inner > .generic-popup-container"),t=$(".generic-popup-container");!genericPopupViewHelper.functions.isMobile()&&genericPopupViewHelper.functions.fixedInnerHeight()&&n.height(t.height())},triggerAlert:function(n){alert(n)},genericBuildReturnUrl:function(n,t){return frm.services.accountService.trackingHelper.addTrackingParameter(n,t,_genericPopuptrackingCode)},genericReturnUrlHref:function(n,t){var i=genericPopupViewHelper.functions.genericBuildReturnUrl(n,t);location.href=i},tracking:{general:function(){var n="Default signup";frm.services.TrackingService.vendor.enroll(n);frm.services.TrackingService.vendor.tenantEnroll(n)},custom:function(n,t){frm.services.TrackingService.vendor.custom(n,t)}}}};(function(n){var i=!1,r=function(n){var i=this;modalService=genericPopupViewHelper.services.getModalService();i.GenericSignUpSuccessHandler=function(t,r){if(App.settings.currentSiteId==1){var u=window.location.href;i.Areas.Payment.SetStartPaymentFlowView(genericPopupViewHelper.functions.genericBuildReturnUrl(u,r))}else genericPopupViewHelper.functions.genericReturnUrlHref(n.returnUrl,r)};i.currentView=ko.observable();i.Loading=ko.observable(!0);i.Areas={Chat:{SetWriteStaffViewModel:function(n){i.SetView("GenericPopup-WriteStaffViewModel",new t.chat.WriteStaffViewModel(i,n))}},Templates:{SetTemplateCreateFromMessageViewModel:function(){i.SetView("GenericPopup-TemplateCreateFromMessageViewModel",new t.templates.TemplateCreateFromMessageViewModel(i,n))},SetEditTemplateViewModel:function(){i.SetView("GenericPopup-TemplateEditViewModel",new t.templates.TemplateEditViewModel(i,n))}},Payment:{SetStartPaymentFlowView:function(r){_shouldReload=!1;n.NextView=i.Areas.Payment.SetPaymentWindowView;n.onCloseFunction=function(){r!==undefined?location.href=r:_shouldReload&&location.reload()};_genericPopupEpayParameters=n.EpayParameters==undefined?{overwriteProductId:0,returnUrl:"",internalReferralId:null,internalReferralType:null,paymentActionId:0,anonymousPaymentAction:0}:n.EpayParameters;i.SetView("GenericPopup-StartPaymentFlowView",new t.payment.defaultProduct.StartPaymentFlowView(i,n))},SetPaymentWindowView:function(r){n.PaymentAccepted=i.Areas.Payment.SetPaymentAcceptedView;n.PaymentDeclined=i.Areas.Payment.SetPaymentDeclinedView;n.onCloseFunction=r;i.SetView("GenericPopup-PaymentWindowView",new t.payment.defaultProduct.PaymentWindowView(i,n))},SetPaymentAcceptedView:function(r){_shouldReload=!0;n.onCloseFunction=r;i.SetView("GenericPopup-PaymentAcceptedView",new t.payment.defaultProduct.PaymentAcceptedView(i,n))},SetPaymentDeclinedView:function(r){_shouldReload=!0;n.onCloseFunction=r;n.Retry=i.Areas.Payment.SetPaymentWindowView;i.SetView("GenericPopup-PaymentDeclinedView",new t.payment.defaultProduct.PaymentDeclinedView(i,n))}},SignUp:{SetSearchPageSignUpView:function(){n.onSignupSuccess=function(t){genericPopupViewHelper.functions.genericReturnUrlHref(n.returnUrl,t)};n.previousView=i.Areas.SignUp.SetSearchPageSignUpView;i.SetView("GenericPopup-SearchPageSignUpView",new t.GenericSignUpViewModel(i,n))},SetSignInView:function(r){var u=n;u.previousView=r!==undefined?r:i.Areas.SignUp.SetTenantNavBarSignUpView;i.SetView("GenericPopup-SignInView",new t.SignInView(i,u))},SetTenantBasicDataView:function(r){var u=n;n.account=r!==undefined?r.account:undefined;n.data=r;i.SetView("GenericPopup-TenantBasicDataView",new t.TenantBasicDataView(i,u))},SetTenantNavBarSignUpView:function(){n.onSignupSuccess=function(n){i.Areas.SignUp.SetTenantBasicDataView(n)};n.previousView=i.Areas.SignUp.SetTenantNavBarSignUpView;i.SetView("GenericPopup-TenantNavBarSignUpView",new t.GenericSignUpViewModel(i,n))},RoomListingSignUpView:function(){n.onSignupSuccess=function(t){i.GenericSignUpSuccessHandler(n.returnUrl,t)};i.SetView("GenericPopup-RoomListingSignUpView",new t.GenericSignUpViewModel(i,n))},RoomListingPreviewSignUpView:function(){n.onSignupSuccess=function(t){i.GenericSignUpSuccessHandler(n.returnUrl,t)};n.previousView=i.Areas.SignUp.RoomListingPreviewSignUpView;i.SetView("GenericPopup-RoomListingPreviewSignUpView",new t.RoomListingPreviewSignUpViewModel(i,n))},TenantListingSignUpView:function(){n.onSignupSuccess=function(t){i.GenericSignUpSuccessHandler(n.returnUrl,t)};n.previousView=i.Areas.SignUp.TenantListingSignUpView;i.SetView("GenericPopup-TenantListingSignUpView",new t.GenericSignUpViewModel(i,n))},PropertyListingSignUpView:function(){n.onSignupSuccess=function(t){i.GenericSignUpSuccessHandler(n.returnUrl,t)};n.previousView=i.Areas.SignUp.PropertyListingSignUpView;i.SetView("GenericPopup-PropertyListingSignUpView",new t.GenericSignUpViewModel(i,n))},ExternalRoomListingSignUpView:function(){n.onSignupSuccess=function(t){i.GenericSignUpSuccessHandler(n.returnUrl,t)};n.previousView=i.Areas.SignUp.ExternalRoomListingSignUpView;i.SetView("GenericPopup-ExternalRoomListingSignUpView",new t.GenericSignUpViewModel(i,n))},MessagePaymentActionSignUpView:function(){n.onSignupSuccess=function(t){genericPopupViewHelper.functions.genericReturnUrlHref(n.returnUrl,t)};n.previousView=i.Areas.SignUp.MessagePaymentActionSignUpView;i.SetView("GenericPopup-MessagePaymentActionSignUpView",new t.GenericSignUpViewModel(i,n))}}};i.SetView=function(n,t){i.currentView({name:n,model:t});i.Loading(!1)}},t;r.create=function(n,t){var r=$(document.createElement("div")),f={isLoading:ko.observable(!i),viewModel:n},e="no",u;return r.html('<!-- ko if: !isLoading() --> <div data-bind="template: { name:\'GenericPopupTemplate\', data: viewModel }"><\/div> <!-- /ko --> <!-- ko if: isLoading()  --> <div class="full-buffer loading-overlay"><div class="LoadSpinner big"><\/div><\/div> <!-- /ko -->'),genericPopupViewHelper.functions.isMobile()||(r.css({"min-width":"350px"}),genericPopupViewHelper.functions.isLowRes()&&(e="yes")),u={template:r,width:"auto",height:"auto",scrolling:e},$("body").append(r),t!=undefined&&(u.closeOnOverlayClick=!1,u.onAfterClose=function(){t.onClose()}),modalService.open(u),f.isLoading.subscribe(function(n){n==!1&&setTimeout(function(){},150)}),ko.applyBindings(f,r[0]),frm.services.TemplateService.request("/misc/templates/popup").then(function(){i=!1;f.isLoading(!1)})};t={payment:{defaultProduct:{StartPaymentFlowView:function(n,t){var r,i,u;ko.validation.rules.checkedTerms={validator:function(n){return!!n}};ko.validation.registerExtenders();r="beforeClose.fb";_genericPopupEpayOptions=null;i=this;i.Loading=ko.observable(!0);i.Texts={Headline:ko.observable(""),SubHeadline:ko.observable(""),Information:ko.observable(""),Terms:ko.observable(""),TermsError:ko.observable("")};i.license=ko.observable(!1);i.SetNextView=function(){i.license()?t.NextView(t.onCloseFunction):alert(i.Texts.TermsError())};u=function(){genericPopupViewHelper.functions.fbRemoveVentListiner(r);t.onCloseFunction!=undefined&&t.onCloseFunction()};i.ClosePopupDOM=function(){modalService.close()};i.GetProduct=function(){console.log("GetProduct");genericPopupViewHelper.services.getPaymentInit(_genericPopupEpayParameters).then(function(n){_genericPopupEpayOptions=n.data;i.Texts.Headline(n.data.PaymentText.ViewProductHeadline);i.Texts.SubHeadline(n.data.PaymentText.ViewProductSubHeadline);i.Texts.Information(n.data.PaymentText.ViewProductInformation);i.Texts.Terms(n.data.PaymentText.PaymentWindowTerms);i.Texts.TermsError(n.data.PaymentText.PaymentWindowTermsError);i.license.extend({checkedTerms:{message:n.data.PaymentText.PaymentWindowTermsError}});i.Loading(!1)})};i.Init=function(){var n=1;App.settings.currentSiteId==1?frm.services.abTestService.getSplitTest("IntroProductTest_3days15",n).then(function(t){var r=t.data;r.Variation.Name!=undefined&&(frm.utils.ABTestTrackingHelper("IntroProductTest3days15",r.Variation.Name,r.Variation.Id,n),r.Variation.Name=="NewProduct"&&(_genericPopupEpayParameters.overwriteProductId=81));i.GetProduct()}):i.GetProduct()};i.Init();genericPopupViewHelper.functions.fbEventListiner(r,u);genericPopupViewHelper.functions.tracking.custom("ViewedPaymentPopup","Popup")},PaymentAcceptedView:function(n,t){var r=this,i,u;r.Loading=ko.observable(!1);i="beforeClose.fb";u=function(){genericPopupViewHelper.functions.fbRemoveVentListiner(i);t.onCloseFunction!=undefined?t.onCloseFunction():location.reload()};r.ClosePopupDOM=function(){modalService.close()};genericPopupViewHelper.functions.fbEventListiner(i,u)},PaymentDeclinedView:function(n,t){var r=this,i,u;r.Loading=ko.observable(!1);r.TryAgain=function(){t.Retry()};i="beforeClose.fb";u=function(){genericPopupViewHelper.functions.fbRemoveVentListiner(i);t.onCloseFunction!=undefined&&t.onCloseFunction()};genericPopupViewHelper.functions.fbEventListiner(i,u)},PaymentWindowView:function(n,t){var f=!1,r=this,e="beforeClose.fb",i=undefined;r.Loading=ko.observable(!0);r.Texts={ProductDescription:ko.observable(_genericPopupEpayOptions.PaymentText.ProductDescriptionShort)};r.StartEpay=function(n){var t=n,u={merchantnumber:t.EpayOption.MerchantId,amount:t.ProductItem.EpayInformation.Price,currency:t.ProductItem.EpayInformation.CurrencyCode,callbackurl:t.EpayOption.CallbackUrl,Instantcallback:"1",instantcapture:"1",ordertext:t.ProductItem.EpayInformation.Description,group:"GoldRoommate Subscription",description:t.EpayOption.AccountId,windowstate:"1",authmail:"",addfee:"0",language:t.EpayOption.LanguageId,subscription:1,googletracker:t.EpayOption.AnalyticsId,paymentcollection:"1"},e;genericPopupViewHelper.functions.isMobile()?(u.mobile=1,u.accepturl=t.EpayOption.AcceptedUrl,u.declineurl=t.EpayOption.RejectedUrl):u.mobile=0;i=new PaymentWindow(u);i.on("precompleted",function(){r.Loading(!0);i.submit()});i.on("completed",function(){});i.on("declined",function(){f=!0;s()});i.on("close",function(){f||h(t)});e=new frm.services.PaymentService(t.EpayOption.PaymentServiceUrl);e.beginOrder(t.EpayOption.OrderId,t.ProductItem.ProductId,function(){i.open()})};var s=function(){r.Loading(!1);i.close();u();t.PaymentDeclined(t.onCloseFunction)},u=function(){genericPopupViewHelper.functions.fbRemoveVentListiner(e)},h=function(n){var i=0,t=!1,r=setInterval(function(){t||(i<5?(i+=1,t=!0,genericPopupViewHelper.services.checkOrderStatus(n.EpayOption.OrderId).then(function(i){var u=i.data;u==!0&&(o(r),c(n));t=!1})):(o(r),modalService.close()))},1e3)},o=function(n){clearInterval(n)},c=function(n){var f=n,e,i;u();e=f.EpayOption.AcceptedUrl;i=document.createElement("iframe");i.frameBorder=0;i.width="0px";i.height="0px";i.id="payment-accepted-frame-"+f.EpayOption.OrderId;i.setAttribute("src",e);document.getElementById("payace-view").appendChild(i).onload=function(){setTimeout(function(){document.getElementById("payace-view").removeChild(i);r.Loading(!1);t.PaymentAccepted(t.onCloseFunction)},2500)}};genericPopupViewHelper.functions.fbEventListiner(e,u);setTimeout(function(){r.StartEpay(_genericPopupEpayOptions);setTimeout(function(){},2e3)},25)}}},SignInView:function(n,t){var i=this;i.ErrorModel={Message:ko.observable(),HasError:ko.observable(!1)};i.Loading=ko.observable(!1);i.goToPreviousView=function(){t.previousView()};i.legacySignInView=new frm.models.AccountSignInViewModel({onAuthenticated:function(n){i.Loading(!0);genericPopupViewHelper.functions.genericReturnUrlHref(t.returnUrl,n.data)},onAuthenticationFailed:function(n){n=n||{responseText:"{}",status:-1};switch(n.status){case 403:var r=JSON.parse(n.responseText);location.href=r.data.url;break;default:i.Loading(!1);switch(n.status){case 404:i.ErrorModel.HasError(!0);i.ErrorModel.Message(t.messages.notFound);break;case 400:i.ErrorModel.HasError(!0);i.ErrorModel.Message(t.messages.unknownError)}}}})},GenericSignUpViewModel:function(n,t){var i=this,r=undefined;i.EmailAvalible=ko.observable(!0);i.RegistrationModel={UserType:ko.observable(1),Firstname:ko.observable().extend({required:!0}),Lastname:ko.observable().extend({required:!0}),Email:ko.observable().extend({required:!0}),Password:ko.observable().extend({required:!0}),emailChecks:ko.observableArray()};t.contacting!=undefined&&(i.RegistrationModel.contacting=t.contacting);i.AcceptedTerms=ko.observable(!1).extend({acceptTerms:{message:"Accept terms please"}});i.ErrorModel={Message:ko.observable(),HasError:ko.observable(!1)};i.Loading=ko.observable(!1);ko.validation.rules.acceptTerms={validator:function(n){return!!n}};i.goToSignInView=function(){n.Areas.SignUp.SetSignInView(t.previousView)};i.RegistrationModel.Email.subscribe(function(n){if(n.length>0)var r=genericPopupViewHelper.services.isEmailAvalible(n).then(function(n){var r=!n.data;r==!1?(i.EmailAvalible(!1),i.ErrorModel.Message(t.messages.duplicateEmail),i.ErrorModel.HasError(!0)):(i.EmailAvalible(!0),i.ErrorModel.Message(undefined),i.ErrorModel.HasError(!1))})});i.UseFacebook=function(){genericPopupViewHelper.functions.removeValidationMessage(r);var n=[i.AcceptedTerms];genericPopupViewHelper.functions.isValid(n)?(i.ErrorModel.Message(undefined),i.ErrorModel.HasError(!1),genericPopupViewHelper.services.facebookAuth().then(function(n){i.Loading(!0);n.data.isExistingUser||genericPopupViewHelper.functions.tracking.general();t.onSignupSuccess(n.data)}),function(n){i.Loading(!1);i.ErrorModel.Message(n||t.messages.unknownError);i.ErrorModel.HasError(!0)}):(r=n,i.Loading(!1),genericPopupViewHelper.functions.triggerAlert(t.messages.terms))};i.UseGoogle=function(){genericPopupViewHelper.functions.removeValidationMessage(r);var n=[i.AcceptedTerms];genericPopupViewHelper.functions.isValid(n)?(i.ErrorModel.Message(undefined),i.ErrorModel.HasError(!1),genericPopupViewHelper.services.googleAuth().then(function(n){i.Loading(!0);n.data.isExistingUser||genericPopupViewHelper.functions.tracking.general();t.onSignupSuccess(n.data)}),function(n){i.Loading(!1);i.ErrorModel.Message(n||t.messages.unknownError);i.ErrorModel.HasError(!0)}):(r=n,i.Loading(!1),genericPopupViewHelper.functions.triggerAlert(t.messages.terms))};i.DefaultCreate=function(){var n,u;genericPopupViewHelper.functions.removeValidationMessage(r);n=[i.RegistrationModel.Firstname,i.RegistrationModel.Lastname,i.RegistrationModel.Email,i.RegistrationModel.Password];genericPopupViewHelper.functions.isValid(n)?i.EmailAvalible()?i.AcceptedTerms()==!1?(genericPopupViewHelper.functions.removeValidationMessage(r),u=[i.AcceptedTerms],r=u,genericPopupViewHelper.functions.isValid(u),genericPopupViewHelper.functions.triggerAlert(t.messages.terms)):(i.ErrorModel.Message(undefined),i.ErrorModel.HasError(!1),i.Loading(!0),genericPopupViewHelper.services.defaultAuth(ko.toJS(i.RegistrationModel)).then(function(n){if(n.status=="success"){genericPopupViewHelper.functions.tracking.general();t.onSignupSuccess(n.data)}else i.ErrorModel.HasError(!0),i.ErrorModel.Message(n.Message),i.Loading(!1)}),function(n){i.ErrorModel.HasError(!0);n.statusText=="Conflict"?i.ErrorModel.Message(t.messages.duplicateEmail):n.responseJSON.data?n.responseJSON.data.type=="invalidEmail"?i.ErrorModel.Message(t.messages.invalidEmail):i.ErrorModel.Message(t.messages.unknownError):i.ErrorModel.Message(t.messages.unknownError);i.Loading(!1)}):(i.Loading(!1),i.ErrorModel.Message(t.messages.duplicateEmail),i.ErrorModel.HasError(!0)):(r=n,i.Loading(!1),i.ErrorModel.Message(t.messages.missingFields),i.ErrorModel.HasError(!0))}},RoomListingPreviewSignUpViewModel:function(n,i){var r=this;r.RoomInformation=i.RoomInformation;r.SignUpViewPart=new t.GenericSignUpViewModel(n,i)},TenantBasicDataView:function(n,t){var i=this,r=new frm.services.TenantService,u={submit:function(n){return r.saveTenantBasicData(n)}};i.Loading=ko.observable(!1);i.ErrorModel={HasError:ko.observable(!1),Message:ko.observable()};i.searchAreaQuery=ko.observable().extend({required:!0});i.DataModel={AccountId:ko.observable(t.account!==undefined?t.account.ID:undefined),SearchArea:ko.observable().extend({required:!0}),Rent:ko.observable().extend({required:!0}),MoveInDate:ko.observable().extend({required:!0})};i.Submit=function(){(i.Loading(!0),i.Validation(),i.ErrorModel.HasError())||u.submit(ko.toJS(i.DataModel)).then(function(){genericPopupViewHelper.functions.genericReturnUrlHref(t.returnUrl,t.data)})};i.Skip=function(){i.Loading(!0);genericPopupViewHelper.functions.genericReturnUrlHref(t.returnUrl,t.data)};i.onAreaSelected=function(n){i.DataModel.SearchArea(n)};i.Validation=function(){var n=ko.validation.group([i.DataModel.SearchArea,i.DataModel.Rent,i.DataModel.MoveInDate]);if(n().length>0){n.showAllMessages();i.ErrorModel.HasError(!0);i.ErrorModel.Message(t.messages.missingFields);i.Loading(!1);return}i.ErrorModel.HasError(!1)}},templates:{TemplateCreateFromMessageViewModel:function(n,t){var i=this,r=frm.services.MessageTemplateService,u={createTemplate:function(n){return r.createTemplate(n)}};i.Loading=ko.observable(!1);i.ErrorModel={HasError:ko.observable(),Message:ko.observable()};i.NewTemplateModel={Name:ko.observable().extend({required:!0}),Message:ko.observable().extend({required:!0})};t.messageModel!=undefined&&i.NewTemplateModel.Message(t.messageModel.Message());i.Validation=function(){var n=ko.validation.group([i.NewTemplateModel.Name,i.NewTemplateModel.Message]);if(n().length>0){n.showAllMessages();i.ErrorModel.HasError(!0);i.ErrorModel.Message(t.texts.errorMessages.missingFields);i.Loading(!1);return}i.ErrorModel.HasError(!1)};i.Create=function(){i.Loading(!0);i.Validation();i.ErrorModel.HasError()===!1&&u.createTemplate(ko.toJS(i.NewTemplateModel)).then(function(n){t.messageModel!=undefined&&(t.messageModel.TemplateId(n.data.Id),t.messageModel.Message(i.NewTemplateModel.Message()),t.messageModel.HasChanged(!1));t.callback.onSuccess(n.data);modalService.close();i.NewTemplateModel.Name(undefined);i.NewTemplateModel.Message(undefined)}).then(function(){i.Loading(!1);i.ErrorModel.HasError(!0);i.ErrorModel.Message(t.texts.errorMessages.unknownError)})}},TemplateEditViewModel:function(n,t){var i=this,r=frm.services.MessageTemplateService;ko.utils.arrayForEach(t.templates,function(n){n.value=n.Id;n.text=n.Name});i.Loading=ko.observable(!1);i.DisplayDeleteConfirmationMessage=ko.observable(!1);i.ErrorModel={HasError:ko.observable(),Message:ko.observable()};i.Templates=ko.observableArray(ko.toJS(t.templates));i.Templates.splice(0,0,{value:undefined,text:t.texts.labels.selectTemplate});i.SelectedTemplateId=ko.observable(undefined);i.SelectedTemplate={Id:ko.observable().extend({required:!0}),Name:ko.observable().extend({required:!0}),Message:ko.observable().extend({required:!0}),AccountId:ko.observable().extend({required:!0})};i.Validation=function(){var n=ko.validation.group([i.SelectedTemplate.Id,i.SelectedTemplate.Name,i.SelectedTemplate.Message,i.SelectedTemplate.AccountId]);if(n().length>0){n.showAllMessages();i.ErrorModel.HasError(!0);i.ErrorModel.Message(t.errorMessages.errorMessages);i.Loading(!1);return}i.ErrorModel.HasError(!1)};i.Edit=function(){i.Loading(!0);i.Validation();i.ErrorModel.HasError()||r.editTemplate(ko.toJS(i.SelectedTemplate)).then(function(){modalService.close();frm.events.dispatch("messagetemplate:edit:done")})};i.StartDelete=function(){i.DisplayDeleteConfirmationMessage(!0)};i.EndDelete=function(){i.DisplayDeleteConfirmationMessage(!1)};i.DeleteTemplate=function(){i.Loading(!0);r.deleteTemplate(i.SelectedTemplate).then(function(){modalService.close();frm.events.dispatch("messagetemplate:edit:done")})};i.SelectedTemplateId.subscribe(function(n){if(n===null||n===undefined){i.SelectedTemplate.Id(undefined);i.SelectedTemplate.Name(undefined);i.SelectedTemplate.Message(undefined);i.SelectedTemplate.AccountId(undefined);return}var t=ko.utils.arrayFirst(i.Templates(),function(t){return t.Id===n});t!==undefined&&(i.SelectedTemplate.Id(t.Id),i.SelectedTemplate.Name(t.Name),i.SelectedTemplate.Message(t.Message),i.SelectedTemplate.AccountId(t.AccountId))})}},chat:{WriteStaffViewModel:function(n,t){var i=this;i.Loading=ko.observable(!1);i.ShowInput=ko.observable(!0);i.MessageInputOptions=t.messageInputOptions;frm.events.addListener("messageinput:message:sent",function(){i.ShowInput(!1);setTimeout(function(){modalService.close()},3e3)})}}};n.GenericPopupViewModel=r})(frm.models,frm.services),function(n){var t=function(n){var t=this;t.PremiumLinks=$(".premium-link");modalService=frm.services.ModalService;t.Init=function(){};t.PremiumLinks.on("touch click",function(){n.payingMember||t.TriggerPopup()});t.TriggerPopup=function(){modalService.open({template:$("#BecomeMemberPremiumPopupTmpl").html(),width:450,height:500})};t.Init()};n.PremiumViewModel=t}(frm.models,frm.services),function(n){var t=function(n){var t=this;t.CommentView=new frm.models.CommentViewModel(n);t.showPopup=function(){var i=frm.services.ModalService;i.open({href:n.membershipPopupUrl,width:460,height:600,onAfterClose:function(){t.popupOnClosed()}})};t.popupOnClosed=function(){frm.events.dispatch("popup_on_closed")}};n.PropertyCommentViewModel=t}(frm.models,frm.services),function(n){var t=function(n){var t=this;t.CommentView=new frm.models.CommentViewModel(n);t.showPopup=function(){var i=frm.services.ModalService;i.open({href:n.membershipPopupUrl,width:460,height:600,onAfterClose:function(){t.popupOnClosed()}})};t.popupOnClosed=function(){frm.events.dispatch("popup_on_closed");location.reload(!0)}};n.ArticleCommentViewModel=t}(frm.models,frm.services),function(n){var i=function(){var n=this,i={setView:function(t,i){n.currentView({name:t,model:i})}};n.currentView=ko.observable();n.isLoading=ko.observable(!1);n.Error=ko.observable(!1);n.setIndexView=function(){i.setView("wall-index",new t.index({stateMachine:n}))};n.setEditView=function(r){i.setView("wall-edit",new t.edit({stateMachine:n,postItem:r}))};n.setIndexView()},t={index:function(n){var t=this,i={fetch:function(n){return frm.services.WallService.getAll(n)}};t.Posts=ko.observableArray();t.paging={hasPrevious:ko.observable(!0),hasNext:ko.observable(!0),isLastPage:ko.observable(!1),totalPages:ko.observable(),currentPageIndex:ko.observable(0),showBtns:ko.observable(!0)};t.getdata=function(){n.stateMachine.isLoading(!0);i.fetch(t.paging.currentPageIndex()).then(function(n){var i=n.data;frm.utils.arrayReplace(t.Posts,i)});n.stateMachine.isLoading(!1)};t.deletePost=function(t){n.stateMachine.isLoading(!0);frm.services.WallService.deletePostAdmin(ko.toJS(t)).then(function(){n.stateMachine.isLoading(!1);n.stateMachine.setIndexView()})};t.nextPage=function(){return t.paging.currentPageIndex(t.paging.currentPageIndex()+1),n.stateMachine.isLoading(!0),i.fetch(ko.toJS(t.paging.currentPageIndex)).then(function(i){frm.utils.arrayReplace(t.Posts,i.data);n.stateMachine.isLoading(!1)},function(){n.stateMachine.isLoading(!1)})};t.previousPage=function(){if(!(t.paging.currentPageIndex()<=0))return t.paging.currentPageIndex(t.paging.currentPageIndex()-1),n.stateMachine.isLoading(!0),i.fetch(ko.toJS(t.paging.currentPageIndex)).then(function(i){frm.utils.arrayReplace(t.Posts,i.data);n.stateMachine.isLoading(!1)},function(){n.stateMachine.isLoading(!1)})};t.getdata()},edit:function(n){var t=this,i={fetch:function(){}};t.Model={Id:ko.observable(n.postItem.Id),AccountId:ko.observable(n.postItem.AccountId),BodyText:ko.observable(n.postItem.BodyText),AttachmentId:ko.observable(n.postItem.AttachmentId),AttachmentType:ko.observable(n.postItem.AttachmentType),Attachment:ko.observable(n.postItem.Attachment)};t.save=function(){n.stateMachine.isLoading(!0);var i=ko.toJS(t.Model);frm.services.WallService.editAdmin(i).then(function(){n.stateMachine.isLoading(!1);n.stateMachine.Error(!1)},function(){n.stateMachine.isLoading(!1);n.stateMachine.Error(!0)})};t.deletePost=function(){n.stateMachine.isLoading(!0);frm.services.WallService.deletePostAdmin(ko.toJS(t.Model)).then(function(){n.stateMachine.isLoading(!1);n.stateMachine.setIndexView()})};t.deleteAttachment=function(){n.stateMachine.isLoading(!0);var i={Id:t.Model.AttachmentId(),Type:t.Model.AttachmentType()};frm.services.WallService.deleteAttachment(i).then(function(){t.Model.AttachmentId(null);t.Model.AttachmentType(null);t.Model.Attachment(null);n.stateMachine.isLoading(!1)})}}};n.WallAdminViewModel=i}(frm.models,frm.services),function(n){var t=function(){var n=this;n.mails=ko.observableArray()};n.MailCheckViewModel=t}(frm.models,frm.services),function(n){var t=function(n){var t=this,e=frm.services.StorageService,i={storageKey:"RoomStatusWidget-"+n.data.roomId,getKey:function(n){return e.read(n)},set:function(){e.create(i.storageKey,new Date)},isValid:function(){var n=i.getKey(i.storageKey),t=JSON.stringify(new Date);if(n!=undefined){var r=Date.parse(n),u=Date.parse(JSON.parse(t)),f=(u-r)/1e3;return f>1200?!1:!0}return!1}},f={updateRented:function(n){return frm.services.RoomService.flagRented(n,!1,null,!1)},updateContactable:function(n){return frm.services.RoomService.flagContactable(n,!0,null)},updateAdplaced:function(n){return frm.services.RoomService.updateAdplaced(n)}};t.CurrentView=ko.observable();t.WidgetVisible=ko.observable(!1);t.Loading=ko.observable(!1);t.IsSuccess=ko.observable(!1);var u=!1,o=!1,r={RoomOverdue:function(t,i){var r=this;r.UpdateAdplacedDate=function(){i.Loading(!0);analytics.identify(App.settings.account.id,{"Owner Topbar Action":"Room adplaced updated via topbar"});f.updateAdplaced(n.data.roomId).then(function(){i.Loading(!1);i.SetOverdueSuccessView()})}},RentedView:function(t,i){var r=this;r.SetAvailable=function(){i.Loading(!0);analytics.identify(App.settings.account.id,{"Owner Topbar Action":"Room reactivated via topbar"});f.updateRented(n.data.roomId).then(function(){i.Loading(!1);i.SetSuccessView()})}},ContactableView:function(t,i){var r=this;r.SetContactable=function(){i.Loading(!0);analytics.identify(App.settings.account.id,{"Owner Topbar Action":"Room set contactable via topbar"});f.updateContactable(n.data.roomId).then(function(){i.Loading(!1);i.SetSuccessView()})}},SuccessView:function(n,t){var i=this;t.IsSuccess(!0)},SuccessOverdueView:function(n,t){var i=this;t.IsSuccess(!0)}};t.SetView=function(n,i){t.CurrentView({Name:n,Model:i})};t.SetSuccessView=function(){t.SetView("success-view",r.SuccessView(n,t))};t.SetOverdueSuccessView=function(){t.SetView("success-overdue-view",r.SuccessOverdueView(n,t))};t.SetStartUpView=function(i,u,f){if(i){t.SetView("rented-view",new r.RentedView(n,t));t.WidgetVisible(!0);return}if(!i&&!u){t.SetView("contactable-view",new r.ContactableView(n,t));t.WidgetVisible(!0);return}if(!i&&f){t.SetView("room-overdue",new r.RoomOverdue(n,t));t.WidgetVisible(!0);return}};t.ViewDefiningRun=function(){i.isValid()===!1?n.data.runCheck===!0&&t.SetStartUpView(n.data.isRented,n.data.isContactable,n.data.isRoomOverdue):(u=!0,t.StartInterval())};t.CloseWidget=function(){t.WidgetVisible(!1);u=!0;t.StartInterval()};t.StartInterval=function(){o!=!0&&(i.set(i.storageKey),o=!0,setInterval(function(){u==!0&&(i.isValid(i.storageKey)?i.set(i.storageKey):(u=!1,t.ViewDefiningRun()))},6e5))};t.ViewDefiningRun()};n.RoomStatusBarViewModel=t}(frm.models,frm.services);frm.models.tenant.AreaViewModel=function(){this.Items=ko.observableArray();this.TotalItems=ko.observable();this.add=function(n){this.Items.push(n);this.updateTotals()};this.addRange=function(n){for(var t=0;t<n.length;t++)this.Items.push(n[t]);this.updateTotals()};this.updateTotals=function(){this.TotalItems(this.Items().length)};this.removeById=function(n){this.Items.remove(function(t){return t.Id==n});this.updateTotals()};this.count=function(){return this.Items.length}};frm.models.tenant.CommentViewModel=function(){this.TotalItems=ko.observable(0);this.IsLastPage=ko.observable(!0);this.Items=ko.observableArray();this.add=function(n,t){n.Replies=ko.observableArray();n.IsDeleted=ko.observable(n.IsDeleted);n.Expanded=ko.observable(!1);n.IsSettingsOpen=ko.observable(!1);n.ToggleSettings=function(n){var t=n.IsSettingsOpen();n.IsSettingsOpen(!t)};t?(this.Items.splice(0,0,n),this.TotalItems(this.TotalItems()+1)):this.Items.push(n);this.expand(n.CommentId)};this.addRange=function(n){this.IsLastPage(n.IsLastPage);this.TotalItems(n.TotalItems);for(var t=0;t<n.Items.length;t++)this.add(n.Items[t],!1)};this.getComment=function(n){return ko.utils.arrayFirst(this.Items(),function(t){return t.CommentId==n})};this.expand=function(n){var t=this.getComment(n);t!=null&&t.Expanded(!0)};this.addReply=function(n,t){var i=this.getComment(n);i!=null&&(t.IsDeleted=ko.observable(t.IsDeleted),t.IsSettingsOpen=ko.observable(!1),t.ToggleSettings=function(n){var t=n.IsSettingsOpen();n.IsSettingsOpen(!t)},i.Replies.push(t),i.Expanded(!0))};this.addReplies=function(n,t){var u=this.getComment(n),i,r;if(u!=null){for(i=0;i<t.Items.length;i++)r=t.Items[i],r.IsSettingsOpen=ko.observable(!1),r.ToggleSettings=function(n){var t=n.IsSettingsOpen();n.IsSettingsOpen(!t)},r.IsDeleted=ko.observable(r.IsDeleted),u.Replies.push(t.Items[i]);u.Expanded(!0)}};this.clear=function(){this.Items.removeAll()};this.count=function(){return this.Items.length}};frm.models.tenant.InterestViewModel=function(){this.TotalItems=ko.observable(0);this.IsLastPage=ko.observable(!1);this.Items=ko.observableArray();this.IsInterested=ko.observable(!1);this.ShowMultipleChoice=ko.observable(!0);this.IsLoaded=ko.observable(!1);this.add=function(n){this.Items.push(n)};this.addRange=function(n){this.TotalItems(n.TotalItems);this.IsLastPage(n.IsLastPage);for(var t=0;t<n.Items.length;t++)this.Items.push(n.Items[t])};this.take=function(n){return this.Items.slice(0,n)};this.set=function(n){this.clear();this.add(n)};this.setInterested=function(n){n?this.ShowMultipleChoice(!1):this.ShowMultipleChoice(!0);this.IsInterested(n)};this.clear=function(){this.Items.removeAll()};this.count=function(){return this.Items.length};this.setShowMultipleChoice=function(n){this.ShowMultipleChoice(n)};this.setLoaded=function(n){this.IsLoaded(n)}},function(){ko.validation.configure({decorateElement:!0,registerExtenders:!0,messagesOnModified:!0,insertMessages:!1,parseInputAttributes:!0,messageTemplate:null});frm.models.TenantEasyCompleteViewModel=function(n){var t=this,r=new frm.services.TenantService,i={onSaveSuccessfull:function(){t.isCompleted(!0)},onSaveFailed:function(){alert("Der skete en fejl.. :-(")}};t.predefinedCities=n.settings.predefinedCities;t.searchAreaQuery=ko.observable();t.searchArea=ko.observable().extend({required:!0});t.maxRent=ko.observable(n.values.rent).extend({min:1,required:!0});t.isCompleted=ko.observable(!1);t.isInvalidAddress=ko.observable(!1);t.currencyList=n.settings.currencyList;t.currency=ko.observable(n.values.currency);t.onAreaSelected=function(n){t.searchArea(n)};t.save=function(){var u=ko.validation.group([t.searchArea,t.maxRent]),n=t.searchArea();if(u().length>0||n==null){u.showAllMessages();n==null&&t.isInvalidAddress(!0);return}r.saveEasyComplete(n.address,n.location.lat,n.location.lng,t.maxRent(),n.countryCode,t.currency).then(i.onSaveSuccessfull,i.onSaveFailed)};n.values.searchArea!==""&&setTimeout(function(){t.searchAreaQuery(n.values.searchArea)},20)};frm.models.RoomEasyCompleteViewModel=function(n){var t=this,r=frm.services.RoomService,i={onSaveSuccessfull:function(){t.isCompleted(!0)},onSaveFailed:function(){alert("ERRROR")}};t.rentalPeriods=n.settings.rentalPeriods;t.addressQuery=ko.observable();t.address=ko.observable().extend({required:!0});t.rent=ko.observable(n.values.rent).extend({required:!0,min:1});t.deposit=ko.observable(n.values.deposit).extend({required:!0,min:0});t.squareMeters=ko.observable(n.values.squareMeters).extend({required:!0,min:1});t.rentalPeriod=ko.observable(n.values.rentalPeriod||undefined).extend({required:!0});t.isCompleted=ko.observable(!1);t.isInvalidAddress=ko.observable(!1);t.currencyList=n.settings.currencyList;t.currency=ko.observable(n.values.currency);t.onAreaSelected=function(n){var i=frm.services.AddressFactory.create(n);if(i===null){t.isInvalidAddress(!0);return}t.isInvalidAddress(!1);t.address(i)};t.save=function(){var u=ko.validation.group([t.address,t.rent,t.deposit,t.squareMeters,t.rentalPeriod]),n=t.address();if(u().length>0||n==null||n==""){u.showAllMessages();(n==null||n=="")&&t.isInvalidAddress(!0);return}r.saveEasyComplete(n,t.rent(),t.deposit(),t.rentalPeriod(),t.squareMeters(),t.currency).then(i.onSaveSuccessfull,i.onSaveFailed)};n.values.address!==""&&setTimeout(function(){t.addressQuery(n.values.address)},20)}}(),function(n){var t=function(){var n=this,t={fetch:function(n){return frm.services.WallService.getTop(n)}};n.WallItems=ko.observableArray();n.getData=function(){t.fetch(3).then(function(t){frm.utils.arrayReplace(n.WallItems,t.data)})};n.getData()};n.WallListViewModel=t}(frm.models,frm.services),function(n){var t=function(){var n=this,t="feature-request:profile-feedback";n.IsActive=ko.observable(localStorage.getItem(t)===null);n.IsInterested=ko.observable(!1);n.HandleInterestShowed=function(){n.IsInterested(!0);localStorage.setItem(t,!0);frm.services.SupportService.requestFeature("Profile Feedback")}},i=function(n,i){var r=this,u=function(){return i.popUpOptions.EpayParameters={overwriteProductId:0,returnUrl:i.popUpOptions.returnUrl,internalReferralId:n.userData.accountId,internalReferralType:2,paymentActionId:0,anonymousPaymentAction:0},new frm.models.GenericPopupViewModel(i.popUpOptions)},f=function(n){return new frm.models.GenericPopupViewModel(n)},e=function(n){return new frm.models.GenericPopupViewModel(n)};r.TenantEndorsementView=new frm.models.TenantEndorsementViewModel({accountId:n.userData.accountId,isOwnProfile:i.isOwnProfile,canEndorse:i.canEndorse,amountOfEndorsements:i.amountOfEndorsements,endorsementComments:i.endorsementComments,endrosementRelations:i.endrosementRelations});r.UserData={ProfileName:ko.observable(n.userData.profileName),Nationality:ko.observable(n.userData.nationality),CountryCode:ko.observable(n.userData.countryCode),Tagline:ko.observable(n.userData.tagLine),LastOnline:ko.observable(n.userData.lastOnline),IsPayingMember:ko.observable(n.userData.isPayingMember),ProfileImage:{Url:ko.observable(n.userData.profileImage.thumbUrl),BigImageUrl:ko.observable(n.userData.profileImage.bigUrl)}};r.Images=ko.observableArray(n.images);r.About={Text:ko.observable(n.about.text),Facts:ko.observableArray(n.about.facts)};r.RoomWishes=ko.observableArray(n.roomWishes);r.RoommateWishes=ko.observableArray(n.roommateWishes);r.CancelInitPopup=ko.observable(!1);r.GoogleMapData=ko.observable(n.googleMapData);r.RequestViewModel=new t;r.MessageInputOptions={inputOptions:{recipientAccountId:n.userData.accountId,senderAccountId:App.settings.account.id,isAdmin:i.isAdmin,isLoggedIn:i.isLoggedIn,isPaymentAction:!i.isPayingMember,isMessagingDisabled:i.isMessagingDisabled,paymentCenterUrl:i.paymentCenterUrl,callBacks:{onSuccessSend:function(){r.MessageStatus("sent")},onFailureSend:function(){},onPaymentActionSuccess:function(n){r.TriggerAnonymousPaymentActionPopup(n)}},texts:i.texts},templateOptions:{texts:i.texts.template}};r.MessageStatus=ko.observable("new");r.StartNewMessage=function(){r.MessageStatus("new")};r.CreateUser=function(){var n,t;r.CancelInitPopup(!0);n=i.popUpOptions;n.returnUrl=i.paymentCenterUrl;t=e(n);frm.models.GenericPopupViewModel.create(t).then(function(){t.Areas.SignUp.RoomListingSignUpView()})};r.TriggerPayment=function(){frm.utils.PaymentUrlHelper(u,i.paymentCenterUrl)};r.TriggerAnonymousPaymentActionPopup=function(n){var r=i.popUpOptions,t;r.returnUrl=n+"&AnonymousPaymentAction=1";t=f(r);frm.models.GenericPopupViewModel.create(t).then(function(){t.Areas.SignUp.MessagePaymentActionSignUpView()})};setTimeout(function(){if(r.CancelInitPopup()===!1&&i.popUpOptions.trigger){var n=u();frm.models.GenericPopupViewModel.create(n).then(function(){n.Areas.SignUp.RoomListingSignUpView()})}},15e3);frm.events.addListener("messageinput:textarea:focus",function(){r.CancelInitPopup(!0)})};n.TenantProfileViewModel=i}(frm.models,frm.services),function(n){var t=function(){var n=this,t=App.settings.account.id;n.Actions={getTemplates:function(){return frm.services.MessageTemplateService.getTemplatesByAccountId(t)}};n.templatesLoaded=ko.observable(!1);n.Loading=ko.observable(!1);n.DropDownVisible=ko.observable(!1);n.DropDownLoading=ko.observable(!1);n.TemplateList=ko.observableArray();n.NewTemplateModel={Name:ko.observable(),Message:ko.observable()};n.ClearNewTemplate=function(){n.NewTemplateModel.Name(undefined);n.NewTemplateModel.Message(undefined)};n.GetPopUp=function(n){return new frm.models.GenericPopupViewModel(n)};n.ToggleDropDown=function(i){if(i===!0||i===!1){n.DropDownVisible(i);return}n.templatesLoaded()===!1?(n.DropDownLoading(!0),n.Actions.getTemplates(t).then(function(t){n.TemplateList(t.data);n.templatesLoaded(!0);n.DropDownLoading(!1);n.Loading(!1);n.DropDownVisible(!0)})):n.DropDownVisible(!n.DropDownVisible())};n.GetTemplates=function(){n.Actions.getTemplates(t).then(function(t){n.TemplateList(t.data);n.Loading(!1)})};n.SelectTemplate=function(){};frm.events.addListener("messagetemplate:edit:done",function(){n.DropDownLoading(!0);n.Loading(!0);n.Actions.getTemplates(t).then(function(t){n.TemplateList(t.data);n.DropDownLoading(!1);n.Loading(!1)})})};n.MessageTemplateViewModel=t}(frm.models,frm.services),function(n,t){var i=function(n){var i=this,u=function(n){frm.utils.arrayReplace(i.thread.messages,n.data.Messages)},f=function(n){i.messageList.pages(n.data.TotalPages);frm.utils.arrayReplace(i.messageList.items,n.data.Items||n.data);i.messageList.isLoading(!1)},r=function(){i.messageList.isLoading(!0);n.getMessageListItemsFunc(i.messageList.currentPageIndex()).then(f)};i.messageList={items:ko.observableArray(),isLoading:ko.observable(!1),pages:ko.observable(0),currentPageIndex:ko.observable(n.pageIndex||1)};i.thread={messages:ko.observableArray(null)};i.openChain=function(n){t.MessageService.requestThread(n.MessageChainId,1,new Date).then(u)};i.changePage=function(n){i.messageList.currentPageIndex(n);r();Modernizr.history&&history.pushState({},"","?page="+n)};r()};n.ThreadAppViewModel=i}(frm.models,frm.services);frm.models.abtest.ABTestViewModel=function(){var n=this;this.Id;this.VersionId;this.Step=4;this.TestItemActiveId;this.initABTest=function(){};this.Score=function(n,t,i){frm.services.abTestService.score(n,t,i)};this.ScoreItem=function(n,t){frm.services.abTestService.scoreItem(n,t)};n.initABTest()};frm.models.popup.membership.ActionFreeModel=function(n,t){var i=this;this.Id=n;this.ActionFreeType=t;this.IsChecked=!1;this.IsActionFree=!1;this.initActionFree=function(){i.ActionFreeType!=""&&$.ajax({url:"/Api/Web/ActionFree/Check",type:"POST",data:{Id:i.Id,Type:i.ActionFreeType},success:function(n){i.IsActionFree=n.data.IsActionFree;i.IsChecked=!0}})};i.initActionFree()},function(n,t){n.UpdateCountryViewModel=function(n){var i=this,r=ko.utils.arrayMap(n.settings,function(n){return n.IsEnabled=ko.observable(n.IsEnabled),n}),u=function(){i.isSuccessSaved(!0);i.isSaved(!0)},f=function(){i.isSuccessSaved(!1);i.isSaved(!0)};i.countryCode=n.countryCode;i.settings=r;i.isSaved=ko.observable(!1);i.isSuccessSaved=ko.observable(!1);i.saveChanges=function(){var n=ko.utils.arrayMap(i.settings,function(n){return{SettingId:n.SettingId,IsEnabled:n.IsEnabled()}});i.isSaved(!1);t.CountryService.updateSettings(i.countryCode,i.settings).then(u,f)}}}(frm.models,frm.services),function(n,t){function i(n){var i=this,r=function(){t.TransactionService.fetch(ko.toJS(i.form),i.currentPage()).then(e,o)},e=function(n){i.pages(n.data.Paging.TotalPages);i.transactions.totalItems(n.data.Paging.TotalItems);i.transactions.totalOrders(n.data.Sum.TotalOrders);i.transactions.totalRecurringOrders(n.data.Sum.TotalRecurringOrders);i.transactions.sumOrders(n.data.Sum.SumOrders);i.transactions.sumRecurringOrders(n.data.Sum.SumRecurringOrders);frm.utils.arrayReplace(i.transactions.items,n.data.Paging.Items)},o=function(){i.currentPage(1);i.pages(0);i.transactions.totalItems(0);i.transactions.totalOrders(0);i.transactions.totalRecurringOrders(0);i.transactions.sumOrders(0);i.transactions.sumRecurringOrders(0);alert("Der skete en fejl")},u=new Date,f=u.getMonth()+1+"-"+u.getDate()+"-"+u.getFullYear();i.options={siteOptions:n.siteOptions};i.currentPage=ko.observable(1);i.pages=ko.observable(0);i.transactions={items:ko.observableArray(),totalItems:ko.observable(0),totalOrders:ko.observable(0),totalRecurringOrders:ko.observable(0),sumOrders:ko.observable(0),sumRecurringOrders:ko.observable(0)};i.form={period:{to:ko.observable(f),from:ko.observable(f)},recurring:ko.observable(!1),standard:ko.observable(!0),siteId:ko.observable(n.siteOptions[0].value)};i.search=function(){i.currentPage(1);i.pages(0);r()};i.changePage=function(n){i.currentPage(n);r()};r()}n.TransactionViewModel=i}(frm.models,frm.services),function(n){var f=function(){var n=this,i={setView:function(t,i){n.currentView({name:t,model:i})},fetchSites:function(){return frm.services.SiteService.getParentSites()},checkAuhtor:function(){return frm.services.ArticleService.IsUserAuthor()},fetchAuthors:function(){return frm.services.ArticleService.getAuthors()}};n.SitesDefault=ko.observable();n.Sites=ko.observableArray();n.Authors=ko.observableArray();n.currentView=ko.observable();n.isLoading=ko.observable(!1);n.Error=ko.observable(!1);n.IsAuthor=ko.observable(!1);n.setHeadline=function(n,t){mod_selection("#","",t);n($("#"+t).val())};n.setImageLeft=function(n,t){var i=prompt("Indsæt sti til billede her","http://");mod_selection('<div class="positionLeft"><img src="'+i+'"/><\/div>',"",t);n($("#"+t).val())};n.setImageCenter=function(n,t){var i=prompt("Indsæt sti til billede her","http://");mod_selection('<div class="positionCenter"><img src="'+i+'"/><\/div>',"",t);n($("#"+t).val())};n.setImageRight=function(n,t){var i=prompt("Indsæt sti til billede her","http://");mod_selection('<div class="positionRight"><img src="'+i+'"/><\/div>',"",t);n($("#"+t).val())};n.setWordWrapLeft=function(n,t){add_class("WordWrapLeft",t);n($("#"+t).val())};n.setWordWrapRight=function(n,t){add_class("WordWrapRight",t);n($("#"+t).val())};n.setLink=function(n,t){var i=prompt("Indtast navn på linket",""),r=prompt("Indsæt sti til linket","http://");mod_selection("["+i+"]("+r+")","",t);n($("#"+t).val())};n.setYouTube=function(n,t){var i=prompt("Indsæt videoens ID - f.eks: 'zEbNiEA8Lfo' ","");mod_selection('<iframe width="560" height="315" src="//www.youtube.com/embed/'+i+'" frameborder="0" allowfullscreen><\/iframe>',"",t);n($("#"+t).val())};n.removeMarkdown=function(n,t){mod_removeMarkDown(t);n($("#"+t).val())};n.setIndexView=function(){i.setView("article-index",new r.index({stateMachine:n}))};n.setCreateView=function(){var t=i.fetchSites().then(function(t){var i=t.data;frm.utils.arrayReplace(n.Sites,i)}),u=i.fetchAuthors().then(function(t){var i=t.data;frm.utils.arrayReplace(n.Authors,i)});$.when(t,u).then(function(){i.setView("article-create",new r.create({stateMachine:n}))})};n.setEditView=function(t){var u=i.fetchSites().then(function(t){var i=t.data;frm.utils.arrayReplace(n.Sites,i)}),f=i.fetchAuthors().then(function(t){var i=t.data;frm.utils.arrayReplace(n.Authors,i)});$.when(u,f).then(function(){i.setView("article-edit",new r.edit({stateMachine:n,articleItem:t}))})};n.setAuthorIndexView=function(){i.setView("author-index",new u.index({stateMachine:n}))};n.setAuthorEditView=function(t){i.setView("author-edit",new u.edit({stateMachine:n,authorItem:t}))};n.setAuthorCreateView=function(){i.setView("author-create",new u.create({stateMachine:n}))};n.setCategoriesIndexView=function(){i.setView("categories-index",new t.index({stateMachine:n}))};n.setCategoryEditView=function(r){i.setView("categories-edit",new t.edit({stateMachine:n,categoriyItem:r}))};n.setCategoryCreateView=function(){i.setView("categories-create",new t.create({stateMachine:n}))};n.setIndexView();i.checkAuhtor().then(function(t){t.data!=null&&n.IsAuthor(!0)})},t={index:function(n){n.stateMachine.Error(!1);var t=this;privates={fetchCategories:function(){n.stateMachine.isLoading(!0);frm.services.ArticleService.fetchCategories().then(function(i){var r=i.data;frm.utils.arrayReplace(t.Categories,r);n.stateMachine.isLoading(!1)})}};t.Categories=ko.observableArray();privates.fetchCategories()},edit:function(n){n.stateMachine.Error(!1);var t=this;privates={editCategory:function(t){n.stateMachine.isLoading(!0);frm.services.ArticleService.editCategory(t).then(function(){n.stateMachine.isLoading(!1);n.stateMachine.setCategoriesIndexView()})}};t.EditModel={Id:ko.observable(n.categoriyItem.Id),KeyName:ko.observable(n.categoriyItem.KeyName),Name:ko.observable(n.categoriyItem.Name),Description:ko.observable(n.categoriyItem.Description),Active:ko.observable(n.categoriyItem.Active)};t.SaveEdit=function(){privates.editCategory(ko.toJS(t.EditModel))}},create:function(n){n.stateMachine.Error(!1);var t=this;privates={saveCategory:function(t){n.stateMachine.isLoading(!0);frm.services.ArticleService.saveCategory(t).then(function(){n.stateMachine.isLoading(!1);n.stateMachine.setCategoriesIndexView()})}};t.Model={KeyName:ko.observable(),Name:ko.observable(),Description:ko.observable()};t.Save=function(){privates.saveCategory(ko.toJS(t.Model))}}},r={index:function(n){n.stateMachine.Error(!1);var t=this,i={fetch:function(i){n.stateMachine.isLoading(!0);i==undefined?frm.services.ArticleService.fetch().then(function(i){var r=i.data;frm.utils.arrayReplace(t.Articles,r);n.stateMachine.isLoading(!1)}):frm.services.ArticleService.fetchBySiteId(i).then(function(i){var r=i.data;frm.utils.arrayReplace(t.Articles,r);n.stateMachine.isLoading(!1)})},fetchSites:function(){n.stateMachine.isLoading(!0);frm.services.SiteService.getParentSites().then(function(i){var r=i.data;frm.utils.arrayReplace(t.Sites,r);n.stateMachine.isLoading(!1)})},searchArticles:function(r){n.stateMachine.isLoading(!0);r.Text!=undefined?frm.services.ArticleService.fetchSearchArticles(r).then(function(i){var r=i.data;frm.utils.arrayReplace(t.Articles,r);n.stateMachine.isLoading(!1)}):i.fetch()}};t.Articles=ko.observableArray();t.Sites=ko.observableArray();t.SearchModel={Text:ko.observable(),SiteId:ko.observable()};this.pageNumber=ko.observable(0);this.nbPerPage=20;this.totalPages=ko.computed(function(){var n=Math.floor(t.Articles().length/t.nbPerPage);return n+=t.Articles().length%t.nbPerPage>0?1:0,n-1});t.Search=function(){i.searchArticles(ko.toJS(t.SearchModel))};t.ClearSearch=function(){t.SearchModel.Text(undefined)};t.ResetSearch=function(){t.ClearSearch();i.fetch()};this.paginatedArticles=ko.computed(function(){var n=t.pageNumber()*t.nbPerPage;return t.Articles.slice(n,n+t.nbPerPage)});this.hasPrevious=ko.computed(function(){return t.pageNumber()!==0});this.hasNext=ko.computed(function(){return t.pageNumber()!==t.totalPages()});this.next=function(){t.pageNumber()<t.totalPages()&&t.pageNumber(t.pageNumber()+1)};this.previous=function(){t.pageNumber()!=0&&t.pageNumber(t.pageNumber()-1)};this.showBtns=ko.computed(function(){return t.totalPages()<=0?!1:!0});t.SearchModel.SiteId.subscribe(function(n){i.fetch(n)});i.fetchSites();i.fetch()},create:function(n){n.stateMachine.Error(!1);var t=this,r={fetchCategories:function(){frm.services.ArticleService.fetchCategories().then(function(n){var i=n.data;ko.utils.arrayForEach(i,function(n){n.IsAssigned=ko.observable(!1)});frm.utils.arrayReplace(t.Article.Categories,i)})}};for(t.Hours=ko.observableArray(),t.Minuts=ko.observableArray(),t.Sites=ko.observableArray(),t.combinedDate={Date:ko.observable((new Date).getUTCMonth()+1+"-"+(new Date).getUTCDate()+"-"+(new Date).getUTCFullYear()),Hour:ko.observable(),Minut:ko.observable()},t.ComputedPublishDate=ko.computed(function(){return t.combinedDate.Date()+" "+t.combinedDate.Hour()+":"+t.combinedDate.Minut()}),t.Article={Headline:ko.observable(),TeaserText:ko.observable(),Cover:ko.observable(),PublishDate:"",BodyText:ko.observable(),Tags:ko.observable(),Featured:ko.observable(),SiteId:ko.observable(),AuthorId:ko.observable(),Categories:ko.observableArray(),Meta:{Title:ko.observable(),Description:ko.observable()}},t.toggleAssigned=function(n){n.IsAssigned()?n.IsAssigned(!1):n.IsAssigned(!0)},t.createArticle=function(){n.stateMachine.isLoading(!0);var i=ko.toJS(t.Article);i.PublishDate=t.ComputedPublishDate();frm.services.ArticleService.createArticle(i).then(function(){n.stateMachine.setIndexView();n.stateMachine.isLoading(!1);n.stateMachine.Error(!1)},function(){n.stateMachine.isLoading(!1);n.stateMachine.Error(!0)})},r.fetchCategories(),i=0;i<24;i++)t.Hours.push(HoursVal=[i]);for(i=0;i<60;i++)t.Minuts.push(MinutsVal=[i])},edit:function(n){n.stateMachine.Error(!1);var t=this,r={fetchArticleViews:function(n,i,r){frm.services.ViewHitService.fetchArticleViewHit(n,i,r).then(function(n){var i=n.data;frm.utils.arrayReplace(t.ArticleViews,i)})},fetchCategories:function(n){frm.services.ArticleService.getCategoriesByArticleId(n).then(function(n){var i=n.data;ko.utils.arrayForEach(i,function(n){n.IsAssigned=ko.observable(n.IsAssigned)});frm.utils.arrayReplace(t.Model.Categories,i)})}};for(t.chartFromDate=ko.observable(),t.chartToDate=ko.observable(),t.ArticleViews=ko.observableArray(),t.ArticleViewLabel=ko.computed(function(){return ko.utils.arrayMap(t.ArticleViews(),function(n){return n.TimeCreated})}).extend({rateLimit:500}),t.ArticleViewData=ko.computed(function(){return ko.utils.arrayMap(t.ArticleViews(),function(n){return n.Views})}).extend({rateLimit:500}),t.Hours=ko.observableArray(),t.Minuts=ko.observableArray(),t.combinedDate={Date:ko.observable(new Date(n.articleItem.PublishDate).getUTCMonth()+1+"-"+new Date(n.articleItem.PublishDate).getUTCDate()+"-"+new Date(n.articleItem.PublishDate).getUTCFullYear()),Hour:ko.observable(new Date(n.articleItem.PublishDate).getUTCHours()),Minut:ko.observable(new Date(n.articleItem.PublishDate).getMinutes())},t.ComputedPublishDate=ko.computed(function(){return t.combinedDate.Date()+" "+t.combinedDate.Hour()+":"+t.combinedDate.Minut()}),t.Model={AuthorId:ko.observable(n.articleItem.AuthorId),ArticleId:ko.observable(n.articleItem.ArticleId),Headline:ko.observable(n.articleItem.Headline),TeaserText:ko.observable(n.articleItem.TeaserText),Cover:ko.observable(n.articleItem.Cover),PublishDate:"",BodyText:ko.observable(n.articleItem.BodyText),Tags:ko.observable(n.articleItem.Tags),Featured:ko.observable(n.articleItem.Featured),SiteId:ko.observable(n.articleItem.SiteId),ArticleUrl:ko.observable(n.articleItem.ArticleUrl),Meta:{Title:ko.observable(n.articleItem.MetaTitle),Description:ko.observable(n.articleItem.MetaDescription)},Categories:ko.observableArray()},t.PublishedModel={ArticleId:ko.observable(n.articleItem.ArticleId),Published:ko.observable(n.articleItem.Published)},t.PublishedTextButton=ko.observable(),t.toggleAssigned=function(n){n.IsAssigned()?n.IsAssigned(!1):n.IsAssigned(!0)},t.saveChanges=function(){n.stateMachine.isLoading(!0);var i=ko.toJS(t.Model);i.PublishDate=t.ComputedPublishDate();frm.services.ArticleService.Update(i).then(function(){n.stateMachine.isLoading(!1);n.stateMachine.Error(!1)},function(){n.stateMachine.isLoading(!1);n.stateMachine.Error(!0)})},t.deleteArticle=function(){frm.services.ArticleService.Delete(n.articleItem.ArticleId);n.stateMachine.setIndexView()},t.changeStatus=function(){t.PublishedModel.Published()==!0?t.PublishedModel.Published(!1):t.PublishedModel.Published(!0);t.changeStatusText();var n=ko.toJS(t.PublishedModel);frm.services.ArticleService.changeStatus(n)},t.changeStatusText=function(){t.PublishedModel.Published()==!0?t.PublishedTextButton("Skift status til: Ikke udgivet"):(t.PublishedModel.Published(!1),t.PublishedTextButton("Skift status til: Udgivet"))},t.updateChart=function(){r.fetchArticleViews(n.articleItem.ArticleId,t.chartFromDate,t.chartToDate)},r.fetchCategories(n.articleItem.ArticleId),t.changeStatusText(),i=0;i<24;i++)t.Hours.push(HoursVal=[i]);for(i=0;i<60;i++)t.Minuts.push(MinutsVal=[i])}},u={index:function(n){n.stateMachine.Error(!1);var t=this,i={fetchAuthors:function(){n.stateMachine.isLoading(!0);frm.services.ArticleService.getAuthors().then(function(i){var r=i.data;frm.utils.arrayReplace(t.Authors,r);n.stateMachine.isLoading(!1)})}};t.Authors=ko.observableArray();i.fetchAuthors()},create:function(n){n.stateMachine.Error(!1);var t=this,i={fetchUsers:function(){n.stateMachine.isLoading(!0);frm.services.ArticleService.getUsers().then(function(i){var r=i.data;frm.utils.arrayReplace(t.Users,r);n.stateMachine.isLoading(!1)})}};t.Users=ko.observableArray();t.Author={AccountId:ko.observable(),Firstname:ko.observable(),Lastname:ko.observable(),PictureUrl:ko.observable(),Description:ko.observable()};t.createAuthor=function(){n.stateMachine.isLoading(!0);var i=ko.toJS(t.Author);frm.services.ArticleService.createAuthor(i).then(function(){n.stateMachine.setAuthorIndexView();i.AccountId==App.settings.account.id&&n.stateMachine.IsAuthor(!0);n.stateMachine.isLoading(!1)},function(){n.stateMachine.isLoading(!1);n.stateMachine.Error(!0)})};i.fetchUsers()},edit:function(n){n.stateMachine.Error(!1);var t=this;t.Model={AccountId:ko.observable(n.authorItem.AccountId),Firstname:ko.observable(n.authorItem.AuthorFirstname),Lastname:ko.observable(n.authorItem.AuthorLastname),PictureUrl:ko.observable(n.authorItem.PictureUrl),Description:ko.observable(n.authorItem.Description)};t.saveAuthorChanges=function(){n.stateMachine.isLoading(!0);var i=ko.toJS(t.Model);frm.services.ArticleService.UpdateAuthor(i).then(function(){n.stateMachine.setAuthorIndexView();n.stateMachine.isLoading(!1)},function(){n.stateMachine.isLoading(!1);n.stateMachine.Error(!0)})}}};n.ArticlesViewModel=f}(frm.models,frm.services),function(n){var t=function(){var n=this,t={getSites:function(){return frm.services.SiteService.getParentSites()},fetchBySiteId:function(n){return frm.services.FrontpageService.fetchBySiteId(n)},createNew:function(n){return frm.services.FrontpageService.createNew(n)},"delete":function(n){return frm.services.FrontpageService["delete"](n)},saveEdit:function(n){return frm.services.FrontpageService.edit(n)},changeStatus:function(n,t){return frm.services.FrontpageService.changeStatus(n,t)},removeTagline:function(n){return frm.services.FrontpageService.removeTagline(n)}};n.IsLoading=ko.observable(!1);n.HasData=ko.observable(!1);n.CanCreateNew=ko.observable(!1);n.IsEditMode=ko.observable(!1);n.CreateNew=ko.observable(!1);n.TaglineText=ko.observable();n.Types=[{Id:2,Name:"Delebolig"},{Id:1,Name:"Værelse"},{Id:0,Name:"Begge"}];n.Sites=ko.observableArray();n.CurrentSite=ko.observable(undefined);n.ContentList=ko.observable();n.CreateModel={City:ko.observable(),Country:ko.observable(),Type:ko.observable(),ImageUrl:ko.observable(),SiteId:ko.observable(),Taglines:ko.observableArray()};n.EditModel={Id:ko.observable(),City:ko.observable(),Country:ko.observable(),Type:ko.observable(),ImageUrl:ko.observable(),Taglines:ko.observableArray()};n.getSites=function(){n.IsLoading(!0);t.getSites().then(function(t){n.Sites(t.data);n.IsLoading(!1)})};n.startCreateMode=function(){n.CreateNew(!0);n.IsEditMode(!1);n.clearCreateModel();n.CreateModel.SiteId(n.CurrentSite())};n.saveNew=function(){var i=ko.toJS(n.CreateModel);n.startCreateMode();n.IsLoading(!0);t.createNew(i).then(function(){n.getContent(n.CurrentSite());n.IsLoading(!1)})};n.saveEdit=function(){var i=ko.toJS(n.EditModel);n.IsLoading(!0);t.saveEdit(i).then(function(){n.IsLoading(!1);n.stopAllModes();n.getContent(n.CurrentSite())})};n.startEditMode=function(t){var i=t;n.CreateNew(!1);n.IsEditMode(!0);n.clearEditModel();n.EditModel.Id(i.Id);n.EditModel.Country(i.Country);n.EditModel.City(i.City);n.EditModel.Type(i.Type);n.EditModel.ImageUrl(i.ImageUrl);n.EditModel.Taglines(i.Taglines)};n.deleteItem=function(i){var r=i.Id;t["delete"](r).then(function(){n.getContent(n.CurrentSite())})};n.stopAllModes=function(){n.CreateNew(!1);n.IsEditMode(!1);n.clearCreateModel();n.clearEditModel()};n.changeStatus=function(i){var r=i;t.changeStatus(r.Id,r.Active).then(function(){n.getContent(n.CurrentSite())})};n.clearCreateModel=function(){n.CreateModel.City(undefined);n.CreateModel.Country(undefined);n.CreateModel.Type(undefined);n.CreateModel.ImageUrl(undefined);n.CreateModel.SiteId(undefined);n.CreateModel.Taglines([])};n.clearEditModel=function(){n.EditModel.Id(undefined);n.EditModel.City(undefined);n.EditModel.Country(undefined);n.EditModel.Type(undefined);n.EditModel.ImageUrl(undefined);n.EditModel.Taglines([])};n.getContent=function(i){n.IsLoading(!0);t.fetchBySiteId(i).then(function(t){n.ContentList(t.data);n.ContentList().length>0?n.HasData(!0):n.HasData(!1);n.IsLoading(!1)})};n.newCreateTagline=function(){var t=n.TaglineText(),i=n.CreateModel.Taglines;i.push({Text:t});n.TaglineText(undefined)};n.newEditTagline=function(){var t=n.TaglineText(),i=n.EditModel.Taglines;i.push({Text:t});n.TaglineText(undefined)};n.removeLocalTagline=function(t){var i=t,r=n.CreateModel.Taglines;r.remove(i)};n.removeTagline=function(i){var r=i,u=n.EditModel.Taglines;r.Id!=undefined?t.removeTagline(r).then(function(){u.remove(r)}):u.remove(r)};n.CurrentSite.subscribe(function(t){n.stopAllModes();t!=undefined?(n.CanCreateNew(!0),n.getContent(t)):(n.ContentList([]),n.HasData(!1),n.CanCreateNew(!1))});n.getSites()};n.FrontpageContentAdminViewModel=t}(frm.models,frm.services),function(n){var t=function(){var n=this,t={fetch:function(){return frm.services.CountryService.fetchAll()}};n.Countries=ko.observableArray();n.ChartData=ko.observableArray();n.ChartLabel=ko.computed(function(){return ko.utils.arrayMap(n.ChartData(),function(n){return n.EnglishName})}).extend({rateLimit:500});n.ChartNumberOfUsers=ko.computed(function(){return["Antal brugere","230, 126, 34",ko.utils.arrayMap(n.ChartData(),function(n){return n.NumberOfUsers})]}).extend({rateLimit:500});n.ChartNumberOfActiveUsers=ko.computed(function(){return["Aktive brugere","155, 89, 182",ko.utils.arrayMap(n.ChartData(),function(n){return n.NumberOfActiveUsers})]}).extend({rateLimit:500});n.ChartNumberOfPayingUsers=ko.computed(function(){return["Betalende medlemmer","46, 204, 113",ko.utils.arrayMap(n.ChartData(),function(n){return n.NumberOfPayingUsers})]}).extend({rateLimit:500});n.headers=[{title:"Lande navn",sortPropertyName:"EnglishName",asc:!0},{title:"Antal brugere",sortPropertyName:"NumberOfUsers",asc:!0},{title:"Aktive brugere",sortPropertyName:"NumberOfActiveUsers",asc:!0},{title:"Betalende brugere",sortPropertyName:"NumberOfPayingUsers",asc:!0},];n.toggleToGraph=function(t){var i=!t.IsInGraph(),r=ko.utils.arrayFirst(n.ChartData(),function(n){return t.EnglishName===n.EnglishName});r?n.ChartData.remove(t):n.ChartData.push(t);t.IsInGraph(i)};n.getData=function(){t.fetch().then(function(t){var i=t.data;ko.utils.arrayForEach(i,function(n){n.IsInGraph=ko.observable(n.IsInGraph)});frm.utils.arrayReplace(n.Countries,i)})};n.activeSort=n.headers[0];n.sort=function(t){n.activeSort===t?t.asc=!t.asc:n.activeSort=t;var i=n.activeSort.sortPropertyName,r=function(n,t){return n[i]<t[i]?-1:n[i]>t[i]?1:n[i]==t[i]?0:0},u=function(n,t){return n[i]>t[i]?-1:n[i]<t[i]?1:n[i]==t[i]?0:0},f=n.activeSort.asc?r:u;n.Countries.sort(f)};n.getData()};n.CountrySettingsViewModel=t}(frm.models,frm.services),function(n){function i(){var n=this,i={onSuccess:function(t){frm.utils.arrayReplace(n.InvalidEmails,t.data)},fetch:function(){frm.services.SendGridService.fetchInvalidEmails().then(i.onSuccess)}};n.InvalidEmails=ko.observableArray();n.IsFormVisible=ko.observable(!1);n.Form=ko.observable();n.openForm=function(i){n.IsFormVisible(!0);n.Form(new t({$parent:n},i))};i.fetch()}var t=function(n,t){var i=this;i.Email=ko.observable(t.Email);i.Created=ko.observable(t.Created);i.Reason=ko.observable(t.Reason);i.Places=[{Name:"Account",IsLoading:ko.observable(!0),IsFound:ko.observable(!1),Item:ko.observable(),fetch:frm.services.accountService.getByEmail,update:function(n){var t=this;return t.IsLoading(!0),frm.services.accountService.update(n.ID,{email:i.UpdatedEmail()}).then(function(){t.IsLoading(!1);t.IsFound(!1)},function(){t.IsLoading(!1);t.IsFound(!0)})}},{Name:"Lead",IsLoading:ko.observable(!0),IsFound:ko.observable(!1),Item:ko.observable(),fetch:frm.services.LeadService.getLeadByEmail,update:function(){alert("Det er ikke muligt at ændre email på leads, kontakt en udvikler! ;)")}}];i.UpdatedEmail=ko.observable(t.Email);i.remove=function(){frm.services.SendGridService.deleteInvalidEmail(i.Email()).then(function(){n.$parent.InvalidEmails.remove(t);i.close()})};i.close=function(){n.$parent.IsFormVisible(!1)};ko.utils.arrayForEach(i.Places,function(n){var t={onComplete:function(){n.IsLoading(!1)},onSuccess:function(t){n.IsFound(!0);n.Item(t.data)},onFailure:function(){n.IsFound(!1)}};n.fetch(i.Email()).then(t.onSuccess,t.onFailure).then(t.onComplete,t.onComplete)})};n.InvalidEmailViewModel=i}(frm.models,frm.services),function(n){var t=function(){var n=this,t={setView:function(t,i){n.currentView({name:t,model:i})}};n.currentView=ko.observable();n.isLoading=ko.observable(!1);n.setIndexView=function(){t.setView("voucher-index",new i({stateMachine:n}))};n.setGroupView=function(i){t.setView("voucher-group-index",new f({stateMachine:n,group:i}))};n.setInsertView=function(){t.setView("voucher-insert-group",new u({stateMachine:n}))};n.setCreateCodesView=function(i){t.setView("voucher-create-codes",new e({stateMachine:n,group:i}))};n.setUpdateVoucherGroupView=function(i){t.setView("voucher-update-group",new r({stateMachine:n,group:i}))};n.setIndexView()},i=function(n){var t=this,i={fetch:function(){n.stateMachine.isLoading(!0);frm.services.VoucherService.fetchVoucherGroups().then(function(i){var r=i.data;ko.utils.arrayForEach(r,function(n){n.IsActive=ko.observable(n.IsActive)});frm.utils.arrayReplace(t.VoucherGroups,r);n.stateMachine.isLoading(!1)})}};t.VoucherGroups=ko.observableArray();t.changeGroupIsActive=function(n){var t=!n.IsActive();n.IsActive(t);frm.services.VoucherService.changeGroupIsActive(n.Id,t)};i.fetch()},r=function(n){var t=this,i=n.group;t.Group=n.group;t.Model={name:ko.observable(i.Name),expirationDate:ko.observable(i.ExpirationDate)};t.saveChanges=function(){n.stateMachine.isLoading(!0);var r=ko.toJS(t.Model);frm.services.VoucherService.updateVoucherGroup(i.Id,r.name,r.expirationDate).then(function(){n.stateMachine.setGroupView(t.Group);n.stateMachine.isLoading(!1)})}},u=function(n){var t=this,i={fetchTypes:function(){n.stateMachine.isLoading(!0);frm.services.VoucherService.getVoucherTypes().then(function(i){var r=i.data;frm.utils.arrayReplace(t.VoucherTypes,r);n.stateMachine.isLoading(!1)})},fetchDataTypes:function(n){frm.services.VoucherService.getVoucherDataTypes(n).then(function(n){var i=n.data,r=ko.utils.arrayMap(i,function(n){return n.Value=ko.observable(),n});frm.utils.arrayReplace(t.Group.Properties,r)})}};t.Group={Name:ko.observable(),ExpirationDate:ko.observable(),VoucherTypeId:ko.observable(),Properties:ko.observableArray()};t.VoucherTypes=ko.observableArray();t.createGroup=function(){n.stateMachine.isLoading(!0);var i=ko.toJS(t.Group);frm.services.VoucherService.createVoucherGroup(i).then(function(){n.stateMachine.setIndexView();n.stateMachine.isLoading(!1)})};t.Group.VoucherTypeId.subscribe(function(n){typeof n!="undefined"&&i.fetchDataTypes(n)});i.fetchTypes()},f=function(n){var t=this,i={fetch:function(){n.stateMachine.isLoading(!0);frm.services.VoucherService.fetchVouchersByGroupId(n.group.Id).then(function(i){var r=i.data;frm.utils.arrayReplace(t.Vouchers,r);n.stateMachine.isLoading(!1)})}};t.Vouchers=ko.observableArray();t.Id=n.group.Id;t.Group=n.group;i.fetch()},e=function(n){var t=this;t.Group=n.group;t.newVoucer={AmountOfKeys:ko.observable(),VoucherGroupeId:n.group.Id};t.createVoucers=function(){n.stateMachine.isLoading(!0);var i=ko.toJS(t.newVoucer);frm.services.VoucherService.createNewVouchers(i).then(function(){n.stateMachine.setGroupView(t.Group);n.stateMachine.isLoading(!1)})}};n.VoucherViewModel=t}(frm.models,frm.services),function(n){var t=function(n){var t=this,f={setView:function(n,i){t.currentView({name:n,model:i})}};t.currentView=ko.observable();t.isLoading=ko.observable(!1);t.setIndexView=function(){f.setView("site-index",new i({stateMachine:t,configurations:n.Configurations,siteId:n.SiteId}))};t.setSettingsIndexView=function(i,r){f.setView("site-settings-index",new u({UserType:r,SiteId:n.SiteId,stateMachine:t}))};t.setWelcomeMessage=function(){f.setView("site-settings-welcomemessage",new r({SiteId:n.SiteId,stateMachine:t}))};t.setIndexView()},i=function(n){var t=this;t.Configurations=ko.utils.arrayMap(n.configurations,function(t){return t.IsActivated=ko.observable(t.IsActivated),t.ToggleActive=function(){var i=t.IsActivated();i?(t.IsActivated(!1),frm.services.SiteSettingsService.removeConfiguration(n.siteId,t.Name).then(function(){},function(){t.IsActivated(!0)})):(t.IsActivated(!0),frm.services.SiteSettingsService.addConfiguration(n.siteId,t.Name).then(function(){},function(){t.IsActivated(!1)}))},t})},r=function(){function n(n){var t=this;t.Model={SiteId:n.SiteId,TranslationKey:ko.observable().extend({required:!0}),TranslationGroup:ko.observable().extend({required:!0}),UserType:ko.observable(null)};t.Save=function(){var r=ko.validation.group([t.TranslationKey,t.TranslationGroup,t.UserType]),i;if(r().length>0)return r.showAllMessages(),null;i=ko.toJS(t.Model);i.UserType===""&&(i.UserType=undefined);frm.services.SiteSettingsService.createWelcomeMessage(i).then(function(){n.Fetch()})}}return function(t){var i=this;i._add=function(n){ko.utils.arrayPushAll(i.Items,ko.utils.arrayMap(n,function(n){return n.TimeCreated=new Date(n.TimeCreated),n.TimeEnded=ko.observable(new Date(n.TimeEnded)),n.IsStopped=ko.observable(n.IsStopped),n}))};i._sort=function(){i.Items.sort(function(n,t){return new Date(t.TimeCreated)-new Date(n.TimeCreated)})};i.SiteId=t.SiteId;i.Form=new n(i);i.Items=ko.observableArray();i.Deactivate=function(n){frm.services.SiteSettingsService.deactivateWelcomeMessage(n.Id).then(function(){n.TimeEnded(new Date);n.IsStopped(!0)})};i.Fetch=function(){i.Items.removeAll();frm.services.SiteSettingsService.findWelcomeMessages(i.SiteId).then(function(n){i._add(n.data)})};i.Fetch()}}(),u=function(n){var t=this,i={fetch:function(){n.stateMachine.isLoading(!0);frm.services.SiteSettingsService.fetchAllSettings(n.SiteId,n.UserType).then(function(i){var r=i.data;frm.utils.arrayReplace(t.siteSettings,r);n.stateMachine.isLoading(!1)})}};t.siteSettings=ko.observableArray();t.NewSetting={NumberOfDays:ko.observable(),SiteId:ko.observable(n.SiteId),UserType:ko.observable(n.UserType)};t.createSetting=function(){n.stateMachine.isLoading(!0);frm.services.SiteSettingsService.insertSetting(t.NewSetting).then(function(){n.stateMachine.setSettingsIndexView(n.SiteId,n.UserType);n.stateMachine.isLoading(!1)})};t.deactivateSetting=function(t){n.stateMachine.isLoading(!0);frm.services.SiteSettingsService.deactivateSetting(t.Id).then(function(){n.stateMachine.setSettingsIndexView(n.SiteId,n.UserType);n.stateMachine.isLoading(!1)})};i.fetch()};n.SiteSettingsViewModel=t}(frm.models,frm.services),function(n){var t=function(n){var t=this,i={search:function(){t.IsLoading(!0);frm.services.accountService.getCustomProfilesList(ko.toJS(t.Paging.PageIndex),ko.toJS(t.Filter)).then(function(n){frm.utils.arrayReplace(t.Results,n.data.Items);t.Paging.TotalItems(n.data.TotalItems);t.Paging.IsLastPage(n.data.IsLastPage);t.Paging.PageIndex(n.data.Number);t.Paging.TotalPages(n.data.TotalPages);t.IsLoading(!1)})}};t.layout={searchAreaInput:$("#custom-profile-list .query")};t.Results=ko.observableArray();t.IsLoading=ko.observable(!1);t.Paging={TotalItems:ko.observable(),IsLastPage:ko.observable(),PageIndex:ko.observable(1),TotalPages:ko.observable()};t.GenericOptions=n.GenericOptions;t.GenderOptions=n.GenderOptions;t.AreaName=ko.observable(undefined);t.Filter={HasImage:ko.observable(null),IsPayingMember:ko.observable(null),HasProfileText:ko.observable(null),HasSentMessages:ko.observable(null),Gender:ko.observable(null),LastLoginDays:ko.observable(null),Area:ko.observable(undefined),Age:{Min:ko.observable(null),Max:ko.observable(null)}};t.Criteria={PageNumber:t.Paging.PageIndex(),Criterias:ko.toJS(t.Filter)};t.Search=function(){t.Paging.PageIndex(1);i.search()};t.Clear=function(){var n=t.Filter;n.HasImage(null);n.IsPayingMember(null);n.HasProfileText(null);n.HasSentMessages(null);n.Gender(null);n.LastLoginDays(null);n.Age.Min(null);n.Age.Max(null);n.Area(undefined);t.AreaName(undefined);t.layout.searchAreaInput.val(undefined)};t.NextPage=function(){if(!t.Paging.IsLastPage()){var n=t.Paging.PageIndex();t.Paging.PageIndex(++n);i.search()}};t.PrevPage=function(){if(t.Paging.PageIndex()!=1){var n=t.Paging.PageIndex();t.Paging.PageIndex(n-1);i.search()}};t.onAreaSelected=function(n){t.Filter.Area({Longitude:n.location.lng,Latitude:n.location.lat})}};n.CustomProfileListViewModel=t}(frm.models,frm.services),function(){frm.models.ProfileSearchViewModel=function(n){var t=this,i={search:function(n){t.IsStarted(!0);t.IsLoading(!0);frm.services.accountService.search(n).then(function(n){frm.utils.arrayReplace(t.Results,n.data);t.IsLoading(!1)})}};t.IsStarted=ko.observable(!1);t.IsLoading=ko.observable(!1);t.Results=ko.observableArray();t.SearchQuery=ko.observable().extend({required:!0});t.search=function(){var r=ko.validation.group([t.SearchQuery]),n;if(r().length>0){r.showAllMessages();return}n=t.SearchQuery();i.search(n);history.pushState({},"null","?q="+n)};n.query.length>0&&(t.SearchQuery(n.query),i.search(n.query))}}(),function(n,t){n.ContactSupportViewModel=function(){var n=this,i=function(){n.state("SUCCESS")},r=function(){n.state("FAILED")};n.message=ko.observable().extend({required:!0});n.name=ko.observable().extend({required:!0});n.email=ko.observable().extend({required:!0,email:!0});n.state=ko.observable("DEFAULT");n.send=function(){var u=App.settings.account.isLoggedIn?ko.validation.group([n.message]):ko.validation.group([n.message,n.name,n.email]);if(u().length>0){u.showAllMessages();return}t.SupportService.sendContactMessage(n.message(),n.name(),n.email()).then(i,r)}}}(frm.models,frm.services),function(n,t){function i(n){var t=this,i={getPendingPictures:function(){return ko.utils.arrayFilter(t.pictures(),function(n){return n.Type()=="pending"})},getPendingStatus:function(){var t=ko.toJS(ko.utils.arrayMap(i.getPendingPictures(),function(n){return n.PendingUserPictureId}));t.length>0?frm.services.PictureService.getPendingStatus(t,n.pictureType).then(i.onPendingFetched):setTimeout(i.getPendingStatus,3e3)},onPendingFetched:function(n){var t=n.data;ko.utils.arrayForEach(i.getPendingPictures(),function(n){var i=ko.utils.arrayFirst(t,function(t){return t.PendingUserPictureId==n.PendingUserPictureId});i.IsCompleted&&(n.PictureUrl=i.PictureUrl,n.IsPrimaryImage=ko.observable(i.IsPrimaryImage),n.PictureId=i.PictureId,n.Type("default"))});setTimeout(i.getPendingStatus,3e3)},onFetched:function(n){var i=[];ko.utils.arrayForEach(n.data.Pictures,function(n){n.Type=ko.observable("default");n.IsPrimaryImage=ko.observable(n.IsPrimaryImage);i.push(n)});ko.utils.arrayForEach(n.data.PendingPictures,function(n){i.push({Type:ko.observable("pending"),PendingUserPictureId:n})});frm.utils.arrayReplace(t.pictures,i);t.isLoadingPictures(!1)}};t.pictures=ko.observableArray();t.isLoadingPictures=ko.observable(!0);t.remove=function(n){var i=n.IsPrimaryImage();t.pictures.remove(n);frm.services.PictureService.remove(n.PictureId).then(function(){var n,r;i&&(n=t.pictures().length,n>0&&(r=t.pictures()[0],t.setPrimary(r)))})};t.setPrimary=function(i){var r=ko.utils.arrayFirst(t.pictures(),function(n){return n.IsPrimaryImage()});r!=null&&r.IsPrimaryImage(!1);i.IsPrimaryImage(!0);frm.services.PictureService.setPrimary(i.PictureId,n.pictureType).then(function(){},function(){i.IsPrimaryImage(!1);r!=null&&r.IsPrimaryImage(!0)})};frm.services.PictureService.fetch(n.pictureType).then(i.onFetched);i.getPendingStatus()}function r(n){var t=this;t.pictureType=n.pictureType;t.file=ko.observable("");t.uploadState=ko.observable(0);t.uploadedImage={PendingUserPictureId:ko.observable(),Filename:ko.observable(),Description:ko.observable(),PictureType:ko.observable(),Angle:ko.observable(0)};t.imageUrl=ko.observable();t.pictureAngle=ko.observable(0);t.pictureRotation=ko.observable();t.UploadErrorModel={HasError:ko.observable(!1),Message:ko.observable()};t.onUploadError=function(n){t.UploadErrorModel.HasError(!0);t.UploadErrorModel.Message(n)};t.validate=function(){var n=!0;return t.file()==""&&(n=!1),n};t.beforeSave=function(){t.uploadState(1);n.onBeforePictureUploaded&&n.onBeforePictureUploaded()};t.afterSave=function(n){if(n[0]==undefined){t.reset();t.onUploadError(n.Message);return}t.uploadState(2);ko.utils.arrayMap(n,function(n){t.imageUrl(n.Filename);t.uploadedImage.PendingUserPictureId(n.PendingUserPictureId);t.uploadedImage.Filename(n.Filename);t.uploadedImage.Description(n.Description);t.uploadedImage.PictureType(n.PictureType);t.uploadedImage.Angle(n.Angle)});t.rotateImage(0)};t.reset=function(){t.file("");t.imageUrl(undefined);t.uploadedImage.PendingUserPictureId(undefined);t.uploadedImage.Filename(undefined);t.uploadedImage.Description(undefined);t.uploadedImage.PictureType(undefined);t.uploadedImage.Angle(undefined);t.UploadErrorModel.HasError(!1);t.uploadState(0)};t.save=function(){var i=ko.toJS(t.uploadedImage);if(frm.services.PictureService.queueUpload(i),n.onAfterPictureUploaded)n.onAfterPictureUploaded({PendingUserPictureId:t.uploadedImage.PendingUserPictureId(),Type:ko.observable("pending")});t.uploadState(3)};t.rotateLeft=function(){t.pictureAngle()==-270?t.pictureAngle(0):t.pictureAngle(t.pictureAngle()-90);t.rotateImage(t.pictureAngle())};t.rotateRight=function(){t.pictureAngle()==270?t.pictureAngle(0):t.pictureAngle(t.pictureAngle()+90);t.rotateImage(t.pictureAngle())};t.rotateImage=function(n){t.pictureRotation({"-webkit-transform":"rotate("+n+"deg)","-moz-transform":"rotate("+n+"deg)","-ms-transform":"rotate("+n+"deg)",transform:"rotate("+n+"deg)",backgroundImage:"url(/temp/"+t.imageUrl()+")"});t.uploadedImage.Angle(n)}}function u(n){var i=this,r={fetch:function(n){t.PictureService.getById(n).then(function(n){var t=n.data;t.Description=ko.observable(t.Description);t.IsPrimaryImage=ko.observable(t.IsPrimaryImage);i.picture(t)})}};i.pictureId=n.pictureId;i.picture=ko.observable(null);i.saved=ko.observable(!1);i.saveChanges=function(){var n=ko.toJS(i.picture);t.PictureService.update(i.pictureId,n.Description,i.pictureAngle).then(function(){i.saved(!0);setTimeout(function(){i.saved(!1)},3e3)})};i.remove=function(){frm.services.PictureService.remove(i.pictureId)};i.setPrimary=function(){var n=ko.toJS(i.picture);i.picture().IsPrimaryImage(!0);frm.services.PictureService.setPrimary(i.pictureId,n.PictureType).then(function(){},function(){n.IsPrimaryImage(!1);previousPrimaryImage!=null&&previousPrimaryImage.IsPrimaryImage(!0)})};r.fetch(i.pictureId)}function f(n){var t=this,f=[],e={onBeforePictureUploaded:function(){t.isUploading(!0)},onAfterPictureUploaded:function(n){t.isUploading(!1);t.picturesView.pictures.push(n)},createView:function(n){t.picturesView=new i({pictureType:n});e.createFormView(n)},createFormView:function(n){t.picturesFormView=new r({pictureType:n,onBeforePictureUploaded:e.onBeforePictureUploaded,onAfterPictureUploaded:e.onAfterPictureUploaded})}};t.picturesView=null;t.picturesFormView=null;t.currentView=ko.observable();t.isUploading=ko.observable(!1);t.roomThumbnails=ko.observableArray(n.roomThumbnails);t.profileThumbnails=ko.observableArray(n.profileThumbnails);t.setRoomView=function(){e.createView(1);t.currentView("room");f.push(t.setRoomView)};t.setProfileView=function(){e.createView(2);t.currentView("profile");f.push(t.setProfileView)};t.setUpdateView=function(n){t.pictureEditView=new u({pictureId:n});t.currentView("update");f.push(function(){t.setUpdateView(n)})};t.setDefaultView=function(){t.currentView("default");f.push(t.setDefaultView)};t.back=function(){var n=f.length-2;f.splice(n+1,1);f[n]();f.splice(f.length-1,1)};t.setDefaultView()}n.PictureViewModel=f}(frm.models,frm.services),function(n){function t(){var n=this,t={onSuccess:function(){n.IsSucceeded(!0);n.IsNotAcceptable(!1)},onFailure:function(){n.IsNotAcceptable(!0)},request:function(){var i=ko.toJS(n.Model);frm.services.VoucherService.redeem(i.VoucherCode).then(t.onSuccess,t.onFailure)}};n.IsNotAcceptable=ko.observable(!1);n.IsSucceeded=ko.observable(!1);n.Model={VoucherCode:ko.observable("")};n.TryRedeem=function(){t.request()}}n.RedeemVoucherViewModel=t}(frm.models,frm.services),function(n){ko.validation.rules.acceptTerms={validator:function(n){return!!n}};ko.validation.registerExtenders();ko.validation.configure({decorateElement:!0,registerExtenders:!0,messagesOnModified:!0,insertMessages:!1,parseInputAttributes:!0,messageTemplate:null});n.CreateAccountViewModel=function(n){n=n||{};var t=this,i={onSuccess:function(t){var i=t.data.account;n.onSuccess(i.UserType,i.IsPayingMember)},onFailure:function(i){t.IsLoading(!1);var u=JSON.parse(i.responseText),r=u.data;i.status==409&&(r.inUse=="email"&&t.ErrorMessage(n.errorMessages.duplicateEmail),r.inUse=="username"&&t.ErrorMessage(n.errorMessages.dublicateUsername));i.status==400&&(r.type=="invalidEmail"?t.ErrorMessage(n.errorMessages.invalidEmail):t.ErrorMessage(n.errorMessages.unknownError));i.status==406&&t.ErrorMessage(n.errorMessages.invalidVoucher)},createAccount:function(n){var r=ko.toJS(t.AccountModel),i;switch(n){case"Default":return(i=ko.validation.group([t.AccountModel.Email,t.AcceptedTerms]),i().length>0)?(i.showAllMessages(),null):(t.IsLoading(!0),frm.services.accountService.createOnlyEmail(r.Email,r.UserType,{emailChecks:r.SuggestedEmails,voucherCode:r.VoucherCode}));case"Facebook":return(i=ko.validation.group([t.AcceptedTerms]),i().length>0)?(i.showAllMessages(),null):(t.IsLoading(!0),frm.services.accountService.createThroughFacebook({userType:r.UserType}));case"Google":return(i=ko.validation.group([t.AcceptedTerms]),i().length>0)?(i.showAllMessages(),null):(t.IsLoading(!0),frm.services.accountService.createThroughGoogle({userType:r.UserType}))}return null}};t.AccountModel={UserType:1,Email:ko.observable().extend({required:!0}),VoucherCode:ko.observable(),SuggestedEmails:ko.observableArray()};t.AcceptedTerms=ko.observable(!1).extend({acceptTerms:{message:"Accept terms please"}});t.IsLoading=ko.observable(!1);t.IsVoucherVisible=ko.observable(!1);t.CurrentState=ko.observable("Default");t.ErrorMessage=ko.observable(null);t.SetFacebookState=function(){t.CurrentState("Facebook")};t.SetGoogleState=function(){t.CurrentState("Google")};t.SetDefaultState=function(){t.CurrentState("Default")};t.CreateAccount=function(){var n=i.createAccount(t.CurrentState());n!=null&&n.then(function(n){var u=!0,r;t.CurrentState()!=="Default"&&n.data.isExistingUser&&(u=!1);u===!0&&(r="Default signup",frm.services.TrackingService.vendor.enroll(r),frm.services.TrackingService.vendor.tenantEnroll(r));i.onSuccess(n)},i.onFailure)};n.tearmsAccepted&&t.AcceptedTerms(n.tearmsAccepted);n.predefinedEmail&&t.AccountModel.Email(n.predefinedEmail)}}(frm.models,frm.services),function(n){n.ExternalRoomViewModel=function(n){if(n=n||{},typeof n.room=="undefined")throw new Error("No room defined!");var t=this,i=n.room,r=function(){return new frm.models.GenericPopupViewModel(n.popupOptions)};t.GoogleMapData=n.googleMapData;t.ClickedGoToButton=!1;t.Coordinates={latitude:i.Location.Latitude,longitude:i.Location.Longitude};t.GoTo=function(){t.ClickedGoToButton=!0;var n=r();frm.models.GenericPopupViewModel.create(n).then(function(){n.Areas.SignUp.ExternalRoomListingSignUpView()})};setTimeout(function(){if(t.ClickedGoToButton==!1&&n.popupOptions.trigger){var i=r();frm.models.GenericPopupViewModel.create(i).then(function(){i.Areas.SignUp.ExternalRoomListingSignUpView()})}},15e3)}}(frm.models,frm.services),function(n){var t=function(n){var t=this,i={checkEmail:function(n){return frm.services.accountService.checkEmail(n)},createRoom:function(n){return frm.services.accountService.createRoom(n)},transform:function(n){var i=n.terms,t=ko.utils.arrayMap(n.terms,function(n){return n.value}).join(", ");return{key:t,data:n}}},f,u,r;t.CustomError={Gender:ko.observable(!1),Smoker:ko.observable(!1),Period:ko.observable(!1),Occupation:ko.observable(!1)};f={cancelUpdated:!1};t.CreateRoomModel={AccountModel:{Firstname:ko.observable().extend({required:!0}),Lastname:ko.observable().extend({required:!0}),Email:ko.observable().extend({required:!0,rateLimit:{timeout:600,method:"notifyWhenChangesStop"}}),SuggestedEmails:ko.observableArray(),Password:ko.observable().extend({required:!0}),UserInfo:{Gender:ko.observable(null).extend({required:!0}),Smoker:ko.observable(null).extend({required:!0}),Age:ko.observable().extend({required:!0}),Occupation:ko.observable(null).extend({required:!0})},Currency:ko.observable(n.defaultCurrency)},RoomModel:{Address:ko.observable().extend({required:!0}),Rent:ko.observable().extend({required:!0}),Deposit:ko.observable().extend({required:!0}),Area:ko.observable().extend({required:!0}),AreaType:ko.observable(undefined).extend({required:!0}),MoveInDate:ko.observable().extend({required:!0}),Period:ko.observable().extend({required:!0}),Adtext:ko.observable().extend({required:!0}),AdTagline:ko.observable().extend({required:!0})}};t.Views={CreationView:ko.observable(!0),NextStepView:ko.observable(!1)};t.isLoading=ko.observable(!1);t.searchAreaQuery=ko.observable();t.EmailAvalible=ko.observable(!0);t.InvalidEmailError=ko.observable(!1);t.ShowErrorSummery=ko.observable(!1);t.TermsAndCondition=ko.observable(!1).extend({required:!0});t.RentCorrectFormat=ko.observable(!0);t.DepositCorrectFormat=ko.observable(!0);t.AreaCorrectFormat=ko.observable(!0);t.Validation=function(){var n=!0,i=ko.validation.group([t.CreateRoomModel.AccountModel.Firstname,t.CreateRoomModel.AccountModel.Lastname,t.CreateRoomModel.AccountModel.Email,t.CreateRoomModel.AccountModel.Password,t.CreateRoomModel.AccountModel.UserInfo.Age,t.CreateRoomModel.RoomModel.Address,t.CreateRoomModel.RoomModel.Rent,t.CreateRoomModel.RoomModel.Deposit,t.CreateRoomModel.RoomModel.Area,t.CreateRoomModel.RoomModel.AreaType,t.CreateRoomModel.RoomModel.MoveInDate,t.CreateRoomModel.RoomModel.Adtext,t.CreateRoomModel.RoomModel.AdTagline,]);return(i().length>0||t.EmailAvalible==!1||t.RentCorrectFormat()==!1||t.DepositCorrectFormat()==!1)&&(i.showAllMessages(),t.ShowErrorSummery(!0),n=!1),t.CreateRoomModel.AccountModel.UserInfo.Gender()==""||t.CreateRoomModel.AccountModel.UserInfo.Gender()==null||t.CreateRoomModel.AccountModel.UserInfo.Gender()==undefined||t.CreateRoomModel.AccountModel.UserInfo.Gender()=="undefined"?(t.CustomError.Gender(!0),n=!1):t.CustomError.Gender(!1),t.CreateRoomModel.AccountModel.UserInfo.Smoker()==""||t.CreateRoomModel.AccountModel.UserInfo.Smoker()==null||t.CreateRoomModel.AccountModel.UserInfo.Smoker()==undefined||t.CreateRoomModel.AccountModel.UserInfo.Smoker()=="undefined"?(t.CustomError.Smoker(!0),n=!1):t.CustomError.Smoker(!1),t.CreateRoomModel.AccountModel.UserInfo.Occupation()==""||t.CreateRoomModel.AccountModel.UserInfo.Occupation()==null||t.CreateRoomModel.AccountModel.UserInfo.Occupation()==undefined||t.CreateRoomModel.AccountModel.UserInfo.Occupation()=="undefined"?(t.CustomError.Occupation(!0),n=!1):t.CustomError.Occupation(!1),t.CreateRoomModel.RoomModel.Period()==""||t.CreateRoomModel.RoomModel.Period()==null||t.CreateRoomModel.RoomModel.Period()==undefined||t.CreateRoomModel.RoomModel.Period()=="undefined"?(t.CustomError.Period(!0),n=!1):t.CustomError.Period(!1),t.TermsAndCondition()==!1&&(i.showAllMessages(),n=!1),n?(t.ShowErrorSummery(!1),!0):!1};t.CreateRoomModel.AccountModel.Email.subscribe(function(n){n.length>0&&i.checkEmail(t.CreateRoomModel.AccountModel.Email()).then(function(n){t.EmailAvalible(!n.data)})});t.CreateRoomModel.RoomModel.Rent.subscribe(function(n){n.indexOf(".")!==-1||n.indexOf(",")!==-1?t.RentCorrectFormat(!1):t.RentCorrectFormat(!0)});t.CreateRoomModel.RoomModel.Area.subscribe(function(n){var i=n,r=!1;i.indexOf(".")!==-1&&(i=i.substring(0,i.indexOf(".")),r=!0);i.indexOf(",")!==-1&&(i=i.substring(0,i.indexOf(",")),r=!0);r&&t.CreateRoomModel.RoomModel.Area(i)});t.CreateRoomModel.RoomModel.Deposit.subscribe(function(n){n.indexOf(".")!==-1||n.indexOf(",")!==-1?t.DepositCorrectFormat(!1):t.DepositCorrectFormat(!0)});t.onAreaSelected=function(n){t.CreateRoomModel.RoomModel.Address(n)};t.CreateRoom=function(){t.Validation()&&(t.isLoading(!0),$(window).scrollTop($(".content-area").offset().top),i.createRoom(ko.toJS(t.CreateRoomModel)).then(function(n){if(n.status==="success"){var i="Default signup";frm.services.TrackingService.vendor.enroll(i);frm.services.TrackingService.vendor.landlordEnroll(i);typeof ga!="undefined"&&ga("send","event","Create Room Form","click","CMS Udlejer Landing Page");t.Views.CreationView(!1);t.Views.NextStepView(!0)}else t.Views.CreationView(!0),t.Views.NextStepView(!1);t.isLoading(!1)},function(n){var i=JSON.parse(n.responseText);n.status===409&&i.hasOwnProperty("AlreadyExists")&&i.AlreadyExists.indexOf("email")>=0&&t.EmailAvalible(!1);n.status===400&&i.data.hasOwnProperty("type")&&i.data.type.indexOf("invalidEmail")>=0&&t.InvalidEmailError(!0);t.Views.CreationView(!0);t.Views.NextStepView(!1);t.isLoading(!1)}))};n.hasPreData&&(n.preData.email.length>0&&t.CreateRoomModel.AccountModel.Email(n.preData.email),n.preData.area.length>0&&t.CreateRoomModel.RoomModel.Area(n.preData.area),n.preData.address.length>0&&(u=n.preData.address,r=new frm.services.GoogleSuggestionService("DK",document.getElementById("suggestion-container")),r.getSuggestions(u).then(function(n){if(n.length>0&&(suggestions=ko.utils.arrayMap(n,i.transform),suggestions.length>0)){var u=suggestions[0];r.geocode(u.data).then(function(n){t.onAreaSelected(n);t.searchAreaQuery(u.key)})}})))};n.CreateRoomViewModel=t}(frm.models,frm.services),function(){var n={internetProtocolAddresses:{index:function(n,t){var i=this,r={onSuccess:function(n){frm.utils.arrayReplace(i.InternetProtocolAddresses,ko.utils.arrayMap(n.data,function(n){return n.Block=ko.observable(!0),n}));i.IsLoading(!1)},fetch:function(){i.IsLoading(!0);t().then(r.onSuccess)}};i.IsLoading=ko.observable(!1);i.InternetProtocolAddresses=ko.observableArray();r.fetch()}},locking:{index:function(t,i){var r=this;r.InternetProtocolAddressView=new n.internetProtocolAddresses.index({$parent:this},function(){return frm.services.LoginLogService.getByAccountId(i.accountId)});r.BlockInternetProtocolAddress=ko.observable(!1);r.NotifyVictims=ko.observable(!1);r.Reason=ko.observable("");r.Message=ko.observable(i.defaultLockMessage);r.Loading=[{IsLoading:ko.observable(!1),Name:"Account",When:function(){return!0},Invoke:function(){return frm.services.accountService.lock({accountId:i.accountId,reason:r.Reason(),notifyVictims:r.NotifyVictims(),message:r.Message()})}},{IsLoading:ko.observable(!1),Name:"InternetProtocolAddresses",When:function(){return r.BlockInternetProtocolAddress()},Invoke:function(){var n=ko.utils.arrayMap(ko.utils.arrayFilter(r.InternetProtocolAddressView.InternetProtocolAddresses(),function(n){return n.Block()===!0}),function(n){return n.InternetProtocol});return frm.services.SecurityService.block(n,i.accountId)}}];r.submit=function(){t.isLoading(!0);var n=ko.utils.arrayFilter(r.Loading,function(n){return n.When()});$.when.call(this,ko.utils.arrayMap(n,function(n){return n.IsLoading(!0),n.Invoke()})).then(function(){t.setLockedCompleteView();t.isLoading(!1)})}},completed:function(){}},unlocking:{index:function(t,i){var r=this;r.InternetProtocolAddressView=new n.internetProtocolAddresses.index({$parent:this},function(){return frm.services.SecurityService.getBlockedInternetProtocolAddressesByAccountId(i.accountId)});r.BlockInternetProtocolAddress=ko.observable(!1);r.NotifyVictims=ko.observable(!1);r.Message=ko.validatedObservable(i.defaultUnlockMessage);r.Loading=[{IsLoading:ko.observable(!1),Name:"Account",When:function(){return!0},Invoke:function(){return frm.services.accountService.unlock({accountId:i.accountId,notifyVictims:r.NotifyVictims(),message:r.Message()})}},{IsLoading:ko.observable(!1),Name:"InternetProtocolAddresses",When:function(){return r.BlockInternetProtocolAddress()},Invoke:function(){var n=ko.utils.arrayMap(ko.utils.arrayFilter(r.InternetProtocolAddressView.InternetProtocolAddresses(),function(n){return n.Block()===!0}),function(n){return n.InternetProtocol});return frm.services.SecurityService.unblock(n,i.accountId)}}];r.submit=function(){t.isLoading(!0);var n=ko.utils.arrayFilter(r.Loading,function(n){return console.dir(n),n.When()});$.when.call(this,ko.utils.arrayMap(n,function(n){return n.IsLoading(!0),n.Invoke()})).then(function(){t.setUnlockedCompleteView();t.isLoading(!1)})}},completed:function(){}}};frm.models.AccountLockViewModel=function(t){var i=this,r={setView:function(n,t){i.currentView({name:n,model:t})}};i.currentView=ko.observable();i.isLoading=ko.observable(!1);i.setLockView=function(){r.setView("lock-account-view",new n.locking.index(i,t))};i.setLockedCompleteView=function(){r.setView("lock-complete-view",new n.locking.completed(i,t))};i.setUnlockView=function(){r.setView("unlock-account-view",new n.unlocking.index(i,t))};i.setUnlockedCompleteView=function(){r.setView("unlock-complete-view",new n.locking.completed(i,t))};t.isLocked?i.setUnlockView():i.setLockView()}}(),function(){frm.models.NotificationViewModel=function(n){n=n||{};var t=this;t.IsVisible=ko.observable(typeof n.getVisibleState!="undefined"?n.getVisibleState():!0);t.dismiss=function(){t.IsVisible(!1);typeof n.onDismiss!="undefined"&&n.onDismiss()}}}(),function(n){function t(t,i){var r=this,u;r.___notification=t;for(u in t)t.hasOwnProperty(u)&&(r[u]=t[u]);r.CurrentState=ko.observable("DEFAULT");r.ChangeState=function(n){r.CurrentState(n)};r.DisableNotifications=function(t,u){u.stopPropagation();r.ChangeState("DISABLED");i.onNotificationDisabled(r.___notification,r.ItemId,r.ItemType);n.accountService.disableNotificationGroup(r.ItemId,r.ItemType)}}function i(i){var r=this,u={onNotificationDisabled:function(n,t,i){frm.utils.arrayReplace(r.Notifications,ko.utils.arrayFilter(r.Notifications(),function(r){return r.___notification===n||r.ItemId!==t&&r.itemType!==i}))},onLatestNotificationsFetched:function(n,i){var f=ko.utils.arrayMap(i.data,function(n){return new t(n,{onNotificationDisabled:u.onNotificationDisabled})});n?(frm.utils.arrayReplace(r.Notifications,f),r.UnreadNotifications(0)):ko.utils.arrayPushAll(r.Notifications,f)},fetchLatestNotifications:function(t){return r.CurrentPageIndex(t),r.Notifications().length==0&&r.IsLoading(!0),n.accountService.getLatestNotifications(t).then(function(n){u.onLatestNotificationsFetched(t===0,n)})}};r.IsOpen=ko.observable(!1);r.IsLoading=ko.observable(!1);r.Notifications=ko.observableArray();r.CurrentPageIndex=ko.observable(1);r.UnreadNotifications=ko.observable(i.unreadNotifications);r.toggleList=function(){var f=r.IsOpen(),t=!f,i=[];t&&i.push(n.NotificationService.requestTemplates());t===!0&&i.push(u.fetchLatestNotifications(0));r.IsOpen(t);jQuery.when.apply(jQuery,i).done(function(){r.IsLoading(!1)})};r.hijack=function(n,t){return(t.target||{}).href=(t.currentTarget||{}).href=n.NotificationUrl,!0};r.nextNotifications=function(){u.fetchLatestNotifications(r.CurrentPageIndex()+1)};frm.events.addListener("notification:count:updated",function(n){r.UnreadNotifications(n)})}frm.models.NotificationDropInViewModel=i}(frm.services),function(n){function t(){var n=this,t=new frm.services.SearchService;n.Query=ko.observable();n.onQueryChange=function(n){var i=t.getRedirectParameters(n),r=t.getUrl("default",App.settings.searchSettings.roomBasePath,i.locality,i.sublocality,i.country);location.href=r}}function i(n){var t=this;t.query=ko.observable();t.results=ko.observableArray();t.selected=ko.observable(0);t.HandleFormSubmit=function(n){if(t.results().length>=0&&typeof t.query()!="undefined"&&t.query().length>0){t.goto(t.results()[t.selected()],{currentTarget:n});return}return};t.submit=function(){var i=t.query();typeof i!="undefined"&&i.length>0?n.state("SEARCHING"):n.state("DEFAULT")};t.goto=function(t){var i=new frm.services.SearchService,r=new frm.services.GoogleSuggestionService("DK",document.body);r.geocode(t).then(function(n){var t=i.getRedirectParameters(n),r=i.getUrl("default",App.settings.searchSettings.roomBasePath,t.locality,t.sublocality,t.country);location.href=r});n.state("DEFAULT")}}function r(n){var r=this,u={incrementUnreadThreads:function(n){var t=r.UnreadThreads().indexOf(n.ThreadId);n.Message===undefined&&t===-1&&r.UnreadThreads.push(n.ThreadId)},decrementUnreadThreads:function(n){r.UnreadThreads.remove(n.ThreadId)}},f=function(){return new frm.models.GenericPopupViewModel(n.popupOptions)};r.IsNavigationOpen=ko.observable(!1);r.IsCurrenciesOpen=ko.observable(!1);r.state=ko.observable("DEFAULT");r.search=new i(r);r.SearchForm=new t;r.MatchCenterViewModel=new function(){function i(){var n=t.TotalUnreadMatches()+1;t.TotalUnreadMatches(n);n>0&&t.HasUnreadMatches(!0)}function r(){var n=t.TotalUnreadMatches()-1;n<0&&(n=0);t.TotalUnreadMatches(n);n==0&&t.HasUnreadMatches(!1)}function u(){alert("Match Savo")}var t=this;t.HasUnreadMatches=ko.observable(n.hasUnreadMatches||!1);t.TotalUnreadMatches=ko.observable(n.totalUnreadMatches||0);frm.events.addListener("matchmaking:match:received",i);frm.events.addListener("matchmaking:match:read",r);frm.events.addListener("matchmaking:match:savo",u)};r.UnreadThreads=ko.observableArray(n.unreadThreads);r.IsSearching=ko.computed(function(){return r.state()=="SEARCHING"||r.search.results().length>0});r.CreateTenantProfile=function(){var n=f();frm.models.GenericPopupViewModel.create(n).then(function(){n.Areas.SignUp.SetTenantNavBarSignUpView()})};frm.events.addListener("chat:message:received",u.incrementUnreadThreads);frm.events.addListener("chat:message:remove:read",u.incrementUnreadThreads);frm.events.addListener("chat:message:read",u.decrementUnreadThreads);frm.events.addListener("chat:thread:removed",u.decrementUnreadThreads)}n.MainMenuBarViewModel=r}(frm.models,frm.services),function(){function n(n){function i(n){var t=this,i=$("#navigation-burger .search-control").attr("placeholder");t.query=ko.observable();t.results=ko.observableArray();t.submit=function(){var r=t.query();typeof r!="undefined"&&r.length>0?n.state("SEARCHING"):typeof i!="undefined"&&i.length>0?(t.query(i),n.state("SEARCHING")):n.state("DEFAULT")};t.goto=function(i,r){var u=new frm.services.SearchService,f=new frm.services.GoogleSuggestionService("DK",r.currentTarget);f.geocode(i).then(function(n,t){var i,r,f;typeof callback=="undefined"?(i=u.getRedirectParameters(n),r=u.getUrl("default",App.settings.searchSettings.roomBasePath,i.locality,i.sublocality,i.country),location.href=r):(f=ui.item.label,callback(f,t))});n.state("DEFAULT");t.query("")}}var t=this;t.state=ko.observable("DEFAULT");t.search=new i(t);t.NotificationCenter=new frm.models.NotificationDropInViewModel(n)}frm.models.MainMobileViewModel=n}(),function(n){var t=[{DataType:"HarmfulCodeMessage",Template:"CodeTemplateNoHtml"},{DataType:"ExceptionMessage",Template:"CodeTemplate"},{DataType:"StackTrace",Template:"CodeTemplate"},{DataType:"Url",Template:"UrlTemplate"},{DataType:"Milliseconds",Template:"MillisecondsTemplate"}];n.LogViewerViewModel=function(n){var i,r,u;n=n||{};i=this;r={cleanFetch:function(){return i.IsLastPage(!1),i.CurrentPageIndex(0),r.fetch().then(function(n){var t=n.data;frm.utils.arrayReplace(i.Logs,t);i.IsLoading(!1)})},fetch:function(){var r=ko.utils.arrayMap(ko.utils.arrayFilter(i.Events(),function(n){return n.IsChecked()}),function(n){return n.EventName}),u=i.SiteFilterEnabled?i.SelectedSite():null,t=[];return t.push(ko.toJS(i.AdvancedSearchModel)),n.sources.fetchLogs(i.CurrentPageIndex(),r,u,t)},fetchEvents:function(){return n.sources.fetchEvents().then(function(t){var r=ko.utils.arrayMap(t.data,function(t){var i=n.uncheckedEventSearch.indexOf(t)==-1;return{IsChecked:ko.observable(i),EventName:t}});frm.utils.arrayReplace(i.Events,r)})},fetchSites:function(){return frm.services.SiteService.findRootSites().then(function(n){for(var r=n.data,t=0;t<r.length;t++)i.SiteListItems.push({text:r[t].Host,value:r[t].Id})})}};i.EventsEnabled=n.enableEvents||!1;i.SiteFilterEnabled=n.enableSiteFilter||!1;i.Events=ko.observableArray();i.Logs=ko.observableArray();i.IsLastPage=ko.observable(!1);i.CurrentPageIndex=ko.observable(0);i.SelectedSite=ko.observable(null);i.IsLoading=ko.observable(!0);i.SiteListItems=ko.observableArray([{text:"Alle websteder",value:null}]);i.IsAdvancedSearch=ko.observable(!1);i.AdvancedSearchModel=function(){return{AttributeName:ko.observable(),Term:ko.observable()}}();i.ContainsTemplate=function(n){return ko.utils.arrayFirst(t,function(t){return t.DataType==n})!=null};i.GetTemplate=function(n){return ko.utils.arrayFirst(t,function(t){return t.DataType==n}).Template};i.Search=function(){r.cleanFetch()};i.ChangeEventStates=function(t){ko.utils.arrayForEach(i.Events(),function(i){n.uncheckedEventSearch.indexOf(i.EventName)==-1&&i.IsChecked(t)})};i.NextPage=function(){var n=i.CurrentPageIndex(),t=++n;return i.IsLastPage()?null:(i.CurrentPageIndex(t),r.fetch().then(function(n){n.data.length==0&&i.IsLastPage(!0);ko.utils.arrayPushAll(i.Logs,n.data)}))};u=[];i.SiteFilterEnabled&&u.push(r.fetchSites().then(function(){i.SelectedSite(n.defaultSelectedSite||null)}));i.EventsEnabled&&u.push(r.fetchEvents());$.when.apply($,u).then(function(){i.SelectedSite.subscribe(i.Search);r.cleanFetch()})}}(frm.models,frm.services),function(n){var t=function(){var n=this;n.Bubbles=ko.observableArray();n.triggerEvent=function(){frm.events.dispatch("notification:new:add",{})};frm.events.addListener("notification:new:add",function(t){frm.utils.arrayReplace(n.Bubbles,t)})};n.NotificationBubbleViewModel=t}(frm.models),function(n,t){var i=function(n){var i=this,r={onNotificationsFetched:function(n,t){var r=t.data;n?frm.utils.arrayReplace(i.Notifications,r):ko.utils.arrayPushAll(i.Notifications,r)},fetchNotifications:function(n){i.CurrentPageIndex(n);t.accountService.getNotifications(n).then(function(t){r.onNotificationsFetched(n===0,t);i.IsLoading(!1)})}};i.IsLoading=ko.observable(!0);i.Notifications=ko.observableArray();i.CurrentPageIndex=ko.observable(0);i.NotificationGroups=ko.utils.arrayMap(n.NotificationGroups,function(n){return n.IsDisabled=ko.observable(n.IsDisabled),n}).reduce(function(n,t){return n[t.NotificationGroupId]=t,n},{});i.toggleNotificationGroup=function(n){n.IsDisabled(!n.IsDisabled());t.accountService.changeNotificationGroupState(n.NotificationGroupId,n.IsDisabled())};i.hijack=function(n,t){var i="/NotificationsRead/?itemId="+n.ItemId+"&itemType="+n.ItemType+"&itemPosition="+n.Position+"&storyUrl="+n.Url;return(t.target||{}).href=(t.currentTarget||{}).href=i,!0};i.nextNotifications=function(){r.fetchNotifications(i.CurrentPageIndex()+1)};jQuery.when.apply(jQuery,t.NotificationService.requestTemplates()).done(function(){i.IsLoading(!0);r.fetchNotifications(0)})};n.NotificationCenterViewModel=i}(frm.models,frm.services),function(n){var t=function(n){var t=[];return n.Street&&t.push(n.Street),n.City&&t.push(n.City),t.join(" - ")},i=function(){var n=this,i={getPropertyMatches:function(n){return frm.services.RoommateMatchWidgetService.getPropertyMatches(n)}};n.TopProperyMatches=4;n.HousingIsLoading=ko.observable(!0);n.Properties=ko.observableArray();n.ShowMore=ko.observable(!1);n.Fetch=function(){n.HousingIsLoading(!0);i.getPropertyMatches(n.TopProperyMatches).then(function(i){var r=i.data.map(function(n){return n.Headline=t(n),n});frm.utils.arrayReplace(n.Properties,r);n.HousingIsLoading(!1)})};n.ShowMoreBtn=function(){n.ShowMore(!n.ShowMore())};setTimeout(function(){n.Fetch()},10)};n.PropertyMatchWidgetViewModel=i}(frm.models,frm.services),function(n,t){function i(n,i){var r=this,u={createNotification:function(n){return n.Filter.RequiredPaying===""&&(n.Filter.RequiredPaying=null),n.Filter.SiteId===""&&(n.Filter.SiteId=null),n.Parameters!=null&&(n.Parameters=n.Parameters.map(function(n){return{Key:n.Name,Value:n.Value}})),t.NotificationService.createTextNotification(n).then(i.onSaved)}};r.Form={Message:ko.observable(),Url:ko.observable(),ImageUrl:ko.observable(),Parameters:ko.observable(null),Filter:{SiteId:ko.observable(),RequiredPaying:ko.observable()}};r.Form.Url.subscribe(function(n){var t=i.urls[n];r.Form.Parameters(ko.utils.arrayMap(t.Parameters,function(n){return{Name:n,Value:ko.observable()}}))});r.IsLoading=ko.observable(!1);r.onFormSubmit=function(){var n=ko.toJS(r.Form);r.IsLoading(!0);u.createNotification(n).then(function(){r.IsLoading(!1)})}}function r(){var n=this,i={fetch:function(){return t.NotificationService.findAllTextNotifications().then(function(t){frm.utils.arrayReplace(n.TextNotifications,t.data)})}};n.TextNotifications=ko.observableArray();n.reload=function(){i.fetch()};i.fetch()}n.NotificationTweetViewModel=function(n){var t=this,u={fetchPreviousTextNotifications:function(){t.PreviousView.reload()}};t.PreviousView=new r(this);t.FormView=new i(this,$.extend(n,{onSaved:u.fetchPreviousTextNotifications}))}}(frm.models,frm.services),function(n,t){function o(n){var u=this,c=new t({"":function(){ModelHandler.setThreadActive(null);u.CurrentView(null);u.MoveSuccessful(!1)},"{id}":function(n){h.changePage(function(){var t=new Date;return ModelHandler.setThreadActive(parseInt(n)),u.LoadingThread(!0),frm.services.MessageService.requestThread(n,1,t).then(function(i){u.setThreadView(parseInt(n),i.data,t)})})}}),h={changePage:function(n){u.IsLoading(!0);u.CurrentView()!==null&&typeof u.CurrentView().model!="undefined"&&typeof u.CurrentView().model.dispose=="function"&&u.CurrentView().model.dispose();var t=n();typeof t!="undefined"?t.then(function(){u.IsLoading(!1)}):u.IsLoading(!1)},changePath:function(t,i){c.redirect(t);i&&history.pushState({},"","/"+n.rootPath+t)},setView:function(n,t){u.endBulkActionView(!1);u.CurrentView({name:n,model:t})},setPageType:function(n){u.endBulkActionView(!1);u.PageType(n)}};n.lists!==null&&ko.utils.arrayForEach(n.lists,function(n){n.UnreadMessages=ko.observable(n.UnreadMessages)});f=n;u.SettingsTemplateView=new frm.models.MessageTemplateViewModel;u.CurrentViewName=ko.observable(n.currentViewName);u.CurrentViewFriendlyName=ko.observable(n.currentViewFriendlyName);u.CurrentView=ko.observable(null);u.IsLoading=ko.observable(!1);u.LoadingThread=ko.observable(!1);u.MoveSuccessful=ko.observable(!1);u.MoveType=ko.observable(0);u.PageType=ko.observable(n.pageType);u.ThreadCategories=ko.observableArray(n.lists||null);u.HasThreads=ko.observable(!1);u.CurrentCategory=ko.observable(n.currentCategory);u.InboxUnreads=ko.observable(n.inboxUnread);u.ListUnreads=ko.observable(n.totalListUnread);u.TotalUnread=ko.computed(function(){return u.InboxUnreads()+u.ListUnreads()});u.CategoryBulkActionViewVisible=ko.observable(!1);u.CategoryBulkActionView=ko.observable();u.ThreadListView={Model:ko.observable(new e(n.threads,n.pageType,n.currentCategory)),IsLoading:ko.observable(!1)};u.IsListOpen=ko.observable(!1);u.IsSettingsListOpen=ko.observable(!1);u.ToggleList=function(){u.IsListOpen(!u.IsListOpen())};u.ToggleSettings=function(){u.IsSettingsListOpen(!u.IsSettingsListOpen())};u.redirect=function(n){h.changePath(n,!0)};u.getPath=function(t){return"/"+n.rootPath+t};u.setThreadView=function(n,t,i){if(ModelHandler.setThreadActive(n),u.LoadingThread(!1),t.IsAuthorized){var r=App.settings.account.isPayingMember===!0?1:2;ModelHandler.readThread(n,r)}h.setView("thread-viewing",new o.ThreadViewingViewModel({threadId:n,thread:t,timestamp:i,pageType:u.PageType(),category:u.CurrentCategory()}));u.endBulkActionView(!1)};u.setBulkActionView=function(){u.IsListOpen(!1);u.IsSettingsListOpen(!1);u.endBulkActionView(!1);u.CategoryBulkActionView(new s(u,f,u.CurrentCategory()));u.CategoryBulkActionViewVisible(!0)};u.endBulkActionView=function(n){u.CategoryBulkActionViewVisible(!1);u.CategoryBulkActionView(undefined);n&&ko.utils.arrayForEach(u.ThreadListView.Model().Threads(),function(n){ModelHandler.readThread(n.ThreadId,6)});u.ThreadListView.IsLoading(!1)};u.changePageType=function(t,i,r,f,e){u.IsListOpen(!1);u.IsSettingsListOpen(!1);n.rootPath=i.substring(1);u.CurrentViewName(r);u.CurrentViewFriendlyName(f);u.CurrentCategory(e);u.redirect("/");h.setPageType(t);u.ThreadListView.IsLoading(!0);u.DeterminPageType(t,f,e)};u.DeterminPageType=function(n,t,i){u.ThreadListView.Model()!=undefined&&u.ThreadListView.Model().Dispose();switch(n){case"inbox":frm.services.MessageService.findThreads(1).then(function(n){u.ThreadListView.Model(new e(n.data,"inbox",undefined));n.data.length>0?u.HasThreads(!0):u.HasThreads(!1);u.ThreadListView.IsLoading(!1)});u.CurrentViewFriendlyName(t);break;case"archived":frm.services.MessageService.findArchivedThreads(1).then(function(n){u.ThreadListView.Model(new e(n.data,"archived",undefined));n.data.length>0?u.HasThreads(!0):u.HasThreads(!1);u.ThreadListView.IsLoading(!1)});u.CurrentViewFriendlyName(t);break;case"customList":frm.services.MessageService.findThreadsByCategory(1,i).then(function(n){u.ThreadListView.Model(new e(n.data,"customList",i));n.data.length>0?u.HasThreads(!0):u.HasThreads(!1);u.ThreadListView.IsLoading(!1)});u.CurrentCategory(i);u.CurrentViewFriendlyName(t)}};u.UpdateInboxUnread=function(n){var t=0;n===1&&(t=u.InboxUnreads()-1);n===2&&(t=u.InboxUnreads()+1);t<0?u.InboxUnreads(0):u.InboxUnreads(t)};u.UpdateListUnread=function(n){var t=0;n===1&&(t=u.ListUnreads()-1);n===2&&(t=u.ListUnreads()+1);t<0?u.ListUnreads(0):u.ListUnreads(t)};u.SettingsTemplateView.StartCreateTemplate=function(){var t={},i;t.texts=n.inputOptions.texts.template;t.callback={onSuccess:function(){frm.events.dispatch("messagetemplate:edit:done")}};u.IsSettingsListOpen(!1);i=u.SettingsTemplateView.GetPopUp(t);frm.models.GenericPopupViewModel.create(i).then(function(){i.Areas.Templates.SetTemplateCreateFromMessageViewModel()})};u.SettingsTemplateView.StartEditTemplate=function(){var t={texts:n.inputOptions.texts.template};u.IsSettingsListOpen(!1);u.SettingsTemplateView.Actions.getTemplates().then(function(n){u.SettingsTemplateView.TemplateList(n.data);t.templates=u.SettingsTemplateView.TemplateList();var i=u.SettingsTemplateView.GetPopUp(t);frm.models.GenericPopupViewModel.create(i).then(function(){i.Areas.Templates.SetEditTemplateViewModel()})})};window.addEventListener("popstate",function(){var t=location.pathname,i=t.replace(n.rootPath,"");h.changePath(i.substring(1),!1)},!1);i.addListener("thread:removed",function(n){var t=u.CurrentView(),i={"thread-viewing":function(){u.CurrentView().model.ThreadId===n}};t!==null&&i.hasOwnProperty(t.name)&&i[t.name]()});i.addListener("thread:setthreadview",function(n){n!==undefined?u.redirect("/"+n.ThreadId):ModelHandler.detachThread()});frm.events.addListener("chat:message:received",function(n){var t={thread:n.ThreadListItem,threadId:n.ThreadListItem.ThreadId,categoryId:n.ThreadListItem.CategoryId,newMessage:!0,type:2};n.ThreadListItem.NumberOfUnread==1&&n.ThreadListItem.CanRead&&u.ListUpdate(t)});i.addListener("thread:updateUnreads",function(n,t,i){var r=ko.utils.arrayFirst(u.ThreadListView.Model().Threads(),function(t){return t.ThreadId===n}),f;r!==null&&r!==undefined&&(f={thread:r,threadId:r.ThreadId,categoryId:r.CategoryId(),newMessage:!1,type:t},r.CanRead&&(i===null&&u.ListUpdate(f),i!==null&&i!==undefined&&r.IsUnread()&&u.ListUpdate(f)))});u.ListUpdate=function(n){if(n.categoryId>0&&n.categoryId!=undefined&&n.categoryId!=null){var t=ko.utils.arrayFirst(u.ThreadCategories(),function(t){return t.Id===n.categoryId});t!=undefined&&t!=null?(n.type==1&&(t.UnreadMessages(t.UnreadMessages()-1),u.UpdateListUnread(n.type)),n.type==2&&(t.UnreadMessages(t.UnreadMessages()+1),u.UpdateListUnread(n.type))):(n.type==1||n.type==2)&&u.UpdateInboxUnread(n.type)}else(n.type==1||n.type==2)&&u.UpdateInboxUnread(n.type)};i.addListener("thread:gladitor:succes",function(){u.MoveType(r.moveType);u.MoveSuccessful(!0)});i.addListener("thread:gladitor:succesdone",function(){setTimeout(function(){u.MoveSuccessful(!1)},1500)});i.addListener("thread:detachThread",function(){setTimeout(function(){u.redirect("/")},1500)});n.threads.length>0&&u.HasThreads(!0);r.listIds={yesId:n.yesListId,maybeId:n.maybeListId,noListId:n.noListId}}var i=new frm.events.Reactor,f=undefined,r={ActiveThread:undefined,listIds:{},moveType:0,isMobile:function(){return $(window).width()<=767?!0:!1}};ModelHandler={removeThread:function(n,t){t&&frm.events.dispatch("chat:thread:removed",{ThreadId:n});frm.services.MessageService.setThreadDeleted(n);i.dispatch("thread:removed",n)},removeThreadFromList:function(n,t){i.dispatch("thread:removedFromList",n);t===!0?ModelHandler.gladiator.moved():ModelHandler.detachThread()},reactivateThread:function(n){frm.services.MessageService.setThreadReactivated(n);i.dispatch("thread:reactivate",n)},readThread:function(n,t){(t===6||r.ActiveThread===n)&&(i.dispatch("thread:updateUnreads",n,1,t),frm.events.dispatch("chat:message:read",{ThreadId:n}),window.CONNECTION_ESTABLISHED.$promise.done(function(){return $.connection.NotificationHub.server.readChatMessage({ThreadId:n,ViewedType:t})}),i.dispatch("thread:viewed",n))},unreadThread:function(n){r.ActiveThread===n&&(i.dispatch("thread:updateUnreads",n,2,null),frm.events.dispatch("chat:message:remove:read",{ThreadId:n}),frm.services.MessageService.setThreadUnreadMark(n),i.dispatch("thread:unviewed",n))},setThreadActive:function(n){n!=""&&(i.dispatch("thread:active",n),r.ActiveThread=n)},detachThread:function(){i.dispatch("thread:detachThread")},gladiator:{moved:function(){i.dispatch("thread:gladitor:moved")},setSuccessfull:function(){i.dispatch("thread:gladitor:succes")},setSuccessfullDone:function(){i.dispatch("thread:gladitor:succesdone")},setThreadView:function(n){i.dispatch("thread:setthreadview",n)},moveNext:function(n){ModelHandler.gladiator.setThreadView(n)}}};var e=function(n,t,r){var f=this,s={archived:frm.services.MessageService.findArchivedThreads,inbox:frm.services.MessageService.findThreads,customList:frm.services.MessageService.findThreadsByCategory},o=1,e=ko.observableArray(ko.utils.arrayMap(n,function(n){return new u(n)}));f.Threads=ko.computed(function(){return ko.utils.arrayFilter(e(),function(n){return n.Priority()<=0})});f.CategoryId=ko.observable(r);f.IsLastPage=ko.observable(!1);f.ActiveThread=ko.observable(null);f.FetchingData=ko.observable(!1);f.OtherThreads=ko.computed(function(){return ko.utils.arrayFilter(e(),function(n){return n.Priority()>0})});f.HandleBottomReach=function(){f.IsLastPage()||(f.FetchingData(!0),o++,f.CategoryId()!=undefined&&f.CategoryId()>0?frm.services.MessageService.findThreadsByCategory(o,f.CategoryId()).then(function(n){n.data.length==0?f.IsLastPage(!0):ko.utils.arrayPushAll(e,ko.utils.arrayMap(n.data,function(n){return new u(n)}));f.FetchingData(!1)}):s[t](o).then(function(n){n.data.length==0?f.IsLastPage(!0):ko.utils.arrayPushAll(e,ko.utils.arrayMap(n.data,function(n){return new u(n)}));f.FetchingData(!1)}))};i.addListener("thread:removed",function(n){e.remove(ko.utils.arrayFirst(e(),function(t){return t.ThreadId===n}));f.HandleBottomReach()});i.addListener("thread:removedFromList",function(n){e.remove(ko.utils.arrayFirst(e(),function(t){return t.ThreadId===n}));f.HandleBottomReach()});i.addListener("thread:reactivate",function(n){e.remove(ko.utils.arrayFirst(e(),function(t){return t.ThreadId===n}))});i.addListener("thread:active",function(n){f.ActiveThread()!==n&&f.ActiveThread(n)});i.addListener("thread:viewed",function(n){var t=ko.utils.arrayFirst(e(),function(t){return t.ThreadId===n});typeof t!="undefined"&&t!==null&&(t.NumberOfUnread(0),t.IsUnread(!1))});i.addListener("thread:unviewed",function(n){var t=ko.utils.arrayFirst(e(),function(t){return t.ThreadId===n});typeof t!="undefined"&&t!==null&&t.IsUnread(!0)});frm.events.addListener("chat:message:received",function(n){var o=f.CategoryId(),i=n,r=ko.utils.arrayFirst(e(),function(n){return n.ThreadId===i.ThreadId});App.settings.account.userType==0?r===null?t!=="archived"&&(o==i.ThreadListItem.CategoryId?e.push(new u(i.ThreadListItem)):t=="inbox"&&o==0&&i.ThreadListItem.CategoryId==null&&e.push(new u(i.ThreadListItem))):t!=="archived"?o==i.ThreadListItem.CategoryId?e.replace(r,new u(i.ThreadListItem)):t=="inbox"&&i.ThreadListItem.CategoryId==null&&e.replace(r,new u(i.ThreadListItem)):e.remove(r):r===null?t==="inbox"&&e.push(new u(n.ThreadListItem)):t==="inbox"?e.replace(r,new u(n.ThreadListItem)):e.remove(r);e.sort(function(n,t){return new Date(t.LastMessage().TimeCreated)-new Date(n.LastMessage().TimeCreated)})});i.addListener("thread:gladitor:moved",function(){f.HandleBottomReach();var n=e()[0];ModelHandler.gladiator.setThreadView(n)});f.Dispose=function(){i.removeListener("thread:gladitor:moved")}},u=function(n){var t=this;(function(){for(var i in n)if(n.hasOwnProperty(i)){if(i==="ThreadId"){t[i]=n[i];continue}t[i]=Object.prototype.toString.call(n[i])==="[object Array]"?ko.observableArray(n[i]):ko.observable(n[i])}})();t.IsActive=ko.observable(!1);t.ContainsLockedParticipant=ko.observable(!1);t.ContainsDeletedParticipant=ko.observable(!1);t.SettingsOpen=ko.observable(!1);t.IsAuthorized=n.IsAuthorized;t.CanRead=n.CanRead;t.ToggleThreadSettings=function(){t.SettingsOpen(!t.SettingsOpen())};t.DeleteThread=function(){ModelHandler.removeThread(t.ThreadId,t.IsUnread());t.ToggleThreadSettings()};t.ReactivateThread=function(){ModelHandler.reactivateThread(t.ThreadId);t.ToggleThreadSettings()};t.MarkUnread=function(){ModelHandler.unreadThread(t.ThreadId);t.ToggleThreadSettings()};t.MarkRead=function(){ModelHandler.readThread(t.ThreadId,3);t.ToggleThreadSettings()};ko.utils.arrayFirst(n.Participants,function(n){n.IsLocked===!0&&t.ContainsLockedParticipant(!0)});ko.utils.arrayFirst(n.Participants,function(n){n.IsDeleted===!0&&t.ContainsDeletedParticipant(!0)})},s=function(n,t,i){var r=this;r.MessageScrollPositionDiffTracker=ko.observable(undefined);r.MessageInputOptions={inputOptions:{categoryId:i,isMessagingDisabled:!1,isCategoryBulkMessage:!0,senderAccountId:App.settings.account.id,isLoggedIn:!0,callBacks:{onSuccessSend:function(){n.endBulkActionView(!0)},onFailureSend:function(){n.ThreadListView.IsLoading(!1)}},preCallBacks:{onPreSend:function(){n.ThreadListView.IsLoading(!0)}},texts:t.inputOptions.texts},autoGrowOptions:{maxHeight:40,wrapper:".conversation-form",onReset:function(n){MessageScrollPositionDiffTracker({event:"RESET",height:n})},onChanged:function(n,t){MessageScrollPositionDiffTracker({height:n,diff:t})}},templateOptions:{texts:t.inputOptions.texts.template}}};o.ThreadViewingViewModel=function(n){function u(n){if(r.ActiveThread===n.ThreadId&&t.ThreadId===n.ThreadId){var i=n.Message;i.ViewedBy=ko.observableArray();t.Messages.push(i);n.Message.Participant.AccountId!==App.settings.account.id&&i.CanRead&&ModelHandler.readThread(t.ThreadId,4);t.IsArchived(!1);i.CanRead&&ModelHandler.readThread(n.ThreadId,4)}}function h(n){t.ThreadId===n.ThreadId&&ko.utils.arrayForEach(t.Messages(),function(i){var r=ko.utils.arrayFirst(i.ViewedBy(),function(t){return t.Id===n.ParticipantId}),u;(typeof r=="undefined"||r===null)&&(u=ko.utils.arrayFirst(t.Participants(),function(t){return t.Id==n.ParticipantId}),i.ViewedBy.push(u))})}var t=this,o=n.timestamp,e=1,s={removeThread:function(){ModelHandler.removeThread(t.ThreadId,!t.ThreadIsRead())}};t.ThreadId=n.threadId;t.ThreadIsRead=ko.observable(!0);t.ThreadProfileView=n.thread.Accounts[0];t.Messages=ko.observableArray(ko.utils.arrayMap(n.thread.Messages,function(t){return t.ViewedBy=ko.observableArray(ko.utils.arrayMap(t.ViewedBy,function(t){return ko.utils.arrayFirst(n.thread.Participants,function(n){return n.Id==t})})),t}));t.Participants=ko.observable(n.thread.Participants);t.CurrentParticipant=ko.utils.arrayFilter(t.Participants(),function(n){return n.AccountId===App.settings.account.id})[0];t.OtherParticipants=ko.computed(function(){return ko.utils.arrayFilter(t.Participants(),function(n){return n.AccountId!==App.settings.account.id})});t.LockedParticipants=ko.computed(function(){return ko.utils.arrayFilter(t.OtherParticipants(),function(n){return n.IsLocked})});t.DeletedParticipants=ko.computed(function(){return ko.utils.arrayFilter(t.OtherParticipants(),function(n){return n.IsDeleted})});t.IsLocked=ko.computed(function(){return t.OtherParticipants().length===t.LockedParticipants().length});t.IsClosedDueToDeletedParticipants=ko.computed(function(){return t.OtherParticipants().length===t.DeletedParticipants().length});t.Form={IsLoading:ko.observable(!1),Message:ko.observable("")};t.Form.IsDisabled=ko.computed(function(){return t.IsLocked()||t.IsClosedDueToDeletedParticipants()||t.Form.IsLoading()||!n.thread.IsAuthorized&&n.thread.CanRead});t.IsMobile=ko.observable(!1);t.IsAuthorized=n.thread.IsAuthorized;t.CanRead=n.thread.CanRead;t.IsArchived=ko.observable(n.pageType=="archived");t.Category=ko.observable(n.category);t.PageType=ko.observable(n.pageType);t.IsSettingsOpen=ko.observable(!1);t.IsProfileViewOpen=ko.observable(!1);t.IsListSelectionOpen=ko.observable(!1);t.IsMobileListSelectionOpen=ko.observable(!1);t.IsChatOpen=ko.observable(!0);t.ScrollPerserver=ko.observable();t.IsRendered=ko.observable(!1).extend({notify:"always"});t.MessageScrollPositionDiffTracker=ko.observable(undefined);t.IsFailed=ko.observable(!1);t.onAfter=function(){setTimeout(function(){t.IsRendered(!0)},20)};t.FetchingMessages=ko.observable(!1);t.LastPage=ko.observable(!1);t.ShowPaymentOverlay=ko.observable(!1||!n.thread.IsAuthorized&&n.thread.CanRead&&!App.settings.account.isPayingMember);t.MessageInputOptions={inputOptions:{threadId:t.ThreadId,isMessagingDisabled:t.IsLocked()||t.IsClosedDueToDeletedParticipants()||!n.thread.IsAuthorized,isLoggedIn:!0,callBacks:{onSuccessSend:function(){t.IsFailed(!1)},onFailureSend:function(){t.IsFailed(!0)}},texts:f.inputOptions.texts},autoGrowOptions:{maxHeight:40,wrapper:".conversation-form",onReset:function(n){MessageScrollPositionDiffTracker({event:"RESET",height:n})},onChanged:function(n,t){MessageScrollPositionDiffTracker({height:n,diff:t})}},templateOptions:{texts:f.inputOptions.texts.template}};t.TriggerPayment=function(){frm.utils.PaymentUrlHelper(matchMessageCenterPopupBuilder,f.paymentUrl+"?returnUrl="+location.pathname)};t.ToggleList=function(){t.IsListSelectionOpen(!t.IsListSelectionOpen())};t.AssignToList=function(i,r){var u=n.threadId,e=t.CurrentParticipant.Id,f=i.Id,o=t.IsArchived();u!=undefined&&e!=undefined&&f!=undefined&&(f!=n.category?frm.services.MessageService.assignThreadToCategory(u,e,f).then(function(){if(o)ModelHandler.reactivateThread(u);else{var n=!0;t.IsMobile()===!0&&(n=!1);r===!0?(ModelHandler.gladiator.setSuccessfull(),setTimeout(function(){ModelHandler.removeThreadFromList(u,n)},500)):ModelHandler.removeThreadFromList(u,n)}}):console.log("ERROR"),t.IsListSelectionOpen(!1),t.IsMobileListSelectionOpen()==!0&&t.SetChatView())};t.GladiatorSelection=function(n){n===r.listIds.yesId&&(r.moveType=1);n===r.listIds.maybeId&&(r.moveType=2);n===r.listIds.noListId&&(r.moveType=3);t.AssignToList({Id:n},!0,!0)};t.MoveToInbox=function(){var i=n.threadId,r=t.CurrentParticipant.Id,u=n.category,f=t.IsArchived();i!=undefined&&r!=undefined&&u!=undefined?t.PageType()!="inbox"&&frm.services.MessageService.removeThreadFromCategory(i,r).then(function(){var n=!0;t.IsMobile()===!0&&(n=!1);f?ModelHandler.reactivateThread(i,!0):ModelHandler.removeThreadFromList(i,n)}):console.log("ERROR");t.IsListSelectionOpen(!1);t.IsMobileListSelectionOpen()==!0&&t.SetChatView()};t.ToggleSettings=function(){var n=!t.IsSettingsOpen();t.IsSettingsOpen(n);n==!1?t.SetChatView():(t.IsProfileViewOpen(!1),t.IsChatOpen(!1))};t.ToggleProfileView=function(){var n=!t.IsProfileViewOpen();t.IsProfileViewOpen(n);n==!1?t.SetChatView():(t.IsSettingsOpen(!1),t.IsChatOpen(!1))};t.ToggleMobileList=function(){var n=!t.IsMobileListSelectionOpen();t.IsMobileListSelectionOpen(n);n==!1?t.SetChatView():(t.IsSettingsOpen(!1),t.IsChatOpen(!1))};t.SetChatView=function(){t.IsProfileViewOpen(!1);t.IsSettingsOpen(!1);t.IsMobileListSelectionOpen(!1);t.IsListSelectionOpen(!1);t.IsChatOpen(!0)};t.HandleTopReach=function(){t.LastPage()||(e++,t.FetchingMessages(!0),t.ScrollPerserver(ko.bindingHandlers.slimScroll.PerserveScrollingEvents.PREPARE),frm.services.MessageService.requestThread(t.ThreadId,e,o).then(function(n){n.data.Messages.length==0?t.LastPage(!0):(t.Messages.unshift.apply(t.Messages,n.data.Messages),t.ScrollPerserver(ko.bindingHandlers.slimScroll.PerserveScrollingEvents.RESTORE));t.FetchingMessages(!1)}))};t.HandleSendAndRemoveMessage=function(){t.IsAuthorized&&t.HandleSendMessage(!0)};t.DesktopDeleteThread=function(){t.DeleteThread(!0)};t.DesktopReactiveThread=function(){t.ReactiveThread(!0)};t.DesktopMarkUnread=function(){t.MarkUnread(!0)};t.DesktopMarkRead=function(){t.MarkRead(!0)};t.DeleteThread=function(n){var i=n===!0?!0:!1;s.removeThread();t.IsArchived(!0);i==!1&&t.ToggleSettings()};t.ReactiveThread=function(n){var i=n===!0?!0:!1;ModelHandler.reactivateThread(t.ThreadId);t.IsArchived(!1);i==!1&&t.ToggleSettings()};t.MarkUnread=function(n){var i=n===!0?!0:!1;ModelHandler.unreadThread(t.ThreadId);t.ThreadIsRead(!1);i==!1&&t.ToggleSettings()};t.MarkRead=function(n){var i=n===!0?!0:!1;ModelHandler.readThread(t.ThreadId,3);t.ThreadIsRead(!0);i==!1&&t.ToggleSettings()};t.IsRendered.subscribe(function(){});frm.events.addListener("chat:message:received",u);frm.events.addListener("chat:message:participant:read",h);i.addListener("thread:removed",function(n){t.ThreadId===n&&t.IsArchived(!0)});i.addListener("thread:reactivate",function(n){t.ThreadId===n&&t.IsArchived(!1)});t.dispose=function(){frm.events.removeListener("chat:message:received",u);frm.events.removeListener("chat:message:participant:read",u);ModelHandler.gladiator.setSuccessfullDone()};$(window).resize(function(){r.isMobile()?t.IsMobile(!0):t.IsMobile(!1)});r.isMobile()&&t.IsMobile(!0)};frm.models.ThreadViewModel=o}(frm.services,frm.Router),function(n){var t=function(){var n=this,i=ko.observable(!1),t;n.CurrentView=ko.observable();n.Loading=ko.observable(!0);n.Areas={WithItemId:function(i){n.SetView("feedpartner-view-withItemId",new t.WithItemId(i))}};t={partials:{PartnerItemViewModel:function(n,t,i){var r=this,u={toggle:function(n,t,i,r){return frm.services.FeedPartnerService.toggle(n,t,i,r)}};r.RoomId=t;r.Type=i;r.Loading=ko.observable(!1),function(){for(var t in n)n.hasOwnProperty(t)&&(r[t]=Object.prototype.toString.call(n[t])==="[object Array]"?ko.observableArray(n[t]):ko.observable(n[t]))}();r.ToggleAssignment=function(){r.Loading(!0);var n=!r.IsAssigned();u.toggle(r.Id(),r.RoomId,n,r.Type).then(function(){r.IsAssigned(n);r.Loading(!1)})}}},WithItemId:function(n){var i=this;privates={get:function(n,t){return frm.services.FeedPartnerService.get(n,t)}};i.Partners=ko.observableArray([]);privates.get(n.itemId,n.type).then(function(r){ko.utils.arrayPushAll(i.Partners,ko.utils.arrayMap(r.data,function(i){return new t.partials.PartnerItemViewModel(i,n.itemId,n.type)}))})}};n.SetView=function(t,i){n.Loading(!0);setTimeout(function(){n.CurrentView({name:t,model:i});n.Loading(!1)},1e3)};frm.services.TemplateService.request("/misc/templates/feedpartner").then(function(){i(!0)})};n.FeedPartnerViewModel=t}(frm.models,frm.services),function(){frm.models.SuspiciousAccountViewModel=function(n){var t=this;t.Accounts=ko.observableArray(n.accounts);t.Actions={Accept:function(n){frm.services.accountService.Suspicious.accept(n.AccountId).then(function(){t.Accounts.remove(n)})},Reject:function(n){frm.services.accountService.Suspicious.reject(n.AccountId).then(function(){t.Accounts.remove(n)})}}}}(),function(){function n(n){var t=this,i;t.Model={IsApproved:ko.observable(),UseProfilePicture:ko.observable(),ForceAutogeneratedTagline:ko.observable(),UserTagline:ko.observable(),OverriddenTagline:ko.observable()};i=new frm.models.FeedPartnerViewModel;i.Areas.WithItemId({itemId:n.roomId,type:1});t.PartnerPanel=ko.observable(i.CurrentView);t.SaveChanges=function(){frm.services.accountService.approveFeed(n.accountId,ko.toJS(t.Model)).then(function(){alert("Gemt!")})};frm.services.accountService.getApproveFeedDetails(n.accountId).then(function(n){t.Model.IsApproved(n.IsApproved);t.Model.UseProfilePicture(n.UseProfilePicture);t.Model.ForceAutogeneratedTagline(n.ForceAutogeneratedTagline);t.Model.UserTagline(n.UserTagline);t.Model.OverriddenTagline(n.OverriddenTagline)})}function t(n){var t=this,i;t.RoomAccountId=n.roomAccountId;t.Logs=ko.observableArray([]);i={ItemId:t.RoomAccountId,MatchType:1,MatchCreationType:1};t.fetchLogs=function(){return $.ajax({url:"/Api/Web/MatchCenter/GetManualSendMatchesLog",type:"GET",data:{itemId:t.RoomAccountId,matchType:1}})};t.queueRoom=function(){return $.ajax({url:"/Api/Web/MatchCenter/ManualSendMatches",type:"POST",data:i})};t.QueueRoomForMatch=function(){t.queueRoom().then(function(){t.FetchLogs()})};t.FetchLogs=function(){t.fetchLogs().then(function(n){t.Logs(n.data)})};t.FetchLogs()}function i(n){var t=this;t.Model=new frm.models.HousingSettingsViewModel({data:{accountId:n.accountId,room:{data:n.room}}});t.Save=function(){t.Model.SaveChanges().then(function(){alert("Gemt!")})}}function r(n){var t=this;t.Transactions=ko.observableArray(n.transactions)}function u(n){var t=this;t.Model={StopMembership:ko.observable(!0),RemovePremium:ko.observable(!0),Amount:ko.observable().extend({required:!0}),Reason:ko.observable()};t.IsLoading=ko.observable(!1);t.Transaction=$.extend(n.transaction,{IsCredited:ko.observable(n.transaction.IsCredited)});t.SaveChanges=function(){if(t.Transaction.IsCredited()){alert("Transaktionen er allerede blevet kreditéret");return}var i=ko.toJS(t.Model),r=function(){t.Transaction.IsCredited(!0);alert("Beløbet er blevet overført tilbage")},u=function(){alert("Der skete en fejl..")};if(i.Amount>t.Transaction.TotalPrice){alert("Beløbet er større end produktet");return}t.IsLoading(!0);frm.services.PaymentService.credit($.extend({Id:t.Transaction.ItemId,PaymentType:t.Transaction.TransactionType,accountId:n.accountId},i)).then(r,u).then(function(){t.IsLoading(!1)})}}frm.models.ProfileAdministrationViewModel=function(f){var o=this,c=frm.services.TemplateService.request("/misc/templates/profile-administration"),e={changePage:function(n,t){c.then(function(){o.CurrentView({name:"ProfileAdminstrationTemplate$"+n,model:t})})},changePath:function(n,t){n.substring(0,1)==="/"&&(n=n.substring(1));s.redirect(n);t&&history.pushState({},"","/"+f.routing.basePath+n)}},s=new frm.Router({"":function(){e.changePage("default",{})},"approve-feed":function(){e.changePage("ApproveFeed",new n({accountId:f.accountId,roomId:f.roomIntId}))},transactions:function(){$.ajax({url:"/Api/Web/Transaction/FindByAccount",data:{accountId:f.accountId}}).then(function(n){e.changePage("Transactions",new r({transactions:n.data}))})},"transactions/credit/{transactionType}/{id}":function(n,t){$.ajax({url:"/Api/Web/Transaction/Find",data:{id:t,transactionType:n}}).then(function(n){e.changePage("Transactions/Credit",new u({transaction:n.data}))})},"manage/room":function(){$.ajax({url:"/Api/Web/Room/Find",data:{accountId:f.accountId}}).then(function(n){e.changePage("ManageRoom",new i({accountId:f.accountId,room:n}))})},match:function(){e.changePage("Match",new t({roomAccountId:f.accountId}))}}),h;o.CurrentView=ko.observable(null);o.Redirect=function(n){e.changePath(n,!0)};h=function(n){var t=this,i={invokeOffer:function(n,t,i){return frm.services.accountService.invokeOffer(n,t,i)}};t.HasAcceptedOffer=ko.observable(n.moneyBack.hasAccepted);t.HasInvoked=ko.observable(n.moneyBack.isInvoked);t.DisplayDoneText=ko.observable(n.moneyBack.isInvoked);t.InvokeOffer=function(){i.invokeOffer(n.moneyBack.moneyBackOfferId,n.accountId,n.moneyBack.productOrderId).then(function(){t.HasInvoked(!0);t.DisplayDoneText(!0)})}};o.MailSettings=new frm.models.MailSubscriptionViewModel(f);o.MoneyBackOffer=new h(f);window.addEventListener("popstate",function(){var n=location.pathname,t;n.lastIndexOf("/")!==n.length&&(n="/");t=n.replace(f.routing.basePath,"");e.changePath(t,!1)},!1);s.redirect(f.routing.startPath)}}();matchMessageCenterPopupBuilder=null,function(n,t){var i=new frm.events.Reactor,f={isMobile:function(){return $(window).width()<=767?!0:!1}},r={removeMatch:function(n,t){i.dispatch("match:unset");i.dispatch("match:removed",n);t&&r.selectNextMatch()},selectNextMatch:function(){i.dispatch("match:selectnext")},setMatchView:function(n){i.dispatch("match:setmatchview",n)},updateStatus:function(n,t){i.dispatch("match:updateStatus",n,t)},matchVerdict:{setSuccessfull:function(n){i.dispatch("match:gladitor:verdict:succes",n)},setSuccessfullDone:function(n){i.dispatch("match:gladitor:verdict:succes:done",n)}}},o=function(n){var r=this,o={fetch:function(){return $.ajax({url:"/Api/Webs/MatchCenter/GetMatches?accountId="+App.settings.account.id+"&pageIndex=1",type:"GET"})},fetchMatch:function(n){return $.ajax({url:"/Api/Web/MatchCenter/GetMatchById?matchId="+n,type:"GET"})},changePath:function(t,i){c.redirect(t);i&&history.pushState({},"","/"+n.rootPath+"/"+t)}},c=new t({"":function(){ko.utils.arrayForEach(r.MatchListView.Model().Matches(),function(n){n.Selected(!1)});r.CurrentMatchView.Model(undefined);r.CurrentMatchView.IsLoading(!1)},"{id}":function(t){o.fetchMatch(t).then(function(t){r.CurrentMatchView.Model(new e(t.data,n));r.CurrentMatchView.IsLoading(!1)})}}),h;r.UnreadMatches=ko.observable(n.unreadMatchesCount||0);r.VerdictSuccessful=ko.observable(!1);r.CurrentVerdict=ko.observable(undefined);r.IsMobile=ko.observable(!1);r.MatchListView={Model:ko.observable(),IsLoading:ko.observable(!1)};r.CurrentMatchView={Model:ko.observable(undefined),IsLoading:ko.observable(!1)};r.UpdateUnread=function(n){var t=0;n===1&&(t=r.UnreadMatches()-1);n===2&&(t=r.UnreadMatches()+1);t<0?r.UnreadMatches(0):r.UnreadMatches(t)};r._setCurrentMatchView=function(t){r.CurrentMatchView.IsLoading(!0);r.CurrentMatchView.Model(new e(t.matchData,n));ko.utils.arrayForEach(r.MatchListView.Model().Matches(),function(n){n.Id==t.matchId?(n.Selected(!0),n.IsNew(!1)):n.Selected(!1)});r.CurrentMatchView.IsLoading(!1)};r.SetCurrentMatchView=function(n){r.CurrentMatchView.IsLoading(!0);o.changePath(n.MatchId(),!0);ko.utils.arrayForEach(r.MatchListView.Model().Matches(),function(n){n.Selected(!1)});n.IsNew()&&r.UpdateUnread(1);n.Selected(!0);n.IsNew(!1)};r.UnsetCurrentMatchView=function(){o.changePath("",!0)};i.addListener("match:unset",function(){r.UnsetCurrentMatchView()});r.MatchListView.IsLoading(!0);h=ko.utils.arrayMap(n.matches,function(n){return new u(n)});r.MatchListView.Model(new s(h));r.MatchListView.IsLoading(!0);frm.events.addListener("matchmaking:match:received",function(n){r.MatchListView.Model().Matches!=undefined&&(r.MatchListView.Model().Matches.unshift(new u(n)),r.UpdateUnread(2))});i.addListener("match:gladitor:verdict:succes",function(n){r.CurrentVerdict(n);r.VerdictSuccessful(!0)});i.addListener("match:gladitor:verdict:succes:done",function(n){n==!0?r.VerdictSuccessful(!1):setTimeout(function(){r.VerdictSuccessful(!1)},1500)});i.addListener("match:setmatchview",function(n){r.IsMobile()||n!=undefined&&r.SetCurrentMatchView(n)});$(window).resize(function(){f.isMobile()?r.IsMobile(!0):r.IsMobile(!1)});f.isMobile()&&r.IsMobile(!0)},u=function(n){var t=this;t.Id=n.MatchId,function(){for(var i in n)n.hasOwnProperty(i)&&(t[i]=Object.prototype.toString.call(n[i])==="[object Array]"?ko.observableArray(n[i]):ko.observable(n[i]))}();t.Selected=ko.observable(!1);t.Status()==3&&t.IsNew(0)},s=function(n){privates={fetch:function(n){return $.ajax({url:"/Api/Web/MatchCenter/GetMatches?accountId="+App.settings.account.id+"&pageIndex="+n,type:"GET"})}};var t=this,f=1;t.Matches=ko.observableArray();t.IsLastPage=ko.observable(!1);t.FetchingData=ko.observable(!1);t.HandleBottomReach=function(){t.IsLastPage()||(t.FetchingData(!0),f=f+1,privates.fetch(f).then(function(n){n.data.length==0&&t.IsLastPage(!0);var i=ko.utils.arrayMap(n.data,function(n){return new u(n)});ko.utils.arrayPushAll(t.Matches,i);t.FetchingData(!1)}))};t.Matches(n);i.addListener("match:removed",function(n){var i=ko.utils.arrayFirst(t.Matches(),function(t){return t.Id==n});t.Matches.remove(i);t.HandleBottomReach()});i.addListener("match:selectnext",function(){t.HandleBottomReach();var n=ko.utils.arrayFirst(t.Matches(),function(n){if(0===n.Status())return n});n!=null&&n!=undefined&&r.setMatchView(n)});i.addListener("match:updateStatus",function(n,i){var r=ko.utils.arrayFirst(t.Matches(),function(t){return t.Id==n});r.Status(i)})},e=function(n,t){var i=this,u={setViewed:function(n){return $.ajax({url:"/Api/Web/MatchCenter/MatchViewed?matchId="+n,type:"POST"})},sendVerdict:function(n,t){return $.ajax({url:"/Api/Web/MatchCenter/AssignVerdict?matchId="+n+"&verdict="+t,type:"POST"})}};(function(){for(var t in n)n.hasOwnProperty(t)&&(i[t]=Object.prototype.toString.call(n[t])==="[object Array]"?ko.observableArray(n[t]):ko.observable(n[t]))})();i.ProfileViewData=n.ProfilePreview;i.ShowScrollIndicator=ko.observable(!0);i.HandleBottomReach=function(){i.ShowScrollIndicator(!1)};i.RemoveMatch=function(n){var t=2;r.matchVerdict.setSuccessfull(t);u.sendVerdict(n,t).then(function(){r.removeMatch(n,!0);r.matchVerdict.setSuccessfullDone(!1)})};i.RemoveFromDom=function(n){var t=ko.toJS(n);i.RemoveMatch(t.Id)};i.TriggerPayment=function(){frm.utils.PaymentUrlHelper(matchMessageCenterPopupBuilder,i.PaymentUrl())};i.Type()==1&&(i.InputAreaHeightTracker=ko.observable(undefined),i.ShowInput=ko.observable(!0),i.InputOptions={inputOptions:{recipientAccountId:n.ProfilePreview.AccountId,senderAccountId:App.settings.account.id,isMessagingDisabled:!App.settings.account.isPayingMember,isLoggedIn:!0,texts:t.inputOptions.texts,callBacks:{onSuccessSend:function(){var t=1;r.matchVerdict.setSuccessfull(t);u.sendVerdict(n.Id,t).then(function(){r.removeMatch(n.Id,!0);r.matchVerdict.setSuccessfullDone(!1)})},onFailureSend:function(){}}},autoGrowOptions:{maxHeight:40,wrapper:".action-area",onReset:function(n){InputAreaHeightTracker({event:"RESET",height:n})},onChanged:function(n,t){InputAreaHeightTracker({height:n,diff:t})}},templateOptions:{texts:t.inputOptions.texts.template},matchOptions:{texts:t.inputOptions.texts.match,matchId:n.Id,callBacks:{removeMatch:function(n){i.RemoveMatch(n)}}}},i.VerdictView=new function(){var t=this;t.isVisible=ko.observable(!0);t.Loading=ko.observable(!1);App.settings.account.isPayingMember||(t.isVisible(!1),i.ShowInput(!0));t.TriggerVerdict=function(f){t.isVisible(!1);i.ShowInput(!1);f==!1?i.RemoveMatch(n.Id):(t.Loading(!0),i.ShowInput(!0),u.sendVerdict(n.Id,3).then(function(){i.Status(1);r.updateStatus(n.Id,1)}),setTimeout(function(){t.Loading(!1)},1500))}},i.Status()!=0&&i.Status()==1&&(i.VerdictView.isVisible(!1),i.ShowInput(!0)),r.matchVerdict.setSuccessfullDone(!1));i.Type()==4&&(i.containerHeight=ko.observable(140),setTimeout(function(){var n=$(".action-area").height();i.containerHeight(n)},1e3));i.Type()==5&&(i.ShowScrollIndicator(!1),i.RemoveExternalRoomBundleMatch=function(){u.sendVerdict(n.Id,2).then(function(){r.removeMatch(n.Id,!0)})});u.setViewed(i.Id());i.IsViewed()===!1&&frm.events.dispatch("matchmaking:match:read")};frm.models.MatchViewModel=o}(frm.services,frm.Router),function(n,t){var i={VIEWNAME:{CHAT:"chat",MATCH:"match"},LOADBUFFER:{VIEWDELAY:700},triggerSearchAreaBar:function(){var n=$(".tenant-message-widget-container");n.show()}},r=function(n){var n,r=this;matchMessageCenterPopupBuilder=function(){return new frm.models.GenericPopupViewModel(n.popupOptionsObject)};var u=function(t){t.indexOf(n.chatOptions.rootPath)!==-1&&r._setChatView();t.indexOf(n.matchOptions.rootPath)!==-1&&r._setMatchView()},f=new t({"{route}":function(n){u(n)}}),e={changePath:function(n,t,i){t!=undefined?(f.redirect(n+"/"+t),i&&history.pushState({},"","/"+n+t)):(f.redirect(n),i&&history.pushState({},"","/"+n))}};r.ChatViewModel=undefined;r.MatchViewModel=undefined;r.MatchEnabled=ko.observable(!1);r.ComCenterLoading=ko.observable(!1);r.ComCenterActive=ko.observable(!1);r.CancelSubscribe=ko.observable(!1);r.CurrentView={ListView:ko.observable("Chat"),Name:ko.observable(),Model:ko.observable()};r.SetChatView=function(){r.CurrentView.Name()!==i.VIEWNAME.CHAT&&(r.ChatViewModel===undefined&&(r.ChatViewModel=new frm.models.ThreadViewModel(n.chatOptions)),r.SetView(i.VIEWNAME.CHAT,r.ChatViewModel),r.CurrentView.Model().redirect(""),e.changePath(n.chatOptions.rootPath,undefined,!0))};r.SetMatchView=function(){r.CurrentView.Name()!==i.VIEWNAME.MATCH&&r.MatchEnabled()&&(r.MatchViewModel===undefined&&(r.MatchViewModel=new frm.models.MatchViewModel(n.matchOptions)),r.SetView(i.VIEWNAME.MATCH,r.MatchViewModel),r.CurrentView.Model().UnsetCurrentMatchView(),e.changePath(n.matchOptions.rootPath,undefined,!0))};r._setChatView=function(){r.SetView(i.VIEWNAME.CHAT,r.ChatViewModel)};r._setMatchView=function(){r.MatchEnabled()?r.SetView(i.VIEWNAME.MATCH,r.MatchViewModel):r._setChatView()};r.ClearCurrentView=function(){r.CurrentView.Name(undefined);r.CurrentView.Model(undefined)};r.DeterminFirstView=function(){var e=window.location.href,f,t;u(e);r.CurrentView.Name()===i.VIEWNAME.CHAT&&(t=e.split("/"),t.length>4&&t.length>4&&t.length<8&&(f=n.chatOptions.currentThread,f!=undefined&&r.CurrentView.Model().setThreadView(f.threadId,f.threadData,f.threadView)));r.CurrentView.Name()===i.VIEWNAME.MATCH&&(t=e.split("/"),n.matchOptions.currentMatch!=undefined&&r.CurrentView.Model()._setCurrentMatchView(n.matchOptions.currentMatch))};r.SetView=function(t,u){r.ComCenterLoading(!0);r.ClearCurrentView();r.CurrentView.Name(t);r.GetListViewName(t);r.CurrentView.Model(u);setTimeout(function(){r.ComCenterLoading(!1)},i.LOADBUFFER.VIEWDELAY);t==="match"&&n.userInfo.missingSearchArea===!0&&i.triggerSearchAreaBar()};r.GetListViewName=function(n){r.CancelSubscribe(!0);n==="chat"&&r.CurrentView.ListView("Chat");n==="match"&&r.CurrentView.ListView("Match");r.CancelSubscribe(!1)};r.MatchEnabled(n.matchOptions.isEnabled);r.ChatViewModel=new frm.models.ThreadViewModel(n.chatOptions);r.MatchEnabled()&&(r.MatchViewModel=new frm.models.MatchViewModel(n.matchOptions));r.DeterminFirstView();r.CurrentView.ListView.subscribe(function(n){r.CancelSubscribe()||(n==="Chat"&&r.SetChatView(),n==="Match"&&r.SetMatchView())})};frm.models.ComCenterViewModel=r}(frm.services,frm.Router),function(n,t,i){function u(n){var e=n,u=this,t={changePage:function(n){u.IsLoading(!0);var t=n();typeof t!="undefined"?t.then(function(){u.IsLoading(!1)}):u.IsLoading(!1)},changePath:function(t,i){t.substring(0,1)==="/"&&(t=t.substring(1));f.redirect(t);i&&history.pushState({},"","/"+n.basePath+t)},setView:function(n,t){u.CurrentView({name:n,model:t})}},f=new i({"":function(){t.changePage(function(){t.setView("external-room-index",new r.externalRoom.IndexViewModel({rooms:[],pageIndex:0}))})},create:function(){t.changePage(function(){t.setView("external-room-create",new r.externalRoom.CreateViewModel({onSave:function(n){t.changePath("update/"+n.Id,!0)}}))})},"needs-manuel-attention":function(){t.changePage(function(){t.setView("external-room-needs-manuel-attention",new r.externalRoom.ManuelAttentionViewModel(e))})},"update/{id}":function(i){t.changePage(function(){return frm.services.RoomService.getExternalRoom(i).then(function(i){t.setView("external-room-update",new r.externalRoom.UpdateViewModel({room:i.data,options:n}))})})}});u.CurrentView=ko.observable();u.IsLoading=ko.observable(!1);u.redirect=function(n){t.changePath(n,!0)};window.addEventListener("popstate",function(){var t=location.pathname,i;t.lastIndexOf("/")!==t.length&&(t+="/");i=t.replace(n.basePath,"")},!1);f.redirect(n.startPath)}var r={externalRoom:function(){var n={RoomFormViewModel:function(n,t){var i=this,r=n.Location||{};i.CurrencyList=t.baseOptions.options.currencyList;i.RoomId=n.Id;i.Title=ko.observable(n.Title);i.Description=ko.observable(n.Description);i.CountryCode=ko.observable(n.CountryCode);i.Street=ko.observable(n.Street);i.HouseNumber=ko.observable(n.HouseNumber);i.CityName=ko.observable(n.CityName);i.ZipCode=ko.observable(n.ZipCode);i.Location={Latitude:ko.observable(r.Latitude),Longitude:ko.observable(r.Longitude)};i.Price=ko.observable(n.Price||0);i.ValutaId=ko.observable(n.ValutaId||1);i.Deposit=ko.observable(n.Deposit||0);i.Advance=ko.observable(n.Advance||0);i.FixedExpenses=ko.observable(n.FixedExpenses||0);i.Period=ko.observable(n.Period);i.NumberOfRooms=ko.observable(n.NumberOfRooms);i.Area=ko.observable(n.Area);i.Available=ko.observable((n.Available||{}).AvailableDate);i.IsActive=ko.observable(n.IsActive);i.AddressQuery=ko.observable();i.save=function(){t.onSave(ko.toJS(this))};i.onQueryChange=function(n){i.Street(n.street);i.HouseNumber(n.streetNumber);i.ZipCode(n.postalCode);i.CityName(n.locality);i.CountryCode(n.countryCode);i.Location.Latitude(n.location.lat);i.Location.Longitude(n.location.lng)}},ContactInformationFormViewModel:function(n,t){var i=this,r={isUpdating:function(n){return typeof n.Type!="undefined"&&typeof n.Value!="undefined"}};i.State=ko.observable(r.isUpdating(n)?"UPDATE":"INSERT");i.Type=ko.observable(n.Type);i.Value=ko.observable(n.Value);i.Save=function(){t.onSave(ko.toJS(this));i.Type("");i.Value("")};i.changeState=function(n,t){i.State(n);i.Type(t.Type);i.Value(t.Value)}},ContactInformationPanelViewModel:function(t){var i=this,r=ko.observable(t);i.ContactInformations=ko.computed(function(){var i=[],t=r(),n;for(n in t)t.hasOwnProperty(n)&&i.push({key:n,value:t[n]});return i});i.FormModel=new n.ContactInformationFormViewModel({},{onSave:function(n){var t=r();t[n.Type]=n.Value;r(t)}});i.Update=function(n){i.FormModel.changeState("UPDATE",{Type:n.key,Value:n.value})};i.Remove=function(n){var t=r();delete t[n.key];r(t)};i.Insert=function(){i.FormModel.changeState("INSERT",{Type:"",Value:""})}},ImagesPanelViewModel:function(n){var i=this;i.Images=ko.observableArray(n.Images);i.File=ko.observable();i.RoomId=n.Id;i.IsWaitingForImageProcess=ko.observable(!1);i.Remove=function(r){var u=r;i.Images.remove(r);t.RoomService.detachImage(n.Id,r.Id).then(undefined,function(){alert("Could not remove picture");i.Images.push(u)})};i.Validate=function(){return i.File()!==""};i.AfterSave=function(){i.IsWaitingForImageProcess(!0)}},PartnerPanelViewModel:function(i){var r=this;r.Partners=ko.observableArray();r.Loading=ko.observable(!0);t.RoomService.ExternalRoomPartner.getPartners(i).then(function(t){ko.utils.arrayPushAll(r.Partners,ko.utils.arrayMap(t.data,function(t){return new n.PartnerItemViewModel(t)}));r.Loading(!1)})},PartnerItemViewModel:function(n,t){var i=this;i.RoomId=t;i.Loading=ko.observable(!1),function(){for(var t in n)n.hasOwnProperty(t)&&(i[t]=Object.prototype.toString.call(n[t])==="[object Array]"?ko.observableArray(n[t]):ko.observable(n[t]))}();i.ToggleAssignment=function(){i.IsAssigned(!i.IsAssigned())}}};return{IndexViewModel:function(n){var t=this;t.Rooms=ko.observableArray(n.rooms);t.NextPage=function(){}},ManuelAttentionViewModel:function(n){var i=this;i.CountryList=ko.observableArray(n.countryList);i.CurrentCountry=ko.observable(null);i.Rooms=ko.observableArray();i.IsLoading=ko.observable(!1);i.Fetch=function(){i.IsLoading(!0);i.Rooms(undefined);t.RoomService.findWithAttentionRequired(i.CurrentCountry()).then(function(n){i.Rooms(n.data);i.IsLoading(!1)})}},CreateViewModel:function(i){var r=this,u={save:function(n,r){t.RoomService.createExternalRoom(n,r).then(function(n){if(typeof i!="undefined")i.onSave(n.data)})}};r.FormModel=new n.RoomFormViewModel({},{onSave:function(n){u.save(n,ko.toJS(r.ContactInformationPanel.ContactInformations))}});r.ContactInformationPanel=new n.ContactInformationPanelViewModel({})},UpdateViewModel:function(i){var r=this,f={save:function(n,r){return t.RoomService.updateExternalRoom(i.room.Id,n,r)}},u=new frm.models.FeedPartnerViewModel;u.Areas.WithItemId({itemId:i.room.Id,type:2});r.RoomId=i.room.Id;r.FormModel=new n.RoomFormViewModel(i.room,{onSave:function(n){r.IsImportEnded(!0);f.save(n,ko.toJS(r.ContactInformationPanel.ContactInformations)).then(undefined,function(){alert("Der skete en fejl");r.IsImportEnded(i.room.IsImportEnded)})},baseOptions:i});r.ManuelAttentionState=ko.observable(i.room.ManuelAttentionState);r.IsImportEnded=ko.observable(i.room.IsImportEnded);r.IsActive=ko.observable(i.room.IsActive);r.ContactInformationPanel=new n.ContactInformationPanelViewModel(i.room.ContactInformations);r.ImagesPanel=new n.ImagesPanelViewModel(i.room);r.PartnerPanel=ko.observable(u.CurrentView);r.MatchLogs=ko.observableArray(undefined);r.DeactivateRoom=function(){t.RoomService.deactivateRoom(i.room.Id).then(function(){r.IsImportEnded(!0);r.IsActive(!1)})};r.SendToMatch=function(){var n={ItemId:i.room.Id,MatchType:4,MatchCreationType:2};$.ajax({url:"/Api/Web/MatchCenter/ManualSendMatches",type:"POST",data:n}).then(function(){alert("The room is now sent to the match system!")})};r.fetchLogs=function(){return $.ajax({url:"/Api/Web/MatchCenter/GetManualSendMatchesLog",type:"GET",data:{itemId:i.room.Id,matchType:4}})};r.ActivateImport=function(){t.RoomService.activateImport(i.room.Id).then(function(){r.IsImportEnded(!1)})};r.ManuelApprove=function(){t.RoomService.manuelAttentionApprove(i.room.Id).then(function(){r.ManuelAttentionState(2)})};r.ManuelReject=function(){t.RoomService.manuelAttentionReject(i.room.Id).then(function(){r.ManuelAttentionState(3)})};r.fetchLogs().then(function(n){console.log(n.data);r.MatchLogs(n.data)})}}}()};n.ExternalRoomAdministrationModule=u}(frm.models,frm.services,frm.Router),function(n,t,i){function u(n){var u=this,f={changePage:function(n){u.IsLoading(!0);var t=n();typeof t!="undefined"?t.then(function(){u.IsLoading(!1)}):u.IsLoading(!1)},changePath:function(t,i){t.substring(0,1)==="/"&&(t=t.substring(1));e.redirect(t);i&&history.pushState({},"","/"+n.basePath+t)},setView:function(n,t){u.CurrentView({name:n,model:t})}},e=new i({"":function(){f.changePage(function(){return t.PropertyService.findProperties().then(function(n){f.setView("external-property-index",new r.externalProperty.IndexViewModel({properties:n.data}))})})},"update/{id}":function(t){f.changePage(function(){return frm.services.PropertyService.getProperty(t).then(function(t){f.setView("external-property-update",new r.externalProperty.UpdateViewModel({property:t.data,currencyList:n.currencyList}))})})}});u.CurrentView=ko.observable();u.IsLoading=ko.observable(!1);u.redirect=function(n){f.changePath(n,!0)};window.addEventListener("popstate",function(){var t=location.pathname,i;t.lastIndexOf("/")!==t.length&&(t+="/");i=t.replace(n.basePath,"");f.changePath(i,!1)},!1);e.redirect(n.startPath)}var r={externalProperty:function(){var n={PropertyFormViewModel:function(n,t){var i=this,r=n.Location||{};i.Title=ko.observable(n.Title);i.Description=ko.observable(n.Description);i.ExternalUrl=ko.observable(n.ExternalUrl);i.Active=ko.observable(n.Active);i.IsRented=ko.observable(n.IsRented);i.IsReserved=ko.observable(n.IsReserved);i.Address=ko.observable(n.Address||null);i.CountryCode=ko.observable(n.CountryCode);i.Street=ko.observable(n.Street);i.HouseNumber=ko.observable(n.HouseNumber);i.CityName=ko.observable(n.City);i.ZipCode=ko.observable(n.ZipCode);i.Location={Latitude:ko.observable(r.Latitude),Longitude:ko.observable(r.Longitude)};i.Rent=ko.observable(n.Rent||0);i.Deposit=ko.observable(n.Deposit||0);i.Advance=ko.observable(n.Advance||0);i.Usage=ko.observable(n.Usage||0);i.ValutaId=ko.observable(n.ValutaId);i.CurrencyList=ko.observableArray(t.currencyList);i.Period=ko.observable(n.Period);i.Bedrooms=ko.observable(n.Bedrooms);i.Area=ko.observable(n.Area);i.Available=ko.observable(n.Available);i.Pets=ko.observable(n.Pets);i.Furnished=ko.observable(n.Furnished);i.AddressQuery=ko.observable();i.save=function(){t.onSave(ko.toJS(this))};i.onQueryChange=function(n){if(n.type!=="street_address"){alert("Ikke én gyldig adresse");return}i.Address(n.address);i.Street(n.street);i.HouseNumber(n.streetNumber);i.ZipCode(n.postalCode);i.CityName(n.locality);i.CountryCode(n.countryCode);i.Location.Latitude(n.location.lat);i.Location.Longitude(n.location.lng)}},ContactInformationFormViewModel:function(n,t){var i=this,r={isUpdating:function(n){return typeof n.Type!="undefined"&&typeof n.Value!="undefined"}};i.State=ko.observable(r.isUpdating(n)?"UPDATE":"INSERT");i.Type=ko.observable(n.Type);i.Value=ko.observable(n.Value);i.Save=function(){t.onSave(ko.toJS(this));i.Type("");i.Value("")};i.changeState=function(n,t){i.State(n);i.Type(t.Type);i.Value(t.Value)}},ContactInformationPanelViewModel:function(t){var i=this,r=ko.observable(t);i.ContactInformations=ko.computed(function(){var i=[],t=r(),n;for(n in t)t.hasOwnProperty(n)&&i.push({key:n,value:t[n]});return i});i.FormModel=new n.ContactInformationFormViewModel({},{onSave:function(n){var t=r();t[n.Type]=n.Value;r(t)}});i.Update=function(n){i.FormModel.changeState("UPDATE",{Type:n.key,Value:n.value})};i.Remove=function(n){var t=r();delete t[n.key];r(t)};i.Insert=function(){i.FormModel.changeState("INSERT",{Type:"",Value:""})}},ImagesPanelViewModel:function(n){var i=this;i.Images=ko.observableArray(n.Images);i.File=ko.observable();i.RoomId=n.Id;i.IsWaitingForImageProcess=ko.observable(!1);i.Remove=function(r){var u=r;i.Images.remove(r);t.PropertyService.detachImage(n.Id,r.Id).then(undefined,function(){alert("Could not remove picture");i.Images.push(u)})};i.Validate=function(){return i.File()!==""};i.AfterSave=function(){i.IsWaitingForImageProcess(!0)}}};return{IndexViewModel:function(n){var t=this;t.Properties=ko.observableArray(n.properties)},UpdateViewModel:function(i){var r=this,u={save:function(n){return t.PropertyService.updateProperty(i.property.Id,n)}};r.PropertyId=i.property.Id;r.FormModel=new n.PropertyFormViewModel(i.property,{currencyList:i.currencyList,onSave:function(n){r.IsImportEnded(!0);u.save(n).then(undefined,function(){alert("Der skete en fejl");r.IsImportEnded(i.property.IsImportEnded)})}});r.IsImportEnded=ko.observable(i.property.IsImportEnded);r.ImagesPanel=new n.ImagesPanelViewModel(i.property);r.ActivateImport=function(){t.PropertyService.activateImport(i.property.Id).then(function(){r.IsImportEnded(!1)})}}}}()};n.PropertyAdministrationViewModel=u}(frm.models,frm.services,frm.Router);frm.services.initApi=function(){this.apiUrl=$("input#apiurl").val()};frm.services.getResult=function(n,t,i,r){i=i||this.apiUrl;$.ajax({type:"POST",url:i+"/"+n,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(t||{}),success:function(n){var t=JSON.parse(n.d);r&&r(t)},error:function(){}})};frm.services.getAjaxResult=function(n,t){return $.get(n,null,t)};frm.services.login=function(n,t){this.getResult("Login",{model:n},"/API/V2/UserService.asmx",t)};frm.services.logout=function(n){this.getResult("Logout",{},"/API/V2/UserService.asmx",n)};frm.services.getTopMenu=function(n){return this.getAjaxResult("/Pages/V2/Ajax/TopMenuHost.aspx",n)};frm.services.profile.getSliderDeck=function(n,t,i,r){var u="/Pages/V2/Ajax/SliderDeckHost.aspx?page="+n+"&count="+t+"&key="+i;$.get(u,r)},function(n){var t=function(){this.supportLocalStorage=typeof Storage!="undefined"};t.prototype.read=function(n){if(!this.supportLocalStorage)return alert("Your browser do not support localStorage and we are not able to save. Please upgrade to at least IE9"),undefined;var t=localStorage[n];return typeof t!="undefined"&&t!=null&&t.length>0?JSON.parse(t):undefined};t.prototype.create=function(n,t){try{if(!this.supportLocalStorage){alert("Your browser do not support localStorage and we are not able to save. Please upgrade to at least IE9");return}localStorage.setItem(n,JSON.stringify(t))}catch(i){console.warn("Your browser properbly support localStorage but there were a error when trying to save data")}};n.StorageService=new t}(frm.services),function(n){n.SiteService={findAll:function(){return $.ajax({url:"/Api/Web/Site/GetSites",type:"GET"})},findRootSites:function(){return $.ajax({url:"/Api/Web/Site/GetRootSites",type:"GET"})},getParentSites:function(){return $.ajax({url:"/Api/Web/Site/GetParentSites",type:"GET"})}}}(frm.services),function(n){n.EbookSubscriberService={addEmail:function(n){return $.ajax({url:"/Api/Web/EbookSubscriber/AddEmail",type:"GET",data:{email:n}})}}}(frm.services),function(n){n.CurrencyService={get:function(){return $.ajax({url:"/Api/Web/Currency/Get",type:"GET"})}}}(frm.services),function(n){n.WallService={get:function(n,t){return $.ajax({url:"/Api/Web/Wall/Get?PageIndex="+n,type:"GET",data:{Filter:t}})},getAll:function(n){return $.ajax({url:"/Api/Web/Wall/GetAll?pageIndex="+n,type:"GET"})},getTop:function(n){return $.ajax({url:"/Api/Web/Wall/GetTopNewest?top="+n,type:"GET"})},getFavorite:function(n){return $.ajax({url:"/Api/Web/Wall/GetFavorite?pageIndex="+n,type:"GET"})},getOwn:function(n){return $.ajax({url:"/Api/Web/Wall/GetOwn?pageIndex="+n,type:"GET"})},addToFavorite:function(n){return $.ajax({url:"/Api/Web/Wall/AddToFavorite?wallPostId="+n,type:"POST"})},removeFromFavorite:function(n){return $.ajax({url:"/Api/Web/Wall/RemoveFromFavorite?wallPostId="+n,type:"POST"})},create:function(n){return $.ajax({url:"/Api/Web/Wall/Create",type:"POST",data:n})},edit:function(n){return $.ajax({url:"/Api/Web/Wall/Edit",type:"POST",data:n})},deletePost:function(n){return $.ajax({url:"/Api/Web/Wall/DeletePost?wallPostId="+n,type:"POST"})},deleteAttachment:function(n){return $.ajax({url:"/Api/Web/Wall/DeleteAttachment?attachmentId="+n.Id+"&attachmentType="+n.Type+"",type:"POST"})},deletePostAdmin:function(n){return $.ajax({url:"/Api/Web/Wall/AdminDeletePost",type:"POST",data:n})},editAdmin:function(n){return $.ajax({url:"/Api/Web/Wall/AdminEdit",type:"POST",data:n})},requestTemplates:function(){return n.TemplateService.request("/misc/templates/wall")}}}(frm.services),function(n){n.TenantEndorsementService={addTenantEndorsement:function(n){return $.ajax({url:"/Api/Web/TenantEndorsement/AddTenantEndorsement?accountId="+n,type:"POST"})},addTenantEndorsementComment:function(n){return $.ajax({url:"/Api/Web/TenantEndorsement/AddTenantEndorsementComment",type:"POST",data:n})},deleteTenantEndorsementComment:function(n){return $.ajax({url:"/Api/Web/TenantEndorsement/DeleteTenantEndorsementComment?commentId="+n,type:"POST"})},pinTenantEndorsementComment:function(n){return $.ajax({url:"/Api/Web/TenantEndorsement/PinTenantEndorsementComment?commentId="+n,type:"POST"})},unPinTenantEndorsementComment:function(n){return $.ajax({url:"/Api/Web/TenantEndorsement/UnPinTenantEndorsementComment?commentId="+n,type:"POST"})},getPagedTenantEndorsementComment:function(n){return $.ajax({url:"/Api/Web/TenantEndorsement/GetPagedTenantEndorsementComment?page="+n,type:"GET"})},activateTenantEndorsementComment:function(n){return $.ajax({url:"/Api/Web/TenantEndorsement/ActivateTenantEndorsementComment?commentId="+n,type:"POST"})}}}(frm.services),function(n){n.PaymentActionService={create:function(n){return $.ajax({url:"/Api/Web/PaymentAction/Create",type:"POST",data:n})},Invoke:function(){return $.ajax({url:"/Api/Web/PaymentAction/Create",type:"GET"})}}}(frm.services),function(n){n.RoommateMatchWidgetService={getRoommateMatches:function(){return $.ajax({url:"/Api/Web/RoommateMatch/GetRoommateMatches",type:"GET"})},getPropertyMatches:function(n){return $.ajax({url:"/Api/Web/RoommateMatch/GetPropertyMatches?top="+n,type:"GET"})}}}(frm.services),function(n){n.DashboardService={getTodoList:function(){return $.ajax({url:"/Api/Web/Dashboard/GetTodoList",type:"GET"})}}}(frm.services),function(n){n.MailSubscriptionService={getSettings:function(n){return $.ajax({url:"/Api/Web/MailSubscription/GetSettingByAccount?accountId="+n,type:"GET"})},updateSetting:function(n,t){return $.ajax({url:"/Api/Web/MailSubscription/UpdateSetting?accountId="+t,type:"POST",data:n})},deactiveAllSettings:function(n){return $.ajax({url:"/Api/Web/MailSubscription/DeactiveAllSettings?accountId="+n,type:"POST"})}}}(frm.services),function(n){n.PhoneSubscriptionService={getSettings:function(n){return $.ajax({url:"/Api/Web/PhoneSubscription/GetSettingByAccount?accountId="+n,type:"GET"})},updateSetting:function(n,t){return $.ajax({url:"/Api/Web/PhoneSubscription/UpdateSetting?accountId="+t,type:"POST",data:n})},deactiveAllSettings:function(n){return $.ajax({url:"/Api/Web/PhoneSubscription/DeactiveAllSettings?accountId="+n,type:"POST"})}}}(frm.services),function(n){n.CommentService={fetchComments:function(n,t,i,r){return $.ajax({url:"/Api/Web/Comment/GetComments",type:"GET",data:{objectId:n,commentType:t,currentPage:i,commentId:r}})},fetchReplies:function(n,t){return $.ajax({url:"/Api/Web/Comment/GetReplies",type:"GET",data:{parentId:n,currentPage:t}})},addComment:function(n,t,i){return $.ajax({url:"/Api/Web/Comment/AddComment",type:"GET",data:{model:n,commentType:t,currentPage:i}})},deleteComment:function(n,t,i,r){return $.ajax({url:"/Api/Web/Comment/DeleteComment",type:"Get",data:{model:n,commentType:t,objectId:i,currentPage:r}})}}}(frm.services);frm.services.tenant.SearchAreaService=function(n){this.apiUrl=n};frm.services.tenant.SearchAreaService.prototype.getSearchAreas=function(n){frm.services.getResult("GetAll",{},this.apiUrl,n)};frm.services.tenant.SearchAreaService.prototype.addArea=function(n,t,i,r,u){var f={name:n,center:{Latitude:t.lat(),Longitude:t.lng()},radius:i,isPrimary:r};frm.services.getResult("Add",f,this.apiUrl,u)};frm.services.tenant.SearchAreaService.prototype.removeArea=function(n,t){var i={areaId:n};frm.services.getResult("Remove",i,this.apiUrl,t)};frm.services.tenant.SearchAreaService.prototype.setPrimaryArea=function(n,t){var i={areaId:n};frm.services.getResult("SetPrimary",i,this.apiUrl,t)};frm.services.tenant.SearchAreaService.prototype.setAreaRadius=function(n,t,i){var r={areaId:n,radius:t};frm.services.getResult("SetRadius",r,this.apiUrl,i)};frm.services.tenant.ProfileService=function(n){this.apiUrl=n};frm.services.tenant.ProfileService.prototype.sendMessage=function(n,t,i){var r={tenantId:n,message:t};frm.services.getResult("SendMessage",r,this.apiUrl,i)};frm.services.landlord.PropertyService=function(n){this.apiUrl=n};frm.services.landlord.PropertyService.prototype.addComment=function(n,t){frm.services.getResult("AddComment",{comment:n},this.apiUrl,t)};frm.services.landlord.PropertyService.prototype.setInterested=function(n,t,i){frm.services.getResult("SetInterested",{propertyId:n,value:t},this.apiUrl,i)};frm.services.landlord.PropertyService.prototype.listComments=function(n,t,i){var r={propertyId:n,pageNumber:t};frm.services.getResult("ListComments",r,this.apiUrl,i)};frm.services.landlord.PropertyService.prototype.deleteComment=function(n,t,i){var r={commentId:n,hardDelete:i||!1};frm.services.getResult("DeleteComment",r,this.apiUrl,t)};frm.services.landlord.PropertyService.prototype.deleteInterest=function(n,t){var i={interestId:n};frm.services.getResult("DeleteInterest",i,this.apiUrl,t)};frm.services.landlord.PropertyService.prototype.listReplies=function(n,t,i,r){var u={propertyId:n,parentId:t,pageNumber:i};frm.services.getResult("ListReplies",u,this.apiUrl,r)};frm.services.landlord.PropertyService.prototype.listInterests=function(n,t,i){var r={propertyId:n,pageNumber:t};frm.services.getResult("ListInterests",r,this.apiUrl,i)};frm.services.landlord.PropertyService.prototype.addToSimilarHouses=function(n,t){frm.services.getResult("AddToSimilarHouses",{propertyId:n},this.apiUrl,t)};frm.services.landlord.RoomService=function(n){this.apiUrl=n};frm.services.landlord.RoomService.prototype.sendMessage=function(n,t,i,r){var u={roomId:n,message:t,lejeboligWhitelist:i};frm.services.getResult("SendMessage",u,this.apiUrl,r)};frm.services.PaymentService=function(n){this.apiUrl=n};frm.services.PaymentService.prototype.beginOrder=function(n,t,i){var r={orderId:n,productId:t};frm.services.getResult("BeginOrder",r,this.apiUrl,i)};frm.services.PaymentService.prototype.beginOrderV2=function(n,t,i,r,u){var f={orderId:n,productId:t,method:i,acceptedUrl:r.acceptedUrl,paymentActionId:r.paymentActionId,anonymousPaymentAction:r.anonymousPaymentAction};frm.services.getResult("BeginOrderV2",f,this.apiUrl,u)};frm.services.PaymentService.credit=function(n){return $.ajax({url:"/Api/Web/Payment/Credit",method:"POST",data:n})},function(n){function t(n,t){typeof t!="undefined"&&t.forEach(function(t){n.on(t.event,t.selector,t.func)});n.on("click touchend",".close, [href='#close']",function(n){frm.services.ModalService.close();n.preventDefault()})}function i(n,t){typeof t!="undefined"&&t.forEach(function(t){n.off(t.event,t.selector,t.func)});n.off("click touchend",".close, [href='#close']")}n.ModalService={open:function(t){t=t||{};n.ModalService.close();var i=$(window),u={width:i.outerWidth(!0),height:i.outerHeight(!0)};this.current=new r(t);this.current.open()},close:function(){typeof this.current!="undefined"&&(this.current.close(),this.current=undefined,$("#viewport").show())},openError:function(t){n.ModalService.open({template:'<article class="clearfix default-modal"><div class="inner-content">'+t+"<\/div><\/article>",events:[]})}};var r=function(){var r=!0,n=function(n){n.closeOnOverlayClick!=undefined&&(r=n.closeOnOverlayClick);var t=null,i=null;typeof n.href!="undefined"?(i="iframe",t=n.href):typeof n.template!="undefined"?(i="template",t=n.template):typeof n.source!="undefined"?(i="source",t=n.source):typeof n.video!="undefined"&&(i="iframe",t=n.video);this.type=i;this.source=t;this.customEvents=n.events;this.width=n.width;this.height=n.height;this.events={onAfterClose:n.onAfterClose}};return n.prototype.close=function(){$.fancybox.close(!0)},n.prototype.open=function(){var n=this,u="inline";switch(n.type){case"template":u="inline";break;case"iframe":u="iframe";break;case"source":u=null}$.fancybox.open({src:n.source,type:u,opts:{closeClickOutside:!1,focus:!1,iframe:{css:{width:"800px",height:"600px","max-width":"80%","max-height":"80%",margin:"0"}},onComplete:function(){var i=$(this.$content);t(i,n.customEvents)},beforeClose:function(){var t=$(this.$content);i(t,n.customEvents)},afterClose:function(){typeof n.events.onAfterClose=="function"&&n.events.onAfterClose.apply(n)}}});return},n}(),u=function(){function r(n,i){var r=$(n);return t(r,i),r}function u(){var u=$(document.body),t=$(document.createElement("aside")),i=$(document.createElement("menu")),r=$(document.createElement("div"));return r.addClass("mobile-modal-wrapper"),i.addClass("navbar navbar-blue navbar-borderless mobile-blue-nav").append($(document.createElement("a")).on("click touchend",function(t){n.ModalService.close();t.preventDefault()}).addClass("close-glyph-icon").attr("href","#").text("X")),t.attr("id","mobile-modal-container").addClass("mobile-modal-container").append(i).append(r).prependTo(u),t}function f(n,t){n.find(".mobile-modal-wrapper").append(t)}function e(n,t){var i=$(document.createElement("iframe")),r=$(window).outerHeight(),u=$(window).outerWidth();i.attr({src:t,scrolling:"yes"}).on("load",function(){n.resolve()});return i.height(r+200).width(u),$(".mobile-modal-wrapper").height(r).width(u),i}var i=function(n){var t=null,i=null;typeof n.href!="undefined"?(i="iframe",t=n.href):typeof n.template!="undefined"?(i="template",t=n.template):typeof n.source!="undefined"&&(i="source",t=n.source);this.type=i;this.source=t;this.customEvents=n.events;this.events={onAfterClose:n.onAfterClose}};return i.prototype.open=function(){var n=this,s=new jQuery.Deferred,i=this.$container=u(),o=null,h={template:function(){o=r(n.source,n.customEvents);s.resolve()},iframe:function(){var t=new jQuery.Deferred,r=t.promise();i.addClass("loading");i.addClass("invisible-hidden-text");o=e(t,n.source);r.then(function(){i.removeClass("loading")});s.resolve()},source:function(){o=n.source;t(o,n.customEvents);s.resolve()}};h[n.type]();f(i,o);s.promise().then(function(){i.css("visibility","visible")})},i.prototype.close=function(){var n=this,t=this.$container;t.slideUp("normal",function(){t.removeClass("invisible-hidden-text");typeof n.events.onAfterClose=="function"&&n.events.onAfterClose.apply(n);t.remove()})},i}()}(frm.services),function(n){n.PropertyService={findProperties:function(){return $.ajax({type:"GET",url:"/Api/Web/Property/GetProperties"})},getProperty:function(n){return $.ajax({type:"GET",url:"/Api/Web/Property/GetById",data:{id:n}})},updateProperty:function(n,t){return $.ajax({type:"POST",url:"/Api/Web/Property/Update?propertyId="+n,data:{Street:t.Street,ZipCode:t.ZipCode,CityName:t.CityName,Rent:t.Rent,Advance:t.Advance,Deposit:t.Deposit,Usage:t.Usage,Pets:t.Pets!="null"?t.Pets==1?!0:!1:null,Furnished:t.Furnished!="null"?t.Furnished==1?!0:!1:null,Active:t.Active,Period:t.Period,CountryCode:t.CountryCode,Area:t.Area,HouseNumber:t.HouseNumber,Bedrooms:t.Bedrooms,Address:t.Address,Location:{Latitude:t.Location.Latitude,Longitude:t.Location.Longitude},Description:t.Description,Title:t.Title,Available:t.Available,ValutaId:t.ValutaId,IsRented:t.IsRented,IsReserved:t.IsReserved}})},activateImport:function(n){return $.ajax({type:"GET",url:"/Api/Web/Property/ActivateImport",data:{propertyId:n}})},detachImage:function(n,t){return $.ajax({type:"POST",url:"/Api/Web/Property/DetachImage?roomId="+n+"&roomImageId="+t})},changeStatus:function(n,t){if(typeof n=="undefined")throw new Error("propertyId is required");if(t!=0&&typeof t=="undefined")throw new Error("statusCodeId is required");return $.ajax({url:"/Api/Web/Property/ChangeStatus",type:"POST",data:{propertyId:n,statusCodeId:t}})},getSimilarProperties:function(n,t){return $.ajax({type:"GET",url:"/Api/Web/Property/GetSimilarProperties",data:{propertyId:n,top:t}})},notifyInterested:function(n){return $.ajax({type:"GET",url:"/Api/Web/Property/NotifyInterested",data:{propertyId:n}})},setRented:function(n){return $.ajax({type:"POST",url:"/Api/Web/Property/SetRented?propertyId="+n})},removeRented:function(n){return $.ajax({type:"POST",url:"/Api/Web/Property/RemoveRented?propertyId="+n})},setInterested:function(n,t){return $.ajax({type:"POST",url:"/Api/Web/Property/SetInterested?propertyId="+n+"&value="+t})}}}(frm.services);frm.services.accountService={authenticate:function(n,t,i){return jQuery.ajax({type:"POST",url:"/Api/Web/Account/Authenticate",data:{authenticatedThrough:0,username:n,password:t,remember:i,url:location.pathname}})},unsubscribe:function(n){return jQuery.ajax({type:"POST",url:"/Api/Web/Account/Unsubscribe?accountId="+n})},acceptMoneyBackOffer:function(){return jQuery.ajax({type:"POST",url:"/Api/Web/Account/AcceptMoneyBackOffer"})},saveMoneyBackOfferSurvey:function(n){return jQuery.ajax({type:"POST",url:"/Api/Web/Account/SaveMoneyBackOfferSurvey?model="+n})},accepChangeProductOffer:function(){return jQuery.ajax({type:"POST",url:"/Api/Web/Account/AcceptChangeProductOffer"})},logChangeProductOfferViewed:function(){return jQuery.ajax({type:"POST",url:"/Api/Web/Account/LogChangeProductOfferViewed"})},invokeOffer:function(n,t,i){return jQuery.ajax({type:"POST",url:"/Api/Web/Account/InvokeMoneyBackOffer",data:{moneyBackOfferId:n,accountId:t,productOrderId:i}})},facebookAuthenticate:function(n,t,i,r,u,f){return $.ajax({url:"/Api/Web/Account/Authenticate",type:"POST",data:{authenticatedThrough:1,facebookUserId:n.id,firstname:n.firstname,lastname:n.lastname,email:n.email,userType:t,gender:n.gender,room:i,contactingLandlordId:r,accessToken:u,url:location.pathname,remember:f}})},googleAuthenticate:function(n,t,i,r,u,f){return $.ajax({url:"/Api/Web/Account/Authenticate",type:"POST",data:{authenticatedThrough:3,email:n.email,accessToken:u,url:location.pathname,remember:f}})},create:function(n,t,i,r,u,f,e){return $.ajax({url:"/Api/Web/Account/Create",type:"POST",data:{createdThrough:0,username:n,password:t,email:i,userType:r,room:u==""||u==null?undefined:u,emailChecks:f,contactingLandlordId:e}})},createOnlyEmail:function(n,t,i){var r=i||{};return r.createdThrough=2,r.email=n,r.userType=t,i.url&&(r.url=i.url),$.ajax({url:"/Api/Web/Account/Create",type:"POST",data:r})},createPartial:function(n){return n.createdThrough=5,$.ajax({url:"/Api/Web/Account/Create",type:"POST",data:n})},createAccount:function(n,t){return n.createdThrough=t,$.ajax({url:"/Api/Web/Account/Create",type:"POST",data:n})},createThroughFacebook:function(n,t){var i={onAuthorized:function(n){return frm.services.FacebookService.getUser(n.accessToken,n.userID,n.expiresIn,n.signedRequest)},onCancellation:function(){typeof t!="undefined"&&t()}};return frm.services.FacebookService.requestLoginDialog().then(i.onAuthorized,i.onCancellation).then(function(t){var i=t.data.User;return $.ajax({url:"/Api/Web/Account/Create",type:"POST",data:{createdThrough:1,facebookUserId:i.id,firstname:i.first_name,lastname:i.last_name,email:i.email,userType:n.userType,room:n.room==""||n.room==null?undefined:n.room,contactingLandlordId:n.contactingLandlordId,gender:i.gender,accessToken:t.data.AccessToken}})})},createThroughGoogle:function(n){return frm.services.GoogleService.authorize().then(function(t,i){var r=t.data;return $.ajax({url:"/Api/Web/Account/Create",type:"POST",data:{createdThrough:3,email:r.email,accessToken:i.access_token,userType:n.userType,room:n.room==""||n.room==null?undefined:n.room,contactingLandlordId:n.contactingLandlordId}})})},getByEmail:function(n){return $.ajax({url:"/Api/Web/Account/GetByEmail",type:"GET",data:{email:n}})},update:function(n,t){return $.ajax({url:"/Api/Web/Account/Update?id="+n,type:"POST",data:t})},lock:function(n){return $.ajax({url:"/Api/Web/Account/Lock",type:"POST",data:n})},unlock:function(n){return $.ajax({url:"/Api/Web/Account/Unlock",type:"POST",data:n})},search:function(n){return $.ajax({url:"/Api/Web/Account/Search",type:"GET",data:{query:n}})},findWatched:function(){return $.ajax({url:"/Api/Web/Account/GetWatchedAccounts",type:"GET"})},createFacebook:function(n,t,i,r,u,f){return $.ajax({url:"/Api/Web/Account/Create",type:"POST",data:{email:n,userType:t,room:i,contactingLandlordId:r,lastname:f,firstname:u}})},sendCredentials:function(n,t){return $.ajax({url:"/Api/Web/Account/SendCredentials",type:"POST",data:{username:n,email:t}})},registerMailSuggestion:function(n){return $.ajax({url:"/Api/Web/Account/RegisterMailSuggestion",type:"POST",data:n})},registerUseMailSuggestion:function(n){return $.ajax({url:"/Api/Web/Account/RegisterUseMailSuggestion",type:"POST",data:n})},getCustomProfilesList:function(n,t){return $.ajax({url:"/Api/Web/Account/GetCustomProfilesList?PageNumber="+n,type:"GEfT",data:{Criterias:t}})},checkEmail:function(n){return $.ajax({url:"/Api/Web/Account/ExistsEmail?email="+n,type:"GET"})},createRoom:function(n){return $.ajax({url:"/Api/Web/Account/CreateRoomAccount",type:"POST",data:n})},getById:function(n){return $.ajax({url:"/Api/Web/Account/GetAccountById?accountId="+n,type:"GET"})},getUserInfoByAccountId:function(n){return $.ajax({url:"/Api/Web/Account/GetUserInfoByAccountId?accountId="+n,type:"GET"})},phone:{sendVerificationCode:function(){return $.ajax({url:"/Api/Web/Account/PhoneSendVerificationCode",type:"POST"})},insertVerificationCode:function(n){return $.ajax({url:"/Api/Web/Account/PhoneInsertVerificationCode?code="+n,type:"POST"})}},manage:{updateAccount:function(n){return $.ajax({url:"/Api/Web/Account/Update",type:"POST",data:n})},updateRoom:function(n,t){return typeof t!="undefined"&&(n.accountId=t),$.ajax({url:"/Api/Web/Room/Update",type:"POST",data:n})},updatePersonal:function(n){return $.ajax({url:"/Api/Web/Personal/Update",type:"POST",data:n})},updateHomeWishes:function(n){return $.ajax({url:"/Api/Web/HomeWishes/Update",type:"POST",data:n})},updateRoommate:function(n){return $.ajax({url:"/Api/Web/Roommate/Update",type:"POST",data:n})}},saveAccountSettings:function(){return $.ajax({url:"/Api/Web/Account/SaveAccountSettings",type:"POST"})},getLatestNotifications:function(n){return window.CONNECTION_ESTABLISHED.$promise.done(function(){$.connection.NotificationHub.server.checkNotifications()}),$.ajax({url:"/Api/Web/Notification/Latest",type:"GET",data:{pageIndex:n}})},disableNotificationGroup:function(n,t){return $.ajax({url:"/Api/Web/Notification/Disable",type:"POST",data:{itemType:t,itemId:n}})},changeNotificationGroupState:function(n,t){return $.ajax({url:"/Api/Web/Notification/ChangeNotificationSectionState",type:"POST",data:{notificationGroupId:n,isDisabled:t}})},getNotifications:function(n){return $.connection.NotificationHub.connection._deferral.done(function(){$.connection.NotificationHub.server.checkNotifications()}),$.ajax({url:"/Api/Web/Notification/FindAllPaged?pageIndex="+n,type:"GET"})},getAllNotifications:function(){return $.connection.NotificationHub.server.checkNotifications(),$.ajax({url:"/Api/Web/Notification/FindAll",type:"GET"})},updatePartialAccountUserInfo:function(n){return $.ajax({url:"/Api/Web/Account/UpdatePartialAccountAndUserInfo",type:"POST",data:{Firstname:n.Firstname,Lastname:n.Lastname,Nationality:n.Nationality,Gender:n.Gender,Age:n.Age}})},updatePartialRoommateInfo:function(n){return $.ajax({url:"/Api/Web/Account/UpdatePartialRoommateInfo",type:"POST",data:{Gender:n.Gender,AgeFrom:n.AgeFrom,AgeTo:n.AgeTo}})},getApproveFeedDetails:function(n){return $.ajax({url:"/Api/Web/Account/ApproveFeed",type:"GET",data:{accountId:n}})},approveFeed:function(n,t){return $.ajax({url:"/Api/Web/Account/ApproveFeed?accountId="+n,type:"POST",data:t})},approveInternal:function(n,t){return $.ajax({url:"/Api/Web/Account/ApproveInternal?accountId="+n+"&state="+t,type:"POST"})},approveExternalForFeed:function(n,t){return $.ajax({url:"/Api/Web/Account/ApproveExternalForFeed?accountId="+n+"&state="+t,type:"POST"})},Suspicious:{reject:function(n){return $.ajax({url:"/api/web/SuspiciousAccount/Reject?accountId="+n,type:"POST",data:{accountId:n}})},accept:function(n){return $.ajax({url:"/api/web/SuspiciousAccount/Accept?accountId="+n,type:"POST"})}},trackingHelper:{addTrackingParameter:function(n,t,i){var r=n,u=i;return(t.url!=null&&t.url.indexOf(u)>-1||!t.isExistingUser)&&(r=frm.services.accountService.trackingHelper.buildTrackingUrl(r,u)),r},buildTrackingUrl:function(n,t){var i=n,r,u;return n.indexOf("?")>-1?(r=t,u=r.replace("?","&"),i=n+u):i=n+t,i}}};frm.services.abTestService={getSplitTest:function(n,t){return $.ajax({url:"/Api/Web/ABTest/GetSplitTest",type:"GET",data:{name:n,version:t}})},score:function(n,t,i){return $.ajax({url:"/Api/Web/ABTest/Score",type:"POST",data:{Id:n,VersionIteration:t,Step:i}})},scoreItem:function(n,t){return $.ajax({url:"/Api/Web/ABTest/ScoreItem",type:"POST",data:{Id:n,Step:t}})},initABTest:function(n,t,i,r){$.ajax({url:"/Api/Web/ABTest/InitABTest",type:"POST",data:{Id:n,VersionIteration:t},success:function(n){i(n.data.model)},failure:function(n){r(n.data.model)}})}},function(n){function t(n){if(typeof n.itemType=="undefined"||n.itemType==="")throw new Error("ItemType is required");if(typeof n.itemId=="undefined"||n.itemId==="")throw new Error("itemId is required");return $.ajax({url:"/Api/Web/Report/Create",type:"POST",data:{itemType:n.itemType,itemId:n.itemId,reason:n.reason,category:n.category}})}n.ReportService={report:function(n){return t({itemType:n.itemType,itemId:n.itemId,reason:n.reason,category:n.category})},reportRoom:function(n,i){return t({itemType:"Room",itemId:n,reason:i,category:category})},reportTenant:function(n,i){return t({itemType:"Tenant",itemId:n,reason:i,category:category})},reportProperty:function(n,i){return t({itemType:"Property",itemId:n,reason:i,category:category})},progress:function(n){return $.ajax({type:"POST",url:"/Api/Web/Report/Progress?ReportId="+n})},reset:function(n){return $.ajax({type:"POST",url:"/Api/Web/Report/Reset?ReportId="+n})},complete:function(n){return $.ajax({type:"POST",url:"/Api/Web/Report/Complete?ReportId="+n})},createNote:function(n,t){return $.ajax({type:"POST",url:"/Api/Web/Report/CreateNote?ReportId="+n,data:{note:t}})},fetchNotes:function(n){return $.ajax({type:"GET",url:"/Api/Web/Report/FetchNotes?ReportId="+n})}}}(frm.services),function(n){_trackingHelper={google:function(n,t){typeof ga!="undefined"&&ga("send","event",n,"action",t)},facebook:{enroll:function(){typeof fbq!="undefined"&&fbq("track","CompleteRegistration")},custom:function(n){typeof fbq!="undefined"&&fbq("trackCustom",n)}},newFindroommate:function(n,t,i){typeof improvely!="undefined"&&(improvely.init("newfindroommate",1),improvely.conversion({goal:n,revenue:t,reference:i}))}};n.TrackingService={archiveCampaign:function(n,t){return $.ajax({url:"/Api/Web/Campaign/Archive",type:"POST",data:{campaignId:n,archiveState:t}})},deleteCampaign:function(n){return $.ajax({url:"/Api/Web/Campaign/Delete?CampaignId="+n,type:"POST"})},vendor:{enroll:function(n){var t=n;_trackingHelper.google("Enroll",n);_trackingHelper.facebook.enroll()},tenantEnroll:function(n){var t=n;_trackingHelper.google("Enroll Tenant",n);_trackingHelper.facebook.custom("EnrollTenant")},landlordEnroll:function(n){var t=n;_trackingHelper.google("Enroll Landlord",n);_trackingHelper.facebook.custom("EnrollLandlord")},paymentSucces:function(){},custom:function(n,t){_trackingHelper.google(n,t);_trackingHelper.facebook.custom(n)}}}}(frm.services),function(n){n.LeadService={registerEmail:function(n,t){if(typeof n=="undefined")throw new Error("leadGroupId is required");if(typeof t=="undefined")throw new Error("email is required");return $.ajax({url:"/Api/Web/Lead/Register",type:"POST",data:{leadGroupId:n,email:t}})},createGroup:function(n,t,i,r,u,f,e){return $.ajax({url:"/Api/Web/Lead/CreateGroup",type:"POST",data:{campaignId:n,siteId:t,languageId:i,city:r,country:u,radius:f,rent:e}})},createCampaign:function(n,t,i){return $.ajax({url:"/Api/Web/LeadCampaign/Create",type:"POST",data:{campaignName:n,campaignType:t,sourceName:i}})},register:function(n,t,i,r,u){if(typeof n=="undefined")throw new Error("campaignKey is required");if(typeof t=="undefined")throw new Error("name is required");if(typeof i=="undefined")throw new Error("email is required");if(typeof r=="undefined")throw new Error("maxRent is required");if(typeof u=="undefined")throw new Error("city is required");return $.ajax({url:"/Api/Web/Lead/RegisterCampaignLead",type:"POST",data:{campaignKey:n,name:t,email:i,maxRent:r,city:u}})},getCampaigns:function(){return $.ajax({url:"/Api/Web/LeadCampaign/Fetch"})},archiveCampaign:function(n){return jQuery.ajax({url:"/Api/Web/LeadCampaign/Archive?campaignId="+n,type:"POST"})},getLeads:function(n,t,i){return jQuery.ajax({url:"/Api/Web/Lead/GetLeads?campaignId="+n+"&cityCenterId="+t+"&siteId="+i})},getLead:function(n){return jQuery.ajax({url:"/Api/Web/Lead/GetLead?LeadId="+n})},getLeadByEmail:function(n){return jQuery.ajax({url:"/Api/Web/Lead/GetByEmail",type:"GET",data:{email:n}})},toggleSubscription:function(n,t){return t?jQuery.ajax({url:"/Api/Web/Lead/Subscribe?LeadId="+n,type:"PUT"}):jQuery.ajax({url:"/Api/Web/Lead/Unsubscribe?LeadId="+n,type:"PUT"})},deleteLead:function(n){return jQuery.ajax({url:"/Api/Web/Lead/Delete?LeadId="+n,type:"DELETE"})}}}(frm.services),function(n){function t(n){$.ajax({url:"chrome-extension://gomekmidlodglbbmalcneegieacbdmki/common/mocks/ga.js",timeout:1e3,type:"HEAD",success:function(){n.resolve()},error:function(){n.reject()}})}n.AvastSecurityService={detect:function(){var n=new jQuery.Deferred;return typeof chrome!="undefined"?t(n):n.reject("NonSupportedPlatform"),n.promise()}}}(frm.services),function(n){function t(){this.isReachingFacebook()?this.initialize():this.displayFacebookReachingError()}function r(){frm.services.ModalService.openError("<h1>Argh!<\/h1><p>Vi kunne ikke loade facebook, dermed er der nogle funktioner der ikke fungere korrekt")}function u(){frm.services.ModalService.openError("<h1>Argh!<\/h1><p>Vi kan se at bruger Avast! Security Online. Der er kan derfor forekomme fejl, hvis du f.eks. vil benytte login til at oprette eller logge ind")}var i=!1;frm.utils.loadScript("//connect.facebook.com/en_US/sdk.js",function(){i=!0;n.FacebookService=new t});t.prototype.initialize=function(){FB.init({appId:"340386656058979",version:"v2.2",channelUrl:"/Pages/FBLoginChannelFile.aspx",status:!0,cookie:!0,xfbml:!0});frm.services.StorageService.create("ReachingFacebook",!0)};t.prototype.displayFacebookReachingError=function(n){var t=frm.services.StorageService.read("ReachingFacebook"),i=n||t==null||t;(frm.services.StorageService.create("ReachingFacebook",!1),i)&&frm.services.AvastSecurityService.detect().then(u,r)};t.prototype.isReachingFacebook=function(){return i&&typeof FB!="undefined"};t.prototype.requestLoginDialog=function(){var n=new jQuery.Deferred,t={scope:"public_profile,email,user_birthday"};return this.isReachingFacebook()&&FB.login(function(t){t.authResponse?n.resolve(t.authResponse):n.reject()},t),n.promise()};t.prototype.getUser=function(n,t,i,r){return $.ajax({type:"POST",url:"/Api/Web/Authorization/Facebook",data:{accessToken:n,userId:t,expiresIn:i,signedRequest:r}})}}(frm.services,window),function(n){var t=!1,i="580436250643-f9jh31k8u9n77k441802gnhdfclhcle1.apps.googleusercontent.com";frm.utils.loadScript("https://apis.google.com/js/client:platform.js?onload=start",function(){t=!0});n.GoogleService={authorize:function(){t||alert("Could not contact google service; Please try again");var r=new jQuery.Deferred,n={onAuthenticated:function(n,t,i){n.resolve(t,i)},onAuthenticateFailure:function(n){n.reject()},onSignIn:function(t,i){typeof i.code!="undefined"&&typeof i.status!="undefined"&&i.status.method!=="AUTO"&&jQuery.ajax({url:"/Api/Web/Authorization/Google",type:"POST",data:{accessToken:i.access_token,code:i.code}}).then(function(r){return n.onAuthenticated(t,r,i)},function(){return n.onAuthenticateFailure(t)})}};return gapi.auth.signIn({scope:"https://www.googleapis.com/auth/userinfo.email",clientid:i,redirecturi:"postmessage",accesstype:"offline",cookiepolicy:"none",approvalprompt:"auto",callback:function(t){return n.onSignIn(r,t)}}),r}}}(frm.services),function(n){n.NotificationService={createTextNotification:function(n){return $.ajax({url:"/Api/Web/Notification/CreateTextNotification",type:"POST",data:n})},findAllTextNotifications:function(){return $.ajax({url:"/Api/Web/Notification/FindAllTextNotifications",type:"GET"})},requestTemplates:function(){return n.TemplateService.request("/misc/templates/notifications")}}}(frm.services),function(n){var t={};n.TemplateService={request:function(n){if(typeof t[n]!="undefined"){var i=new jQuery.Deferred;return i.resolve(),i.promise()}return $.get(n,function(i){var r=[],u=$("body");$(i).filter("script").each(function(){document.getElementById(this.id)===null&&r.push(this)});u.append(r);t[n]=!0})}}}(frm.services),function(n,t,i){function r(){i(i.proxy(function(){this.initialize()},this))}r.prototype.initialize=function(){var n=[];i("[data-localize-group][data-localize-key]").each(function(){var t=i(this),r=t.attr("data-localize-group"),u=t.attr("data-localize-key");n.push({key:u,group:r})});n.length>0&&i.ajax({type:"POST",url:"/Api/Web/Localization/Localize",data:{items:n}}).then(function(n){var t=n.data;t.forEach(function(n){i("[data-localize-group='"+n.Group+"'][data-localize-key='"+n.Key+"']").html(n.Value)})})};n.LocalizationService=new r}(frm.services,window,jQuery),function(n){n.AuthenticationService={authenticateThroughFacebook:function(t){var i=function(n){var i=n.data.User;return frm.services.accountService.facebookAuthenticate({id:i.id,email:i.email,firstname:i.first_name,lastname:i.last_name,gender:i.gender},1,null,null,n.data.AccessToken,t)};return n.FacebookService.requestLoginDialog().then(function(t){return n.FacebookService.getUser(t.accessToken,t.userID,t.expiresIn,t.signedRequest)},function(){n.ModelService.openError("Hvis du vil oprette dig igennem facebook har vi brug for at at du godkender os")}).then(i)},authenticateThroughGoogle:function(t){var i=function(n,i){var r=n.data;return frm.services.accountService.googleAuthenticate({createdThrough:3,email:r.email,userType:1},1,null,null,i.access_token,t)};return n.GoogleService.authorize().then(i)},authenticate:function(n,t,i){return frm.services.accountService.authenticate(n,t,i)}}}(frm.services,window),function(n){function u(n){var t=ko.utils.arrayFilter(n,function(n){return ko.utils.unwrapObservable(n.selected)});return n.length==t.length?[]:t}function t(n){this.parts=n||[]}var r={separators:{or:","}},i;t.prototype.appendPart=function(n,t){if(t instanceof Array){var i=u(t);i.length>0&&this.parts.push({name:n,data:ko.utils.arrayMap(i,function(n){return n.value})})}else this.parts.push({name:n,data:t});return this};t.prototype.contains=function(n,t){var i=ko.utils.arrayFirst(this.parts,function(i){return i.name==n&&ko.utils.arrayFirst(i.data,function(n){return n==t})!=null});return i!==null};t.prototype.get=function(n){var t=ko.utils.arrayFirst(this.parts,function(t){return t.name==n});return typeof t!="undefined"&&t!==null?t.data:null};t.prototype.toString=function(){var n=ko.utils.arrayMap(this.parts,function(n){var t=n.data;return n.data instanceof Array&&(t=n.data.join(r.separators.or)),n.name+"="+t});return n.length>0?"?"+n.join("&"):""};i=function(){};i.prototype.create=function(){return new t};i.prototype.parse=function(){var f=location.pathname.split("?"),n=location.search.substring(1),i,u;return n!==""?(i=n.split("&"),u=ko.utils.arrayMap(i,function(n){var t=n.split("="),i=t[1];return{name:t[0],data:t[1].split(r.separators.or)}}),new t(u)):new t};n.HashUrlService=i}(frm.services),function(n){var r={BASE_SEARCH_URL:"/Api/Web/Search",BASE_ROOM_URL:"/Api/Web/Search/SearchRooms",BASE_EXTERNALROOM_URL:"/Api/Web/Search/SearchExternalRooms",BASE_TENANT_URL:"/Api/Web/Search/SearchTenants",BASE_MARKERS_URL:"/Api/Web/Search/GetMarkerCoordinates"},t={allValuesSame:function(n){for(var i=0,t=0;t<n.length;t++)n[t].selected&&(i+=1);return i===n.length?!0:!1},reduceToSelected:function(n){return ko.utils.arrayFilter(n,function(n){return ko.utils.unwrapObservable(n.selected)})},getValues:function(n){return ko.utils.arrayMap(t.reduceToSelected(n),function(n){return n.value})},getKeys:function(n){return ko.utils.arrayMap(t.reduceToSelected(n),function(n){return n.key})},getExternalRoomFilterRequestData:function(n){var r=typeof n.RentRange!="undefined"?n.RentRange.Min:undefined,u=typeof n.RentRange!="undefined"?n.RentRange.Max:undefined,i={rentalPeriods:t.getValues(n.RentalPeriods),rentRange:{minimum:r,maximum:u},roomPicture:n.HasImageOfRoom?!0:undefined,profilePicture:n.HasProfileImage?!0:undefined,address:n.Address,CoordinateBounds:{northEast:{latitude:n.Coords.NORTH_WEST.lat(),longitude:n.Coords.NORTH_WEST.lng()},southWest:{latitude:n.Coords.SOUTH_EAST.lat(),longitude:n.Coords.SOUTH_EAST.lng()}}};return ko.utils.arrayForEach(t.getKeys(n.Facilities),function(n){i[n]=!0}),i},getRoomFilterRequestData:function(n){var r=typeof n.RentRange!="undefined"?n.RentRange.Min:undefined,u=typeof n.RentRange!="undefined"?n.RentRange.Max:undefined,i={rentalPeriods:t.getValues(n.RentalPeriods),rentRange:{minimum:r,maximum:u},gender:t.allValuesSame(n.Gender)?null:t.getValues(n.Gender),roomPicture:n.HasImageOfRoom?!0:undefined,profilePicture:n.HasProfileImage?!0:undefined,address:n.Address,CoordinateBounds:{northEast:{latitude:n.Coords.NORTH_WEST.lat(),longitude:n.Coords.NORTH_WEST.lng()},southWest:{latitude:n.Coords.SOUTH_EAST.lat(),longitude:n.Coords.SOUTH_EAST.lng()}}};return ko.utils.arrayForEach(t.getKeys(n.Facilities),function(n){i[n]=!0}),i},getPropertyFilterRequestData:function(n){var i=typeof n.RentRange!="undefined"?n.RentRange.Min:undefined,r=typeof n.RentRange!="undefined"?n.RentRange.Max:undefined;return{rentalPeriods:t.getValues(n.RentalPeriods),rentRange:{minimum:i,maximum:r},hasComment:n.HasComments?!0:undefined,interested:n.HasInterested?!0:undefined,address:n.Address,CoordinateBounds:{northEast:{latitude:n.Coords.NORTH_WEST.lat(),longitude:n.Coords.NORTH_WEST.lng()},southWest:{latitude:n.Coords.SOUTH_EAST.lat(),longitude:n.Coords.SOUTH_EAST.lng()}}}},getTenantFilterRequestData:function(n){var i=typeof n.RentRange!="undefined"?n.RentRange.Min:undefined,r=typeof n.RentRange!="undefined"?n.RentRange.Max:undefined,u=typeof n.AgeRange!="undefined"?n.AgeRange.Min:undefined,f=typeof n.AgeRange!="undefined"?n.AgeRange.Max:undefined;return{gender:t.allValuesSame(n.Gender)?null:t.getValues(n.Gender),smoking:t.allValuesSame(n.Smoking)?null:t.getValues(n.Smoking),Nationality:n.Nationality,picture:n.HasProfileImage?!0:undefined,rentalPeriods:t.getValues(n.RentalPeriods),rentRange:{minimum:i,maximum:r},ageRange:{minimum:u,maximum:f},address:n.Address}}},i=n.SearchService=function(){this.cachedMarkerCoordinates={}};i.prototype.getMarkerCoordinates=function(n){return jQuery.ajax({url:r.BASE_MARKERS_URL,type:"POST",data:t.getFilterRequestData(n)})};i.prototype.searchRooms=function(n,i){return jQuery.ajax({url:r.BASE_ROOM_URL,type:"POST",data:{criteria:t.getFilterRequestData(n),pageIndex:n.pageIndex-1,sortKey:i}})};i.prototype.searchExternalRooms=function(n,i){return jQuery.ajax({url:r.BASE_EXTERNALROOM_URL,type:"POST",data:{criteria:t.getExternalRoomFilterRequestData(n),pageIndex:i,sortKey:n.Sort}})};i.prototype.searchRooms_new=function(n,i){return jQuery.ajax({url:r.BASE_ROOM_URL,type:"POST",data:{criteria:t.getRoomFilterRequestData(n),pageIndex:i,sortKey:n.Sort}})};i.prototype.searchProperties=function(n,i){return jQuery.ajax({url:"/Api/Web/Search/SearchProperties",type:"POST",data:{criteria:t.getPropertyFilterRequestData(n),pageIndex:i,sortKey:n.Sort}})};i.prototype.searchTenants=function(n,i){return jQuery.ajax({url:r.BASE_TENANT_URL,type:"POST",data:{criteria:t.getTenantFilterRequestData(n),pageIndex:i,sortKey:n.Sort}})};i.prototype.getUrl=function(n,t,i,r,u){t=decodeURI(t);var e=t,f=[];switch(n){case"coordinates":typeof i!="undefined"&&f.push(i);e+=f.join("/");break;default:typeof u!="undefined"&&f.push(frm.utils.encodeFriendlyUrl(u));typeof i!="undefined"&&f.push(frm.utils.encodeFriendlyUrl(i));typeof r!="undefined"&&f.push(frm.utils.encodeFriendlyUrl(r));e+=f.join("/")}return(e||"").toLowerCase()};i.prototype.getRedirectParameters=function(n){function t(t,i){return{locality:t,sublocality:i,country:n.country}}return typeof n=="undefined"?{}:n.type==="street_address"?t(n.locality,n.street+" "+n.streetNumber):n.type==="route"?t(n.locality,n.street):n.type==="establishment"?typeof n.coords!="undefined"?t("@"+n.coords.lat+","+n.coords.lng):t(n.locality,n.name):n.type==="country"?t():n.type==="sublocality"?t(n.locality,n.sublocality):n.type==="neighborhood"?t(n.locality,n.sublocality):n.type==="sublocality"?t(n.locality,n.neighborhood):t(n.locality)};i.prototype.checkSearchChoice=function(){return jQuery.ajax({url:r.BASE_SEARCH_URL+"/CheckSearchChoice",type:"POST"})};i.prototype.setSearchChoice=function(n){return jQuery.ajax({url:r.BASE_SEARCH_URL+"/SetSearchChoice?value="+n,type:"POST"})}}(frm.services),function(n){var t=function(){this.googleGeocoder=new google.maps.Geocoder};t.prototype.getCoordsFromBounds=function(n){if(n===null||typeof n=="undefined")return null;var t=n.getNorthEast(),i=n.getSouthWest();return{NORTH_EAST:n.getNorthEast(),NORTH_WEST:new google.maps.LatLng(t.lat(),i.lng(),!1),SOUTH_EAST:new google.maps.LatLng(i.lat(),t.lng(),!1),SOUTH_WEST:n.getSouthWest()}};t.prototype.geocode=function(n,t){var i=new jQuery.Deferred,r={callback:function(n){i.resolve(n)}};return this.googleGeocoder.geocode({address:n,region:t},r.callback),i.promise()};n.GeocoderService=t}(frm.services),function(n){var i={Room:new google.maps.MarkerImage("/Content/Images/Search/Maps/pin_exact.png"),RoomStaffPick:new google.maps.MarkerImage("/Content/Images/Search/Maps/pin_exact.png"),ExternalRoom:new google.maps.MarkerImage("/Content/Images/Search/Maps/pin_exact.png"),Property:new google.maps.MarkerImage("/Content/Images/Search/Maps/pin_external.png"),ContactedRoom:new google.maps.MarkerImage("/Content/Images/Search/Maps/pin_exact_contacted.png"),NewRoom:new google.maps.MarkerImage("/Content/Images/Search/Maps/pin_exact_new.png")},t=function(){this.cachedMarkers={};this.clusterer={}};t.prototype.getMarker=function(n,t,i){return new google.maps.Marker({icon:exactMarkerType,position:new google.maps.LatLng(t,i)})};t.prototype.clearMarkers=function(n){var t=this.cachedMarkers[n],i=this.clusterer[n];typeof t!="undefined"&&t instanceof Array&&(ko.utils.arrayForEach(t,function(n){n.setMap(null);google.maps.event.clearInstanceListeners(n,"click")}),this.cachedMarkers[n]=[]);typeof i!="undefined"&&i.clearMarkers()};t.prototype.setMarker=function(n,t,i,r,u){var f=this.createMarker(n,t,i,r,u);return f.setMap(n),f};t.prototype.createMarker=function(n,t,r,u,f){var s=this.cachedMarkers[n],e=null,o;if(typeof this.cachedMarkers[n]=="undefined"&&(this.cachedMarkers[n]=[]),e=new google.maps.Marker({icon:i[t],position:new google.maps.LatLng(r,u)}),typeof f!="undefined")for(o in f)f.hasOwnProperty(o)&&google.maps.event.addListener(e,o,function(n){return function(){f[n](e)}}(o));return this.cachedMarkers[n].push(e),e};t.prototype.cluster=function(n){var t=this.cachedMarkers[n];typeof this.clusterer[n]=="undefined"?(this.clusterer[n]=new MarkerClusterer(n,t,{gridSize:60,maxZoom:13,styles:[{url:"/content/images/misc/search/marker-group.png",width:56,height:56,textColor:"#FFF",fontFamily:"Lato, Helvetica, sans-serif"}]}),google.maps.event.addListener(this.clusterer[n],"clusterclick",function(t){n.setCenter(t.center_);n.setZoom(n.zoom+1)})):(this.clusterer[n].clearMarkers(),this.clusterer[n].addMarkers(t))};n.GoogleMarkerService=t}(frm.services),function(n){var i=function(n,t,i){this.service=n;this.onStartFunc=t;this.onFinishFunc=i},t;i.prototype.start=function(){this.service.start();this.onStartFunc&&this.onStartFunc()};i.prototype.done=function(){this.onFinishFunc&&this.onFinishFunc();this.service.finish()};i.prototype.restart=function(){this.service.restart()};t=function(n){n=n||{};this.$pageProgress=null;this.isRunning=!1;this.performAnimation=n.progressAnimation};t.prototype.create=function(n,t){return new i(this,n,t)};t.prototype.start=function(){var n=this;if(this.performAnimation){n.$pageProgress=$("#page-progress");function t(i){var u=100-i,r=i+.15*Math.pow(1-Math.sqrt(u),2);n.$pageProgress.animate({width:r+"%"},1e3,function(){n.isRunning&&t(r)})}n.isRunning||(n.isRunning=!0,n.$pageProgress.removeClass("error").css("width","0%").slideDown().show(),t(0))}};t.prototype.finish=function(){var n=this;this.performAnimation&&(n.isRunning=!1,n.$pageProgress.stop().animate({width:"100%"},function(){n.$pageProgress.fadeOut()}))};t.prototype.restart=function(){var n=this;this.performAnimation&&(n.isRunning=!1,n.$pageProgress.addClass("error").stop().slideUp(function(){n.start()}))};n.ProgressLoaderService=t}(frm.services),function(n){function t(){this.requests={}}t.prototype.request=function(n,t,i){i=i||{};var r=this;return this.request.hasOwnProperty(n)&&(this.request[n].abort(),i.onNewRequest&&i.onNewRequest()),this.request[n]=t,t.then(function(){delete r.request[n]}),t};n.SingleAjaxRequestService=t}(frm.services),function(n){function i(n){return n.indexOf("establishment")>=0?"establishment":n.indexOf("street_address")>=0?"street_address":n.indexOf("route")>=0?"route":n.indexOf("sublocality")>=0?"sublocality":n.indexOf("country")>=0?"country":n.indexOf("neighborhood")>=0?"neighborhood":n.indexOf("administrative_area_level_1")>=0?"region":"locality"}function r(n){for(var r={},u=n.address_components,f=n.geometry.location,i,t=0;t<u.length;t++)i=u[t],r[i.types[0]]={long:i.long_name,short:i.short_name};return r.coords={lat:f.lat(),lng:f.lng()},r}function t(n,t,i){if(typeof t=="undefined")throw new Error("GoogleMap/Input can not be undefined");this.placesService=new frm.maps.places.PlacesService(n,i);this.googlePlacesService=new google.maps.places.PlacesService(t)}t.prototype.getSuggestions=function(n){var t=new jQuery.Deferred;return this.placesService.getPlacePredictions(n,function(n){t.resolve(n)},"terms"),t};t.prototype.geocode=function(n){var t=new jQuery.Deferred,u={reference:n.ref};return this.googlePlacesService.getDetails(u,function(u){var f,e,o;if(typeof u!="undefined"){f=r(u);e={type:i(u.types),address:n.text,location:f.coords};typeof f.country!="undefined"&&(e.country=f.country.long,e.countryCode=f.country.short);switch(e.type){case"street_address":e.streetNumber=f.street_number.long;e.street=f.route.long;e.locality=f.locality.long;typeof f.country!="undefined"&&f.country.short==="US"&&typeof f.administrative_area_level_1!="undefined"&&(e.state=f.administrative_area_level_1.short);typeof f.postal_code!="undefined"&&(e.postalCode=f.postal_code.long);typeof f.sublocality!="undefined"&&(e.subLocality=f.sublocality.long);break;case"route":e.street=f.route.long;e.locality=typeof f.locality!="undefined"?f.locality.long:"";break;case"establishment":e.name=u.name;typeof f.locality!="undefined"?e.locality=f.locality.long:e.coords=f.coords;break;case"country":e.country=f.country.long;break;case"sublocality":typeof f.sublocality!="undefined"?e.sublocality=f.sublocality.long:typeof f.sublocality_level_1!="undefined"&&(e.sublocality=f.sublocality_level_1.long);e.locality=f.locality.long;break;case"neighborhood":e.neighborhood=f.neighborhood.long;e.locality=f.locality.long;break;case"region":e.locality=f.administrative_area_level_1.long;break;default:o="";typeof f.locality!="undefined"?o=f.locality.long:typeof f.administrative_area_level_2!="undefined"&&(o=f.administrative_area_level_2.long);e.locality=o}t.resolve(e,u)}}),t};n.GoogleSuggestionService=t}(frm.services),function(n){n.AgentDispatchService={changeDispatchDate:function(n,t){return $.ajax({type:"POST",url:"/Api/Web/Dispatch/UpdateDispatchDate",data:{AccountId:n,DispatchDate:t}})},stop:function(n){return $.ajax({type:"POST",url:"/Api/Web/Dispatch/Stop?accountId="+n})},remove:function(n){return $.ajax({type:"POST",url:"/Api/Web/Dispatch/Delete?accountId="+n})}}}(frm.services),function(n){function t(){}t.prototype.saveEasyComplete=function(n,t,i,r,u,f){return $.ajax({url:"/Api/Web/Tenant/SaveEasyComplete",type:"POST",data:{SearchArea:n,MaxRent:r,Coordinates:{Latitude:t,Longitude:i},CountryCode:u,CurrencyCode:f}})};t.prototype.createSearchArea=function(n,t,i,r){return $.ajax({url:"/Api/Web/SearchArea/Create",type:"POST",data:{SearchArea:n,Coordinates:{Latitude:t,Longitude:i},CountryCode:r}})};t.prototype.createSearchAreaByRoom=function(n){return $.ajax({url:"/Api/Web/SearchArea/CreateFromRoom?roomId="+n,type:"POST"})};t.prototype.saveRentAndCurrency=function(n,t){return $.ajax({url:"/Api/Web/Tenant/SaveRentAndCurrency",type:"POST",data:{MaxRent:n,CurrencyCode:t}})};t.prototype.saveMoveInDate=function(n){return $.ajax({url:"/Api/Web/Tenant/SaveMoveInDate?moveInDate="+n,type:"POST"})};t.prototype.saveTenantBasicData=function(n){return $.ajax({url:"/Api/Web/Tenant/SaveTenantBasicDatePopup",type:"POST",data:n})};n.TenantService=t}(frm.services),function(){frm.services.AddressFactory={create:function(n,t){return(t=typeof t!="undefined"?t:!0,t&&n.type!=="street_address"&&n.type!=="route")?null:{Country:n.country,CountryCode:n.countryCode,Locality:n.locality,SubLocality:n.subLocality,Latitude:n.location.lat,Longitude:n.location.lng,Street:n.street,StreetNumber:n.streetNumber,PostalCode:n.postalCode,DisplayAddress:n.address}}}}(),function(n){n.CountryService={updateSettings:function(n,t){return $.ajax({url:"/Api/Web/Country/UpdateSettings",type:"POST",data:{CountryCode:n,Settings:t}})},fetch:function(){return $.ajax({url:"/Api/Web/Country/Get",type:"GET"})},fetchAll:function(){return $.ajax({url:"/Api/Web/Country/Fetch",type:"GET"})},getByCountryCode:function(n){return $.ajax({url:"/Api/Web/Country/GetByContryCode?countryCode="+n,type:"GET"})}}}(frm.services),function(n){n.MessageService={getMessageListItemsByAccountId:function(n,t){return $.ajax({type:"GET",url:"/Api/Web/Message/GetMessageListItemsByAccountId",data:{accountId:n,pageIndex:t}})},getMessageListItemsBetweenTenants:function(n){return $.ajax({type:"GET",url:"/Api/Web/Message/GetMessageListItemsBetweenTenants",data:{pageIndex:n}})},requestThread:function(n,t,i){return $.ajax({type:"GET",url:"/Api/Web/Message/Thread",data:{threadId:n,pageIndex:t,timestamp:i.toISOString()}})},setThreadViewed:function(n){return $.ajax({type:"POST",url:"/Api/Web/Message/SetThreadViewed?threadId="+n})},setThreadDeleted:function(n){return $.ajax({type:"POST",url:"/Api/Web/Message/SetThreadDeleted?threadId="+n})},setThreadReactivated:function(n){return $.ajax({type:"POST",url:"/Api/Web/Message/SetThreadReactivated?threadId="+n})},setThreadUnreadMark:function(n){return $.ajax({type:"POST",url:"/Api/Web/Message/setThreadUnreadMark?threadId="+n})},findThreads:function(n){return $.ajax({type:"GET",url:"/Api/Web/Message/FindThreads",data:{pageIndex:n}})},findArchivedThreads:function(n){return $.ajax({type:"GET",url:"/Api/Web/Message/FindArchivedThreads",data:{pageIndex:n}})},findThreadsByCategory:function(n,t){return $.ajax({type:"GET",url:"/Api/Web/Message/FindThreadsByCategory",data:{pageIndex:n,categoryId:t}})},assignThreadToCategory:function(n,t,i){return $.ajax({type:"POST",url:"/Api/Web/Message/AssignThreadToCategory?threadId="+n+"&participentId="+t+"&category="+i})},removeThreadFromCategory:function(n,t){return $.ajax({type:"POST",url:"/Api/Web/Message/RemoveThreadFromCategory?threadId="+n+"&participentId="+t})}};n.MessageTemplateService={getTemplatesByAccountId:function(n){return $.ajax({type:"GET",url:"/Api/Web/ThreadMessageTemplate/GetTemplatesByAccountId?accountId="+n})},createTemplate:function(n){return $.ajax({type:"POST",url:"/Api/Web/ThreadMessageTemplate/CreateTemplate",data:{Name:n.Name,Message:n.Message}})},editTemplate:function(n){return $.ajax({type:"POST",url:"/Api/Web/ThreadMessageTemplate/EditTemplate",data:n})},deleteTemplate:function(n){return $.ajax({type:"POST",url:"/Api/Web/ThreadMessageTemplate/DeleteTemplate",data:n})}};n.BulkMessageService={sendCategoryBulkMessage:function(n){return $.ajax({type:"POST",url:"/Api/Web/Message/BulkMessageList",data:n})}}}(frm.services),function(n){n.TransactionService={fetch:function(n,t){return $.ajax({type:"GET",url:"/Api/Web/Transaction/FetchTransactions?page="+t,data:n})},search:function(){}}}(frm.services),function(n){n.SupportService={sendContactMessage:function(n,t,i){return $.ajax({type:"POST",url:"/Api/Web/Support/Contact",data:{Message:n,Name:t,email:i}})},requestFeature:function(n,t){var r=[],i;for(i in t)t.hasOwnProperty(i)&&r.push({Key:i,Value:t[i]});return $.ajax({type:"POST",url:"/Api/Web/Support/FeatureRequest",data:{name:n,data:r}})}}}(frm.services),function(n){n.PictureService={fetch:function(n){return $.ajax({url:"/Api/Web/Pictures/Fetch",type:"GET",data:{pictureType:n}})},remove:function(n){return $.ajax({url:"/Api/Web/Pictures/Remove",type:"POST",data:{pictureId:n}})},setPrimary:function(n,t){return $.ajax({url:"/Api/Web/Pictures/SetPrimary",type:"POST",data:{pictureId:n,pictureType:t}})},getPendingStatus:function(n,t){return $.ajax({url:"/Api/Web/Pictures/GetPendingStatus",type:"GET",data:{pendingPictures:n,pictureType:t}})},getById:function(n){return $.ajax({url:"/Api/Web/Pictures/GetById",type:"GET",data:{pictureId:n}})},update:function(n,t,i){return $.ajax({url:"/Api/Web/Pictures/Update",type:"POST",data:{pictureId:n,description:t,angle:i}})},queue:function(n){return $.ajax({url:"/Api/Web/Pictures/Queue",type:"GET",data:{pictureId:n}})},queueUpload:function(n){return $.ajax({url:"/Api/Web/Pictures/QueueUpload",type:"GET",data:n})}}}(frm.services),function(n){n.VoucherService={fetchVoucherGroups:function(){return $.ajax({url:"/Api/Web/VoucherGroup/GetAll",type:"GET"})},changeGroupIsActive:function(n,t){return $.ajax({url:"/Api/Web/VoucherGroup/UpdateActiveState",type:"POST",data:{voucherGroupId:n,isActive:t}})},fetchVouchersByGroupId:function(n){return $.ajax({url:"/Api/Web/Voucher/GetByGroupId",type:"GET",data:{voucherGroupId:n}})},createVoucherGroup:function(n){return $.ajax({url:"/Api/Web/VoucherGroup/Create",type:"POST",data:n})},updateVoucherGroup:function(n,t,i){return $.ajax({url:"/Api/Web/VoucherGroup/Update",type:"POST",data:{VoucherGroupId:n,Name:t,ExpirationDate:i}})},getVoucherTypes:function(){return $.ajax({url:"/Api/Web/VoucherType/GetAll",type:"GET"})},getVoucherDataTypes:function(n){return $.ajax({url:"/Api/Web/VoucherType/GetDataTypes",type:"GET",data:{voucherTypeId:n}})},createNewVouchers:function(n){return $.ajax({url:"/Api/Web/Voucher/Create",type:"POST",data:n})},redeem:function(n){return $.ajax({url:"/Api/Web/Voucher/Redeem",type:"POST",data:{VoucherCode:n}})},isRedeemable:function(n){return $.ajax({url:"/Api/Web/Voucher/IsRedeemable",type:"POST",data:{VoucherCode:n}})}}}(frm.services),function(n){n.ArticleService={fetch:function(){return $.ajax({url:"/Api/Web/Article/Get",type:"GET"})},fetchBySiteId:function(n){return $.ajax({url:"/Api/Web/Article/GetBySiteId?SiteId="+n,type:"GET"})},fetchSearchArticles:function(n){return $.ajax({url:"/Api/Web/Article/SearchArticles",type:"GET",data:{Text:n.Text,SiteId:n.SiteId}})},createArticle:function(n){return $.ajax({url:"/Api/Web/Article/Create",type:"POST",data:n})},Update:function(n){return $.ajax({url:"/Api/Web/Article/Update",type:"POST",data:n})},changeStatus:function(n){return $.ajax({url:"/Api/Web/Article/ChangeStatus",type:"POST",data:n})},Delete:function(n){return $.ajax({url:"/Api/Web/Article/DeleteArticle?articleId="+n,type:"POST"})},getAuthors:function(){return $.ajax({url:"/Api/Web/Author/GetAuthors",type:"GET"})},getUsers:function(){return $.ajax({url:"/Api/Web/Account/GetUsers",type:"GET"})},createAuthor:function(n){return $.ajax({url:"/Api/Web/Author/CreateAuthor",type:"POST",data:n})},UpdateAuthor:function(n){return $.ajax({url:"/Api/Web/Author/UpdateAuthor",type:"POST",data:n})},IsUserAuthor:function(){return $.ajax({url:"/Api/Web/Author/IsUserAuthor",type:"GET"})},fetchCategories:function(){return $.ajax({url:"/Api/Web/Article/GetArticleCategories",type:"GET"})},editCategory:function(n){return $.ajax({url:"/Api/Web/Article/EditCategory",type:"POST",data:n})},saveCategory:function(n){return $.ajax({url:"/Api/Web/Article/CreateCategory",type:"POST",data:n})},getCategoriesByArticleId:function(n){return $.ajax({url:"/Api/Web/Article/GetArticleAssignedCategory?articleId="+n,type:"GET"})}}}(frm.services),function(n){n.FrontpageService={fetchBySiteId:function(n){return $.ajax({url:"/Api/Web/FrontpageAdmin/GetBySiteId?siteId="+n,type:"GET"})},createNew:function(n){return $.ajax({url:"/Api/Web/FrontpageAdmin/Create",type:"POST",data:n})},"delete":function(n){return $.ajax({url:"/Api/Web/FrontpageAdmin/Delete?id="+n,type:"POST"})},edit:function(n){return $.ajax({url:"/Api/Web/FrontpageAdmin/Edit",type:"POST",data:n})},changeStatus:function(n,t){return $.ajax({url:"/Api/Web/FrontpageAdmin/ChangeStatus?id="+n+"&active="+t,type:"POST"})},removeTagline:function(n){return $.ajax({url:"/Api/Web/FrontpageAdmin/RemoveTagline",type:"POST",data:n})}}}(frm.services),function(n){n.ViewHitService={fetchArticleViewHit:function(n,t,i){return $.ajax({url:"/Api/Web/ViewHit/GetViewHitArticle",type:"GET",data:{articleId:n,fromDate:t,toDate:i}})}}}(frm.services),function(n){n.SiteSettingsService={fetchAllSettings:function(n,t){return $.ajax({url:"/Api/Web/SiteSettings/GetAllSettings",type:"GET",data:{SiteId:n,UserType:t}})},insertSetting:function(n){return $.ajax({url:"/Api/Web/SiteSettings/InsertSetting",type:"POST",data:n})},deactivateSetting:function(n){return $.ajax({url:"/Api/Web/SiteSettings/deactivateSetting",type:"POST",data:{SettingId:n}})},createWelcomeMessage:function(n){return $.ajax({url:"/Api/Web/SiteSettings/CreateWelcomeMessage",type:"POST",data:n})},findWelcomeMessages:function(n){return $.ajax({url:"/Api/Web/SiteSettings/FindWelcomeMessages",type:"GET",data:{siteId:n}})},deactivateWelcomeMessage:function(n){return $.ajax({url:"/Api/Web/SiteSettings/DeactivateWelcomeMessage",type:"POST",data:{id:n}})},addConfiguration:function(n,t){return $.ajax({url:"/Api/Web/SiteSettings/AddConfiguration",type:"POST",data:{siteId:n,configurationName:t}})},removeConfiguration:function(n,t){return $.ajax({url:"/Api/Web/SiteSettings/RemoveConfiguration",type:"POST",data:{siteId:n,configurationName:t}})}}}(frm.services),function(n){n.SendGridService={fetchInvalidEmails:function(){return $.ajax({type:"GET",url:"/Api/Web/SendGrid/GetInvalidEmails"})},deleteInvalidEmail:function(n){return $.ajax({type:"GET",url:"/Api/Web/SendGrid/DeleteInvalidEmail",data:{email:n}})}}}(frm.services),function(n){n.LoginLogService={getByAccountId:function(n){return $.ajax({url:"/Api/Web/LoginLog/GetByAccountId",type:"GET",data:{accountId:n}})}}}(frm.services),function(n){n.SecurityService={block:function(n,t){return $.ajax({type:"POST",url:"/Api/Web/Security/BlockInternetProtocolAddresses",data:{InternetProtocolAddresses:n,AccountId:t}})},unblock:function(n,t){return $.ajax({type:"POST",url:"/Api/Web/Security/UnblockInternetProtocolAddresses",data:{InternetProtocolAddresses:n,AccountId:t}})},getBlockedInternetProtocolAddressesByAccountId:function(n){return $.ajax({type:"GET",url:"/Api/Web/Security/FindBlockedInternetProtocolAddressesByAccountId",data:{AccountId:n}})}}}(frm.services),function(n){n.RoomService={findExternalRooms:function(){return $.ajax({type:"GET",url:"/Api/Web/ExternalRoom/FindAll"})},findExternalRoomsPaged:function(n){return $.ajax({type:"GET",url:"/Api/Web/ExternalRoom/FindAllPaged",data:{page:n}})},getCountriesWithRooms:function(){return $.ajax({type:"GET",url:"/Api/Web/ExternalRoom/GetCountriesWithRooms"})},findWithAttentionRequired:function(n){return $.ajax({type:"GET",url:"/Api/Web/ExternalRoom/findWithAttentionRequired?countryCode="+n})},getExternalRoom:function(n){return $.ajax({type:"GET",url:"/Api/Web/ExternalRoom/GetById",data:{id:n}})},deactivateRoom:function(n){return $.ajax({type:"POST",url:"/Api/Web/ExternalRoom/DeactivateRoom?roomId="+n})},updateExternalRoom:function(n,t,i){return $.ajax({type:"POST",url:"/Api/Web/ExternalRoom/Update?roomId="+n,data:{Street:t.Street,ZipCode:t.ZipCode,CityName:t.CityName,Price:t.Price,Advance:t.Advance,Deposit:t.Deposit,FixedExpenses:t.FixedExpenses,Period:t.Period,CountryCode:t.CountryCode,ValutaId:t.ValutaId,Area:t.Area,HouseNumber:t.HouseNumber,NumberOfRooms:t.NumberOfRooms,location:{Latitude:t.Location.Latitude,Longitude:t.Location.Longitude},title:t.Title,description:t.Description,available:t.Available,contactInformations:i.map(function(n){return{Type:n.key,Value:n.value}})}})},createExternalRoom:function(n,t){return $.ajax({type:"POST",url:"/Api/Web/ExternalRoom/Create",data:{Street:n.Street,ZipCode:n.ZipCode,CityName:n.CityName,Price:n.Price,Advance:n.Advance,Deposit:n.Deposit,FixedExpenses:n.FixedExpenses,Period:n.Period,Area:n.Area,HouseNumber:n.HouseNumber,NumberOfRooms:n.NumberOfRooms,CountryCode:n.CountryCode,location:{Latitude:n.Location.Latitude,Longitude:n.Location.Longitude},description:n.Description,available:n.Available,contactInformations:t.map(function(n){return{Type:n.key,Value:n.value}})}})},activateImport:function(n){return $.ajax({type:"GET",url:"/Api/Web/RoomExternal/ActivateImport",data:{roomId:n}})},detachImage:function(n,t){return $.ajax({type:"POST",url:"/Api/Web/ExternalRoom/DetachImage?roomId="+n+"&roomImageId="+t})},flagRented:function(n,t,i,r){if(typeof n=="undefined")throw new Error("roomId is required");if(typeof t=="undefined")throw new Error("rented is required");return $.ajax({url:"/Api/Web/Room/Rented",type:"POST",data:{roomId:n,rented:t,rentedText:i,sentMessage:r}})},flagContactable:function(n,t){if(typeof n=="undefined")throw new Error("roomId is required");if(typeof t=="undefined")throw new Error("contactable is required");return $.ajax({url:"/Api/Web/Room/Contactable",type:"POST",data:{roomId:n,contactable:t}})},updateAdplaced:function(n){return $.ajax({url:"/Api/Web/Room/UpdateAdplaced?roomId="+n,type:"POST"})},saveEasyComplete:function(n,t,i,r,u,f){var e=$.extend(n,{Rent:t,Deposit:i,RentalPeriod:r,SquareMeters:u,Currency:f});return $.ajax({url:"/Api/Web/Room/SaveEasyComplete",type:"POST",data:e})},getStaffPicks:function(n){return $.ajax({url:"/Api/Web/Room/GetStaffPicks?limit="+n,type:"GET"})},manuelAttentionApprove:function(n){return $.ajax({url:"/Api/Web/ExternalRoom/ManuelAttention?reject=false&roomId="+n,type:"POST"})},manuelAttentionReject:function(n){return $.ajax({url:"/Api/Web/ExternalRoom/ManuelAttention?reject=true&roomId="+n,type:"POST"})},reactiveRoom:function(n){return $.ajax({url:"/Api/Web/Room/ReactiveRoom?roomId="+n,type:"POST"})},ExternalRoomPartner:{getPartners:function(){},getPartners:function(n){return $.ajax({type:"GET",url:"/Api/Web/ExternalRoom/GetPartners",data:{roomId:n}})}}}}(frm.services),function(n){n.FeedPartnerService={get:function(n,t){return $.ajax({type:"GET",url:"/Api/Web/FeedPartner/Get",data:{itemId:n,type:t}})},toggle:function(n,t,i,r){return $.ajax({type:"POST",url:"/Api/Web/FeedPartner/Toggle",data:{partnerId:n,itemId:t,state:i,type:r}})}}}(frm.services);undefined,function(n){n.LogService={getAccountLogs:function(n,t,i,r,u){return i=i||null,r=r||undefined,u=u||[],$.ajax({url:"/Api/Web/Logging/GetAccountLogs",type:"GET",data:{pageIndex:n,accountId:t,events:i,siteId:r,searchFields:u}})},getAccountEvents:function(n){return $.ajax({url:"/Api/Web/Logging/GetAccountEvents",type:"GET",data:{accountId:n}})},getWatchdogLogs:function(n,t,i){return t=t||undefined,i=i||undefined,$.ajax({url:"/Api/Web/Logging/GetWatchdogLogs",type:"GET",data:{pageIndex:n,events:t,siteId:i}})},getWatchdogEvents:function(){return $.ajax({url:"/Api/Web/Logging/GetWatchdogEvents",type:"GET"})},getLogs:function(n,t,i,r){return t=t||null,i=i||undefined,r=r||[],$.ajax({url:"/Api/Web/Logging/GetLogs?pageIndex="+n+"&siteId="+i,type:"POST",data:{events:t,searchFields:r}})},getEvents:function(){return $.ajax({url:"/Api/Web/Logging/GetEvents",type:"GET"})},getSystemLogs:function(n,t,i){return t=t||undefined,i=i||undefined,$.ajax({url:"/Api/Web/Logging/GetSystemLogs",type:"GET",data:{pageIndex:n,events:t,searchFields:i}})},getSystemEvents:function(){return $.ajax({url:"/Api/Web/Logging/GetSystemEvents",type:"GET"})}}}(frm.services),function(){frm.services.AnalyticsService={SplitTesting:{findAll:function(n){return $.ajax({url:"/api/web/abtest/findall",method:"GET",data:n})},find:function(n){return $.ajax({url:"/api/web/abtest/find",method:"GET",data:{id:n}})},create:function(n){return $.ajax({url:"/api/web/abtest/create",method:"POST",data:n})}}}}(),function(n,t,i){ko.validation.rules.checkedTerms={validator:function(n){return!!n}};ko.validation.registerExtenders();ko.validation.configure({decorateElement:!0,registerExtenders:!0,messagesOnModified:!0,insertMessages:!1,parseInputAttributes:!0,messageTemplate:null});var r="78C8FB76-B9D6-49D2-9973-144A9F168B90";n.LandingpageViewModel=function(n){function f(n,t){var f=u.priceRange(),e=u.city();frm.services.LeadService.register(r,n,t,f,e).done(function(){$("body, html").animate({scrollTop:0});u.step(1)}).fail(function(n){var t=JSON.parse(n.responseText);n.status===409&&t.message==="AlreadyCreated"?i.openError("Din email er allerede tilmeldt denne kampagne."):i.openError("Der skete en fejl og vi kunne ikke tilmelde dig kampagnen")})}var u=this;n=n||{};this.cities=n.cities;this.priceRanges=n.priceRanges;this.city=ko.observable().extend({required:{message:"Du skal vælge en by"}});this.priceRange=ko.observable().extend({required:{message:"Du skal vælge din budget"}});this.license=ko.observable().extend({checkedTerms:{message:"Du skal acceptere betingelserne for brug af dette tilbud"}});this.name=ko.observable().extend({required:!0});this.email=ko.observable().extend({required:!0});this.step=ko.observable(0);this.createThroughFacebook=function(){var n=ko.validation.group([this.city,this.priceRange,this.license]);n().length==0?t.requestLoginDialog().then(function(n){return t.getUser(n.accessToken,n.userID,n.expiresIn,n.signedRequest)},function(){modelService.openError("Hvis du vil oprette dig igennem facebook har vi brug for at at du godkender os")}).then(function(n){f(n.data.name,n.data.email)}):n.showAllMessages()};this.create=function(){var n=ko.validation.group([this.city,this.priceRange,this.name,this.email,this.license]),t=this.name(),i=this.email();n().length==0?f(t,i):n.showAllMessages()}}}(frm.models,frm.services.FacebookService,frm.services.ModalService),function(n){var t=function(){var n=this};n.TenantSearchViewModel=t}(frm.models.search,frm.services),function(n){function f(n,t){var i=this;(function(){for(var t in n)if(n.hasOwnProperty(t)){if(t==="IsInterested"){i[t]=ko.observable(n[t]);continue}i[t]=Object.prototype.toString.call(n[t])==="[object Array]"?n[t]:n[t]}})();i.setInterested=function(){if(!i.IsInterested()){if(!options.isLoggedIn){var n=t();frm.models.GenericPopupViewModel.create(n).then(function(){n.Areas.SignUp.PropertyListingSignUpView()});return}i.IsInterested(!0);frm.services.PropertyService.setInterested(i.Id,!0)}}}(function(n,t){typeof define=="function"&&define.amd?define(t):typeof module=="object"?module.exports=t():n.augment=t()})(this,function(){"use strict";var t=function(){},i=Array.prototype.slice,n=function(n,r){var s=t.prototype=typeof n=="function"?n.prototype:n,u=new t,f=r.apply(u,i.call(arguments,2).concat(s)),e,o;if(typeof f=="object")for(e in f)u[e]=f[e];return u.hasOwnProperty("constructor")?(o=u.constructor,o.prototype=u,o):u};return n.defclass=function(n){var t=n.constructor;return t.prototype=n,t},n.extend=function(t,i){return n(t,function(n){return this.uber=n,i})},n});var t=new frm.services.GoogleMarkerService,u=augment.defclass,r=u(function(){function n(n,t,i){var r=n.create();return typeof t.RentalPeriods!="undefined"&&r.appendPart("rentalPeriods",t.RentalPeriods),typeof t.Gender!="undefined"&&r.appendPart("sex",t.Gender),typeof t.Smoking!="undefined"&&r.appendPart("smoking",t.Smoking),typeof t.Facilities!="undefined"&&r.appendPart("facilities",t.Facilities),typeof t.RentRange!="undefined"&&(typeof t.RentRange.Min!="undefined"&&t.RentRange.Min!==0&&r.appendPart("rentMin",t.RentRange.Min),typeof t.RentRange.Max!="undefined"&&t.RentRange.Max!==2e4&&r.appendPart("rentMax",t.RentRange.Max)),typeof t.AgeRange!="undefined"&&(typeof t.AgeRange.Min!="undefined"&&t.AgeRange.Min!==0&&r.appendPart("minAge",t.AgeRange.Min),typeof t.AgeRange.Max!="undefined"&&t.AgeRange.Max!==99&&r.appendPart("maxAge",t.AgeRange.Max)),typeof t.HasProfileImage!="undefined"&&t.HasProfileImage&&r.appendPart("profilePicture",1),typeof t.HasImageOfRoom!="undefined"&&t.HasImageOfRoom&&r.appendPart("roomPicture",1),typeof t.TenantSort!="undefined"&&t.TenantSort!=="lastactive"&&r.appendPart("sort",t.TenantSort),typeof t.ResidenceSort!="undefined"&&t.ResidenceSort!=="newest"&&r.appendPart("sort",t.ResidenceSort),typeof t.HasComments!="undefined"&&t.HasComments&&r.appendPart("comments",1),typeof t.HasInterested!="undefined"&&t.HasInterested&&r.appendPart("interests",1),typeof i!="undefined"&&i>1&&r.appendPart("page",i),typeof t.Nationality!="undefined"&&t.Nationality!==""&&r.appendPart("nationality",t.Nationality),r.toString()}function t(t,i,r,u){return i.substring(0,1)!=="/"&&(i="/"+i),{Url:i+n(t,r,u),NextPageUrl:i+n(t,r,u+1),PreviousPageUrl:i+n(t,r,u-1)}}return{constructor:function(n,t){this.VIEW_STATE={DISABLE_FETCH:!1,ENABLE_PAGE_INIT_REDIRECT:!0,DISABLE_MAP_EVENT:!1,DISABLE_REDIRECT:!1,DISABLE_FILTER:!1,DISABLE_PAGEINDEX_UPDATE:!0,CURRENT_QUERY_MODE:undefined,CURRENT_QUERY:undefined};this._services={searchService:new frm.services.SearchService,hashUrlService:new frm.services.HashUrlService,geocoderService:new frm.services.GeocoderService};this.ViewId=Math.round(Math.random()*4e3);this.Result=ko.observableArray();this.TotalItems=ko.observable(0);this.IsLastPage=ko.observable(!1);this.TotalPages=ko.observable(0);this.NextPageUrl=ko.observable();this.PreviousPageUrl=ko.observable();this.Loading=ko.observable(!0);this.Query=ko.observable(undefined);this.SearchState=ko.observable(n.viewState);this.DisplaySearchDescription=ko.observable(!0);this.SearchDescriptionOpen=ko.observable(!1);this.FilterChanged=ko.observable(!0);this.startLocation=n.startLocation;this.basePath=n.basePath;this.SearchState.subscribe(function(n){n==="Searching"&&t("Searching");n==="Start"&&t("Start")});var i=ko.computed(function(){return ko.toJS(this.Filters)}.bind(this));this._filterListenerListener=i.subscribe(function(t){n.events.onFilterChanged(t);this.VIEW_STATE.DISABLE_FILTER||(this.FilterChanged(!0),this._redirect())}.bind(this));this._updatePageUrls()},_getFetchImpl:function(){throw new Error("_getFetchImpl is not implanted");},_updatePageUrls:function(n){n=n||decodeURI(window.location.pathname);var r=ko.toJS(this.Filters),u=this.Filters.PageIndex(),i=t(this._services.hashUrlService,n,r,u);return this.NextPageUrl(i.NextPageUrl),this.PreviousPageUrl(i.PreviousPageUrl),i},_redirect:function(n){var i=undefined,t;if(typeof n=="string"?i=n:typeof n!="undefined"&&(i=this._services.searchService.getUrl(n.type,options.basePath+"/",n.locality,n.sublocality,n.country)),t=this._updatePageUrls(i),this.VIEW_STATE.ENABLE_PAGE_INIT_REDIRECT){if(!Modernizr.history){location.href=t.Url;return}history.pushState({},"",t.Url)}else this.VIEW_STATE.ENABLE_PAGE_INIT_REDIRECT=!0,history.replaceState({},"",t.Url)},_fetch:function(n){if(this.VIEW_STATE.DISABLE_PAGEINDEX_UPDATE=!1,this.VIEW_STATE.DISABLE_FETCH){this.VIEW_STATE.DISABLE_FETCH=!1;return}return this.Loading(!0),this.SearchState("Searching"),options.showFilter(!1),options.functions.scrollToTop(),this.FilterChanged(!1),this._getFetchImpl()($.extend({Sort:this.Sort()},ko.toJS(this.Filters)),n).then(function(n){this._customMap(n.data);this.Result(this._map(n.data).Items);this.TotalItems(n.data.TotalItems);this.IsLastPage(n.data.IsLastPage);this.TotalPages(n.data.TotalPages);this.VIEW_STATE.DISABLE_FILTER=!0;this.Filters.PageIndex(n.data.Number);this.VIEW_STATE.DISABLE_FILTER=!1;this.Loading(!1)}.bind(this))},_customMap:function(n){return n},_map:function(n){return n},StartSearch:function(){this.Filters.PageIndex(0);this._fetch(0)},NextPage:function(n,t){var i,r,u;if(t.ctrlKey||t.which===2)return!0;i=0;this.FilterChanged()||(r=this.Filters.PageIndex(),u=r+1,i=u);this.Filters.PageIndex(i);this._redirect();this._fetch(i)},PrevPage:function(){var n,t,i;if(event.ctrlKey||event.which===2)return!0;n=0;this.FilterChanged()||(t=this.Filters.PageIndex(),i=t-1,n=i);this.Filters.PageIndex(n);this._redirect();this._fetch(n)},close:function(){this._filterListenerListener.dispose();delete this._filterListenerListener},ClearSearch:function(){this.Filters.Query=undefined;this.Filters.Coordinates=undefined;this.Query("");this._redirect(this.basePath+"/")},OnQueryChanged:function(n){var t,i;if(n===null){this.ClearSearch();return}t=options.area;n.locality&&(i=n.locality.toLowerCase(),t=="koebenhavn"&&(t="københavn"),t!=i&&this.DisplaySearchDescription(!1));this.VIEW_STATE.CURRENT_QUERY_MODE="Address";this.VIEW_STATE.CURRENT_QUERY=n.address;this.Query(this.VIEW_STATE.CURRENT_QUERY);this.VIEW_STATE.DISABLE_FILTER=!0;this.VIEW_STATE.DISABLE_PAGEINDEX_UPDATE||this.Filters.PageIndex(0);this.Filters.SearchType="address";this.Filters.Query=this.VIEW_STATE.CURRENT_QUERY;this.Filters.Address(frm.services.AddressFactory.create(n,!1));this.VIEW_STATE.DISABLE_FILTER=!1;this._handleQueryGeocoding().then(function(){this._fetch(this.Filters.PageIndex());var t=this._services.searchService.getRedirectParameters(n);if(this.VIEW_STATE.DISABLE_REDIRECT){this.VIEW_STATE.DISABLE_REDIRECT=!1;return}this._redirect({type:"default",locality:t.locality,sublocality:t.sublocality,country:t.country})}.bind(this))}}}()),i=augment(r,function(n){var i={dom:{map:undefined},googleIdleEvent:null};return{constructor:function(t,r){var u,f;n.constructor.apply(this,arguments);typeof i.dom.map=="undefined"&&(u=Math.max(document.documentElement.clientWidth,window.innerWidth||0)>768?!0:!1,i.dom.map=new google.maps.Map(document.getElementById("map-canvas"),{zoom:8,minZoom:2,panControl:!1,streetViewControl:!1,mapTypeControl:!1,draggable:u,scrollwheel:!1,styles:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#46bcec"},{visibility:"on"}]},{featureType:"transit.station.rail",elementType:"labels",stylers:[{visibility:"on"}]}],zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.RIGHT_BOTTOM}}));this._dom={$window:$(window)};this.Makers={isClustered:ko.observable(!0)};this.VIEW_STATE.CURRENT_QUERY_MODE=t.filter.SearchType;this.VIEW_STATE.CURRENT_QUERY=t.filter.Query;t.isMapLoaded()?r()==="Searching"&&(i.googleIdleEvent=google.maps.event.addListener(i.dom.map,"idle",this._googleIdleEventImpl.bind(this)),this.VIEW_STATE.CURRENT_QUERY_MODE==="address"?setTimeout(function(){this.VIEW_STATE.DISABLE_REDIRECT=!0;this.Query(this.VIEW_STATE.CURRENT_QUERY)}.bind(this),200):this.VIEW_STATE.CURRENT_QUERY_MODE==="coordinates"?(this.VIEW_STATE.DISABLE_REDIRECT=!0,f=new google.maps.LatLng(t.filter.Coordinates.lat,t.filter.Coordinates.lng),i.dom.map.setCenter(f),i.dom.map.setZoom(t.filter.Coordinates.zoom),google.maps.event.addListenerOnce(i.dom.map,"idle",function(){this._fetch(this.Filters.PageIndex())}.bind(this)),this.VIEW_STATE.DISABLE_REDIRECT=!0,google.maps.event.trigger(i.dom.map,"idle")):(google.maps.event.addListenerOnce(i.dom.map,"idle",function(){this._fetch(this.Filters.PageIndex())}.bind(this)),this.VIEW_STATE.DISABLE_REDIRECT=!0,google.maps.event.trigger(i.dom.map,"idle"))):google.maps.event.addListenerOnce(i.dom.map,"idle",function(){var r;google.maps.event.addListenerOnce(i.dom.map,"bounds_changed",function(){this.VIEW_STATE.DISABLE_FILTER=!0;this.Filters.Coords(this._services.geocoderService.getCoordsFromBounds(i.dom.map.getBounds()));this.VIEW_STATE.DISABLE_FILTER=!1;this._fetch(this.Filters.PageIndex());this.VIEW_STATE.DISABLE_MAP_EVENT=!0;i.googleIdleEvent=google.maps.event.addListener(i.dom.map,"idle",this._googleIdleEventImpl.bind(this))}.bind(this));t.isMapLoaded(!0);switch(this.VIEW_STATE.CURRENT_QUERY_MODE){case"coordinates":var n=this.VIEW_STATE.CURRENT_QUERY.substr(1).split(","),r=new google.maps.LatLng(n[0],n[1]),u=-1;n.length==3&&(u=parseInt(n[2]));i.dom.map.setCenter(r);u>=0&&i.dom.map.setZoom(u);break;case"address":this.VIEW_STATE.DISABLE_REDIRECT=!1;this.VIEW_STATE.DISABLE_FETCH=!0;this.VIEW_STATE.ENABLE_PAGE_INIT_REDIRECT=!1;this.Query(this.VIEW_STATE.CURRENT_QUERY);break;default:r=new google.maps.LatLng(t.startLocation.coords.latitude,t.startLocation.coords.longitude);this.VIEW_STATE.DISABLE_MAP_EVENT=!0;i.dom.map.setCenter(r);i.dom.map.setZoom(t.startLocation.zoom)}}.bind(this))},close:function(){n.close.apply(this,arguments);i.googleIdleEvent!==null&&google.maps.event.removeListener(i.googleIdleEvent)},ClearSearch:function(){var t=new google.maps.LatLng(this.startLocation.coords.latitude,this.startLocation.coords.longitude);this.VIEW_STATE.DISABLE_REDIRECT=!0;google.maps.event.addListenerOnce(i.dom.map,"idle",function(){this.Filters.PageIndex(0);this._fetch(this.Filters.PageIndex()).then(function(){this.FilterChanged(!1)}.bind(this))}.bind(this));i.dom.map.setCenter(t);i.dom.map.setZoom(this.startLocation.zoom);n.ClearSearch.apply(this,arguments)},_map:function(r){return setTimeout(function(){t.clearMarkers(i.dom.map);var n=function(n){return function(){window.open(n.Url)}};ko.utils.arrayForEach(r.Markers,function(r){t.setMarker(i.dom.map,r.Type,r.Latitude,r.Longitude,{click:n(r)})});t.cluster(i.dom.map)},100),n._map.apply(this,arguments)},_handleQueryGeocoding:function(){return this._services.geocoderService.geocode(this.VIEW_STATE.CURRENT_QUERY,"DK").then(function(n){var t=new jQuery.Deferred,r;return n.length===0?t.reject():(r=n[0].geometry,google.maps.event.addListenerOnce(i.dom.map,"bounds_changed",function(){this.VIEW_STATE.DISABLE_FILTER=!0;this.Filters.Coords(this._services.geocoderService.getCoordsFromBounds(i.dom.map.getBounds()));this.VIEW_STATE.DISABLE_FILTER=!1;t.resolve()}.bind(this)),this.VIEW_STATE.DISABLE_MAP_EVENT=!0,i.dom.map.fitBounds(r.viewport),google.maps.event.trigger(i.dom.map,"bounds_changed")),t.promise()}.bind(this))},_googleIdleEventImpl:function(){var n;if(this.VIEW_STATE.DISABLE_MAP_EVENT){this.VIEW_STATE.DISABLE_MAP_EVENT=!1;return}if(n=i.dom.map.getCenter(),typeof n!="undefined"){if(this.VIEW_STATE.CURRENT_QUERY_MODE="Coordinates",this.Filters.SearchType="coordinates",this.Filters.Coordinates={lat:n.lat(),lng:n.lng(),zoom:i.dom.map.getZoom()},this.VIEW_STATE.DISABLE_FILTER=!0,this.Filters.Coords(this._services.geocoderService.getCoordsFromBounds(i.dom.map.getBounds())),this.Filters.Address(undefined),this.DisplaySearchDescription(!1),this.VIEW_STATE.DISABLE_FILTER=!1,this.FilterChanged(!0),this.VIEW_STATE.DISABLE_REDIRECT){this.VIEW_STATE.DISABLE_REDIRECT=!1;return}var t=1e7,r=Math.round(n.lat()*t)/t,u=Math.round(n.lng()*t)/t;this._redirect({type:"coordinates",locality:"@"+r+","+u+","+i.dom.map.getZoom()})}}}});n.RoomSearchViewModel=augment(i,function(n){this.constructor=function(t){this.Layout={IsTextQueryVisible:!0,IsMapVisible:!0,IsFilterVisible:!0,IsSortVisible:!0,QueryPlaceHolder:t.localization.queryPlaceholder.residence,Sort:["newest","cheapest"]};this.Filters={ResidenceSort:ko.observable(t.filter.ResidenceSort),Address:ko.observable(t.filter.Address),Coords:ko.observable(t.filter.Coords),PageIndex:ko.observable(t.filter.PageIndex),HasProfileImage:ko.observable(t.filter.HasProfileImage),HasImageOfRoom:ko.observable(t.filter.HasImageOfRoom),RentRange:{Min:ko.observable(t.filter.RentRange.Min),Max:ko.observable(t.filter.RentRange.Max)},Gender:ko.observableArray(ko.utils.arrayMap(JSON.parse(JSON.stringify(t.filter.Gender.slice())),function(n){return n.selected=ko.observable(n.selected),n})),RentalPeriods:ko.observableArray(ko.utils.arrayMap(JSON.parse(JSON.stringify(t.filter.RentalPeriods.slice())),function(n){return n.selected=ko.observable(n.selected),n})),Facilities:ko.observableArray(ko.utils.arrayMap(JSON.parse(JSON.stringify(t.filter.Facilities.slice())),function(n){return n.selected=ko.observable(n.selected),n}))};this._getFetchImpl=function(){return this._services.searchService.searchRooms_new};this.Sort=ko.observable(this.Filters.ResidenceSort());this.Sort.subscribe(function(n){this.Filters.ResidenceSort(n);this.Filters.PageIndex(1);this._redirect();this._fetch(0)}.bind(this));n.constructor.apply(this,arguments)}});n.ExternalRoomSearchViewModel=augment(i,function(n){this.constructor=function(t){var i=new frm.events.Reactor,r=this;this.Layout={IsTextQueryVisible:!0,IsMapVisible:!0,IsFilterVisible:!0,IsSortVisible:!0,QueryPlaceHolder:t.localization.queryPlaceholder.residence,Sort:["newest","cheapest"]};r.OverlayVisible=ko.observable(!1);r.TriggerPopup=function(){i.dispatch("externalRoom:triggerPopUp");r.OverlayVisible(!1)};this.Filters={ResidenceSort:ko.observable(t.filter.ResidenceSort),Address:ko.observable(t.filter.Address),Coords:ko.observable(t.filter.Coords),PageIndex:ko.observable(t.filter.PageIndex),HasProfileImage:ko.observable(t.filter.HasProfileImage),HasImageOfRoom:ko.observable(t.filter.HasImageOfRoom),RentRange:{Min:ko.observable(t.filter.RentRange.Min),Max:ko.observable(t.filter.RentRange.Max)},RentalPeriods:ko.observableArray(ko.utils.arrayMap(JSON.parse(JSON.stringify(t.filter.RentalPeriods.slice())),function(n){return n.selected=ko.observable(n.selected),n}))};this._getFetchImpl=function(){return this._services.searchService.searchExternalRooms};this._customMap=function(n){return ko.utils.arrayForEach(n.Items,function(n){n.TriggerOverlay=function(){i.dispatch("externalRoom:triggerOverlay")}}),n};this.Sort=ko.observable(this.Filters.ResidenceSort());this.Sort.subscribe(function(n){this.Filters.ResidenceSort(n);this.Filters.PageIndex(1);this._redirect();this._fetch(0)}.bind(this));i.addListener("externalRoom:triggerOverlay",function(){window.scrollTo(0,0);r.OverlayVisible(!0)});i.addListener("externalRoom:triggerPopUp",function(){var n=t.popup();frm.models.GenericPopupViewModel.create(n).then(function(){n.Areas.SignUp.RoomListingSignUpView()})});n.constructor.apply(this,arguments)}});n.PropertySearchViewModel=augment(i,function(n){this.constructor=function(t){this.Layout={IsTextQueryVisible:!0,IsMapVisible:!0,IsFilterVisible:!0,IsSortVisible:!0,QueryPlaceHolder:t.localization.queryPlaceholder.residence,Sort:["newest","cheapest"]};this.Filters={ResidenceSort:ko.observable(t.filter.ResidenceSort),Address:ko.observable(t.filter.Address),Coords:ko.observable(t.filter.Coords),PageIndex:ko.observable(t.filter.PageIndex),RentRange:{Min:ko.observable(t.filter.RentRange.Min),Max:ko.observable(t.filter.RentRange.Max)},RentalPeriods:ko.observableArray(ko.utils.arrayMap(JSON.parse(JSON.stringify(t.filter.RentalPeriods)),function(n){return n.selected=ko.observable(n.selected),n})),HasComments:ko.observable(t.filter.HasComments),HasInterested:ko.observable(t.filter.HasInterested)};this._getFetchImpl=function(){return this._services.searchService.searchProperties};this._map=function(i){return i=n._map.apply(this,arguments),i.Items=ko.utils.arrayMap(i.Items,function(n){return new f(n,t.popup)}),i};this.Sort=ko.observable(this.Filters.ResidenceSort());this.Sort.subscribe(function(n){this.Filters.ResidenceSort(n);this.Filters.PageIndex(1);this._redirect();this._fetch(0)}.bind(this));n.constructor.apply(this,arguments)}});n.TenantSearchViewModel=augment(r,function(n){this.constructor=function(t){this.Layout={IsTextQueryVisible:!0,IsMapVisible:!1,IsFilterVisible:!0,IsSortVisible:!0,QueryPlaceHolder:t.localization.queryPlaceholder.tenant,Sort:["lastactive","newest"]};this.Nationality={isVisible:ko.observable(!1),countryCode:ko.observable(t.filter.Nationality),countryName:ko.observable()};this.changeCountry=function(n){this.Filters.Nationality(n.CountryCode);this.Nationality.countryCode(n.CountryCode);this.Nationality.countryName(n.Name);this.Nationality.isVisible(!this.Nationality.isVisible())};this.Filters={TenantSort:ko.observable(t.filter.TenantSort),Address:ko.observable(t.filter.Address),HasProfileImage:ko.observable(t.filter.HasProfileImage),PageIndex:ko.observable(t.filter.PageIndex),Nationality:ko.observable(t.filter.Nationality),AgeRange:{Min:ko.observable(t.filter.AgeRange.Min),Max:ko.observable(t.filter.AgeRange.Max)},RentRange:{Min:ko.observable(t.filter.RentRange.Min),Max:ko.observable(t.filter.RentRange.Max)},Gender:ko.observableArray(ko.utils.arrayMap(JSON.parse(JSON.stringify(t.filter.Gender)),function(n){return n.selected=ko.observable(n.selected),n})),Smoking:ko.observableArray(ko.utils.arrayMap(JSON.parse(JSON.stringify(t.filter.Smoking)),function(n){return n.selected=ko.observable(n.selected),n})),RentalPeriods:ko.observableArray(ko.utils.arrayMap(JSON.parse(JSON.stringify(t.filter.RentalPeriods)),function(n){return n.selected=ko.observable(n.selected),n}))};this._handleQueryGeocoding=function(){return this._services.geocoderService.geocode(this.VIEW_STATE.CURRENT_QUERY,"DK")};this._getFetchImpl=function(){return this._services.searchService.searchTenants};this._map=function(t){return t=n._map.apply(this,arguments),{Items:t.Items}};this.close=function(){n.close.apply(this,arguments);this._SortListener.dispose();delete this._SortListener};this.Sort=ko.observable(this.Filters.TenantSort());this._SortListener=this.Sort.subscribe(function(n){this.Filters.TenantSort(n);this.Filters.PageIndex(0);this._fetch(0)}.bind(this));this.ClearSearch=function(){this.Filters.Address(undefined);this.Filters.PageIndex(0);this._fetch(this.Filters.PageIndex());n.ClearSearch.apply(this,arguments)};n.constructor.apply(this,arguments);var i=this;setTimeout(function(){t.searchType==="address"?(i.VIEW_STATE.CURRENT_QUERY_MODE=t.searchType,i.VIEW_STATE.CURRENT_QUERY=t.filter.Query,i.VIEW_STATE.ENABLE_PAGE_INIT_REDIRECT=!1,i.VIEW_STATE.DISABLE_REDIRECT=!1,i.Query(i.VIEW_STATE.CURRENT_QUERY)):i._fetch(t.filter.PageIndex)},200)}})}(frm.models.search,frm.services),function(n){function t(n){var t={};return n.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(n,i,r,u){t[i]=u}),t}function r(n){for(var r=n.split("/"),u=[],f=r.length,i,t=0;t<f;t+=1)i=r[t],i!==""&&u.push(i);return u.slice(1).join("/")}function i(n){n=n||{};this.basePath=decodeURI(n.basePath)}i.prototype.parse=function(n){var u=n.replace(this.basePath,"").replace(this.basePath.substring(0,this.basePath.length-1),""),i=u.split("/").filter(function(n){return n!==""}),t={searchType:null,terms:null,coords:null},r;return i.length>0&&(i[0].substring(0,1)==="@"?(r=i[0].substring(1).split(",").map(function(n){return parseFloat(n)}),t.searchType="coordinates",t.coords={lat:r[0],lng:r[1],zoom:r[2]}):(t.searchType="address",t.terms=i.map(function(n){return n}))),t};var u={create:function(n,t,i,r){if(n==="room")return new frm.models.search.RoomSearchViewModel(t,i,r);if(n==="externalroom")return new frm.models.search.ExternalRoomSearchViewModel(t,i,r);if(n==="property")return new frm.models.search.PropertySearchViewModel(t,i,r);if(n==="tenant")return new frm.models.search.TenantSearchViewModel(t,i,r);throw new Error("Unknown PageViewModel (search) : {"+n+"}");}},f=function(n){var s=function(){return new frm.models.GenericPopupViewModel(n.popupOptions)},e=this,h=ko.observable("Searching"),f={isMapLoaded:ko.observable(!1),IsInitialLoad:!0,filter:{Address:undefined,Coords:undefined,Query:n.query||"",Coordinates:n.coordinates||null,SearchType:n.searchType||"",ResidenceSort:n.residenceSort||n.defaults.residenceSort,TenantSort:n.tenantSort||n.defaults.tenantSort,HasProfileImage:n.filter.profilePicture,HasImageOfRoom:n.filter.roomPicture,PageIndex:n.pageIndex||0,Smoking:[{value:"true",text:n.localization.filter.smoking.smoker,selected:n.filter.smoking==="true"},{value:"false",text:n.localization.filter.smoking.nonSmoker,selected:n.filter.smoking==="false"}],RentRange:{Min:n.filter.minRent||n.settings.minRent,Max:n.filter.maxRent||n.settings.maxRent},Gender:[{value:"male",text:n.localization.filter.gender.male,selected:n.filter.sex==="male"},{value:"female",text:n.localization.filter.gender.female,selected:n.filter.sex==="female"}],RentalPeriods:[{value:0,text:n.localization.filter.rentalPeriod["0to3months"],selected:n.filter.rentalPeriods.indexOf(0)>=0},{value:1,text:n.localization.filter.rentalPeriod["3to12months"],selected:n.filter.rentalPeriods.indexOf(1)>=0},{value:2,text:n.localization.filter.rentalPeriod["12to24months"],selected:n.filter.rentalPeriods.indexOf(2)>=0},{value:3,text:n.localization.filter.rentalPeriod.unlimited,selected:n.filter.rentalPeriods.indexOf(3)>=0}],Facilities:[{value:0,key:"pets",text:n.localization.filter.facilities.pets,selected:n.filter.facilities.indexOf(0)>=0},{value:1,key:"smoking",text:n.localization.filter.facilities.smoking,selected:n.filter.facilities.indexOf(1)>=0},{value:2,key:"washer",text:n.localization.filter.facilities.washer,selected:n.filter.facilities.indexOf(2)>=0},{value:3,key:"dishwasher",text:n.localization.filter.facilities.dishwasher,selected:n.filter.facilities.indexOf(3)>=0},{value:4,key:"internet",text:n.localization.filter.facilities.internet,selected:n.filter.facilities.indexOf(4)>=0},{value:5,key:"cable",text:n.localization.filter.facilities.cable,selected:n.filter.facilities.indexOf(5)>=0}],HasComments:n.filter.comments||!1,HasInterested:n.filter.interests||!1,Nationality:n.filter.nationality||"",AgeRange:{Min:n.filter.age.min||0,Max:n.filter.age.max||99}}},o={setPageType:function(t){var i=u.create(t,$.extend(n,f,{DEFAULTS:{rent:{min:n.settings.minRent,max:n.settings.maxRent},SORT_KEY:"newest"},events:{onFilterChanged:o.onFilterChanged},popup:s,showFilter:e.ShowFilter}),h);e.CurrentView({Type:t,ViewModel:i})},onFilterChanged:function(n){for(var t in n)n.hasOwnProperty(t)&&(f.filter[t]=n[t])}};$(window).on("popstate",function(){var l,u,h,a,r,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,c,ft,s;e.CurrentView().ViewModel.close();l=location.pathname;u={pageType:null,basePath:null};for(h in n.PagePaths)if(n.PagePaths.hasOwnProperty(h)&&(a=n.PagePaths[h],l.startsWith(a))){u.pageType=h;u.basePath=n.PagePaths[h];break}r=t(location.search);typeof r.rentalPeriods!="undefined"?(v=r.rentalPeriods.split(",").map(function(n){return parseInt(n)}),f.filter.RentalPeriods.forEach(function(n){n.selected=v.indexOf(n.value)>=0})):f.filter.RentalPeriods.forEach(function(n){n.selected=!1});typeof r.facilities!="undefined"?(y=r.facilities.split(",").map(function(n){return parseInt(n)}),f.filter.Facilities.forEach(function(n){n.selected=y.indexOf(n.value)>=0})):f.filter.Facilities.forEach(function(n){n.selected=!1});typeof r.sex!="undefined"?(p=r.sex.split(","),f.filter.Gender.forEach(function(n){n.selected=p.indexOf(n.value)>=0})):f.filter.Gender.forEach(function(n){n.selected=!1});typeof r.smoking!="undefined"?(w=r.smoking.split(","),f.filter.Smoking.forEach(function(n){n.selected=w.indexOf(n.value)>=0})):f.filter.Smoking.forEach(function(n){n.selected=!1});typeof r.nationality!="undefined"?(b=r.nationality,f.filter.Nationality=b):f.filter.Nationality=n.filter.nationality||"";typeof r.rentMin!="undefined"?(k=r.rentMin,f.filter.RentRange.Min=parseInt(k)):f.filter.RentRange.Min=n.filter.minRent||n.settings.minRent;typeof r.rentMax!="undefined"?(d=r.rentMax,f.filter.RentRange.Max=parseInt(d)):f.filter.RentRange.Max=n.filter.maxRent||n.settings.maxRent;typeof r.minAge!="undefined"?(g=r.minAge,f.filter.AgeRange.Min=parseInt(g)):f.filter.AgeRange.Min=(n.filter.age||{min:0}).min;typeof r.maxAge!="undefined"?(nt=r.maxAge,f.filter.AgeRange.Max=parseInt(nt)):f.filter.AgeRange.Max=(n.filter.age||{max:99}).max;typeof r.roomPicture!="undefined"?(tt=r.roomPicture,f.filter.HasImageOfRoom=tt==="1"):f.filter.HasImageOfRoom=!1;typeof r.comments!="undefined"?(it=r.comments,f.filter.HasComments=it==="1"):f.filter.HasComments=!1;typeof r.interests!="undefined"?(rt=r.interests,f.filter.HasInterested=rt==="1"):f.filter.HasInterested=!1;typeof r.profilePicture!="undefined"?(ut=r.profilePicture,f.filter.HasProfileImage=ut==="1"):f.filter.HasProfileImage=!1;typeof r.sort!="undefined"&&(c=r.sort,u.pageType==="tenant"?f.filter.TenantSort=c:f.filter.ResidenceSort=c);f.filter.PageIndex=typeof r.page!="undefined"?parseInt(r.page):0;ft=new i({basePath:u.basePath});s=ft.parse(decodeURI(location.pathname));s.searchType==="address"?(s.terms.reverse(),f.filter.SearchType="address",f.filter.Query=s.terms.join(", ")):s.searchType==="coordinates"&&(f.filter.SearchType="coordinates",f.filter.Coordinates=s.coords);o.setPageType(u.pageType)});e.SortOptions=n.sortOptions;e.CurrentView=ko.observable();e.ShowFilter=ko.observable(!1);e.CurrentViewType=ko.observable();e.ChangeView=function(i,u){var l,s,h,c,a;e.CurrentView().ViewModel.close();l=r(location.pathname);s=t(location.search);["property","room","externalroom"].indexOf(i)>=0?(s.sort=f.filter.ResidenceSort,f.filter.ResidenceSort===n.defaults.residenceSort&&delete s.sort):i==="tenant"&&(s.sort=f.filter.TenantSort,f.filter.TenantSort===n.defaults.tenantSort&&delete s.sort);delete s.page;h=[];for(c in s)s.hasOwnProperty(c)&&h.push(c+"="+s[c]);a=h.length>0?"?"+h.join("&"):"";history.pushState({},"",u+"/"+l+a);n.basePath=u;f.filter.PageIndex=0;o.setPageType(i)};e.toggleFilter=function(){e.ShowFilter(!e.ShowFilter())};o.setPageType(n.pageType||"room");f.IsInitialLoad=!1};n.SearchViewModel=f}(frm.models.search,frm.services),function(){ko.validation.configure({decorateElement:!0,registerExtenders:!0,messagesOnModified:!0,insertMessages:!1,parseInputAttributes:!0,messageTemplate:null});frm.models.CreateAccountDetailsViewModel=function(n){var t=this,r=new frm.services.TenantService,i={onSaveSuccessfull:function(){t.isCompleted(!0)},onSaveFailed:function(){alert("Der skete en fejl.. :-(")}};t.searchAreaQuery=ko.observable();t.date=ko.observable(n.date);t.searchArea=ko.observable().extend({required:!0});t.isCompleted=ko.observable(!1);t.isInvalidAddress=ko.observable(!1);t.onAreaSelected=function(n){t.searchArea(n);t.save()};t.save=function(){var n=t.searchArea();return r.createSearchArea(n.address,n.location.lat,n.location.lng,n.countryCode).then(i.onSaveSuccessfull,i.onSaveFailed)};n.values.searchArea!==""&&setTimeout(function(){t.searchAreaQuery(n.values.searchArea)},20)}}();frm.maps.SearchAreasMap=function(n){var t=this;google.maps.visualRefresh=!0;this.canvas=n;this.circles={};this.fitBounds=function(n){var i=n.getSouthWest(),r=n.getNorthEast(),u=r.lat()-i.lat(),t=r.lng()-i.lng();t<0&&(t+=360);var f=Math.round(Math.log(this.canvas.offsetHeight*180/u/256)/Math.LN2),e=Math.round(Math.log(this.canvas.offsetWidth*360/t/256)/Math.LN2),o=Math.min(f,e);this.innerMap.setCenter(n.getCenter());this.innerMap.setZoom(o)};this.fitAll=function(){this.innerMap.setCenter(new google.maps.LatLng(56.2,11.1));this.innerMap.setZoom(8)};this.addArea=function(n,t){var i=this.circles[n.Id]=new google.maps.Circle({strokeColor:"#000000",strokeOpacity:.5,strokeWeight:1,fillColor:"#000000",fillOpacity:.1,draggable:!1,editable:!1,radius:n.Radius,center:new google.maps.LatLng(n.Center.Latitude,n.Center.Longitude),map:this.innerMap,areaId:n.Id});google.maps.event.addListener(i,"radius_changed",function(){frm.events.dispatch("radius_changed",this)});t&&this.fitBounds(i.getBounds().expand(1.5))};this.addAreas=function(n){for(var t=0;t<n.length;t++)this.addArea(n[t],!1)};this.removeArea=function(n){var t=this.circles[n];t&&(t.setMap(null),delete this.circles[n])};this.initMap=function(){var n={mapTypeId:google.maps.MapTypeId.ROADMAP,minZoom:1,panControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},zoomControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},center:new google.maps.LatLng(56.2,11.1),zoom:8};this.innerMap=new google.maps.Map(this.canvas,n)};this.initMap();this.listen=function(){google.maps.event.addListener(this.innerMap,"idle",function(){this.isLoaded||(this.isLoaded=!0,t.onLoad())});google.maps.event.addListener(this.innerMap,"zoom_changed",function(){var i=this.getZoom()>=11,n;for(n in t.circles)t.circles[n].setEditable(i)})};this.listen();this.onLoad=function(){};this.getInnerMap=function(){return this.innerMap}};frm.maps.places.PlacesService=function(n,t){var i={},r;typeof t!="undefined"&&t.onlyAddress&&(i.types=["address"]);r=new google.maps.places.AutocompleteService(i);this.getPlacePredictions=function(n,t,u){i.input=n;r.getPlacePredictions(i,function(n){var i=$.map(n||[],function(n){var i=n.types[0]=="establishment",t;if(!i)return typeof u=="undefined"?{label:frm.maps.places.getPredictionTitle(n),ref:n.reference}:(t=ko.utils.arrayMap(n.terms,function(n){return n.value}).join(", "),{ref:n.reference,terms:n.terms,text:t})});t(i)})}};frm.maps.places.Autocomplete=function(n,t,i,r,u){var o=this,f=new frm.services.GoogleSuggestionService(t,n[0]),e=new frm.services.SearchService;return n[0]&&(this.input=n,this.input.autocomplete({autoFocus:!0,source:function(n,t){f.getSuggestions(n.term).then(function(n){var i=$.map(n,function(n){return{label:n.text,value:n.text,data:n}});t(i)})},select:function(n,t){f.geocode(t.item.data).then(function(n,r){var u,f,o;typeof i=="undefined"?(u=e.getRedirectParameters(n),f=e.getUrl("default",App.settings.searchSettings.roomBasePath,u.locality,u.sublocality,u.country),location.href=f):(o=t.item.label,i(o,r))})},open:function(){var n=$(this).autocomplete("widget");r&&r(n)},close:function(){var n=$(this).autocomplete("widget");u&&u(n)}}),this.addClass=function(n){this.input.autocomplete("widget").addClass(n)},this.setCountry=function(){}),n};frm.ui.openPopupAd=function(n){this.openPopup(n)};frm.ui.openPopup=function(n,t,i,r,u,f){var o=$("input#popup-close").val()||"Luk",e=null;typeof n=="string"&&(e="iframe");$.fancybox.open(n,{padding:r||0,scrolling:"no",width:t||460,height:i||600,type:e,autoSize:!1,tpl:{closeBtn:'<a class="fancybox-item fancybox-close" href="javascript:;"><\/a>'},index:u||0,afterClose:f})};frm.ui.openImages=function(n,t){var i=[];return n.each(function(){i.push($(this).attr("href"))}),frm.ui.openPopup(i,null,null,20,t)};frm.ui.closePopup=function(){$.fancybox.close()};frm.ui.initJsonify=function(){var n={parser:{number:function(n){var t=n.val();return t?Number(t):null},bool:function(n){var t=n.val()||n.attr("data-value");return t&&(t=="1"||t.toLowerCase()=="true"||t.toLowerCase()=="yes")}}};$.jsonify(n)};frm.ui.views.ScrollView=function(n,t,i){var r=this;this.obj=n;this.callback=i;this.itemSelector=t;this.isUpdating=function(){return this.obj.data("autoscroll-updating")};this.isDisabled=function(){return this.obj.data("autoscroll-disabled")};this.finished=function(){this.setUpdating(!1)};this.setUpdating=function(n){this.obj.data("autoscroll-updating",n)};this.enable=function(){this.obj.data("autoscroll-disabled",!1)};this.disable=function(){this.obj.data("autoscroll-disabled",!0)};this.update=function(){this.obj.trigger("scroll")};n.on("scroll",function(){var n=$(this);if(!r.isUpdating()&&!r.isDisabled()){var t=$(r.itemSelector,r.obj).outerHeight(),i=n.scrollTop()+n.height(),u=n.prop("scrollHeight");u-i<=t*2&&(r.setUpdating(!0),r.callback())}})};frm.ui.views.ScrollView2=function(){var n=this;this.obj=null;this.selector=null;this.callback=null;this.isUpdating=function(){return this.obj.data("autoscroll-updating")};this.isDisabled=function(){return this.obj.data("autoscroll-disabled")};this.finished=function(){this.setUpdating(!1)};this.setUpdating=function(n){this.obj.data("autoscroll-updating",n)};this.enable=function(){this.obj.data("autoscroll-disabled",!1)};this.disable=function(){this.obj.data("autoscroll-disabled",!0)};this.update=function(){this.obj.trigger("scroll")};this.bindToList=function(t,i,r){this.obj=t;this.selector=i;this.callback=r;this.obj.on("scroll",function(){var t=$(this);if(!n.isUpdating()&&!n.isDisabled()){var i=$(n.itemSelector,n.obj).outerHeight(),r=t.scrollTop()+t.height(),u=t.prop("scrollHeight");u-r<=i*2&&(n.setUpdating(!0),n.callback())}})}};frm.ui.views.MasterView=function(){var n=this;this.layout=new frm.ui.layout.MasterLayout;this.searchEnabled=!0;this.disableSearch=function(){this.searchEnabled=!1};frm.events.addListener("user_login",function(){var t=n.layout.getLoginUrl();t?location.href=t:location.reload()});frm.events.addListener("user_logout",function(){n.layout.updateMenu()})};frm.ui.views.landlord.PropertyView=function(){var n=this,t;this.layout=new frm.ui.layout.landlord.PropertyLayout;this.service=new frm.services.landlord.PropertyService(this.layout.getApiUrl());this.commentsPage=1;this.interestsPage=1;this.interestsModel=new frm.models.tenant.InterestViewModel;this.interestsScroll=new frm.ui.views.ScrollView2;this.commentsModel=new frm.models.CommentViewModel({commentType:"Property",objectId:this.layout.dom.data.propertyId,commentId:this.layout.dom.data.deeplink.commentId,onCommentCreated:function(){n.interestsModel.IsInterested()||(n.interestsModel.setInterested(!0),n.updateInterests(),n.layout.dom.data.isInterested?(n.layout.dom.data.isInterested=!1,n.layout.dom.data.showMultipleChoice=!0):(n.layout.dom.data.isInterested=!0,n.layout.dom.data.showMultipleChoice=!1))},onLoadComplete:function(){n.layout.hideComments()}});t={propertyId:this.layout.dom.data.propertyId,top:4};this.similarPropertiesModel=new frm.models.SimilarPropertiesWidgetViewModel(t);this.popupReloadOnClose=!1;this.map=null;this.listen=function(){frm.events.addListener("toggle_interest",function(t){var i=!n.interestsModel.IsInterested();n.service.setInterested(t,i,function(){var t,r;n.interestsModel.setInterested(i);i&&n.featureInterested("Yes");n.updateInterests();i&&(t=$("#helpbox"),t.length>0&&(r=$("#helpbox").offset().top,$("html").animate({scrollTop:r})))})});frm.events.addListener("show_replies",function(t,i){n.service.listReplies(t,i,1,function(t){n.commentsModel.addReplies(i,t)})});frm.events.addListener("similar_houses_add",function(t){n.service.addToSimilarHouses(t)});frm.events.addListener("share_on_wall",function(n){frm.services.WallService.create(n)});frm.events.addListener("notify_interested",function(n){frm.services.PropertyService.notifyInterested(n)});frm.events.addListener("more_interests",function(){n.nextInterests()});frm.events.addListener("more_comments",function(){n.nextComments()});frm.events.addListener("popup_set_reload",function(t){n.popupReloadOnClose=t});frm.events.addListener("popup_on_closed",function(){n.popupReloadOnClose&&location.reload(!0)});frm.events.addListener("interested_maybe",function(){var t=n.layout.getDOM();if(!t.data.loggedIn){frm.events.dispatch("trigger_popup__property");return}n.featureInterested("Maybe")});frm.events.addListener("interested_nope",function(){var t=n.layout.getDOM();if(!t.data.loggedIn){frm.events.dispatch("trigger_popup__property");return}n.featureInterested("Nope")})};this.listen();this.init=function(){var t=this.layout.getDOM();this.interestsModel.setInterested(t.data.isInterested);t.data.isCommentEnabled&&ko.applyBindings(this.commentsModel,t.comments.container[0]);ko.applyBindings(this.interestsModel,t.interested.container[0]);ko.applyBindings(this.similarPropertiesModel,t.similarProperties.container[0]);ko.applyBindings({},t.gallery[0]);this.interestsScroll.bindToList(t.interested.list,"> ul > li",function(){n.nextInterests()});this.createMap();this.updateInterests();this.updateComments()};this.updateInterests=function(){this.interestsModel.clear();this.interestsPage=1;this.addInterests()};this.updateComments=function(){this.commentsPage=1};this.canWriteComment=function(){var n=this.layout.getDOM();return n.data.isActive||n.data.isCommentsFree&&n.data.loggedIn};this.addInterests=function(){var t=this.layout.getDOM();n.layout.setInterestedLoading(!0);n.service.listInterests(t.data.propertyId,this.interestsPage,function(t){n.interestsModel.addRange(t);n.interestsModel.setLoaded(!0);n.interestsScroll.finished();n.layout.setInterestedLoading(!1)})};this.nextComments=function(){this.commentsModel.IsLastPage()||(this.commentsPage++,this.addComments())};this.nextInterests=function(){this.interestsModel.IsLastPage()||(this.interestsPage++,this.addInterests())};this.featureInterested=function(t){var i={propertyId:n.layout.dom.data.propertyId,selected:t};frm.services.SupportService.requestFeature("Multiple Choice, Property Interest",i);n.layout.dom.data.showMultipleChoice=!1;n.interestsModel.setShowMultipleChoice(!1)};this.createMap=function(){var n=this.layout.getDOM(),i=n.map.data("lat"),r=n.map.data("lng"),t,u,f;i&&r&&(t=new google.maps.LatLng(i,r),u={mapTypeId:google.maps.MapTypeId.ROADMAP,minZoom:7,center:t,zoom:13,scrollwheel:!1},this.map=new google.maps.Map(n.map[0],u),f=new google.maps.Marker({map:this.map,position:t,icon:"/Content/Images/Search/Maps/pin_external.png?1"}))};this.init()};frm.ui.views.landlord.RoomView=function(){var n=this;this.layout=new frm.ui.layout.landlord.RoomLayout;this.service=new frm.services.landlord.RoomService(this.layout.getApiUrl());this.paymentActionService=frm.services.PaymentActionService;this.map=null;this.popupReloadOnClose=!1;this.listen=function(){frm.events.addListener("send_message",function(t,i){var r={Recipients:[t],Message:i,Sender:App.settings.account.id};typeof r.Message!="undefined"&&r.Message.trim()!==""&&window.CONNECTION_ESTABLISHED.$promise.done(function(){$.connection.NotificationHub.server.sendChatMessage(r).then(function(){n.layout.setMessageStatus("sent")},function(){n.layout.setMessageStatus("error")})})});frm.events.addListener("add_to_payment_action",function(t,i,r,u,f){var e=i.replace(/\r\n|\n|\r/g,"<br>").replace(/'/g,"\\'"),o={Event:"Message",EventData:JSON.stringify({RecipientAccountId:t,Message:e})};n.paymentActionService.create(o).then(function(n){var t="&PaymentActionId="+n.data;u&&(window.location.href=r+t);f&&f(t)})});frm.events.addListener("popup_set_reload",function(t){n.popupReloadOnClose=t});frm.events.addListener("popup_on_closed",function(){n.popupReloadOnClose&&location.reload(!0)})};this.listen();this.init=function(){var n=this.layout.getDOM();this.createMap()};this.createMap=function(){var n=this.layout.getDOM(),i=n.map.data("lat"),r=n.map.data("lng"),t,u,f;i&&r&&(t=new google.maps.LatLng(i,r),u={mapTypeId:google.maps.MapTypeId.ROADMAP,minZoom:7,center:t,zoom:13,scrollwheel:!1},this.map=new google.maps.Map(n.map[0],u),f=new google.maps.Marker({map:this.map,position:t,icon:"/Content/Images/Search/Maps/pin_exact.png?1"}))};this.init()};frm.ui.views.landlord.ExternRoomView=function(){var n=this;this.layout=new frm.ui.layout.landlord.ExternRoomLayout;this.service=new frm.services.landlord.RoomService(this.layout.getApiUrl());this.map=null;this.popupReloadOnClose=!1;this.init=function(){var n=this.layout.getDOM();this.createMap()};this.listen=function(){frm.events.addListener("popup_set_reload",function(t){n.popupReloadOnClose=t});frm.events.addListener("popup_on_closed",function(){n.popupReloadOnClose&&location.reload(!0)})};this.listen();this.createMap=function(){var n=this.layout.getDOM(),i=n.map.data("lat"),r=n.map.data("lng"),t,u,f;i&&r&&(t=new google.maps.LatLng(i,r),u={mapTypeId:google.maps.MapTypeId.ROADMAP,minZoom:7,center:t,zoom:13,scrollwheel:!1},this.map=new google.maps.Map(n.map[0],u),f=new google.maps.Marker({map:this.map,position:t,icon:"/Content/Images/Search/Maps/pin_exact.png?1"}))};this.init()};frm.ui.views.tenant.SearchAreasView=function(){var n=this;this.map=null;this.service=null;this.layout=new frm.ui.layout.tenant.SearchAreasLayout;this.model=new frm.models.tenant.AreaViewModel;this.listen=function(){frm.events.addListener("searcharea_added",function(t,i){var r=n.model.Items().length==0;n.service.addArea(t,i.geometry.location,5e3,r,function(t){n.model.add(t);n.map.addArea(t,!0)})});frm.events.addListener("searcharea_removed",function(t){n.map.removeArea(t);n.model.removeById(t);n.service.removeArea(t)});frm.events.addListener("searcharea_primary",function(t){n.service.setPrimaryArea(t)});frm.events.addListener("searcharea_fitall",function(){n.map.fitAll()});frm.events.addListener("radius_changed",function(t){n.layout.setRadius(t.areaId,t.getRadius());n.service.setAreaRadius(t.areaId,t.getRadius())})};this.listen();this.initAreas=function(){n.service.getSearchAreas(function(t){n.model.addRange(t);n.map.addAreas(t)})};this.init=function(){var n=this.layout.getDOM();ko.applyBindings(this.model);this.map=new frm.maps.SearchAreasMap(n.map.canvas[0]);this.service=new frm.services.tenant.SearchAreaService(n.apiUrl.val());this.initAreas()};this.init()};frm.ui.views.tenant.ProfileView=function(){var n=this;this.layout=new frm.ui.layout.tenant.ProfileLayout;this.service=new frm.services.tenant.ProfileService(this.layout.getApiUrl());this.map=null;this.popupReloadOnClose=!1;this.listen=function(){frm.events.addListener("send_message",function(t,i){n.service.sendMessage(t,i,function(t){t?n.layout.setMessageStatus("error",t):n.layout.setMessageStatus("sent")})});frm.events.addListener("popup_set_reload",function(t){n.popupReloadOnClose=t});frm.events.addListener("popup_on_closed",function(){n.popupReloadOnClose&&location.reload(!0)})};this.listen();this.init=function(){var n=this.layout.getDOM()};this.init()};frm.ui.views.accounts.CreateAccountView=function(){var n=this.layout=new frm.ui.layout.accounts.CreateAccountLayout,t=this.layout.dom};frm.ui.views.misc.HomepageView=function(){var t=this,n;this.service=null;this.layout=new frm.ui.layout.misc.HomepageLayout;this.init=function(){n=this.layout.dom};this.init()};frm.ui.layout.getDOM=function(){return this.innerDOM||(this.innerDOM={top:{container:$("header#top"),location:$("input#location"),locationButton:$("input#location").siblings("a.hotspot"),country:$("input#country"),searchUrl:$("input#searchUrl"),login:$(".dropin-login"),menu:$("ul#user-menu"),loginUrl:$("input#loginurl"),userMenu:$("ul#user-menu"),miniMenu:$("a#mini-menu")},footer:{picker:$("footer .picker")}}),this.innerDOM},function(){var n=!1;frm.ui.layout.MasterLayout=function(){var t=this;this.getDOM=function(){return frm.ui.layout.getDOM()};this.getLoginUrl=function(){var n=this.getDOM();return n.top.loginUrl.length==0?null:n.top.loginUrl.val()};this.getSearchUrl=function(){var n=this.getDOM();return $("body").attr("data-searchUrl")};this.getLoginModel=function(){var n=this.getDOM();return n.top.login.jsonify()};this.init=function(){var n=this.getDOM();$(".dropin-login-trigger").on("click",function(){if($(".hide-sm").is(":visible")){var t=$(this).closest("a"),i=t.offset();return n.top.login.css("left",i.left-n.top.login.outerWidth()+t.outerWidth()+"px"),n.top.login.slideToggle(),t.toggleClass("selected"),$("input.text:eq(0)",n.top.login).trigger("focus"),!1}});$("body").on("click",function(t){var r=n.top.login.is(":visible"),i=$(t.target),u=n.top.login.has(i).length>0,f=n.top.login[0]==i[0];!r||u||f||n.top.login.hide()});n.footer.picker.on("click",".footer-btn span",function(n){var t=$(this).parents(".footer-btn:first"),i=250;t.hasClass("open")?t.find("nav").slideUp(i,function(){t.removeClass("open")}):t.addClass("open").find("nav").hide().slideDown(i);n.preventDefault()});$(".navbar-menu-item").on("mouseenter mouseleave",function(){var n=$(this).children(".navbar-menu-item-tooltip");n.toggleClass("tooltip-open")});$("#mobile-burger").on("click touchend",function(n){window.AppState.openBurger($("#navigation-burger"));n.stopPropagation();n.preventDefault()})};n||(this.init(),n=!0)}}();frm.ui.layout.landlord.PropertyLayout=function(){var n=this;this.dom={map:$("div#map"),comments:{container:$("div#property-comment"),becomeMemberButton:$("div#property-comment  a.become-memeber"),inputs:$("div#property-comment div.comment-input"),loadMore:$("div#property-comment > a.more"),overlay:$("div#property-comment  div.comment-overlay"),list:$("div#property-comment > div.comment-list:not(.comment-list-helper)"),listhelper:$("div#property-comment > div.comment-list-helper")},interested:{container:$("div#interested"),sideBox:$("#interest-side"),toggle:$("#interested a.btn.toggle, #interest-side a.btn.toggle"),optionMaybe:$("a.btn.option-maybe"),optionNope:$("a.btn.option-nope"),showAll:$("div#interested a.btn.all"),loadMore:$(".all-interests .more"),all:$("#AllInterestsTmpl"),list:$(".all-interests .items")},navigation:$("#property nav.sections"),link:$("a#link"),data:{urlMembershipPopupExternalUrl:$("input#url-membership-popup-externalUrl").val(),urlMembershipPopupInterested:$("input#url-membership-popup-interested").val(),urlMembershipPopupComment:$("input#url-membership-popup-comment").val(),urlMembershipPopupShareOnWall:$("input#url-membership-popup-shareOnWall").val(),apiUrl:$("input#api-url-p").val(),propertyId:$("input#property-id").val(),loggedIn:$("input#logged-in").val()=="True",isInterested:$("input#is-interested").val()=="True",isActive:$("input#is-active").val()=="True",urlExternalAd:$("input#url-external-ad").val(),isCommentsFree:$("input#is-comments-free").val()=="True",isInterestedFree:$("input#is-interested-free").val()=="True",isExternalFree:$("input#is-external-free").val()=="True",isCommentEnabled:$("input#is-comment-enabled").val()==="true",showMultipleChoice:$("input#is-interested").val()=="True"==!0?!1:!0,deeplink:{commentId:function(){var n=$("input#deeplink\\:comment-id").val();return n!=""?parseInt(n,10):undefined}()},propertyUrl:$("input#property-url").val(),propertyFrindlyName:$("input#property-friendlyName").val(),amountOfInterested:$("input#total-interested")},gallery:$("#gallery-section"),adminNavigation:$("#admin-navigation"),similarProperties:{container:$("div#similarpropertieswidget-container")},shareOnWall:{btn:$(".share-on-wall"),walltext:$("#walltext-textarea")}};this.getApiUrl=function(){var n=this.getDOM();return n.data.apiUrl};this.getDOM=function(){var n=frm.ui.layout.getDOM();return $.extend(n,this.dom)};this.setCommentsLoading=function(n){var t=this.getDOM();t.comments.loadMore.toggleClass("loading",n)};this.setInterestedLoading=function(n){var t=this.getDOM();t.interested.loadMore.toggleClass("loading",n)};this.canWriteComment=function(){var n=this.getDOM();return n.data.isActive||n.data.isCommentsFree&&n.data.loggedIn};this.canWriteInterested=function(){var n=this.getDOM();return n.data.isActive||n.data.isInterestedFree&&n.data.loggedIn};this.canShareOnWall=function(){var n=this.getDOM();return n.data.loggedIn};this.canVisitExternal=function(){var n=this.getDOM();return n.data.isActive||n.data.isExternalFree&&n.data.loggedIn};this.showPopup=function(){frm.events.dispatch("trigger_popup__property")};this.popupOnClosed=function(){frm.events.dispatch("popup_on_closed")};this.hideComments=function(){var n=this.getDOM(),t=n.comments.list.outerHeight()+n.comments.listhelper.outerHeight()-10,i=n.comments.list.outerWidth();n.comments.overlay.height(t);n.comments.overlay.show()};this.scrollTo=function(n){location.href="#hidden-"+n};this.init=function(){var t=this.getDOM(),i=this,r,u;t.comments.overlay.on("click touchend",function(t){i.canWriteComment()||n.showPopup("add_comment");t.preventDefault()});t.comments.becomeMemberButton.on("click touchend",function(t){i.canWriteComment()||n.showPopup("add_comment");t.preventDefault()});r=$("a",t.navigation);r.on("click touchend",function(){var t=$(this).data("rel");return n.scrollTo(t),r.removeClass("selected"),$(this).addClass("selected"),!1});t.comments.container.on("click touchend","a.btn.replies",function(){var n=$(this).closest("li").data("id");return frm.events.dispatch("show_replies",t.data.propertyId,n),!1});t.comments.loadMore.on("click touchend",function(){return frm.events.dispatch("more_comments"),!1});t.shareOnWall.btn.on("click touchend",function(){i.canShareOnWall()?frm.services.ModalService.open({template:$("#ShareOnWallTmpl").html(),width:460,height:360,events:[{event:"click touchend",selector:".share-btn",func:function(){var n=$("#walltext-textarea"),i;n.val()==undefined||n.val()==""?n.addClass("error"):(n.removeClass("error"),i={BodyText:n.val(),Attachment:{Id:t.data.propertyId,Type:"Property"}},frm.events.dispatch("share_on_wall",i),frm.services.ModalService.close())}},{event:"click touchend",selector:".cancel-btn",func:function(){frm.services.ModalService.close()}}]}):n.showPopup("share_on_wall")});t.interested.optionMaybe.on("click touchend",function(){frm.events.dispatch("interested_maybe")});t.interested.optionNope.on("click touchend",function(){frm.events.dispatch("interested_nope")});t.interested.toggle.on("click touchend",function(){return i.canWriteInterested()?(frm.events.dispatch("toggle_interest",t.data.propertyId),t.data.isInterested?(t.data.isInterested=!1,t.data.showMultipleChoice=!0):(t.data.isInterested=!0,t.data.showMultipleChoice=!1),t.data.isInterested&&t.data.amountOfInterested.val()>0&&frm.services.ModalService.open({template:$("#NotifyInterestedTmpl").html(),width:460,height:220,events:[{event:"click touchend",selector:"a.yes-please",func:function(){frm.events.dispatch("notify_interested",t.data.propertyId);frm.services.ModalService.close()}},{event:"click touchend",selector:"a.no-thanks",func:function(){frm.services.ModalService.close()}}]})):n.showPopup("toggle_interest"),!1});u=function(r){i.canVisitExternal()?(frm.services.ModalService.open({template:$("#RedirectToExtenalWebsiteTmpl").html(),width:460,height:"auto",events:[{event:"change",selector:"[name='iHaveReadAndAccepted']",func:function(){var t=$(this),i=t.is(":checked"),n=$("[name='iHaveReadAndAccepted']").parent(".form-label");i?n.css("color","initial"):n.css("color","red")}},{event:"click touchend",selector:"div.form-actions a.goto-button",func:function(){var i=$("[name='iHaveReadAndAccepted']"),n=$("[name='iHaveReadAndAccepted']").parent(".form-label"),r=i.is(":checked");r?(n.css("color","initial"),frm.services.ModalService.close(),window.open(t.data.urlExternalAd,"_blank").focus()):n.css("color","red")}}]}),r.preventDefault()):n.showPopup("click_externalUrl")};$("#goto-interested-btn").on("click touchend",u);t.link.on("click",u);t.interested.showAll.on("click touchend",function(){return t.interested.all.addClass("loading"),frm.services.ModalService.open({template:t.interested.all,events:[{event:"click touchend",selector:".more",func:function(n){frm.events.dispatch("more_interests");n.preventDefault()}}],onAfterClose:function(){var n=t.interested.container.find(".all-interests");t.interested.all.append(n)}}),!1});t.adminNavigation.on("click touchend","[data-action='changeStatus']",function(){var n=$("#propertyActive").val();n=="True"?frm.services.PropertyService.setRented(t.data.propertyId).then(function(){window.location.reload()}):frm.services.PropertyService.removeRented(t.data.propertyId).then(function(){window.location.reload()})})};this.init()};frm.ui.layout.landlord.RoomLayout=function(){var n=this,t;return this.dom={map:$("div#map"),navigation:$("#room-profile nav.sections"),contact:{send:$("a#send-message"),messageText:$("textarea#message"),message:$("div#contact .comment-input"),newMessage:$("a#new-message"),sent:$("div#contact .sent"),link:$("a#contact-link"),showPopup:$("div#contact a.popup"),buttons:$("div#contact .buttons"),error:$("div#contact .buttons .error")},pictures:{container:$("div#pictures"),list:$("div#pictures > ul"),bigLink:$("div#pictures > a.big"),big:$("div#pictures > a.big > img"),thumbs:$("div#pictures > ul > li > a"),fullScreen:$("div#pictures > a.big > span.fs"),person:{thumbs:$("div#profile > div.pictures > a.picture")}},data:{urlMembershipPopupContact:$("input#url-membership-popup-contact").val(),apiUrl:$("input#api-url-r").val(),roomId:$("input#room-id").val(),isActive:$("input#is-active").val()=="True",loggedIn:$("input#logged-in").val()=="True",MessageWriteFirst:$("input#write-message").val()=="True",CanContactOwner:$("input#can-contact-owner").val()=="True",ExternalAuth:$("input#external-auth").val()=="True",OwnerAccountId:$("input#owner-accountId").val(),PaymentPageUrl:$("input#payment-url").val(),messageStatus:"new",roomAccountId:$("input#roomAccountId").val()}},this.getApiUrl=function(){var n=this.getDOM();return n.data.apiUrl},this.getDOM=function(){var n=frm.ui.layout.getDOM();return $.extend(n,this.dom)},this.showPopup=function(){var t=this.getDOM();frm.services.ModalService.open({href:t.data.urlMembershipPopupContact,width:460,height:750,onAfterClose:function(){n.popupOnClosed()}})},this.popupOnClosed=function(){frm.events.dispatch("popup_on_closed")},this.prevPicture=function(){var n=this.getDOM(),t=n.pictures.bigLink.data("index");t--<=0&&(t=n.pictures.thumbs.length-1);n.pictures.thumbs.eq(t).trigger("click")},this.nextPicture=function(){var n=this.getDOM(),t=n.pictures.bigLink.data("index");t++>=n.pictures.thumbs.length-1&&(t=0);n.pictures.thumbs.eq(t).trigger("click")},this.scrollTo=function(n){location.href="#hidden-"+n},this.canContact=function(){var n=this.getDOM();return n.data.loggedIn&&n.data.isActive},this.setMessageStatus=function(n){var t=this.getDOM();t.data.messageStatus=n;switch(n){case"sending":t.contact.error.addClass("hide");t.contact.buttons.addClass("loading");break;case"sent":t.contact.message.hide();t.contact.sent.show();break;case"new":t.contact.message.show();t.contact.sent.hide();t.contact.buttons.removeClass("loading");t.contact.messageText.val("");t.contact.messageText.focus();break;case"error":t.contact.error.removeClass("hide");t.contact.buttons.removeClass("loading");t.contact.messageText.focus()}},this.init=function(){var t=this.getDOM(),i=$("a",t.navigation);i.on("click",function(){var t=$(this).data("rel");return n.scrollTo(t),i.removeClass("selected"),$(this).addClass("selected"),!1});t.contact.messageText.on("click",function(){frm.events.dispatch("started_new_message")});t.contact.send.on("click",function(){var i,r;if(t.data.messageStatus!="new"&&t.data.messageStatus!="error")return!1;if(i=t.contact.messageText.val(),t.data.MessageWriteFirst&&!t.data.CanContactOwner&&i.length>0)return n.setMessageStatus("sending"),frm.events.dispatch("add_to_payment_action",t.data.OwnerAccountId,i,t.data.PaymentPageUrl,!0,null),!1;if(!t.data.loggedIn)return t.contact.messageText.blur(),r=null,t.contact.messageText.val().length>0&&(r={OwnerAccountId:t.data.OwnerAccountId,MessageText:t.contact.messageText.val()}),frm.events.dispatch("trigger_new_popup",r),!1;if(t.data.OwnerAccountId===App.settings.account.id)return!1;if(i.length>0)return n.setMessageStatus("sending"),frm.events.dispatch("send_message",t.data.roomAccountId,i,t.data.ExternalAuth),!1;t.data.messageStatus="error"});t.contact.link.on("click",function(){return n.canContact()?(n.scrollTo("contact"),t.contact.messageText.focus()):n.showPopup(),!1});t.contact.showPopup.on("click",function(){return n.showPopup(),!1});t.contact.newMessage.on("click",function(){return n.setMessageStatus("new"),!1});t.pictures.bigLink.on("click",function(){return n.nextPicture(),!1});t.pictures.thumbs.on("click",function(){var n=$(this).attr("href"),i=$(this).data("index");return t.pictures.thumbs.removeClass("selected"),$(this).addClass("selected"),t.pictures.big.attr("src",n),t.pictures.bigLink.attr("href",n),t.pictures.bigLink.data("index",i),!1});t.pictures.person.thumbs.on("click",function(){var n=t.pictures.person.thumbs.index(this);return frm.ui.openImages(t.pictures.person.thumbs,n),!1});t.pictures.fullScreen.on("click",function(n){var i=$(this).parent().data("index");return frm.ui.openImages(t.pictures.thumbs,i),n.preventDefault(),!1});$(document).on("keydown",function(t){if(!$.fancybox.isOpen)t.keyCode==37&&n.prevPicture(),t.keyCode==39&&n.nextPicture()})},this.init(),t=window.location.hash.substr(1),t=="contact-owner"?(n.canContact()?(n.scrollTo("contact"),dom.contact.messageText.focus()):n.showPopup(),!1):void 0};frm.ui.layout.landlord.ExternRoomLayout=function(){var n=this;this.dom={map:$("div#map"),contact:{link:$(".open-contact")},data:{urlMembershipPopupContact:$("input#url-membership-popup-contact").val(),apiUrl:$("input#api-url-r").val(),roomId:$("input#room-id").val(),isActive:$("input#is-active").val()=="True",loggedIn:$("input#logged-in").val()=="True",messageStatus:"new"}};this.getApiUrl=function(){var n=this.getDOM();return n.data.apiUrl};this.getDOM=function(){var n=frm.ui.layout.getDOM();return $.extend(n,this.dom)};this.canContact=function(){var n=this.getDOM();return n.data.loggedIn&&n.data.isActive};this.showPopup=function(){var t=this.getDOM();frm.services.ModalService.open({href:t.data.urlMembershipPopupContact,width:460,height:600,onAfterClose:function(){n.popupOnClosed()}})};this.popupOnClosed=function(){frm.events.dispatch("popup_on_closed")};this.init=function(){var t=this.getDOM();t.contact.link.on("click",function(t){n.canContact()?alert("Kontakt.. :P"):n.showPopup();t.preventDefault()})};this.init()};frm.ui.layout.tenant.SearchAreasLayout=function(){var n=this;this.dom={map:{canvas:$("div#map")},find:{container:$("div#find"),input:$("input#area-input")},areas:{container:$("div#areas"),header:$("div#areas > h2"),list:$("ul#list")},fitAll:$("a#fit-all"),apiUrl:$("input#sa-apiurl")};this.getDOM=function(){var n=frm.ui.layout.getDOM();return $.extend(n,this.dom)};this.setRadius=function(n,t){var i=this.getDOM(),r=$("li[data-id='"+n+"'] > div.text > h4.radius",i.areas.list),u=Math.round(t/100)/10;r.text(u+" km")};this.init=function(){var t=this.getDOM();$(window).on("resize",function(){n.update()});this.autocomplete=new frm.maps.places.Autocomplete(t.find.input,t.top.country.val(),function(n,i){frm.events.dispatch("searcharea_added",n,i);t.find.input.val("");t.find.input.focus()});t.areas.list.on("click","a.remove",function(){var r=$(this).data("id"),u=$(this).siblings("a.primary"),n,i;return u.hasClass("on")&&(n=$("> li > div.text > a.primary:not(.on)",t.areas.list).first(),i=n.data("id"),n.addClass("on"),frm.events.dispatch("searcharea_primary",i)),frm.events.dispatch("searcharea_removed",r),!1});t.areas.list.on("click","a.primary",function(){var n=$(this).data("id"),i=$("a.primary",t.areas.list).not(this);return i.removeClass("on"),$(this).addClass("on"),frm.events.dispatch("searcharea_primary",n),!1});t.fitAll.on("click",function(){return frm.events.dispatch("searcharea_fitall"),!1});this.update()};this.update=function(){var n=this.getDOM();n.map.canvas.height($(window).height()-n.top.container.outerHeight());n.map.canvas.width($(window).width()-n.areas.container.outerWidth());n.map.canvas.css("left",n.areas.container.width()+"px");n.map.canvas.css("position","relative");n.areas.container.height($(window).height()-n.top.container.outerHeight());n.areas.container.css("top",n.top.container.outerHeight()+"px")};this.init()};frm.ui.layout.tenant.ProfileLayout=function(){var n=this;this.dom={map:$("div#map"),navigation:$("#tenant-profile nav.sections"),contact:{send:$("a#send-message"),messageText:$("#contact .comment-input textarea#message"),message:$("#contact .comment-input"),newMessage:$("a#new-message"),sent:$("#contact .sent"),link:$("a#contact-link"),showPopup:$("#contact > a.popup"),buttons:$("#contact .comment-input .buttons "),error:$("#contact .comment-input .buttons .error")},pictures:{container:$("div#pictures"),list:$("div#pictures > ul"),thumbs:$("div#profile > a.picture, div#pictures > ul > li > a")},data:{urlMembershipPopupContact:$("input#url-membership-popup-contact").val(),apiUrl:$("input#api-url-p").val(),tenantId:$("input#tenant-id").val(),isActive:$("input#is-active").val()=="True",loggedIn:$("input#logged-in").val()=="True",messageStatus:"new"}};this.getApiUrl=function(){var n=this.getDOM();return n.data.apiUrl};this.getDOM=function(){var n=frm.ui.layout.getDOM();return $.extend(n,this.dom)};this.showPopup=function(){var t=this.getDOM();frm.services.ModalService.open({href:t.data.urlMembershipPopupContact,width:460,height:720,onAfterClose:function(){n.popupOnClosed()}})};this.popupOnClosed=function(){frm.events.dispatch("popup_on_closed")};this.scrollTo=function(n){location.href="#hidden-"+n};this.canContact=function(){var n=this.getDOM();return n.data.loggedIn&&n.data.isActive};this.setMessageStatus=function(n,t){var i=this.getDOM();i.data.messageStatus=n;switch(n){case"sending":i.contact.error.text("");i.contact.buttons.addClass("loading");break;case"sent":i.contact.message.hide();i.contact.sent.show();break;case"new":i.contact.message.show();i.contact.sent.hide();i.contact.buttons.removeClass("loading");i.contact.messageText.val("");i.contact.messageText.focus();break;case"error":i.contact.error.text(t);i.contact.buttons.removeClass("loading");i.contact.messageText.focus()}};this.init=function(){var t=this.getDOM(),i=$("a",t.navigation);i.on("click",function(){var t=$(this).data("rel");return n.scrollTo(t),i.removeClass("selected"),$(this).addClass("selected"),!1});t.contact.send.on("click",function(){if(t.data.messageStatus!="new"&&t.data.messageStatus!="error")return!1;var i=t.contact.messageText.val();return n.setMessageStatus("sending"),frm.events.dispatch("send_message",t.data.tenantId,i),!1});t.contact.link.on("click",function(){return n.canContact()?(n.scrollTo("contact"),t.contact.messageText.focus()):n.showPopup(),!1});t.contact.showPopup.on("click",function(){return n.showPopup(),!1});t.contact.newMessage.on("click",function(){return n.setMessageStatus("new"),!1});t.pictures.thumbs.on("click",function(){var n=t.pictures.thumbs.index(this);return frm.ui.openImages(t.pictures.thumbs,n),!1})};this.init()};frm.ui.layout.misc.HomepageLayout=function(){var n={searchWrapper:$(".search-wrapper"),searchForm:{$el:$(".search-wrapper [role='form']"),$input:$(".search-wrapper [role='form']").find("[name='query']"),$button:$(".search-wrapper [role='form']").find("[name='submit']")},landlords:{room:$(".newest-landlords"),property:$(".newest-properties")}},t;this.dom=$.extend(frm.ui.layout.getDOM(),n);n.landlords.room.on("click","a",function(){frm.services.abTestService.scoreItem("18AE0D31-E3DD-4505-B84C-546A21E8012D",1)});n.landlords.property.on("click","a",function(){frm.services.abTestService.scoreItem("1DFE4DD4-8D89-45EC-858B-C6A168132FA9",1)});t=new frm.maps.places.Autocomplete(n.searchForm.$input,App.settings.countryCode)};frm.ui.layout.accounts.CreateAccountLayout=function(){function u(n,i,r,u){return function(f,e,o,s,h){f&&(h=="reactivated"?location.href=e:t({data:{account:{UserType:n}}},i,r,u))}}function t(t,i,r,u){var o=$("#create-account-settings"),e=n.$form.find("[name='voucherCode']").val(),f={onDefault:function(){location.href=t.data.account.UserType==0?o.attr("data-trial-owner")=="true"?u:r:i},onRedeemSuccess:function(){location.href=u}};e!==""?frm.services.VoucherService.redeem(e).then(f.onRedeemSuccess,f.onDefault):f.onDefault()}var n=this.dom=$.extend(frm.ui.layout.getDOM(),{$form:$("#create-account-form"),$openFacebook:$(".open-facebook"),$notFacebookRequired:$(".not-facebook-required"),$loading:$(".loading"),$openVoucherCode:$(".open-voucher-code"),$visibleForRoom:$(".visible-for-room"),$visibleForTenant:$(".visible-for-tenant")}),i=new frm.models.MailCheckViewModel,r;ko.applyBindings(i,document.getElementById("create-account-settings"));n.$openFacebook.on("click",function(t){$(".create-split").fadeOut(120,function(){$(this).text($(this).attr("data-secondary-text")).fadeIn(120)});n.$notFacebookRequired.filter(".keep").fadeOut(400,function(){$(this).show().css("visibility","hidden")}).end().filter(":not(.keep)").slideUp();setTimeout(function(){n.$form.find("[type='submit']").removeClass("green").addClass("blue")},200);n.$form.attr("data-mode","facebook");t.preventDefault()});$("[href='#Voucher']").on("click",function(t){n.$form.find(".voucher-code-container").slideDown();t.preventDefault()});r=$(".license-container").on("click",".fancy-license",function(){var n=r.find("[name='license']");n.prop("checked",!0)});n.$form.on("change","[name='userType']",function(){n.$form.find("[name='userType']:checked").val()=="0"?(n.$form.find(".room-details").slideDown(300),n.$visibleForRoom.show(),n.$visibleForTenant.hide()):(n.$form.find(".room-details").slideUp(300),n.$visibleForRoom.hide(),n.$visibleForTenant.show())}).on("keyup","[name='voucherCode']",frm.utils.debounce(function(){var n=$(".voucher-state"),t={onSuccess:function(){n.removeClass("well-error").addClass("well-success");n.find("img").hide().end().find(".icon-success").show()},onFailure:function(){n.removeClass("well-success").addClass("well-error");n.find("img").hide().end().find(".icon-error").show()}};n.is(":visible")||n.removeClass("add-on-invisible").find("img").hide().end().hide().fadeIn(200);frm.services.VoucherService.isRedeemable($(this).val()).then(t.onSuccess,t.onFailure)},200)).on("submit",function(r){var f=$(this),v=f.find("[name='username']"),y=f.find("[name='email']"),p=f.find("[name='password']"),l=f.find("[name='address']"),nt=f.find("[name='locality']"),tt=f.find("[name='streetNumber']"),s=f.find("[name='rent']"),it=f.find("[name='route']"),rt=f.find("[name='postalCode']"),ut=f.find("[name='country']"),ft=f.find("[name='countryCode']"),et=f.find("[name='city']"),ot=f.find("[name='sublocality']"),st=f.find("[name='latitude']"),ht=f.find("[name='longitude']"),ct=f.find("[name='userType']:checked"),w=f.find("[name='license']"),b=f.find(".alert"),o=b.find(".form-status-message"),k=n.$loading,e={mode:f.attr("data-mode"),isValid:!0},vt;f.find(".error:not(.alert)").removeClass("error");var d=v.val(),h=y.val(),g=p.val(),c=ct.val(),a=null,lt=i.mails(),at=w.is(":checked");e.mode!="facebook"&&d==""&&(v.addClass("error"),e.isValid=!1);e.mode!="facebook"&&(h==""||h.indexOf("@")<0||h.indexOf(".")<0)&&(y.addClass("error"),e.isValid=!1);e.mode!="facebook"&&g==""&&(p.addClass("error"),e.isValid=!1);at||(w.parents(".form-label:first-child").addClass("error"),e.isValid=!1);c=="0"&&(l.val()==""&&(l.addClass("error"),e.isValid=!1),s.val()!=""&&!isNaN(parseFloat(s.val()))&&isFinite(s.val())||(s.addClass("error"),e.isValid=!1),a={rent:s.val(),fullAddress:l.val(),route:it.val(),locality:nt.val(),streetNumber:tt.val(),country:ut.val(),countryCode:ft.val(),city:et.val(),subLocality:ot.val(),latitude:st.val(),longitude:ht.val(),postalCode:rt.val()});e.isValid&&(e.mode=="facebook"?(vt=u(parseInt(c),f.attr("data-success-tenant-url"),f.attr("data-success-room-url"),f.attr("data-success-url")),frm.services.accountService.createThroughFacebook({userType:c,room:a}).then(function(n){return t(n,f.attr("data-success-tenant-url"),f.attr("data-success-room-url"),f.attr("data-success-url"))})):f.fadeOut(300,function(){k.show();$(".hide-when-loading").css("visibility","hidden");frm.services.accountService.create(d,g,h,c,a,lt).done(function(n){return t(n,f.attr("data-success-tenant-url"),f.attr("data-success-room-url"),f.attr("data-success-url"))}).fail(function(n){var t=JSON.parse(n.responseText);if(n.status===409)switch(t.data.inUse){case"email":o.text(o.attr("data-error-email-inuse"));break;case"username":o.text(o.attr("data-error-username-inuse"))}else o.text(o.attr("data-error"));k.hide();$(".hide-when-loading").css("visibility","visible");f.fadeIn(300,function(){b.slideDown()})})}));r.preventDefault()})},function(n){function t(n){for(var r={},u=n.address_components,f=n.geometry.location,i,t=0;t<u.length;t++)i=u[t],r[i.types[0]]={long:i.long_name,short:i.short_name};return r.coords={lat:f.lat(),lng:f.lng()},r}n.bindingHandlers.googleMapsAutocomplete={init:function(n,i){var u=$(n),r=i(),f=r.country,e=r.event,o=new frm.maps.places.Autocomplete(u,f,function(n,i){var r=t(i);e(r)})}};n.bindingHandlers.customGoogleMapsAutocomplete={init:function(n,t,i){var r=$(n),u=i(),f=u.country,e=new frm.maps.places.PlacesService(f),o=new google.maps.places.PlacesService(n);this.placesService=e;this.googlePlacesService=o;r.on("keydown",function(n){var t=n.which;switch(t){case 40:i().selected(i().selected()+1);break;case 38:i().selected(i().selected()-1)}})},update:function(t,i,r){var u=n.unwrap(i()),f=this.googlePlacesService;typeof u!="undefined"&&u.length>0?this.placesService.getPlacePredictions(u,function(n){n=n.map(function(n){return n.googlePlacesService=f,n});r().results(n);r().selected(0)},"TERMS"):(r().results([]),r().selected(0))}}}(ko),function(){var t=[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#46bcec"},{visibility:"on"}]}],n={Property:"/Content/Images/Search/Maps/pin_external.png",CommomProperty:"/Content/Images/Search/Maps/pin_external_common.png",Room:"/Content/Images/Search/Maps/pin_exact.png"};ko.bindingHandlers.googlemap={init:function(r,u){function y(n,t){for(var r=0;r<t.length;r++){var i=t[r],f=new google.maps.LatLng(i.Latitude,i.Longitude),u=new google.maps.Marker({title:i.Title,position:f,map:n,url:i.Url,icon:p(i.Type)});i.Url!=null&&google.maps.event.addListener(u,"click",function(){window.open(this.url,"_blank")});s.push(u)}}function p(t){return t=="CommonInterest"?n.CommomProperty:t=="Property"?n.Property:t=="Room"?n.Room:void 0}var f=ko.unwrap(u()),h=f.latitude||f.Latitude,c=f.longitude||f.Longitude,l=f.locations||f.Locations,v={zoom:13,mapTypeId:google.maps.MapTypeId.ROADMAP,panControl:f.panControl||!1,streetViewControl:f.streetViewControl||!1,scrollwheel:f.scrollwheel||!1,styles:t},e=new google.maps.Map(r,v),s=[],o,a;if(l.length>0){for(y(e,l),o=new google.maps.LatLngBounds,i=0;i<s.length;i++)o.extend(s[i].getPosition());e.setCenter(o.getCenter());e.fitBounds(o);a=google.maps.event.addListener(e,"idle",function(){e.getZoom()>13&&e.setZoom(13);google.maps.event.removeListener(a)})}else h!=undefined&&c!=undefined&&e.setCenter(new google.maps.LatLng(h,c))}}}(),function(n,t){n.CreateLeadsViewModel=function(n){n=n||{};var i=this;i.campaignId=n.campaignId;i.languages=ko.observableArray(n.languages);i.sites=ko.observableArray(n.sites);i.model={city:ko.observable(),country:ko.observable(),site:ko.observable(),language:ko.observable(),radius:ko.observable(25e3),rent:ko.observable(5e3),emails:ko.observableArray()};i.creationState={items:ko.observableArray([]),headline:ko.observable("Vent venligst..."),isFinish:ko.observable(!1)};i.updateMapFields=function(n){i.model.city(n.locality.long);i.model.country(n.country.long)};i.emailView={email:ko.observable(),addEmails:function(){for(var t=i.emailView.email().split("\n"),n=0;n<t.length;n+=1)i.model.emails.push(t[n]);i.emailView.email("")},removeEmail:function(n){i.model.emails.remove(n)}};i.create=function(){i.step(1);t.createGroup(i.campaignId,i.model.site(),i.model.language(),i.model.city(),i.model.country(),i.model.radius(),i.model.rent()).then(function(n){var r=i.model.emails().map(function(r){var u={message:ko.observable(r),state:ko.observable("creating")},f;return i.creationState.items.push(u),f=new $.Deferred,t.registerEmail(n.data.LeadGroupId,r).done(function(n){u.state(n.status)}).fail(function(n){var t=JSON.parse(n.responseText);u.state(t.status);u.message(u.message()+" - "+t.message)}).always(function(){f.resolve()}),f.promise()});$.when.apply($,r).done(function(){i.creationState.headline("Leads er blevet gemt");i.creationState.isFinish(!0)})})};i.step=ko.observable(0)}}(frm.models,frm.services.LeadService),function(n,t,i){function r(n,t,i){this.campaignId=n;this.name=t;this.advertiserName=i}function u(n,t,i,r,u,f,e,o,s,h,c,l,a){this.leadId=n;this.email=ko.observable(t);this.isConverted=i;this.isSubscribed=ko.observable(r);this.timeCreated=u;this.cityName=f;this.rent=e;this.siteId=o;this.numberOfMails=s;this.radius=h;this.isRecievingEmails=c;this.languageId=l;this.name=a}function f(n){t.getCampaigns().then(function(t){var i=t.data.map(function(n){return new r(n.LeadCampaignId,n.CampaignName,n.AdvertiserName)});n.campaigns.push.apply(n.campaigns,i)})}n.OverviewLeadsViewModel=function(n){var r=this;n=n||{};r.campaigns=ko.observableArray();r.leads=ko.observableArray();r.selectedCampaign=ko.observable();r.selectedLead=ko.observable();r.selectCampaign=function(n){r.selectedCampaign(n);t.getLeads(n.campaignId).then(function(n){var t=n.data.map(function(n){return new u(n.LeadId,n.Email,n.IsConverted,n.IsSubscribed,n.TimeCreated,n.CityName,n.MaxRent,n.SiteId,n.NumberOfMails,n.Radius,n.IsRecievingEmails,n.LanguageId,n.Name)});r.leads.removeAll();r.leads.push.apply(r.leads,t)})};r.toggleSubscription=function(n){var r=n.isSubscribed(),u=!r;n.isSubscribed(u);t.toggleSubscription(n.leadId,u).fail(function(){n.isSubscribed(r);i.openError("A error happen; Could not change subscription")})};r.open=function(n){r.selectedLead(n);i.open({template:$("#test")})};r.archiveCampaign=function(n){t.archiveCampaign(n.campaignId).done(function(){r.campaigns.remove(r.selectedCampaign());r.selectedCampaign(undefined)}).fail(function(){i.openError("A error happen; Could not archive campaign")})};r.deleteLead=function(n){i.close();t.deleteLead(n.leadId).done(function(){r.leads.remove(n)}).fail(function(){r.leads.push(n);i.openError("A error happen; Could not delete lead")})};f(r)}}(frm.models,frm.services.LeadService,frm.services.ModalService),function(n){var t="GoldRoommate Subscription";ko.validation.rules.checkedTerms={validator:function(n){return!!n}};ko.validation.registerExtenders();n.PaymentCenterViewModel=function(n){n=n||{};var i=new frm.services.PaymentService(n.paymentServiceUrl),r=new frm.models.abtest.ABTestViewModel;this.orderId=n.orderId;this.license=ko.observable(!1).extend({checkedTerms:{message:n.texts.licenseRequired}});this.purchase=function(u){var f=ko.validation.group([this.license]);if(f().length==0){var o=u.ProductId,s=u.EpayInformation.CurrencyCode,h=u.EpayInformation.Price,c=u.EpayInformation.Text,l=u.EpayInformation.Description,a=this.orderId,e="";n.testItemActiveId!=""&&(e="&ABTestItemId="+n.testItemActiveId+"&ABTestStep=3");i.beginOrder(a,o,function(){var i=new PaymentWindow({merchantnumber:n.merchantId,amount:h,currency:s,accepturl:n.acceptedUrl,declineurl:n.rejectedUrl,callbackurl:n.callbackUrl+e,Instantcallback:"1",instantcapture:"1",ordertext:c,group:t,description:l,windowstate:"1",authmail:"",addfee:"0",language:n.languageId,subscription:1});i.open();r.Score(n.abTestId,1,2)})}else f.showAllMessages()};this.continueAsFree=function(){location.href=n.continueUrl}}}(frm.models,jQuery,frm.services.ModalService),function(n,t){var i="GoldRoommate Subscription";ko.validation.rules.checkedTerms={validator:function(n){return!!n}};ko.validation.registerExtenders();n.BecomeMemberViewModel=function(n){n=n||{};var r=new frm.services.PaymentService(n.paymentServiceUrl);this.orderId=n.orderId;this.license=ko.observable(!1).extend({checkedTerms:{message:n.texts.licenseRequired}});this.InitiateEpay=function(u,f){var s=f,h=u.ProductId,c=u.EpayInformation.CurrencyCode,l=u.EpayInformation.Price,a=u.EpayInformation.Text,v=u.EpayInformation.Description,y=this.orderId,o="1",e;n.windowState&&(o=n.windowState);e={merchantnumber:n.merchantId,amount:l,currency:c,accepturl:n.acceptedUrl,declineurl:n.rejectedUrl,callbackurl:n.callbackUrl,Instantcallback:"1",instantcapture:"1",ordertext:a,group:i,description:v,windowstate:o,authmail:"",addfee:"0",language:n.languageId,subscription:1,googletracker:n.analyticsId,description:App.settings.account.id};o=="4"&&(e.iframeheight=t(".order-summery").outerHeight()+t(".read-terms").outerHeight()+370,e.iframewidth=t("#payment-div").width(),e.mobile="0",n.cssurl!="undefined"&&(e.cssurl=n.cssurl));r.beginOrder(y,h,function(){var i=new PaymentWindow(e);if(o=="1"&&(t(window).scrollTop(0),i.open()),o=="4"){i.on("precompleted",function(){if(t(".terms-checkbox").is(":checked"))i.submit();else{var n=ko.validation.group([s.license]);n().length!=0&&n.showAllMessages()}});i.append("payment-div");i.open();n.displayPaymentBox()}})};this.purchase=function(t){var i=ko.validation.group([this.license]);i().length==0?this.InitiateEpay(t,this):(i.showAllMessages(),alert(n.texts.licenseRequired))};this.continueAsFree=function(){location.href=n.continueUrl};n.windowState&&n.windowState=="4"&&(n.product?this.InitiateEpay(n.product,this):console.log("Product was not found, please contact Findroommate Support."))}}(frm.models,jQuery,frm.services.ModalService),function(n){ko.validation.rules.checkedTermsIdeal={validator:function(n){return!!n}};ko.validation.registerExtenders();n.BecomeMemberViewModelIdeal=function(n){n=n||{};var t=new frm.services.PaymentService(n.paymentServiceUrl);this.orderId=n.orderId;this.licenseIdeal=ko.observable(!1).extend({checkedTermsIdeal:{message:n.texts.licenseIdealRequired}});this.InitiateIdeal=function(i,r){var u=r,f=ko.validation.group([u.licenseIdeal]);if(f().length!=0&&f.showAllMessages(),u.licenseIdeal()){var e=i.ProductId,s=i.EpayInformation.CurrencyCode,h=i.EpayInformation.Price,c=i.EpayInformation.Text,l=i.EpayInformation.Description,o=this.orderId;t.beginOrderV2(o,e,1,n,function(n){location.href=n})}};this.purchaseIdeal=function(t){var i=ko.validation.group([this.licenseIdeal]);i().length==0?this.InitiateIdeal(t,this):(i.showAllMessages(),alert(n.texts.licenseIdealRequired))}}}(frm.models,jQuery,frm.services.ModalService),function(){frm.models.AccountSignInViewModel=function(n){function i(t){t.then(function(t){var r=!0,i;t.data.isExistingUser&&(r=!1);r===!0&&(i="Default signup",frm.services.TrackingService.vendor.enroll(i),frm.services.TrackingService.vendor.tenantEnroll(i));n.onAuthenticated(t)},n.onAuthenticationFailed)}var t=this;t.username=ko.observable().extend({required:!0});t.password=ko.observable().extend({required:!0});t.rememberMe=ko.observable(!0);t.error=ko.observable();t.isLoading=ko.observable(!1);t.authenticateThroughFacebook=function(){i(frm.services.AuthenticationService.authenticateThroughFacebook(t.rememberMe()))};t.authenticateThroughGoogle=function(){i(frm.services.AuthenticationService.authenticateThroughGoogle(t.rememberMe()))};t.authenticate=function(){var n=ko.validation.group([t.username,t.password]);n().length==0?(t.isLoading(!0),i(frm.services.AuthenticationService.authenticate(t.username(),t.password(),t.rememberMe()))):n.showAllMessages()}}}();$(function(){$(".faq-container").on("click",".faq-item h2",function(n){var t=$(this).parent(".faq-item");t.find(".openedItem").slideToggle(600,function(){t.toggleClass("opened")});n.preventDefault()});$("[role='form'][data-action='contact-us']").on("click","[data-submit]",function(n){function r(n,t,i){n.removeClass(n.data("custom-classes")).addClass(i).data("custom-classes",i).show().html(n.attr(t))}var u=$(this),i=u.parents("[role='form']"),t={$status:i.find(".messageStatus"),$name:i.find("[name='name']"),$email:i.find("[name='email']"),$message:i.find("[name='message']"),$button:u};t.$message.val()==""?r(t.$status,"data-missing","error"):$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:"/API/Support/SupportAPI.asmx/SendContactMail",data:JSON.stringify({Name:t.$name.val()||"",Email:t.$email.val()||"",Message:t.$message.val()})}).success(function(n){var i=n.d;i.IsValid?(r(t.$status,"data-success","success"),t.$name.attr("disabled","disabled"),t.$email.attr("disabled","disabled"),t.$message.attr("disabled","disabled"),t.$button.attr("disabled","disabled")):r(t.$status,"data-error","error")});n.preventDefault()});$("[data-toggle]").on("click",function(n){var t=$(this),i=t.attr("data-toggle");$(i).slideToggle(600);n.preventDefault()});$(".flags").on("click",".item",function(n){var i=$(this),t=i.attr("data-countryCode");$("#txtCountry").val(t);$("#currentCountryFlag").attr("class","flag flag-"+t);n.preventDefault()});$(".fancybox").fancybox({openEffect:"none",closeEffect:"none"}),function(){var n=$("#moveInDatePicker"),t=n.attr("data-updateInput"),i=new Date($(t).attr("data-javascript-date"));n.datepicker({inline:!0,onSelect:function(n){$(t).val(n)}}).datepicker("setDate",i)}();$(".range-group .range").each(function(){var n=$(this),t=parseInt(n.attr("data-min")),i=parseInt(n.attr("data-max")),r=$.map(n.attr("data-range").split(","),function(n){return parseInt(n)});n.slider({range:!0,min:t,max:i,values:r,step:1,slide:function(n,t){var i=t.values[0],r=t.values[1],u=$("[data-slider='.range']");u.filter("[data-slider-show='min']").filter("input").val(i).end().filter(":not(input)").html(i).end();u.filter("[data-slider-show='max']").filter("input").val(r).end().filter(":not(input)").html(r).end()}})});$(".alert.fade:not(.hide)").hide().fadeIn(550);$("form[data-action='report']").on("submit",function(n){n.preventDefault()});(function(){function r(t){n.find("[data-view]").not(t).hide();t.show()}function u(n,t){n.html(n.attr(t))}function e(n){r(t);n.preventDefault()}var n=$("[data-controller='report']"),f=n.find("[data-view='requestReport']"),t=n.find("[data-view='writeReport']"),i=n.find("[data-view='responseReport']");f.on("click",".write-report",e);t.on("change","#ListOfReportCategories",function(){var i=$(this),n=t.find(".need-category");i.val().length>0?n.slideDown():n.slideUp()});t.on("submit","form",function(n){var t=$(this),f=t.attr("data-itemType"),e=t.attr("data-itemId"),o=t.find("[name='reason']").val(),s=t.find("#ListOfReportCategories").val();frm.services.ReportService.report({itemType:f,itemId:e,reason:o,category:s}).done(function(){u(i,"data-text-success")}).fail(function(n){switch(n.status){case 403:u(i,"data-text-not-authorized");break;default:u(i,"data-text-error")}}).always(function(){r(i)});n.preventDefault()});r(f)})();$(".fancy-license").on("click",function(n){var t=$(this).attr("href");frm.services.ModalService.open({href:t,width:460,height:600,onAfterClose:function(){$(".fancybox-overlay").hide();$("html").removeClass("fancybox-lock");$("html").removeClass("fancybox-margin")}});n.preventDefault()});$(".navbar-menu").on("mouseover",".navbar-menu-item",function(){var n=$(this),t=n.find(".navbar-menu-item-tooltip"),i=t.outerWidth(!0)-n.outerWidth(!0),r=-1*Math.round(i/2);t.css("left",r+"px")});frm.utils.PaymentUrlHelper=function(n,t){if(App.settings.currentSiteId==1){var i=n();frm.models.GenericPopupViewModel.create(i).then(function(){i.Areas.Payment.SetStartPaymentFlowView()})}else window.location.href=t};frm.utils.GetPaymentPopupSplitTest=function(){return frm.services.abTestService.getSplitTest("PaymentPopup",1)};frm.utils.PaymentSplitTestTracking=function(n){frm.utils.ABTestTrackingHelper("PaymentPopup",n,undefined,undefined)};frm.utils.ABTestTrackingHelper=function(n,t,i,r){var u,f;i!=undefined&&frm.services.abTestService.scoreItem(i,r);u="";App.settings.account.isLoggedIn&&(u=App.settings.account.id);f="Experiment: "+n+" v1";analytics.identify(u,{exName:t})}})